---
uid: web-forms/overview/deployment/configuring-team-foundation-server-for-web-deployment/creating-a-build-definition-that-supports-deployment
title: "Criando uma definição de compilação que dá suporte à implantação | Microsoft Docs"
author: jrjlee
description: "Se você quiser executar qualquer tipo de compilação no Team Foundation Server (TFS) 2010, você precisa criar uma definição de compilação em seu projeto de equipe. Des neste tópico..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 05/04/2012
ms.topic: article
ms.assetid: fe47a018-f6d0-4979-80e7-5b1fa75a5865
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/deployment/configuring-team-foundation-server-for-web-deployment/creating-a-build-definition-that-supports-deployment
msc.type: authoredcontent
ms.openlocfilehash: c2e7a768c2cf9900731b822ec187093a4b250ead
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 11/10/2017
---
<a name="creating-a-build-definition-that-supports-deployment"></a><span data-ttu-id="99c6b-104">Criando uma definição de compilação que dá suporte à implantação</span><span class="sxs-lookup"><span data-stu-id="99c6b-104">Creating a Build Definition That Supports Deployment</span></span>
====================
<span data-ttu-id="99c6b-105">por [Jason Lee](https://github.com/jrjlee)</span><span class="sxs-lookup"><span data-stu-id="99c6b-105">by [Jason Lee](https://github.com/jrjlee)</span></span>

[<span data-ttu-id="99c6b-106">Baixar PDF</span><span class="sxs-lookup"><span data-stu-id="99c6b-106">Download PDF</span></span>](https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/63/56/8130.DeployingWebAppsInEnterpriseScenarios.pdf)

> <span data-ttu-id="99c6b-107">Se você quiser executar qualquer tipo de compilação no Team Foundation Server (TFS) 2010, você precisa criar uma definição de compilação em seu projeto de equipe.</span><span class="sxs-lookup"><span data-stu-id="99c6b-107">If you want to perform any kind of build in Team Foundation Server (TFS) 2010, you need to create a build definition within your team project.</span></span> <span data-ttu-id="99c6b-108">Este tópico descreve como criar uma nova definição de compilação no TFS e como controlar a implantação da web como parte do processo de compilação no Team Build.</span><span class="sxs-lookup"><span data-stu-id="99c6b-108">This topic describes how to create a new build definition in TFS and how to control web deployment as part of the build process in Team Build.</span></span>


<span data-ttu-id="99c6b-109">Este tópico faz parte de uma série de tutoriais com base em torno de requisitos de implantação corporativa de uma empresa fictícia chamada Fabrikam, Inc. Esta série de tutoriais usa uma solução de exemplo & #x 2014; o [solução Contact Manager](../web-deployment-in-the-enterprise/the-contact-manager-solution.md)& #x 2014; para representar um aplicativo web com um nível realista de complexidade, incluindo um aplicativo ASP.NET MVC 3, Windows Serviço do Communication Foundation (WCF) e um projeto de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="99c6b-109">This topic forms part of a series of tutorials based around the enterprise deployment requirements of a fictional company named Fabrikam, Inc. This tutorial series uses a sample solution&#x2014;the [Contact Manager solution](../web-deployment-in-the-enterprise/the-contact-manager-solution.md)&#x2014;to represent a web application with a realistic level of complexity, including an ASP.NET MVC 3 application, a Windows Communication Foundation (WCF) service, and a database project.</span></span>

<span data-ttu-id="99c6b-110">O método de implantação no centro desses tutoriais baseia-se a abordagem de arquivo de projeto divisão descrita em [Noções básicas sobre o arquivo de projeto](../web-deployment-in-the-enterprise/understanding-the-project-file.md), no qual o processo de compilação e implantação é controlado por meio de dois arquivos de projeto & #x 2014; o ne contendo instruções de compilação que se aplicam a todos os ambientes de destino e que contém configurações específicas ao ambiente de compilação e implantação.</span><span class="sxs-lookup"><span data-stu-id="99c6b-110">The deployment method at the heart of these tutorials is based on the split project file approach described in [Understanding the Project File](../web-deployment-in-the-enterprise/understanding-the-project-file.md), in which the build and deployment process is controlled by two project files&#x2014;one containing build instructions that apply to every destination environment, and one containing environment-specific build and deployment settings.</span></span> <span data-ttu-id="99c6b-111">No momento da compilação, o arquivo de projeto específico do ambiente é mesclado no arquivo de projeto de ambiente independente para formar um conjunto completo de instruções de compilação.</span><span class="sxs-lookup"><span data-stu-id="99c6b-111">At build time, the environment-specific project file is merged into the environment-agnostic project file to form a complete set of build instructions.</span></span>

## <a name="task-overview"></a><span data-ttu-id="99c6b-112">Visão geral da tarefa</span><span class="sxs-lookup"><span data-stu-id="99c6b-112">Task Overview</span></span>

<span data-ttu-id="99c6b-113">Uma definição de compilação é o mecanismo que controla como e quando as compilações ocorrem para projetos de equipe no TFS.</span><span class="sxs-lookup"><span data-stu-id="99c6b-113">A build definition is the mechanism that controls how and when builds occur for team projects in TFS.</span></span> <span data-ttu-id="99c6b-114">Cada definição de compilação especifica:</span><span class="sxs-lookup"><span data-stu-id="99c6b-114">Each build definition specifies:</span></span>

- <span data-ttu-id="99c6b-115">As coisas que você deseja criar, como arquivos de solução do Visual Studio ou arquivos de projeto Microsoft Build Engine (MSBuild) personalizados.</span><span class="sxs-lookup"><span data-stu-id="99c6b-115">The things you want to build, like Visual Studio solution files or custom Microsoft Build Engine (MSBuild) project files.</span></span>
- <span data-ttu-id="99c6b-116">Os critérios que determinam quando uma compilação deve levar colocar, como gatilhos manuais, CI (integração contínua), ou check-ins restritos.</span><span class="sxs-lookup"><span data-stu-id="99c6b-116">The criteria that determine when a build should take place, like manual triggers, continuous integration (CI), or gated check-ins.</span></span>
- <span data-ttu-id="99c6b-117">O local para o qual o Team Build deve enviar saídas de compilação, incluindo artefatos de implantação como pacotes da web e scripts de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="99c6b-117">The location to which Team Build should send build outputs, including deployment artifacts like web packages and database scripts.</span></span>
- <span data-ttu-id="99c6b-118">A quantidade de tempo que deve ser mantida cada compilação.</span><span class="sxs-lookup"><span data-stu-id="99c6b-118">The amount of time that each build should be retained.</span></span>
- <span data-ttu-id="99c6b-119">Vários outros parâmetros do processo de compilação.</span><span class="sxs-lookup"><span data-stu-id="99c6b-119">Various other parameters of the build process.</span></span>

> [!NOTE]
> <span data-ttu-id="99c6b-120">Para obter mais informações sobre definições de compilação, consulte [definir seu processo de criação](https://msdn.microsoft.com/en-us/library/ms181715.aspx).</span><span class="sxs-lookup"><span data-stu-id="99c6b-120">For more information on build definitions, see [Define Your Build Process](https://msdn.microsoft.com/en-us/library/ms181715.aspx).</span></span>


<span data-ttu-id="99c6b-121">Neste tópico mostram como criar uma definição de compilação que usa CI, para que uma compilação é acionada quando um desenvolvedor verifica no novo conteúdo.</span><span class="sxs-lookup"><span data-stu-id="99c6b-121">This topic will show you how to create a build definition that uses CI, so that a build is triggered when a developer checks in new content.</span></span> <span data-ttu-id="99c6b-122">Se a compilação for bem-sucedida, o serviço de compilação é executado em um arquivo de projeto personalizados para implantar a solução em um ambiente de teste.</span><span class="sxs-lookup"><span data-stu-id="99c6b-122">If the build succeeds, the build service runs a custom project file to deploy the solution to a test environment.</span></span>

<span data-ttu-id="99c6b-123">Quando você acionar uma compilação, essas ações precisam ocorrer:</span><span class="sxs-lookup"><span data-stu-id="99c6b-123">When you trigger a build, these actions need to happen:</span></span>

- <span data-ttu-id="99c6b-124">Primeiro, o Team Build Compile a solução.</span><span class="sxs-lookup"><span data-stu-id="99c6b-124">First, Team Build should build the solution.</span></span> <span data-ttu-id="99c6b-125">Como parte desse processo, Team Build chamará o Pipeline de publicação de Web (WPP) para gerar pacotes de implantação da web para cada um dos projetos de aplicativo web na solução.</span><span class="sxs-lookup"><span data-stu-id="99c6b-125">As part of this process, Team Build will invoke the Web Publishing Pipeline (WPP) to generate web deployment packages for each of the web application projects in the solution.</span></span> <span data-ttu-id="99c6b-126">Team Build também executará testes de unidade associados com a solução.</span><span class="sxs-lookup"><span data-stu-id="99c6b-126">Team Build will also run any unit tests associated with the solution.</span></span>
- <span data-ttu-id="99c6b-127">Se houver falha na criação de solução, Team Build não deve tomar nenhuma ação adicional.</span><span class="sxs-lookup"><span data-stu-id="99c6b-127">If the solution build fails, Team Build should take no further action.</span></span> <span data-ttu-id="99c6b-128">Falhas de teste de unidade devem ser tratadas como uma falha de compilação.</span><span class="sxs-lookup"><span data-stu-id="99c6b-128">Unit test failures should be treated as a build failure.</span></span>
- <span data-ttu-id="99c6b-129">Se a compilação de solução for bem-sucedida, o Team Build deve executar o arquivo de projeto personalizados que controla a implantação da solução.</span><span class="sxs-lookup"><span data-stu-id="99c6b-129">If the solution build succeeds, Team Build should run the custom project file that controls the deployment of the solution.</span></span> <span data-ttu-id="99c6b-130">Como parte desse processo, Team Build invocará a ferramenta de implantação da Web de serviços de informações da Internet (IIS) (implantação da Web) para instalar os aplicativos empacotados web nos servidores da web de destino e ele invocará o utilitário VSDBCMD.exe para executar a criação do banco de dados scripts nos servidores de banco de dados de destino.</span><span class="sxs-lookup"><span data-stu-id="99c6b-130">As part of this process, Team Build will invoke the Internet Information Services (IIS) Web Deployment Tool (Web Deploy) to install the packaged web applications on the destination web servers, and it will invoke the VSDBCMD.exe utility to run database creation scripts on the destination database servers.</span></span>

<span data-ttu-id="99c6b-131">Isso ilustra o processo:</span><span class="sxs-lookup"><span data-stu-id="99c6b-131">This illustrates the process:</span></span>

![](creating-a-build-definition-that-supports-deployment/_static/image1.png)

<span data-ttu-id="99c6b-132">O [Contact Manager](../web-deployment-in-the-enterprise/the-contact-manager-solution.md) solução de exemplo inclui um arquivo de projeto MSBuild personalizado, *Publish.proj*, que você pode executar do MSBuild ou Team Build.</span><span class="sxs-lookup"><span data-stu-id="99c6b-132">The [Contact Manager](../web-deployment-in-the-enterprise/the-contact-manager-solution.md) sample solution includes a custom MSBuild project file, *Publish.proj*, that you can run from MSBuild or Team Build.</span></span> <span data-ttu-id="99c6b-133">Conforme descrito em [Noções básicas sobre o processo de compilação](../web-deployment-in-the-enterprise/understanding-the-build-process.md), esse arquivo de projeto define a lógica que implanta os pacotes de web e os bancos de dados em um ambiente de destino.</span><span class="sxs-lookup"><span data-stu-id="99c6b-133">As described in [Understanding the Build Process](../web-deployment-in-the-enterprise/understanding-the-build-process.md), this project file defines the logic that deploys your web packages and databases to a target environment.</span></span> <span data-ttu-id="99c6b-134">O arquivo inclui a lógica que omite a construção e o processo de empacotamento, se ele estiver em execução no Team Build, deixando apenas as tarefas de implantação para ser executado.</span><span class="sxs-lookup"><span data-stu-id="99c6b-134">The file includes logic that omits the building and packaging process if it's running in Team Build, leaving just the deployment tasks to run.</span></span> <span data-ttu-id="99c6b-135">Isso ocorre porque quando você automatizar a implantação dessa forma, você geralmente fará garantir que a solução seja criada com êxito e passa o teste de unidade antes de começa o processo de implantação.</span><span class="sxs-lookup"><span data-stu-id="99c6b-135">This is because when you automate deployment in this way, you'll typically want to ensure that the solution builds successfully and passes any unit tests before the deployment process commences.</span></span>

<span data-ttu-id="99c6b-136">A próxima seção explica como implementar esse processo, criando uma nova definição de compilação.</span><span class="sxs-lookup"><span data-stu-id="99c6b-136">The next section explains how to implement this process by creating a new build definition.</span></span>

> [!NOTE]
> <span data-ttu-id="99c6b-137">Esse procedimento & #x 2014; em que um único processo automatizado compilações, testes e implanta uma solução & #x 2014; provavelmente será mais adequado para implantação em ambientes de teste.</span><span class="sxs-lookup"><span data-stu-id="99c6b-137">This procedure&#x2014;in which a single automated process builds, tests, and deploys a solution&#x2014;is likely to be most suited to deployment to test environments.</span></span> <span data-ttu-id="99c6b-138">Para ambientes de preparo e produção estiver muito provavelmente deseja implantar o conteúdo de um build anterior que você já tiver verificado e validado em um ambiente de teste.</span><span class="sxs-lookup"><span data-stu-id="99c6b-138">For staging and production environments you're a lot more likely to want to deploy content from a previous build that you've already verified and validated in a test environment.</span></span> <span data-ttu-id="99c6b-139">Essa abordagem é descrita no próximo tópico, [Implantando um Build específico](deploying-a-specific-build.md).</span><span class="sxs-lookup"><span data-stu-id="99c6b-139">This approach is described in the next topic, [Deploying a Specific Build](deploying-a-specific-build.md).</span></span>


### <a name="who-performs-this-procedure"></a><span data-ttu-id="99c6b-140">Que executa este procedimento?</span><span class="sxs-lookup"><span data-stu-id="99c6b-140">Who Performs This Procedure?</span></span>

<span data-ttu-id="99c6b-141">Normalmente, um administrador do TFS executa este procedimento.</span><span class="sxs-lookup"><span data-stu-id="99c6b-141">Typically, a TFS administrator performs this procedure.</span></span> <span data-ttu-id="99c6b-142">Em alguns casos, um líder de equipe do desenvolvedor pode assumir a responsabilidade para a coleção de projeto de equipe no TFS.</span><span class="sxs-lookup"><span data-stu-id="99c6b-142">In some cases, a developer team leader may take responsibility for the team project collection in TFS.</span></span> <span data-ttu-id="99c6b-143">Para criar uma nova definição de compilação, você precisa ser um membro do **administradores de compilação do projeto coleção** grupo para a coleção de projeto de equipe que contém sua solução.</span><span class="sxs-lookup"><span data-stu-id="99c6b-143">In order to create a new build definition, you need to be a member of the **Project Collection Build Administrators** group for the team project collection that contains your solution.</span></span>

## <a name="create-a-build-definition-for-ci-and-deployment"></a><span data-ttu-id="99c6b-144">Criar uma definição de compilação para implantação e CI</span><span class="sxs-lookup"><span data-stu-id="99c6b-144">Create a Build Definition for CI and Deployment</span></span>

<span data-ttu-id="99c6b-145">O procedimento a seguir descreve como criar uma definição de compilação que dispara o IC.</span><span class="sxs-lookup"><span data-stu-id="99c6b-145">The next procedure describes how to create a build definition that CI triggers.</span></span> <span data-ttu-id="99c6b-146">Se a compilação for bem-sucedida, a solução é implantada usando a lógica em um arquivo de projeto MSBuild personalizado.</span><span class="sxs-lookup"><span data-stu-id="99c6b-146">If the build succeeds, the solution is deployed using the logic in a custom MSBuild project file.</span></span>

<span data-ttu-id="99c6b-147">**Para criar uma definição de compilação de CI e implantação**</span><span class="sxs-lookup"><span data-stu-id="99c6b-147">**To create a build definition for CI and deployment**</span></span>

1. <span data-ttu-id="99c6b-148">No Visual Studio 2010, no **Team Explorer** janela, expanda o nó do projeto de equipe, clique com botão direito **cria**e, em seguida, clique em **nova definição de compilação**.</span><span class="sxs-lookup"><span data-stu-id="99c6b-148">In Visual Studio 2010, in the **Team Explorer** window, expand your team project node, right-click **Builds**, and then click **New Build Definition**.</span></span>

    ![](creating-a-build-definition-that-supports-deployment/_static/image2.png)
2. <span data-ttu-id="99c6b-149">Sobre o **geral** guia, nomeie a definição de compilação (por exemplo, **DeployToTest**) e uma descrição opcional.</span><span class="sxs-lookup"><span data-stu-id="99c6b-149">On the **General** tab, give the build definition a name (for example, **DeployToTest**) and an optional description.</span></span>
3. <span data-ttu-id="99c6b-150">Sobre o **gatilho** guia, selecione os critérios nos quais você deseja disparar uma nova compilação.</span><span class="sxs-lookup"><span data-stu-id="99c6b-150">On the **Trigger** tab, select the criteria on which you want to trigger a new build.</span></span> <span data-ttu-id="99c6b-151">Por exemplo, se você deseja criar a solução e implantar o ambiente de teste toda vez que um desenvolvedor verifica no novo, selecione **integração contínua**.</span><span class="sxs-lookup"><span data-stu-id="99c6b-151">For example, if you want to build the solution and deploy to the test environment every time a developer checks in new code, select **Continuous Integration**.</span></span>
4. <span data-ttu-id="99c6b-152">No **padrões de compilação** guia o **copiar saída da compilação para a seguinte pasta-depósito** caixa, digite o caminho de convenção de nomenclatura Universal (UNC) da sua pasta de armazenamento (por exemplo,  **\\TFSBUILD\Drops**).</span><span class="sxs-lookup"><span data-stu-id="99c6b-152">On the **Build Defaults** tab, in the **Copy build output to the following drop folder** box, type the Universal Naming Convention (UNC) path of your drop folder (for example, **\\TFSBUILD\Drops**).</span></span>

    ![](creating-a-build-definition-that-supports-deployment/_static/image3.png)

    > [!NOTE]
    > <span data-ttu-id="99c6b-153">Esse local de destino armazena várias compilações, dependendo da política de retenção que você configurar.</span><span class="sxs-lookup"><span data-stu-id="99c6b-153">This drop location stores several builds, depending on the retention policy you configure.</span></span> <span data-ttu-id="99c6b-154">Quando você deseja publicar os artefatos de implantação de uma compilação específica para um ambiente de preparo ou produção, isso é onde você encontrará-los.</span><span class="sxs-lookup"><span data-stu-id="99c6b-154">When you want to publish deployment artifacts from a specific build to a staging or production environment, this is where you'll find them.</span></span>
5. <span data-ttu-id="99c6b-155">No **processo** guia o **arquivo do processo de compilação** lista suspensa, deixe **DefaultTemplate.xaml** selecionado.</span><span class="sxs-lookup"><span data-stu-id="99c6b-155">On the **Process** tab, in the **Build process file** dropdown list, leave **DefaultTemplate.xaml** selected.</span></span> <span data-ttu-id="99c6b-156">Este é um dos modelos de processo padrão compilação que são adicionados a todos os novos projetos de equipe.</span><span class="sxs-lookup"><span data-stu-id="99c6b-156">This is one of the default build process templates that get added to all new team projects.</span></span>
6. <span data-ttu-id="99c6b-157">No **parâmetros de processo de compilação** da tabela, clique no **itens a serem compilados** de linha e, em seguida, clique no **reticências** botão.</span><span class="sxs-lookup"><span data-stu-id="99c6b-157">In the **Build process parameters** table, click in the **Items to Build** row, and then click the **ellipsis** button.</span></span>

    ![](creating-a-build-definition-that-supports-deployment/_static/image4.png)
7. <span data-ttu-id="99c6b-158">No **itens a serem compilados** caixa de diálogo, clique em **adicionar**.</span><span class="sxs-lookup"><span data-stu-id="99c6b-158">In the **Items to Build** dialog box, click **Add**.</span></span>
8. <span data-ttu-id="99c6b-159">Navegue até o local do arquivo de solução e, em seguida, clique em **Okey**.</span><span class="sxs-lookup"><span data-stu-id="99c6b-159">Browse to the location of your solution file, and then click **OK**.</span></span>

    ![](creating-a-build-definition-that-supports-deployment/_static/image5.png)
9. <span data-ttu-id="99c6b-160">No **itens a serem compilados** caixa de diálogo, clique em **adicionar**.</span><span class="sxs-lookup"><span data-stu-id="99c6b-160">In the **Items to Build** dialog box, click **Add**.</span></span>
10. <span data-ttu-id="99c6b-161">No **itens do tipo** lista suspensa, selecione **arquivos de projeto MSBuild**.</span><span class="sxs-lookup"><span data-stu-id="99c6b-161">In the **Items of type** dropdown list, select **MSBuild Project files**.</span></span>
11. <span data-ttu-id="99c6b-162">Navegue até o local do arquivo de projeto personalizado com o qual você controla o processo de implantação, selecione o arquivo e, em seguida, clique em **Okey**.</span><span class="sxs-lookup"><span data-stu-id="99c6b-162">Browse to the location of the custom project file with which you control the deployment process, select the file, and then click **OK**.</span></span>

    ![](creating-a-build-definition-that-supports-deployment/_static/image6.png)
12. <span data-ttu-id="99c6b-163">O **itens a serem compilados** caixa de diálogo agora deve mostrar os dois itens.</span><span class="sxs-lookup"><span data-stu-id="99c6b-163">The **Items to Build** dialog box should now show two items.</span></span> <span data-ttu-id="99c6b-164">Clique em **OK**.</span><span class="sxs-lookup"><span data-stu-id="99c6b-164">Click **OK**.</span></span>

    ![](creating-a-build-definition-that-supports-deployment/_static/image7.png)
13. <span data-ttu-id="99c6b-165">No **processo** guia o **parâmetros de processo de compilação** da tabela, expanda o **avançado** seção.</span><span class="sxs-lookup"><span data-stu-id="99c6b-165">On the **Process** tab, in the **Build process parameters** table, expand the **Advanced** section.</span></span>
14. <span data-ttu-id="99c6b-166">No **argumentos de MSBuild** de linha, adicione quaisquer argumentos de linha de comando do MSBuild que *ou* os itens para criar requer.</span><span class="sxs-lookup"><span data-stu-id="99c6b-166">In the **MSBuild Arguments** row, add any MSBuild command-line arguments that *either* of your items to build requires.</span></span> <span data-ttu-id="99c6b-167">No cenário de solução do gerente do contato, esses argumentos são necessários:</span><span class="sxs-lookup"><span data-stu-id="99c6b-167">In the Contact Manager solution scenario, these arguments are required:</span></span>

    [!code-console[Main](creating-a-build-definition-that-supports-deployment/samples/sample1.cmd)]

    ![](creating-a-build-definition-that-supports-deployment/_static/image8.png)
15. <span data-ttu-id="99c6b-168">Neste exemplo:</span><span class="sxs-lookup"><span data-stu-id="99c6b-168">In this example:</span></span>

    1. <span data-ttu-id="99c6b-169">O **DeployOnBuild = true** e **DeployTarget = pacote** argumentos são necessários quando você compila a solução do gerente do contato.</span><span class="sxs-lookup"><span data-stu-id="99c6b-169">The **DeployOnBuild=true** and **DeployTarget=package** arguments are required when you build the Contact Manager solution.</span></span> <span data-ttu-id="99c6b-170">Isso instrui o MSBuild para criar web pacotes de implantação depois de criar cada projeto de aplicativo da web, conforme descrito em [criação e a projetos de aplicativo Web de empacotamento](../web-deployment-in-the-enterprise/building-and-packaging-web-application-projects.md).</span><span class="sxs-lookup"><span data-stu-id="99c6b-170">This instructs MSBuild to create web deployment packages after building each web application project, as described in [Building and Packaging Web Application Projects](../web-deployment-in-the-enterprise/building-and-packaging-web-application-projects.md).</span></span>
    2. <span data-ttu-id="99c6b-171">O **TargetEnvPropsFile** argumento é necessário quando você compila o *Publish.proj* arquivo.</span><span class="sxs-lookup"><span data-stu-id="99c6b-171">The **TargetEnvPropsFile** argument is required when you build the *Publish.proj* file.</span></span> <span data-ttu-id="99c6b-172">Essa propriedade indica o local do arquivo de configuração específico do ambiente, conforme descrito em [Noções básicas sobre o processo de compilação](../web-deployment-in-the-enterprise/understanding-the-build-process.md).</span><span class="sxs-lookup"><span data-stu-id="99c6b-172">This property indicates the location of the environment-specific configuration file, as described in [Understanding the Build Process](../web-deployment-in-the-enterprise/understanding-the-build-process.md).</span></span>
16. <span data-ttu-id="99c6b-173">Sobre o **política de retenção** guia, defina quantas compilações de cada tipo que você deseja manter conforme necessário.</span><span class="sxs-lookup"><span data-stu-id="99c6b-173">On the **Retention Policy** tab, configure how many builds of each type you want to retain as required.</span></span>
17. <span data-ttu-id="99c6b-174">Clique em **Salvar**.</span><span class="sxs-lookup"><span data-stu-id="99c6b-174">Click **Save**.</span></span>

## <a name="queue-a-build"></a><span data-ttu-id="99c6b-175">Enfileirar uma compilação</span><span class="sxs-lookup"><span data-stu-id="99c6b-175">Queue a Build</span></span>

<span data-ttu-id="99c6b-176">Neste ponto, você criou pelo menos uma nova definição de compilação.</span><span class="sxs-lookup"><span data-stu-id="99c6b-176">At this point, you have created at least one new build definition.</span></span> <span data-ttu-id="99c6b-177">O processo de compilação que você definiu será executado de acordo com os disparadores especificado na definição de compilação.</span><span class="sxs-lookup"><span data-stu-id="99c6b-177">The build process you defined will now run according to the triggers you specified in the build definition.</span></span>

<span data-ttu-id="99c6b-178">Se você tiver configurado a sua definição de compilação para usar CI, você pode testar sua definição de compilação de duas maneiras:</span><span class="sxs-lookup"><span data-stu-id="99c6b-178">If you've configured your build definition to use CI, you can test your build definition in two ways:</span></span>

- <span data-ttu-id="99c6b-179">Verifique se algum conteúdo para o projeto de equipe para disparar uma compilação automática.</span><span class="sxs-lookup"><span data-stu-id="99c6b-179">Check in some content to the team project to trigger an automatic build.</span></span>
- <span data-ttu-id="99c6b-180">Enfileire uma compilação manualmente.</span><span class="sxs-lookup"><span data-stu-id="99c6b-180">Queue a build manually.</span></span>

<span data-ttu-id="99c6b-181">**Para enfileirar uma compilação manualmente**</span><span class="sxs-lookup"><span data-stu-id="99c6b-181">**To queue a build manually**</span></span>

1. <span data-ttu-id="99c6b-182">No **Team Explorer** janela, clique na definição de compilação e, em seguida, clique em **enfileirar nova compilação**.</span><span class="sxs-lookup"><span data-stu-id="99c6b-182">In the **Team Explorer** window, right-click the build definition, and then click **Queue New Build**.</span></span>

    ![](creating-a-build-definition-that-supports-deployment/_static/image9.png)
2. <span data-ttu-id="99c6b-183">No **Enfileirar compilação** caixa de diálogo, analise as propriedades de compilação e, em seguida, clique em **fila**.</span><span class="sxs-lookup"><span data-stu-id="99c6b-183">In the **Queue Build** dialog box, review the build properties, and then click **Queue**.</span></span>

    ![](creating-a-build-definition-that-supports-deployment/_static/image10.png)

<span data-ttu-id="99c6b-184">Para analisar o progresso e o resultado de uma compilação & #x 2014; independentemente se ele foi acionado automaticamente ou manualmente & #x 2014; clique duas vezes a definição de compilação no **Team Explorer** janela.</span><span class="sxs-lookup"><span data-stu-id="99c6b-184">To review the progress and the outcome of a build&#x2014;regardless of whether it was triggered manually or automatically&#x2014;double-click the build definition in the **Team Explorer** window.</span></span> <span data-ttu-id="99c6b-185">Isso abrirá um **Build Explorer** guia.</span><span class="sxs-lookup"><span data-stu-id="99c6b-185">This will open a **Build Explorer** tab.</span></span>

![](creating-a-build-definition-that-supports-deployment/_static/image11.png)

<span data-ttu-id="99c6b-186">A partir daqui, você pode solucionar falhas de construção.</span><span class="sxs-lookup"><span data-stu-id="99c6b-186">From here, you can troubleshoot failed builds.</span></span> <span data-ttu-id="99c6b-187">Se você clicar duas vezes uma compilação individual, você pode exibir informações de resumo e clique para arquivos de log detalhados.</span><span class="sxs-lookup"><span data-stu-id="99c6b-187">If you double-click an individual build, you can view summary information and click through to detailed log files.</span></span>

![](creating-a-build-definition-that-supports-deployment/_static/image12.png)

<span data-ttu-id="99c6b-188">Você pode usar essas informações para solucionar problemas de compilações com falha e resolver os problemas antes de tentar outra.</span><span class="sxs-lookup"><span data-stu-id="99c6b-188">You can use this information to troubleshoot failed builds and address any problems before you attempt another build.</span></span>

> [!NOTE]
> <span data-ttu-id="99c6b-189">Compilações que executar lógica de implantação são provavelmente falharão até que você tiver concedido o servidor de compilação todas as permissões necessárias no ambiente de destino.</span><span class="sxs-lookup"><span data-stu-id="99c6b-189">Builds that execute deployment logic are likely to fail until you have granted the build server any permissions required in the destination environment.</span></span> <span data-ttu-id="99c6b-190">Para obter mais informações, consulte [configurar permissões para a implantação de compilação de equipe](configuring-permissions-for-team-build-deployment.md).</span><span class="sxs-lookup"><span data-stu-id="99c6b-190">For more information, see [Configuring Permissions for Team Build Deployment](configuring-permissions-for-team-build-deployment.md).</span></span>


## <a name="monitor-the-build-process"></a><span data-ttu-id="99c6b-191">Monitorar o processo de compilação</span><span class="sxs-lookup"><span data-stu-id="99c6b-191">Monitor the Build Process</span></span>

<span data-ttu-id="99c6b-192">TFS fornece uma ampla gama de recursos para ajudá-lo a monitorar o processo de compilação.</span><span class="sxs-lookup"><span data-stu-id="99c6b-192">TFS provides a broad range of functionality to help you monitor the build process.</span></span> <span data-ttu-id="99c6b-193">Por exemplo, o TFS pode enviar um email ou exibir alertas na área de notificação da barra de tarefas quando uma compilação for concluída.</span><span class="sxs-lookup"><span data-stu-id="99c6b-193">For example, TFS can send you an email or display alerts in your taskbar notification area when a build has completed.</span></span> <span data-ttu-id="99c6b-194">Para obter mais informações, consulte [executar e monitorar compilações](https://msdn.microsoft.com/en-us/library/ms181721.aspx).</span><span class="sxs-lookup"><span data-stu-id="99c6b-194">For more information, see [Run and Monitor Builds](https://msdn.microsoft.com/en-us/library/ms181721.aspx).</span></span>

## <a name="conclusion"></a><span data-ttu-id="99c6b-195">Conclusão</span><span class="sxs-lookup"><span data-stu-id="99c6b-195">Conclusion</span></span>

<span data-ttu-id="99c6b-196">Este tópico descreveu como criar uma definição de compilação no TFS.</span><span class="sxs-lookup"><span data-stu-id="99c6b-196">This topic described how to create a build definition in TFS.</span></span> <span data-ttu-id="99c6b-197">A definição de compilação está configurada para CI, para que o processo de compilação é executado sempre que verifica se um desenvolvedor de conteúdo para o projeto de equipe.</span><span class="sxs-lookup"><span data-stu-id="99c6b-197">The build definition is configured for CI, so the build process runs whenever a developer checks in content to the team project.</span></span> <span data-ttu-id="99c6b-198">A definição de compilação executa um arquivo de projeto MSBuild personalizado para implantar pacotes da web e scripts de banco de dados em um ambiente de servidor de destino.</span><span class="sxs-lookup"><span data-stu-id="99c6b-198">The build definition executes a custom MSBuild project file to deploy web packages and database scripts to a target server environment.</span></span>

<span data-ttu-id="99c6b-199">A fim de uma implantação automatizada para se tornar parte de um processo de compilação, você precisará conceder as permissões apropriadas para a conta de serviço de compilação nos servidores de web de destino e o servidor de banco de dados de destino.</span><span class="sxs-lookup"><span data-stu-id="99c6b-199">In order for an automated deployment to succeed as part of a build process, you'll need to grant appropriate permissions to the build service account on the target web servers and the target database server.</span></span> <span data-ttu-id="99c6b-200">O tópico final neste tutorial, [configurar permissões para a implantação de compilação de equipe](configuring-permissions-for-team-build-deployment.md), descreve como identificar e configurar as permissões necessárias para a implantação automática de um servidor do Team Build.</span><span class="sxs-lookup"><span data-stu-id="99c6b-200">The final topic in this tutorial, [Configuring Permissions for Team Build Deployment](configuring-permissions-for-team-build-deployment.md), describes how to identify and configure the permissions required for automated deployment from a Team Build server.</span></span>

## <a name="further-reading"></a><span data-ttu-id="99c6b-201">Leitura adicional</span><span class="sxs-lookup"><span data-stu-id="99c6b-201">Further Reading</span></span>

<span data-ttu-id="99c6b-202">Para obter mais informações sobre como criar definições de compilação, consulte [criar uma definição básica de compilação](https://msdn.microsoft.com/en-us/library/ms181716.aspx) e [definir seu processo de criação](https://msdn.microsoft.com/en-us/library/ms181715.aspx).</span><span class="sxs-lookup"><span data-stu-id="99c6b-202">For more information on creating build definitions, see [Create a Basic Build Definition](https://msdn.microsoft.com/en-us/library/ms181716.aspx) and [Define Your Build Process](https://msdn.microsoft.com/en-us/library/ms181715.aspx).</span></span> <span data-ttu-id="99c6b-203">Para obter mais diretrizes em compilações de enfileiramento de mensagens, consulte [enfileirar uma compilação](https://msdn.microsoft.com/en-us/library/ms181722.aspx).</span><span class="sxs-lookup"><span data-stu-id="99c6b-203">For more guidance on queuing builds, see [Queue a Build](https://msdn.microsoft.com/en-us/library/ms181722.aspx).</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="99c6b-204">[Anterior](configuring-a-tfs-build-server-for-web-deployment.md)
[Próximo](deploying-a-specific-build.md)</span><span class="sxs-lookup"><span data-stu-id="99c6b-204">[Previous](configuring-a-tfs-build-server-for-web-deployment.md)
[Next](deploying-a-specific-build.md)</span></span>

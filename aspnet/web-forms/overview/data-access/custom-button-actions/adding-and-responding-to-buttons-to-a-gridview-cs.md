---
uid: web-forms/overview/data-access/custom-button-actions/adding-and-responding-to-buttons-to-a-gridview-cs
title: Adicionar e responder a botões em um GridView (c#) | Microsoft Docs
author: rick-anderson
description: Neste tutorial, examinaremos como adicionar botões personalizados, tanto para um modelo para os campos de um controle GridView ou DetailsView. Em particular, vamos bui...
ms.author: riande
ms.date: 09/13/2006
ms.assetid: 128fdb5f-4c5e-42b5-b485-f3aee90a8e38
msc.legacyurl: /web-forms/overview/data-access/custom-button-actions/adding-and-responding-to-buttons-to-a-gridview-cs
msc.type: authoredcontent
ms.openlocfilehash: 3a081b1633e7762560aea68500f5bd614e4fb5a6
ms.sourcegitcommit: 45ac74e400f9f2b7dbded66297730f6f14a4eb25
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/16/2018
ms.locfileid: "41824773"
---
<a name="adding-and-responding-to-buttons-to-a-gridview-c"></a><span data-ttu-id="f1543-104">Adicionar e responder a botões em um GridView (c#)</span><span class="sxs-lookup"><span data-stu-id="f1543-104">Adding and Responding to Buttons to a GridView (C#)</span></span>
====================
<span data-ttu-id="f1543-105">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="f1543-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="f1543-106">[Baixe o aplicativo de exemplo](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_28_CS.exe) ou [baixar PDF](adding-and-responding-to-buttons-to-a-gridview-cs/_static/datatutorial28cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="f1543-106">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_28_CS.exe) or [Download PDF](adding-and-responding-to-buttons-to-a-gridview-cs/_static/datatutorial28cs1.pdf)</span></span>

> <span data-ttu-id="f1543-107">Neste tutorial, examinaremos como adicionar botões personalizados, tanto para um modelo para os campos de um controle GridView ou DetailsView.</span><span class="sxs-lookup"><span data-stu-id="f1543-107">In this tutorial we'll look at how to add custom buttons, both to a template and to the fields of a GridView or DetailsView control.</span></span> <span data-ttu-id="f1543-108">Em particular, vamos criar uma interface que tem um FormView que permite ao usuário a percorrer os fornecedores.</span><span class="sxs-lookup"><span data-stu-id="f1543-108">In particular, we'll build an interface that has a FormView that allows the user to page through the suppliers.</span></span>


## <a name="introduction"></a><span data-ttu-id="f1543-109">Introdução</span><span class="sxs-lookup"><span data-stu-id="f1543-109">Introduction</span></span>

<span data-ttu-id="f1543-110">Embora muitos cenários de relatório envolvem acesso somente leitura aos dados do relatório, não é incomum para relatórios incluem a capacidade de executar ações com base nos dados exibidos.</span><span class="sxs-lookup"><span data-stu-id="f1543-110">While many reporting scenarios involve read-only access to the report data, it's not uncommon for reports to include the ability to perform actions based upon the data displayed.</span></span> <span data-ttu-id="f1543-111">Normalmente isso envolvido a adição de um controle de botão, LinkButton ou ImageButton Web com cada registro exibido no relatório que, quando clicado, faz com que um postback e invoca um código do lado do servidor.</span><span class="sxs-lookup"><span data-stu-id="f1543-111">Typically this involved adding a Button, LinkButton, or ImageButton Web control with each record displayed in the report that, when clicked, causes a postback and invokes some server-side code.</span></span> <span data-ttu-id="f1543-112">Editar e excluir os dados em uma base de registro por registro são o exemplo mais comum.</span><span class="sxs-lookup"><span data-stu-id="f1543-112">Editing and deleting the data on a record-by-record basis is the most common example.</span></span> <span data-ttu-id="f1543-113">Na verdade, como vimos começando com o [visão geral de inserindo, atualizando e excluindo dados](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md) tutorial, edição e exclusão é tão comum que os controles GridView, DetailsView e FormView podem oferecer suporte a essa funcionalidade sem o necessário para escrever uma única linha de código.</span><span class="sxs-lookup"><span data-stu-id="f1543-113">In fact, as we saw starting with the [Overview of Inserting, Updating, and Deleting Data](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md) tutorial, editing and deleting is so common that the GridView, DetailsView, and FormView controls can support such functionality without the need for writing a single line of code.</span></span>

<span data-ttu-id="f1543-114">Além para editar e excluir os botões, o GridView, DetailsView e FormView controles também podem incluir botões, botões de link ou ImageButtons que, quando clicado, executar alguma lógica personalizada do lado do servidor.</span><span class="sxs-lookup"><span data-stu-id="f1543-114">In addition to Edit and Delete buttons, the GridView, DetailsView, and FormView controls can also include Buttons, LinkButtons, or ImageButtons that, when clicked, perform some custom server-side logic.</span></span> <span data-ttu-id="f1543-115">Neste tutorial, examinaremos como adicionar botões personalizados, tanto para um modelo para os campos de um controle GridView ou DetailsView.</span><span class="sxs-lookup"><span data-stu-id="f1543-115">In this tutorial we'll look at how to add custom buttons, both to a template and to the fields of a GridView or DetailsView control.</span></span> <span data-ttu-id="f1543-116">Em particular, vamos criar uma interface que tem um FormView que permite ao usuário a percorrer os fornecedores.</span><span class="sxs-lookup"><span data-stu-id="f1543-116">In particular, we'll build an interface that has a FormView that allows the user to page through the suppliers.</span></span> <span data-ttu-id="f1543-117">Para um determinado fornecedor, FormView mostrará informações sobre o fornecedor, junto com um controle da Web de botão que, se clicada, marcará todos os seus produtos associados como descontinuado.</span><span class="sxs-lookup"><span data-stu-id="f1543-117">For a given supplier, the FormView will show information about the supplier along with a Button Web control that, if clicked, will mark all of their associated products as discontinued.</span></span> <span data-ttu-id="f1543-118">Além disso, um GridView lista esses produtos fornecidos pelo fornecedor selecionado, com cada linha que contém o preço de aumentar e botões de preço de desconto que, se clicada, aumentar ou reduzir o produto `UnitPrice` em 10% (veja a Figura 1).</span><span class="sxs-lookup"><span data-stu-id="f1543-118">Additionally, a GridView lists those products provided by the selected supplier, with each row containing Increase Price and Discount Price Buttons that, if clicked, raise or reduce the product's `UnitPrice` by 10% (see Figure 1).</span></span>


<span data-ttu-id="f1543-119">[![FormView e GridView contenham botões que executam ações personalizadas](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image2.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="f1543-119">[![Both the FormView and GridView Contain Buttons That Perform Custom Actions](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image2.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image1.png)</span></span>

<span data-ttu-id="f1543-120">**Figura 1**: os dois FormView e GridView contém botões que executam ações personalizadas ([clique para exibir a imagem em tamanho normal](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="f1543-120">**Figure 1**: Both the FormView and GridView Contain Buttons That Perform Custom Actions ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image3.png))</span></span>


## <a name="step-1-adding-the-button-tutorial-web-pages"></a><span data-ttu-id="f1543-121">Etapa 1: Adicionar as páginas da Web Tutorial do botão</span><span class="sxs-lookup"><span data-stu-id="f1543-121">Step 1: Adding the Button Tutorial Web Pages</span></span>

<span data-ttu-id="f1543-122">Antes, vamos examinar como adicionar um botões personalizados, primeiro vamos criar as páginas do ASP.NET em nosso projeto de site que precisaremos para este tutorial.</span><span class="sxs-lookup"><span data-stu-id="f1543-122">Before we look at how to add a custom buttons, let's first take a moment to create the ASP.NET pages in our website project that we'll need for this tutorial.</span></span> <span data-ttu-id="f1543-123">Comece adicionando uma nova pasta chamada `CustomButtons`.</span><span class="sxs-lookup"><span data-stu-id="f1543-123">Start by adding a new folder named `CustomButtons`.</span></span> <span data-ttu-id="f1543-124">Em seguida, adicione as duas páginas do ASP.NET a seguir para essa pasta, certificando-se de associar cada página com o `Site.master` página mestra:</span><span class="sxs-lookup"><span data-stu-id="f1543-124">Next, add the following two ASP.NET pages to that folder, making sure to associate each page with the `Site.master` master page:</span></span>

- `Default.aspx`
- `CustomButtons.aspx`


![Adicione as páginas do ASP.NET para que os tutoriais de relacionadas de botões personalizados](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image4.png)

<span data-ttu-id="f1543-126">**Figura 2**: adicionar as páginas do ASP.NET para que os tutoriais de relacionadas de botões personalizados</span><span class="sxs-lookup"><span data-stu-id="f1543-126">**Figure 2**: Add the ASP.NET Pages for the Custom Buttons-Related Tutorials</span></span>


<span data-ttu-id="f1543-127">Como em outras pastas `Default.aspx` no `CustomButtons` pasta listará os tutoriais em sua seção.</span><span class="sxs-lookup"><span data-stu-id="f1543-127">Like in the other folders, `Default.aspx` in the `CustomButtons` folder will list the tutorials in its section.</span></span> <span data-ttu-id="f1543-128">Lembre-se de que o `SectionLevelTutorialListing.ascx` controle de usuário fornece essa funcionalidade.</span><span class="sxs-lookup"><span data-stu-id="f1543-128">Recall that the `SectionLevelTutorialListing.ascx` User Control provides this functionality.</span></span> <span data-ttu-id="f1543-129">Portanto, adicionar esse controle de usuário `Default.aspx` arrastando-no Gerenciador de soluções no modo de exibição de Design da página.</span><span class="sxs-lookup"><span data-stu-id="f1543-129">Therefore, add this User Control to `Default.aspx` by dragging it from the Solution Explorer onto the page's Design view.</span></span>


<span data-ttu-id="f1543-130">[![Adicionar o controle de usuário SectionLevelTutorialListing.ascx para default. aspx](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image6.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="f1543-130">[![Add the SectionLevelTutorialListing.ascx User Control to Default.aspx](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image6.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image5.png)</span></span>

<span data-ttu-id="f1543-131">**Figura 3**: Adicione o `SectionLevelTutorialListing.ascx` controle de usuário `Default.aspx` ([clique para exibir a imagem em tamanho normal](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="f1543-131">**Figure 3**: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image7.png))</span></span>


<span data-ttu-id="f1543-132">Por fim, adicione as páginas como entradas para o `Web.sitemap` arquivo.</span><span class="sxs-lookup"><span data-stu-id="f1543-132">Lastly, add the pages as entries to the `Web.sitemap` file.</span></span> <span data-ttu-id="f1543-133">Especificamente, adicione a seguinte marcação após a paginação e classificação `<siteMapNode>`:</span><span class="sxs-lookup"><span data-stu-id="f1543-133">Specifically, add the following markup after the Paging and Sorting `<siteMapNode>`:</span></span>

[!code-xml[Main](adding-and-responding-to-buttons-to-a-gridview-cs/samples/sample1.xml)]

<span data-ttu-id="f1543-134">Depois de atualizar `Web.sitemap`, reserve um tempo para exibir o site de tutoriais através de um navegador.</span><span class="sxs-lookup"><span data-stu-id="f1543-134">After updating `Web.sitemap`, take a moment to view the tutorials website through a browser.</span></span> <span data-ttu-id="f1543-135">No menu à esquerda agora inclui itens para a edição, inserindo e excluindo tutoriais.</span><span class="sxs-lookup"><span data-stu-id="f1543-135">The menu on the left now includes items for the editing, inserting, and deleting tutorials.</span></span>


![O mapa do Site agora inclui a entrada para o Tutorial de botões personalizados](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image8.png)

<span data-ttu-id="f1543-137">**Figura 4**: O mapa do Site agora inclui a entrada para o Tutorial de botões personalizados</span><span class="sxs-lookup"><span data-stu-id="f1543-137">**Figure 4**: The Site Map Now Includes the Entry for the Custom Buttons Tutorial</span></span>


## <a name="step-2-adding-a-formview-that-lists-the-suppliers"></a><span data-ttu-id="f1543-138">Etapa 2: Adicionando um FormView que lista os fornecedores</span><span class="sxs-lookup"><span data-stu-id="f1543-138">Step 2: Adding a FormView that Lists the Suppliers</span></span>

<span data-ttu-id="f1543-139">Vamos começar com este tutorial adicionando FormView que lista os fornecedores.</span><span class="sxs-lookup"><span data-stu-id="f1543-139">Let's get started with this tutorial by adding the FormView that lists the suppliers.</span></span> <span data-ttu-id="f1543-140">Conforme discutido na introdução, este FormView permitirá que o usuário à página por meio de fornecedores, mostrando os produtos fornecidos pelo fornecedor em um GridView.</span><span class="sxs-lookup"><span data-stu-id="f1543-140">As discussed in the Introduction, this FormView will allow the user to page through the suppliers, showing the products provided by the supplier in a GridView.</span></span> <span data-ttu-id="f1543-141">Além disso, esse FormView incluirá um botão que, quando clicado, marcará todos os produtos do fornecedor como descontinuado.</span><span class="sxs-lookup"><span data-stu-id="f1543-141">Additionally, this FormView will include a Button that, when clicked, will mark all of the supplier's products as discontinued.</span></span> <span data-ttu-id="f1543-142">Antes de nós mesmos estamos envolvem com a adição de botão personalizado para FormView, primeiro vamos simplesmente criar FormView para que ele exiba as informações do fornecedor.</span><span class="sxs-lookup"><span data-stu-id="f1543-142">Before we concern ourselves with adding the custom button to the FormView, let's first just create the FormView so that it displays the supplier information.</span></span>

<span data-ttu-id="f1543-143">Comece abrindo o `CustomButtons.aspx` página o `CustomButtons` pasta.</span><span class="sxs-lookup"><span data-stu-id="f1543-143">Start by opening the `CustomButtons.aspx` page in the `CustomButtons` folder.</span></span> <span data-ttu-id="f1543-144">Adicionar um FormView para a página arrastando-o na caixa de ferramentas para o Designer e o conjunto de seu `ID` propriedade para `Suppliers`.</span><span class="sxs-lookup"><span data-stu-id="f1543-144">Add a FormView to the page by dragging it from the Toolbox onto the Designer and set its `ID` property to `Suppliers`.</span></span> <span data-ttu-id="f1543-145">Na marca inteligente de FormView, optar por criar um novo ObjectDataSource chamado `SuppliersDataSource`.</span><span class="sxs-lookup"><span data-stu-id="f1543-145">From the FormView's smart tag, opt to create a new ObjectDataSource named `SuppliersDataSource`.</span></span>


<span data-ttu-id="f1543-146">[![Criar um novo ObjectDataSource chamado SuppliersDataSource](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image10.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="f1543-146">[![Create a New ObjectDataSource Named SuppliersDataSource](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image10.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image9.png)</span></span>

<span data-ttu-id="f1543-147">**Figura 5**: criar um novo ObjectDataSource nomeado `SuppliersDataSource` ([clique para exibir a imagem em tamanho normal](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="f1543-147">**Figure 5**: Create a New ObjectDataSource Named `SuppliersDataSource` ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image11.png))</span></span>


<span data-ttu-id="f1543-148">Configurar esse novo ObjectDataSource, de modo que ele consulta a partir de `SuppliersBLL` da classe `GetSuppliers()` método (veja a Figura 6).</span><span class="sxs-lookup"><span data-stu-id="f1543-148">Configure this new ObjectDataSource such that it queries from the `SuppliersBLL` class's `GetSuppliers()` method (see Figure 6).</span></span> <span data-ttu-id="f1543-149">Como esse FormView não fornece uma interface para atualizar as informações do fornecedor, selecione opção na lista suspensa na guia de atualização (nenhum).</span><span class="sxs-lookup"><span data-stu-id="f1543-149">Since this FormView does not provide an interface for updating the supplier information, select the (None) option from the drop-down list in the UPDATE tab.</span></span>


<span data-ttu-id="f1543-150">[![Configurar a fonte de dados para usar a classe SuppliersBLL s GetSuppliers() método](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image13.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="f1543-150">[![Configure the Data Source to use the SuppliersBLL Class s GetSuppliers() Method](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image13.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image12.png)</span></span>

<span data-ttu-id="f1543-151">**Figura 6**: configurar a fonte de dados para usar o `SuppliersBLL` da classe `GetSuppliers()` método ([clique para exibir a imagem em tamanho normal](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="f1543-151">**Figure 6**: Configure the Data Source to use the `SuppliersBLL` Class's `GetSuppliers()` Method ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image14.png))</span></span>


<span data-ttu-id="f1543-152">Depois de configurar o ObjectDataSource, o Visual Studio gerará um `InsertItemTemplate`, `EditItemTemplate`, e `ItemTemplate` para FormView.</span><span class="sxs-lookup"><span data-stu-id="f1543-152">After configuring the ObjectDataSource, Visual Studio will generate an `InsertItemTemplate`, `EditItemTemplate`, and `ItemTemplate` for the FormView.</span></span> <span data-ttu-id="f1543-153">Remover o `InsertItemTemplate` e `EditItemTemplate` e modifique o `ItemTemplate` para que ele exiba apenas do fornecedor da empresa nome e número de telefone.</span><span class="sxs-lookup"><span data-stu-id="f1543-153">Remove the `InsertItemTemplate` and `EditItemTemplate` and modify the `ItemTemplate` so that it displays just the supplier's company name and phone number.</span></span> <span data-ttu-id="f1543-154">Por fim, ativar o suporte de paginação para FormView marcando a caixa de seleção Habilitar paginação na marca inteligente de (ou definindo sua `AllowPaging` propriedade para `True`).</span><span class="sxs-lookup"><span data-stu-id="f1543-154">Finally, turn on paging support for the FormView by checking the Enable Paging checkbox from its smart tag (or by setting its `AllowPaging` property to `True`).</span></span> <span data-ttu-id="f1543-155">Após essas alterações marcação declarativa de sua página deve ser semelhante ao seguinte:</span><span class="sxs-lookup"><span data-stu-id="f1543-155">After these changes your page's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](adding-and-responding-to-buttons-to-a-gridview-cs/samples/sample2.aspx)]

<span data-ttu-id="f1543-156">Figura 7 mostra a página de CustomButtons.aspx quando visualizado por meio de um navegador.</span><span class="sxs-lookup"><span data-stu-id="f1543-156">Figure 7 shows the CustomButtons.aspx page when viewed through a browser.</span></span>


<span data-ttu-id="f1543-157">[![Lista de FormView CompanyName e campos de telefone do fornecedor selecionado no momento](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image16.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="f1543-157">[![The FormView Lists the CompanyName and Phone Fields from the Currently Selected Supplier](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image16.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image15.png)</span></span>

<span data-ttu-id="f1543-158">**Figura 7**: A lista de FormView a `CompanyName` e `Phone` campos de fornecedor atualmente selecionado ([clique para exibir a imagem em tamanho normal](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="f1543-158">**Figure 7**: The FormView Lists the `CompanyName` and `Phone` Fields from the Currently Selected Supplier ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image17.png))</span></span>


## <a name="step-3-adding-a-gridview-that-lists-the-selected-suppliers-products"></a><span data-ttu-id="f1543-159">Etapa 3: Adicionando um GridView que lista os produtos do fornecedor selecionado</span><span class="sxs-lookup"><span data-stu-id="f1543-159">Step 3: Adding a GridView that Lists the Selected Supplier's Products</span></span>

<span data-ttu-id="f1543-160">Antes de adicionar o botão interromper todos os produtos para o modelo de FormView, vamos adicionar primeiro um GridView abaixo FormView que lista os produtos fornecidos pelo fornecedor selecionado.</span><span class="sxs-lookup"><span data-stu-id="f1543-160">Before we add the Discontinue All Products Button to the FormView's template, let's first add a GridView beneath the FormView that lists the products provided by the selected supplier.</span></span> <span data-ttu-id="f1543-161">Para fazer isso, adicione um GridView à página, defina suas `ID` propriedade para `SuppliersProducts`, e adicione um novo ObjectDataSource chamado `SuppliersProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="f1543-161">To accomplish this, add a GridView to the page, set its `ID` property to `SuppliersProducts`, and add a new ObjectDataSource named `SuppliersProductsDataSource`.</span></span>


<span data-ttu-id="f1543-162">[![Criar um novo ObjectDataSource chamado SuppliersProductsDataSource](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image19.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="f1543-162">[![Create a New ObjectDataSource Named SuppliersProductsDataSource](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image19.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image18.png)</span></span>

<span data-ttu-id="f1543-163">**Figura 8**: criar um novo ObjectDataSource nomeado `SuppliersProductsDataSource` ([clique para exibir a imagem em tamanho normal](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="f1543-163">**Figure 8**: Create a New ObjectDataSource Named `SuppliersProductsDataSource` ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image20.png))</span></span>


<span data-ttu-id="f1543-164">Configurar este ObjectDataSource para usar a classe de ProductsBLL `GetProductsBySupplierID(supplierID)` método (veja a Figura 9).</span><span class="sxs-lookup"><span data-stu-id="f1543-164">Configure this ObjectDataSource to use the ProductsBLL class's `GetProductsBySupplierID(supplierID)` method (see Figure 9).</span></span> <span data-ttu-id="f1543-165">Enquanto esse GridView permitirá para preço de um produto a ser ajustado, ele não usará internos, editar ou excluir recursos de GridView.</span><span class="sxs-lookup"><span data-stu-id="f1543-165">While this GridView will allow for a product's price to be adjusted, it won't be using the built-in editing or deleting features from the GridView.</span></span> <span data-ttu-id="f1543-166">Portanto, podemos definir a lista suspensa como (nenhum) para o ObjectDataSource do UPDATE, INSERT e exclui as guias.</span><span class="sxs-lookup"><span data-stu-id="f1543-166">Therefore, we can set the drop-down list to (None) for the ObjectDataSource's UPDATE, INSERT, and DELETE tabs.</span></span>


<span data-ttu-id="f1543-167">[![Configurar a fonte de dados para usar a classe ProductsBLL s GetProductsBySupplierID(supplierID) método](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image22.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="f1543-167">[![Configure the Data Source to use the ProductsBLL Class s GetProductsBySupplierID(supplierID) Method](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image22.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image21.png)</span></span>

<span data-ttu-id="f1543-168">**Figura 9**: configurar a fonte de dados para usar o `ProductsBLL` da classe `GetProductsBySupplierID(supplierID)` método ([clique para exibir a imagem em tamanho normal](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image23.png))</span><span class="sxs-lookup"><span data-stu-id="f1543-168">**Figure 9**: Configure the Data Source to use the `ProductsBLL` Class's `GetProductsBySupplierID(supplierID)` Method ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image23.png))</span></span>


<span data-ttu-id="f1543-169">Uma vez que o `GetProductsBySupplierID(supplierID)` método aceita um parâmetro de entrada, o assistente ObjectDataSource nos solicita a origem desse valor de parâmetro.</span><span class="sxs-lookup"><span data-stu-id="f1543-169">Since the `GetProductsBySupplierID(supplierID)` method accepts an input parameter, the ObjectDataSource wizard prompts us for the source of this parameter value.</span></span> <span data-ttu-id="f1543-170">Para passar o `SupplierID` FormView de valor, defina a lista de lista suspensa de origem do parâmetro para o controle e a lista suspensa de ControlID para `Suppliers` (a ID do FormView criado na etapa 2).</span><span class="sxs-lookup"><span data-stu-id="f1543-170">To pass in the `SupplierID` value from the FormView, set the Parameter source drop-down list to Control and the ControlID drop-down list to `Suppliers` (the ID of the FormView created in Step 2).</span></span>


<span data-ttu-id="f1543-171">[![Indicar que o supplierID parâmetro deva vir do controle FormView de fornecedores](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image25.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image24.png)</span><span class="sxs-lookup"><span data-stu-id="f1543-171">[![Indicate that the supplierID Parameter Should Come from the Suppliers FormView Control](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image25.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image24.png)</span></span>

<span data-ttu-id="f1543-172">**Figura 10**: indica que o *`supplierID`* parâmetro deve vir do `Suppliers` controle FormView ([clique para exibir a imagem em tamanho normal](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image26.png))</span><span class="sxs-lookup"><span data-stu-id="f1543-172">**Figure 10**: Indicate that the *`supplierID`* Parameter Should Come from the `Suppliers` FormView Control ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image26.png))</span></span>


<span data-ttu-id="f1543-173">Depois de concluir o assistente ObjectDataSource, o GridView conterá uma BoundField ou CheckBoxField para cada um dos campos de dados do produto.</span><span class="sxs-lookup"><span data-stu-id="f1543-173">After completing the ObjectDataSource wizard, the GridView will contain a BoundField or CheckBoxField for each of the product's data fields.</span></span> <span data-ttu-id="f1543-174">Vamos reduzir isso para mostrar apenas o `ProductName` e `UnitPrice` BoundFields juntamente com o `Discontinued` CheckBoxField; Além disso, vamos formatar o `UnitPrice` BoundField, de modo que seu texto é formatado como uma moeda.</span><span class="sxs-lookup"><span data-stu-id="f1543-174">Let's trim this down to show just the `ProductName` and `UnitPrice` BoundFields along with the `Discontinued` CheckBoxField; furthermore, let's format the `UnitPrice` BoundField such that its text is formatted as a currency.</span></span> <span data-ttu-id="f1543-175">O GridView e `SuppliersProductsDataSource` marcação declarativa do ObjectDataSource deve ser semelhante à seguinte marcação:</span><span class="sxs-lookup"><span data-stu-id="f1543-175">Your GridView and `SuppliersProductsDataSource` ObjectDataSource's declarative markup should look similar to the following markup:</span></span>

[!code-aspx[Main](adding-and-responding-to-buttons-to-a-gridview-cs/samples/sample3.aspx)]

<span data-ttu-id="f1543-176">Neste ponto, nosso tutorial exibe um relatório de detalhes/mestre, permitindo que o usuário escolher um fornecedor de FormView na parte superior e para exibir os produtos fornecidos por esse fornecedor por meio de GridView na parte inferior.</span><span class="sxs-lookup"><span data-stu-id="f1543-176">At this point our tutorial displays a master/details report, allowing the user to pick a supplier from the FormView at the top and to view the products provided by that supplier through the GridView at the bottom.</span></span> <span data-ttu-id="f1543-177">Figura 11 mostra uma captura de tela desta página, ao selecionar o fornecedor Tokyo Traders do FormView.</span><span class="sxs-lookup"><span data-stu-id="f1543-177">Figure 11 shows a screen shot of this page when selecting the Tokyo Traders supplier from the FormView.</span></span>


<span data-ttu-id="f1543-178">[![Os produtos do fornecedor selecionado são exibidos em GridView](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image28.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="f1543-178">[![The Selected Supplier s Products are Displayed in the GridView](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image28.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image27.png)</span></span>

<span data-ttu-id="f1543-179">**Figura 11**: produtos do fornecedor selecionado o são exibidos no GridView ([clique para exibir a imagem em tamanho normal](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image29.png))</span><span class="sxs-lookup"><span data-stu-id="f1543-179">**Figure 11**: The Selected Supplier's Products are Displayed in the GridView ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image29.png))</span></span>


## <a name="step-4-creating-dal-and-bll-methods-to-discontinue-all-products-for-a-supplier"></a><span data-ttu-id="f1543-180">Etapa 4: Criar métodos BLL e DAL para interromper todos os produtos para um fornecedor</span><span class="sxs-lookup"><span data-stu-id="f1543-180">Step 4: Creating DAL and BLL Methods to Discontinue All Products for a Supplier</span></span>

<span data-ttu-id="f1543-181">Antes de podermos adicionar um botão para FormView que, quando clicado, interrompe todos os produtos do fornecedor, primeiro precisamos adicionar um método para o DAL e BLL que executa essa ação.</span><span class="sxs-lookup"><span data-stu-id="f1543-181">Before we can add a Button to the FormView that, when clicked, discontinues all of the supplier's products, we first need to add a method to both the DAL and BLL that performs this action.</span></span> <span data-ttu-id="f1543-182">Em particular, esse método será chamado `DiscontinueAllProductsForSupplier(supplierID)`.</span><span class="sxs-lookup"><span data-stu-id="f1543-182">In particular, this method will be named `DiscontinueAllProductsForSupplier(supplierID)`.</span></span> <span data-ttu-id="f1543-183">Quando o botão de FormView é clicado, podemos irá invocar esse método na camada de lógica de negócios, passando do fornecedor selecionado `SupplierID`; a BLL, em seguida, chamará para baixo para o método de camada de acesso de dados correspondente, que emitirá um `UPDATE` instrução para o banco de dados que deixou de produtos do fornecedor especificado.</span><span class="sxs-lookup"><span data-stu-id="f1543-183">When the FormView's Button is clicked, we'll invoke this method in the Business Logic Layer, passing in the selected supplier's `SupplierID`; the BLL will then call down to the corresponding Data Access Layer method, which will issue an `UPDATE` statement to the database that discontinues the specified supplier's products.</span></span>

<span data-ttu-id="f1543-184">Como fizemos nos nossos tutoriais anteriores, vamos usar uma abordagem de baixo para cima, começando com o método DAL, em seguida, o método BLL, de criação e, finalmente, a implementação da funcionalidade na página ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="f1543-184">As we have done in our previous tutorials, we'll use a bottom-up approach, starting with creating the DAL method, then the BLL method, and finally implementing the functionality in the ASP.NET page.</span></span> <span data-ttu-id="f1543-185">Abra o `Northwind.xsd` digitado o conjunto de dados no `App_Code/DAL` pasta e adicione um novo método para o `ProductsTableAdapter` (com o botão direito no `ProductsTableAdapter` e escolha Add Query).</span><span class="sxs-lookup"><span data-stu-id="f1543-185">Open the `Northwind.xsd` Typed DataSet in the `App_Code/DAL` folder and add a new method to the `ProductsTableAdapter` (right-click on the `ProductsTableAdapter` and choose Add Query).</span></span> <span data-ttu-id="f1543-186">Isso abrirá o Assistente de configuração de consulta do TableAdapter, que nos conduz pelo processo de adicionar o novo método.</span><span class="sxs-lookup"><span data-stu-id="f1543-186">Doing so will bring up the TableAdapter Query Configuration wizard, which walks us through the process of adding the new method.</span></span> <span data-ttu-id="f1543-187">Iniciar, indicando que o nosso método DAL usará uma instrução de SQL ad hoc.</span><span class="sxs-lookup"><span data-stu-id="f1543-187">Start by indicating that our DAL method will use an ad-hoc SQL statement.</span></span>


<span data-ttu-id="f1543-188">[![Crie o método DAL usando uma instrução de SQL Ad Hoc](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image31.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image30.png)</span><span class="sxs-lookup"><span data-stu-id="f1543-188">[![Create the DAL Method Using an Ad-Hoc SQL Statement](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image31.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image30.png)</span></span>

<span data-ttu-id="f1543-189">**Figura 12**: criar o método DAL usando uma instrução de SQL Ad Hoc ([clique para exibir a imagem em tamanho normal](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image32.png))</span><span class="sxs-lookup"><span data-stu-id="f1543-189">**Figure 12**: Create the DAL Method Using an Ad-Hoc SQL Statement ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image32.png))</span></span>


<span data-ttu-id="f1543-190">Em seguida, o assistente solicita conosco sobre que tipo de consulta para criar.</span><span class="sxs-lookup"><span data-stu-id="f1543-190">Next, the wizard prompts us as to what type of query to create.</span></span> <span data-ttu-id="f1543-191">Uma vez que o `DiscontinueAllProductsForSupplier(supplierID)` método será necessário atualizar o `Products` tabela de banco de dados, definindo o `Discontinued` campo como 1 para todos os produtos fornecidos por especificado *`supplierID`*, precisamos criar uma consulta que atualiza os dados.</span><span class="sxs-lookup"><span data-stu-id="f1543-191">Since the `DiscontinueAllProductsForSupplier(supplierID)` method will need to update the `Products` database table, setting the `Discontinued` field to 1 for all products provided by the specified *`supplierID`*, we need to create a query that updates data.</span></span>


<span data-ttu-id="f1543-192">[![Escolha o tipo de consulta de atualização](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image34.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image33.png)</span><span class="sxs-lookup"><span data-stu-id="f1543-192">[![Choose the UPDATE Query Type](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image34.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image33.png)</span></span>

<span data-ttu-id="f1543-193">**Figura 13**: escolha o tipo de consulta de atualização ([clique para exibir a imagem em tamanho normal](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image35.png))</span><span class="sxs-lookup"><span data-stu-id="f1543-193">**Figure 13**: Choose the UPDATE Query Type ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image35.png))</span></span>


<span data-ttu-id="f1543-194">A próxima tela do assistente fornece o TableAdapter existente `UPDATE` instrução, que atualiza cada um dos campos definidos na `Products` DataTable.</span><span class="sxs-lookup"><span data-stu-id="f1543-194">The next wizard screen provides the TableAdapter's existing `UPDATE` statement, which updates each of the fields defined in the `Products` DataTable.</span></span> <span data-ttu-id="f1543-195">Substitua este texto de consulta com a seguinte instrução:</span><span class="sxs-lookup"><span data-stu-id="f1543-195">Replace this query text with the following statement:</span></span>

[!code-sql[Main](adding-and-responding-to-buttons-to-a-gridview-cs/samples/sample4.sql)]

<span data-ttu-id="f1543-196">Depois de inserir essa consulta e clicar em Avançar, a última tela do assistente pede para uso do nome do novo método `DiscontinueAllProductsForSupplier`.</span><span class="sxs-lookup"><span data-stu-id="f1543-196">After entering this query and clicking Next, the last wizard screen asks for the new method's name use `DiscontinueAllProductsForSupplier`.</span></span> <span data-ttu-id="f1543-197">Conclua o assistente clicando no botão Concluir.</span><span class="sxs-lookup"><span data-stu-id="f1543-197">Complete the wizard by clicking the Finish button.</span></span> <span data-ttu-id="f1543-198">Ao retornar para o Designer de conjunto de dados, você deverá ver um novo método na `ProductsTableAdapter` chamado `DiscontinueAllProductsForSupplier(@SupplierID)`.</span><span class="sxs-lookup"><span data-stu-id="f1543-198">Upon returning to the DataSet Designer you should see a new method in the `ProductsTableAdapter` named `DiscontinueAllProductsForSupplier(@SupplierID)`.</span></span>


<span data-ttu-id="f1543-199">[![Nomeie o novo DiscontinueAllProductsForSupplier DAL método](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image37.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image36.png)</span><span class="sxs-lookup"><span data-stu-id="f1543-199">[![Name the New DAL Method DiscontinueAllProductsForSupplier](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image37.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image36.png)</span></span>

<span data-ttu-id="f1543-200">**Figura 14**: Nomeie o novo método DAL `DiscontinueAllProductsForSupplier` ([clique para exibir a imagem em tamanho normal](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image38.png))</span><span class="sxs-lookup"><span data-stu-id="f1543-200">**Figure 14**: Name the New DAL Method `DiscontinueAllProductsForSupplier` ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image38.png))</span></span>


<span data-ttu-id="f1543-201">Com o `DiscontinueAllProductsForSupplier(supplierID)` método criado na camada de acesso a dados, nossa próxima tarefa é criar o `DiscontinueAllProductsForSupplier(supplierID)` método na camada de lógica de negócios.</span><span class="sxs-lookup"><span data-stu-id="f1543-201">With the `DiscontinueAllProductsForSupplier(supplierID)` method created in the Data Access Layer, our next task is to create the `DiscontinueAllProductsForSupplier(supplierID)` method in the Business Logic Layer.</span></span> <span data-ttu-id="f1543-202">Para fazer isso, abra o `ProductsBLL` arquivo de classe e adicione o seguinte:</span><span class="sxs-lookup"><span data-stu-id="f1543-202">To accomplish this, open the `ProductsBLL` class file and add the following:</span></span>

[!code-csharp[Main](adding-and-responding-to-buttons-to-a-gridview-cs/samples/sample5.cs)]

<span data-ttu-id="f1543-203">Esse método simplesmente chama para baixo até a `DiscontinueAllProductsForSupplier(supplierID)` método em que a DAL, passando fornecido *`supplierID`* valor do parâmetro.</span><span class="sxs-lookup"><span data-stu-id="f1543-203">This method simply calls down to the `DiscontinueAllProductsForSupplier(supplierID)` method in the DAL, passing along the provided *`supplierID`* parameter value.</span></span> <span data-ttu-id="f1543-204">Se houver quaisquer regras de negócio que são permitidos apenas os produtos do fornecedor ser interrompido em determinadas circunstâncias, essas regras devem ser implementadas aqui, na BLL.</span><span class="sxs-lookup"><span data-stu-id="f1543-204">If there were any business rules that only allowed a supplier's products to be discontinued under certain circumstances, those rules should be implemented here, in the BLL.</span></span>

> [!NOTE]
> <span data-ttu-id="f1543-205">Ao contrário o `UpdateProduct` sobrecargas na `ProductsBLL` classe, o `DiscontinueAllProductsForSupplier(supplierID)` assinatura de método não inclui o `DataObjectMethodAttribute` atributo (`<System.ComponentModel.DataObjectMethodAttribute(System.ComponentModel.DataObjectMethodType.Update, Boolean)>`).</span><span class="sxs-lookup"><span data-stu-id="f1543-205">Unlike the `UpdateProduct` overloads in the `ProductsBLL` class, the `DiscontinueAllProductsForSupplier(supplierID)` method signature does not include the `DataObjectMethodAttribute` attribute (`<System.ComponentModel.DataObjectMethodAttribute(System.ComponentModel.DataObjectMethodType.Update, Boolean)>`).</span></span> <span data-ttu-id="f1543-206">Isso impede o `DiscontinueAllProductsForSupplier(supplierID)` método na lista suspensa do Assistente de configurar fonte de dados do ObjectDataSource na guia de atualização. Eu ve omitido este atributo porque estamos chamará o `DiscontinueAllProductsForSupplier(supplierID)` método diretamente de um manipulador de eventos em nossa página do ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="f1543-206">This precludes the `DiscontinueAllProductsForSupplier(supplierID)` method from the ObjectDataSource's Configure Data Source wizard's drop-down list in the UPDATE tab. I ve omitted this attribute because we'll be calling the `DiscontinueAllProductsForSupplier(supplierID)` method directly from an event handler in our ASP.NET page.</span></span>


## <a name="step-5-adding-a-discontinue-all-products-button-to-the-formview"></a><span data-ttu-id="f1543-207">Etapa 5: Adicionando um interromper todos os botões de produtos para FormView</span><span class="sxs-lookup"><span data-stu-id="f1543-207">Step 5: Adding a Discontinue All Products Button to the FormView</span></span>

<span data-ttu-id="f1543-208">Com o `DiscontinueAllProductsForSupplier(supplierID)` método na BLL e DAL completa, a etapa final para adicionar a capacidade de interromper todos os produtos para o fornecedor selecionado é adicionar um controle da Web de botão para de FormView `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="f1543-208">With the `DiscontinueAllProductsForSupplier(supplierID)` method in the BLL and DAL complete, the final step for adding the ability to discontinue all products for the selected supplier is to add a Button Web control to the FormView's `ItemTemplate`.</span></span> <span data-ttu-id="f1543-209">Vamos adicionar o botão abaixo do número de telefone do fornecedor com o texto do botão, interromper todos os produtos e uma `ID` valor da propriedade `DiscontinueAllProductsForSupplier`.</span><span class="sxs-lookup"><span data-stu-id="f1543-209">Let's add such a Button below the supplier's phone number with the button text, Discontinue All Products and an `ID` property value of `DiscontinueAllProductsForSupplier`.</span></span> <span data-ttu-id="f1543-210">Você pode adicionar esse controle da Web de botão por meio do Designer clicando no link Editar modelos na marca inteligente de FormView (consulte a Figura 15), ou diretamente por meio da sintaxe declarativa.</span><span class="sxs-lookup"><span data-stu-id="f1543-210">You can add this Button Web control through the Designer by clicking on the Edit Templates link in the FormView's smart tag (see Figure 15), or directly through the declarative syntax.</span></span>


<span data-ttu-id="f1543-211">[![Adicionar um interromper todos os controle de Web de botão de produtos para o ItemTemplate de FormView s](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image40.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image39.png)</span><span class="sxs-lookup"><span data-stu-id="f1543-211">[![Add a Discontinue All Products Button Web Control to the FormView s ItemTemplate](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image40.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image39.png)</span></span>

<span data-ttu-id="f1543-212">**Figura 15**: Adicione um descontinuar todos os produtos Web controle Button para o FormView `ItemTemplate` ([clique para exibir a imagem em tamanho normal](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image41.png))</span><span class="sxs-lookup"><span data-stu-id="f1543-212">**Figure 15**: Add a Discontinue All Products Button Web Control to the FormView's `ItemTemplate` ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image41.png))</span></span>


<span data-ttu-id="f1543-213">Quando o botão é clicado, uma visita do usuário massacre de página, um postback e de FormView [ `ItemCommand` evento](https://msdn.microsoft.com/library/system.web.ui.webcontrols.formview.itemcommand.aspx) é acionado.</span><span class="sxs-lookup"><span data-stu-id="f1543-213">When the Button is clicked by a user visiting the page, a postback ensues and the FormView's [`ItemCommand` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.formview.itemcommand.aspx) fires.</span></span> <span data-ttu-id="f1543-214">Para executar código personalizado em resposta a esse botão sendo clicado, podemos criar um manipulador de eventos para este evento.</span><span class="sxs-lookup"><span data-stu-id="f1543-214">To execute custom code in response to this Button being clicked, we can create an event handler for this event.</span></span> <span data-ttu-id="f1543-215">Entenda, no entanto, que o `ItemCommand` evento será disparado sempre que *qualquer* controle de botão, LinkButton ou ImageButton Web é clicado em FormView.</span><span class="sxs-lookup"><span data-stu-id="f1543-215">Understand, though, that the `ItemCommand` event fires whenever *any* Button, LinkButton, or ImageButton Web control is clicked within the FormView.</span></span> <span data-ttu-id="f1543-216">Isso significa que, quando o usuário move de uma página para outra em FormView, o `ItemCommand` evento é acionado; mesmo quando o usuário clica em novo, editar ou excluir em um FormView que dá suporte à inserção, atualização ou exclusão.</span><span class="sxs-lookup"><span data-stu-id="f1543-216">That means that when the user moves from one page to another in the FormView, the `ItemCommand` event fires; same thing when the user clicks New, Edit, or Delete in a FormView that supports inserting, updating, or deleting.</span></span>

<span data-ttu-id="f1543-217">Uma vez que o `ItemCommand` é acionado independentemente de qual botão é clicado, no caso de manipulador precisamos de uma maneira de determinar se clicou no botão interromper todos os produtos ou se ele tiver sido algum outro botão.</span><span class="sxs-lookup"><span data-stu-id="f1543-217">Since the `ItemCommand` fires regardless of what button is clicked, in the event handler we need a way to determine if the Discontinue All Products Button was clicked or if it was some other button.</span></span> <span data-ttu-id="f1543-218">Para fazer isso, podemos definir o controle de botão Web `CommandName` propriedade para algum valor de identificação.</span><span class="sxs-lookup"><span data-stu-id="f1543-218">To accomplish this, we can set the Button Web control's `CommandName` property to some identifying value.</span></span> <span data-ttu-id="f1543-219">Quando o botão é clicado, isso `CommandName` valor é passado para o `ItemCommand` manipulador de eventos, possibilitando a determinar se o botão interromper todos os produtos era o botão clicado.</span><span class="sxs-lookup"><span data-stu-id="f1543-219">When the Button is clicked, this `CommandName` value is passed into the `ItemCommand` event handler, enabling us to determine whether the Discontinue All Products Button was the button clicked.</span></span> <span data-ttu-id="f1543-220">Definir interromper todos os produtos do botão `CommandName` propriedade DiscontinueProducts.</span><span class="sxs-lookup"><span data-stu-id="f1543-220">Set the Discontinue All Products Button's `CommandName` property to DiscontinueProducts .</span></span>

<span data-ttu-id="f1543-221">Por fim, vamos usar uma caixa de diálogo de confirmação do lado do cliente para garantir que o usuário realmente deseja descontinuar o produtos do fornecedor selecionado.</span><span class="sxs-lookup"><span data-stu-id="f1543-221">Finally, let's use a client-side confirm dialog box to ensure that the user really wants to discontinue the selected supplier's products.</span></span> <span data-ttu-id="f1543-222">Como vimos na [' adicionando confirmação do lado do cliente quando excluindo](../editing-inserting-and-deleting-data/adding-client-side-confirmation-when-deleting-cs.md) tutorial, isso pode ser feito com um pouco de JavaScript.</span><span class="sxs-lookup"><span data-stu-id="f1543-222">As we saw in the [Adding Client-Side Confirmation When Deleting](../editing-inserting-and-deleting-data/adding-client-side-confirmation-when-deleting-cs.md) tutorial, this can be accomplished with a bit of JavaScript.</span></span> <span data-ttu-id="f1543-223">Em particular, defina a propriedade de OnClientClick do controle da Web de botão `return confirm('This will mark _all_ of this supplier\'s products as discontinued. Are you certain you want to do this?');`</span><span class="sxs-lookup"><span data-stu-id="f1543-223">In particular, set the Button Web control's OnClientClick property to `return confirm('This will mark _all_ of this supplier\'s products as discontinued. Are you certain you want to do this?');`</span></span>

<span data-ttu-id="f1543-224">Depois de fazer essas alterações, a sintaxe declarativa de FormView deve ser semelhante ao seguinte:</span><span class="sxs-lookup"><span data-stu-id="f1543-224">After making these changes, the FormView's declarative syntax should look like the following:</span></span>

[!code-aspx[Main](adding-and-responding-to-buttons-to-a-gridview-cs/samples/sample6.aspx)]

<span data-ttu-id="f1543-225">Em seguida, crie um manipulador de eventos para o FormView `ItemCommand` eventos.</span><span class="sxs-lookup"><span data-stu-id="f1543-225">Next, create an event handler for the FormView's `ItemCommand` event.</span></span> <span data-ttu-id="f1543-226">Nesse manipulador de eventos, precisamos determinar primeiro se clicou no botão interromper todos os produtos.</span><span class="sxs-lookup"><span data-stu-id="f1543-226">In this event handler we need to first determine whether the Discontinue All Products Button was clicked.</span></span> <span data-ttu-id="f1543-227">Se assim, desejamos criar uma instância das `ProductsBLL` de classe e chamar seu `DiscontinueAllProductsForSupplier(supplierID)` método, passando o `SupplierID` do FormView selecionado:</span><span class="sxs-lookup"><span data-stu-id="f1543-227">If so, we want to create an instance of the `ProductsBLL` class and invoke its `DiscontinueAllProductsForSupplier(supplierID)` method, passing in the `SupplierID` of the selected FormView:</span></span>

[!code-csharp[Main](adding-and-responding-to-buttons-to-a-gridview-cs/samples/sample7.cs)]

<span data-ttu-id="f1543-228">Observe que o `SupplierID` do fornecedor selecionado atual FormView podem ser acessados usando o FormView [ `SelectedValue` propriedade](https://msdn.microsoft.com/library/system.web.ui.webcontrols.formview.selectedvalue.aspx).</span><span class="sxs-lookup"><span data-stu-id="f1543-228">Note that the `SupplierID` of the current selected supplier in the FormView can be accessed using the FormView's [`SelectedValue` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.formview.selectedvalue.aspx).</span></span> <span data-ttu-id="f1543-229">O `SelectedValue` propriedade retorna o valor do registro que está sendo exibido no FormView os primeiros dados da chave.</span><span class="sxs-lookup"><span data-stu-id="f1543-229">The `SelectedValue` property returns the first data key value for the record being displayed in the FormView.</span></span> <span data-ttu-id="f1543-230">O FormView [ `DataKeyNames` propriedade](https://msdn.microsoft.com/system.web.ui.webcontrols.formview.datakeynames.aspx), que indica os dados de campos do qual os dados de valores de chave são extraídos de, foi definida automaticamente como `SupplierID` pelo Visual Studio ao associar o ObjectDataSource a FormView novamente na etapa 2.</span><span class="sxs-lookup"><span data-stu-id="f1543-230">The FormView's [`DataKeyNames` property](https://msdn.microsoft.com/system.web.ui.webcontrols.formview.datakeynames.aspx), which indicates the data fields from which the data key values are pulled from, was automatically set to `SupplierID` by Visual Studio when binding the ObjectDataSource to the FormView back in Step 2.</span></span>

<span data-ttu-id="f1543-231">Com o `ItemCommand` manipulador de eventos criado, reserve um tempo para testar a página.</span><span class="sxs-lookup"><span data-stu-id="f1543-231">With the `ItemCommand` event handler created, take a moment to test out the page.</span></span> <span data-ttu-id="f1543-232">Navegue até o Cooperativa de Quesos supplier 'Las Cabras' (ele é o quinto fornecedor FormView para mim).</span><span class="sxs-lookup"><span data-stu-id="f1543-232">Browse to the Cooperativa de Quesos 'Las Cabras' supplier (it's the fifth supplier in the FormView for me).</span></span> <span data-ttu-id="f1543-233">Este fornecedor oferece dois produtos, Queso Cabrales e Queso Pastora de La Manchego, sendo que ambos *não* descontinuado.</span><span class="sxs-lookup"><span data-stu-id="f1543-233">This supplier provides two products, Queso Cabrales and Queso Manchego La Pastora, both of which are *not* discontinued.</span></span>

<span data-ttu-id="f1543-234">Imagine que a Alemanha Cooperativa Quesos 'Las Cabras' tiver saído do negócio e, portanto, seus produtos estão para ser interrompido.</span><span class="sxs-lookup"><span data-stu-id="f1543-234">Imagine that Cooperativa de Quesos 'Las Cabras' has gone out of business and therefore its products are to be discontinued.</span></span> <span data-ttu-id="f1543-235">Clique em de descontinuar o botão de todos os produtos.</span><span class="sxs-lookup"><span data-stu-id="f1543-235">Click the Discontinue All Products Button.</span></span> <span data-ttu-id="f1543-236">Isso exibirá a caixa de diálogo de confirmação do lado do cliente caixa (veja a Figura 16).</span><span class="sxs-lookup"><span data-stu-id="f1543-236">This will display the client-side confirm dialog box (see Figure 16).</span></span>


<span data-ttu-id="f1543-237">[![Cooperativa de Quesos Las Cabras fornece dois produtos ativos](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image43.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image42.png)</span><span class="sxs-lookup"><span data-stu-id="f1543-237">[![Cooperativa de Quesos Las Cabras Supplies Two Active Products](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image43.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image42.png)</span></span>

<span data-ttu-id="f1543-238">**Figura 16**: Cooperativa de Quesos Las Cabras fornece dois produtos ativos ([clique para exibir a imagem em tamanho normal](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image44.png))</span><span class="sxs-lookup"><span data-stu-id="f1543-238">**Figure 16**: Cooperativa de Quesos Las Cabras Supplies Two Active Products ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image44.png))</span></span>


<span data-ttu-id="f1543-239">Se você clicar em Okey na caixa de diálogo de confirmação do lado do cliente, o envio do formulário continuará, causando um postback em que o FormView `ItemCommand` evento será disparado.</span><span class="sxs-lookup"><span data-stu-id="f1543-239">If you click OK in the client-side confirm dialog box, the form submission will proceed, causing a postback in which the FormView's `ItemCommand` event will fire.</span></span> <span data-ttu-id="f1543-240">O manipulador de eventos que criamos, em seguida, executará, invocando o `DiscontinueAllProductsForSupplier(supplierID)` método e descontinuar o Queso Cabrales e Queso Manchego La Pastora produtos.</span><span class="sxs-lookup"><span data-stu-id="f1543-240">The event handler we created will then execute, invoking the `DiscontinueAllProductsForSupplier(supplierID)` method and discontinuing both the Queso Cabrales and Queso Manchego La Pastora products.</span></span>

<span data-ttu-id="f1543-241">Se você tiver desabilitado o estado de exibição do GridView, GridView é que está sendo ligado novamente o armazenamento de dados subjacente em cada postagem e, portanto, imediatamente será atualizada para refletir que esses dois produtos agora são descontinuados (consulte a Figura 17).</span><span class="sxs-lookup"><span data-stu-id="f1543-241">If you have disabled the GridView's view state, the GridView is being rebound to the underlying data store on every postback, and therefore will immediately be updated to reflect that these two products are now discontinued (see Figure 17).</span></span> <span data-ttu-id="f1543-242">Se, no entanto, você não tiver desabilitado o estado de exibição do GridView, você precisará manualmente depois de fazer essa alteração, associar novamente os dados para o GridView.</span><span class="sxs-lookup"><span data-stu-id="f1543-242">If, however, you have not disabled view state in the GridView, you will need to manually rebind the data to the GridView after making this change.</span></span> <span data-ttu-id="f1543-243">Para fazer isso, basta fazer uma chamada para o GridView `DataBind()` método imediatamente depois de invocar o `DiscontinueAllProductsForSupplier(supplierID)` método.</span><span class="sxs-lookup"><span data-stu-id="f1543-243">To accomplish this, simply make a call to the GridView's `DataBind()` method immediately after invoking the `DiscontinueAllProductsForSupplier(supplierID)` method.</span></span>


<span data-ttu-id="f1543-244">[![Depois de clicar no botão interromper todos os produtos, os produtos de fornecedor s são atualizadas adequadamente.](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image46.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image45.png)</span><span class="sxs-lookup"><span data-stu-id="f1543-244">[![After Clicking the Discontinue All Products Button, the Supplier s Products are Updated Accordingly](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image46.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image45.png)</span></span>

<span data-ttu-id="f1543-245">**Figura 17**: depois de clicar no botão interromper todos os produtos, os produtos do fornecedor são atualizados adequadamente ([clique para exibir a imagem em tamanho normal](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image47.png))</span><span class="sxs-lookup"><span data-stu-id="f1543-245">**Figure 17**: After Clicking the Discontinue All Products Button, the Supplier's Products are Updated Accordingly ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image47.png))</span></span>


## <a name="step-6-creating-an-updateproduct-overload-in-the-business-logic-layer-for-adjusting-a-products-price"></a><span data-ttu-id="f1543-246">Etapa 6: Criando uma sobrecarga UpdateProduct na camada de lógica de negócios para o ajuste de preço de um produto</span><span class="sxs-lookup"><span data-stu-id="f1543-246">Step 6: Creating an UpdateProduct Overload in the Business Logic Layer for Adjusting a Product's Price</span></span>

<span data-ttu-id="f1543-247">Como com interromper todos os produtos botão FormView, para adicionar botões para aumentar e diminuir o preço de um produto GridView é necessário primeiro adicionar os métodos apropriados de camada de acesso a dados e camada de lógica comercial.</span><span class="sxs-lookup"><span data-stu-id="f1543-247">Like with the Discontinue All Products Button in the FormView, in order to add buttons for increasing and decreasing the price for a product in the GridView we need to first add the appropriate Data Access Layer and Business Logic Layer methods.</span></span> <span data-ttu-id="f1543-248">Como já temos um método que atualiza uma linha única de produto a DAL, podemos fornecer essa funcionalidade, criando uma nova sobrecarga para o `UpdateProduct` método na BLL.</span><span class="sxs-lookup"><span data-stu-id="f1543-248">Since we already have a method that updates a single product row in the DAL, we can provide such functionality by creating a new overload for the `UpdateProduct` method in the BLL.</span></span>

<span data-ttu-id="f1543-249">Nosso passado `UpdateProduct` sobrecargas entraram em alguma combinação de campos de produto como valores escalares de entrada e, em seguida, atualizou apenas os campos para o produto especificado.</span><span class="sxs-lookup"><span data-stu-id="f1543-249">Our past `UpdateProduct` overloads have taken in some combination of product fields as scalar input values and have then updated just those fields for the specified product.</span></span> <span data-ttu-id="f1543-250">Para essa sobrecarga vamos variar levemente com relação esse padrão e o produto em vez disso, passe `ProductID` e a porcentagem pela qual ajustar a `UnitPrice` (em vez de passar nos novos, ajustados `UnitPrice` em si).</span><span class="sxs-lookup"><span data-stu-id="f1543-250">For this overload we'll vary slightly from this standard and instead pass in the product's `ProductID` and the percentage by which to adjust the `UnitPrice` (as opposed to passing in the new, adjusted `UnitPrice` itself).</span></span> <span data-ttu-id="f1543-251">Essa abordagem será simplificam o código que precisamos escrever na classe ASP.NET página code-behind, já que não será preciso se preocupar com a determinação do produto atual `UnitPrice`.</span><span class="sxs-lookup"><span data-stu-id="f1543-251">This approach will simplify the code we need to write in the ASP.NET page code-behind class, since we don't have to bother with determining the current product's `UnitPrice`.</span></span>

<span data-ttu-id="f1543-252">O `UpdateProduct` sobrecarga para este tutorial é mostrado abaixo:</span><span class="sxs-lookup"><span data-stu-id="f1543-252">The `UpdateProduct` overload for this tutorial is shown below:</span></span>

[!code-csharp[Main](adding-and-responding-to-buttons-to-a-gridview-cs/samples/sample8.cs)]

<span data-ttu-id="f1543-253">Essa sobrecarga recupera informações sobre o produto especificado através da DAL `GetProductByProductID(productID)` método.</span><span class="sxs-lookup"><span data-stu-id="f1543-253">This overload retrieves information about the specified product through the DAL's `GetProductByProductID(productID)` method.</span></span> <span data-ttu-id="f1543-254">Em seguida, ele verifica se o produto `UnitPrice` for atribuído a um banco de dados `NULL` valor.</span><span class="sxs-lookup"><span data-stu-id="f1543-254">It then checks to see whether the product's `UnitPrice` is assigned a database `NULL` value.</span></span> <span data-ttu-id="f1543-255">Se for, o preço é deixado inalterado.</span><span class="sxs-lookup"><span data-stu-id="f1543-255">If it is, the price is left unaltered.</span></span> <span data-ttu-id="f1543-256">Se, no entanto, há um não -`NULL` `UnitPrice` valor, o método de atualizações do produto `UnitPrice` pelo percentual especificado (`unitPriceAdjustmentPercent`).</span><span class="sxs-lookup"><span data-stu-id="f1543-256">If, however, there is a non-`NULL` `UnitPrice` value, the method updates the product's `UnitPrice` by the specified percent (`unitPriceAdjustmentPercent`).</span></span>

## <a name="step-7-adding-the-increase-and-decrease-buttons-to-the-gridview"></a><span data-ttu-id="f1543-257">Etapa 7: Adicionar o aumento e diminuição botões a GridView</span><span class="sxs-lookup"><span data-stu-id="f1543-257">Step 7: Adding the Increase and Decrease Buttons to the GridView</span></span>

<span data-ttu-id="f1543-258">O GridView (e DetailsView) são ambos composto por uma coleção de campos.</span><span class="sxs-lookup"><span data-stu-id="f1543-258">The GridView (and DetailsView) are both made up of a collection of fields.</span></span> <span data-ttu-id="f1543-259">Além de BoundFields, CheckBoxFields e TemplateFields, o ASP.NET inclui ButtonField, que, como o nome sugere, é renderizada como uma coluna com um botão, LinkButton ou ImageButton para cada linha.</span><span class="sxs-lookup"><span data-stu-id="f1543-259">In addition to BoundFields, CheckBoxFields, and TemplateFields, ASP.NET includes the ButtonField, which, as its name implies, renders as a column with a Button, LinkButton, or ImageButton for each row.</span></span> <span data-ttu-id="f1543-260">Semelhante de FormView, clicando em *qualquer* botão dentro de GridView botões de paginação, editar ou excluir botões, botões de classificação e assim por diante causa um postback e aciona o GridView [ `RowCommand` evento](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.rowcommand.aspx).</span><span class="sxs-lookup"><span data-stu-id="f1543-260">Similar to the FormView, clicking *any* button within the GridView paging buttons, Edit or Delete buttons, sorting buttons, and so on causes a postback and raises the GridView's [`RowCommand` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.rowcommand.aspx).</span></span>

<span data-ttu-id="f1543-261">O ButtonField tem um `CommandName` propriedade que atribui o valor especificado para cada um dos seus botões `CommandName` propriedades.</span><span class="sxs-lookup"><span data-stu-id="f1543-261">The ButtonField has a `CommandName` property that assigns the specified value to each of its Buttons `CommandName` properties.</span></span> <span data-ttu-id="f1543-262">Como com FormView, o `CommandName` valor é usado pelo `RowCommand` manipulador de eventos para determinar qual botão foi clicado.</span><span class="sxs-lookup"><span data-stu-id="f1543-262">Like with the FormView, the `CommandName` value is used by the `RowCommand` event handler to determine which button was clicked.</span></span>

<span data-ttu-id="f1543-263">Vamos adicionar dois ButtonFields novo para o GridView, uma com um texto do botão preço + 10% e o outro com o texto do preço -10%.</span><span class="sxs-lookup"><span data-stu-id="f1543-263">Let's add two new ButtonFields to the GridView, one with a button text Price +10% and the other with the text Price -10%.</span></span> <span data-ttu-id="f1543-264">Para adicionar esses ButtonFields, clique no link Edit Columns na marca inteligente do GridView, selecione o tipo de campo ButtonField na lista na parte superior esquerda e clique no botão Adicionar.</span><span class="sxs-lookup"><span data-stu-id="f1543-264">To add these ButtonFields, click on the Edit Columns link from the GridView's smart tag, select the ButtonField field type from the list in the upper left and click the Add button.</span></span>


![Adicionar dois ButtonFields a GridView](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image48.png)

<span data-ttu-id="f1543-266">**Figura 18**: adicionar duas ButtonFields a GridView</span><span class="sxs-lookup"><span data-stu-id="f1543-266">**Figure 18**: Add Two ButtonFields to the GridView</span></span>


<span data-ttu-id="f1543-267">Mova os dois ButtonFields para que eles apareçam como os primeiros dois campos de GridView.</span><span class="sxs-lookup"><span data-stu-id="f1543-267">Move the two ButtonFields so that they appear as the first two GridView fields.</span></span> <span data-ttu-id="f1543-268">Em seguida, defina as `Text` propriedades desses dois ButtonFields preço + 10% e preço -10% e o `CommandName` propriedades IncreasePrice e DecreasePrice, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="f1543-268">Next, set the `Text` properties of these two ButtonFields to Price +10% and Price -10% and the `CommandName` properties to IncreasePrice and DecreasePrice, respectively.</span></span> <span data-ttu-id="f1543-269">Por padrão, um ButtonField processa sua coluna de botões como botões de link.</span><span class="sxs-lookup"><span data-stu-id="f1543-269">By default, a ButtonField renders its column of buttons as LinkButtons.</span></span> <span data-ttu-id="f1543-270">Isso pode ser alterado, no entanto, por meio do ButtonField [ `ButtonType` propriedade](https://msdn.microsoft.com/library/system.web.ui.webcontrols.buttonfieldbase.buttontype.aspx).</span><span class="sxs-lookup"><span data-stu-id="f1543-270">This can be changed, however, through the ButtonField's [`ButtonType` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.buttonfieldbase.buttontype.aspx).</span></span> <span data-ttu-id="f1543-271">Vamos ter esses dois ButtonFields renderizados como botões de envio regulares; Portanto, defina as `ButtonType` propriedade para `Button`.</span><span class="sxs-lookup"><span data-stu-id="f1543-271">Let's have these two ButtonFields rendered as regular push buttons; therefore, set the `ButtonType` property to `Button`.</span></span> <span data-ttu-id="f1543-272">Figura 19 mostra os campos de caixa de diálogo depois que essas alterações foram feitas; a seguir que é a marcação declarativa do GridView.</span><span class="sxs-lookup"><span data-stu-id="f1543-272">Figure 19 shows the Fields dialog box after these changes have been made; following that is the GridView's declarative markup.</span></span>


![Configurar o texto de ButtonFields, CommandName e ButtonType propriedades](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image49.png)

<span data-ttu-id="f1543-274">**Figura 19**: configurar o ButtonFields `Text`, `CommandName`, e `ButtonType` propriedades</span><span class="sxs-lookup"><span data-stu-id="f1543-274">**Figure 19**: Configure the ButtonFields `Text`, `CommandName`, and `ButtonType` Properties</span></span>


[!code-aspx[Main](adding-and-responding-to-buttons-to-a-gridview-cs/samples/sample9.aspx)]

<span data-ttu-id="f1543-275">Com essas ButtonFields criados, a etapa final é criar um manipulador de eventos para o GridView `RowCommand` eventos.</span><span class="sxs-lookup"><span data-stu-id="f1543-275">With these ButtonFields created, the final step is to create an event handler for the GridView's `RowCommand` event.</span></span> <span data-ttu-id="f1543-276">Esse manipulador de eventos, se acionada porque o preço + 10% ou botões de % do preço -10 foram clicados, é preciso determinar o `ProductID` da linha cujo botão foi clicado e, em seguida, chamar o `ProductsBLL` da classe `UpdateProduct` método, passando o apropriado `UnitPrice` percentual de ajuste juntamente com o `ProductID`.</span><span class="sxs-lookup"><span data-stu-id="f1543-276">This event handler, if fired because either the Price +10% or Price -10% buttons were clicked, needs to determine the `ProductID` for the row whose button was clicked and then invoke the `ProductsBLL` class's `UpdateProduct` method, passing in the appropriate `UnitPrice` percentage adjustment along with the `ProductID`.</span></span> <span data-ttu-id="f1543-277">O código a seguir executa essas tarefas:</span><span class="sxs-lookup"><span data-stu-id="f1543-277">The following code performs these tasks:</span></span>

[!code-csharp[Main](adding-and-responding-to-buttons-to-a-gridview-cs/samples/sample10.cs)]

<span data-ttu-id="f1543-278">Para determinar a `ProductID` da linha cujo preço + 10% ou botão de % do preço -10 foi clicado, é preciso consultar o GridView `DataKeys` coleção.</span><span class="sxs-lookup"><span data-stu-id="f1543-278">In order to determine the `ProductID` for the row whose Price +10% or Price -10% button was clicked, we need to consult the GridView's `DataKeys` collection.</span></span> <span data-ttu-id="f1543-279">Esta coleção mantém os valores dos campos especificados no `DataKeyNames` propriedade para cada linha de GridView.</span><span class="sxs-lookup"><span data-stu-id="f1543-279">This collection holds the values of the fields specified in the `DataKeyNames` property for each GridView row.</span></span> <span data-ttu-id="f1543-280">Desde o GridView `DataKeyNames` propriedade foi definida como ProductID pelo Visual Studio ao associar o ObjectDataSource a GridView `DataKeys(rowIndex).Value` fornece o `ProductID` especificado *rowIndex*.</span><span class="sxs-lookup"><span data-stu-id="f1543-280">Since the GridView's `DataKeyNames` property was set to ProductID by Visual Studio when binding the ObjectDataSource to the GridView, `DataKeys(rowIndex).Value` provides the `ProductID` for the specified *rowIndex*.</span></span>

<span data-ttu-id="f1543-281">O ButtonField passa automaticamente a *rowIndex* da linha cujo botão foi clicado por meio do `e.CommandArgument` parâmetro.</span><span class="sxs-lookup"><span data-stu-id="f1543-281">The ButtonField automatically passes in the *rowIndex* of the row whose button was clicked through the `e.CommandArgument` parameter.</span></span> <span data-ttu-id="f1543-282">Portanto, para determinar a `ProductID` da linha cujo preço + 10% ou botão de % do preço -10 foi clicado, usamos: `Convert.ToInt32(SuppliersProducts.DataKeys(Convert.ToInt32(e.CommandArgument)).Value)`.</span><span class="sxs-lookup"><span data-stu-id="f1543-282">Therefore, to determine the `ProductID` for the row whose Price +10% or Price -10% button was clicked, we use: `Convert.ToInt32(SuppliersProducts.DataKeys(Convert.ToInt32(e.CommandArgument)).Value)`.</span></span>

<span data-ttu-id="f1543-283">Como com o botão interromper todos os produtos, se você tiver desabilitado o estado de exibição do GridView, GridView é que está sendo ligado novamente o armazenamento de dados subjacente em cada postagem e, portanto, imediatamente será atualizada para refletir uma alteração de preço que ocorre entre o clique qualquer um dos botões.</span><span class="sxs-lookup"><span data-stu-id="f1543-283">As with the Discontinue All Products button, if you have disabled the GridView's view state, the GridView is being rebound to the underlying data store on every postback, and therefore will immediately be updated to reflect a price change that occurs from clicking either of the buttons.</span></span> <span data-ttu-id="f1543-284">Se, no entanto, você não tiver desabilitado o estado de exibição do GridView, você precisará manualmente depois de fazer essa alteração, associar novamente os dados para o GridView.</span><span class="sxs-lookup"><span data-stu-id="f1543-284">If, however, you have not disabled view state in the GridView, you will need to manually rebind the data to the GridView after making this change.</span></span> <span data-ttu-id="f1543-285">Para fazer isso, basta fazer uma chamada para o GridView `DataBind()` método imediatamente depois de invocar o `UpdateProduct` método.</span><span class="sxs-lookup"><span data-stu-id="f1543-285">To accomplish this, simply make a call to the GridView's `DataBind()` method immediately after invoking the `UpdateProduct` method.</span></span>

<span data-ttu-id="f1543-286">Figura 20 mostra a página ao exibir os produtos oferecidos por vovó Kelly Homestead.</span><span class="sxs-lookup"><span data-stu-id="f1543-286">Figure 20 shows the page when viewing the products provided by Grandma Kelly's Homestead.</span></span> <span data-ttu-id="f1543-287">Figura 21 mostra os resultados após o preço + 10% botão foi clicado duas vezes para distribuir de Framboesa da Vovó e o botão do preço -10% uma vez para Molho Oxicoco ingrediente.</span><span class="sxs-lookup"><span data-stu-id="f1543-287">Figure 21 shows the results after the Price +10% button has been clicked twice for Grandma's Boysenberry Spread and the Price -10% button once for Northwoods Cranberry Sauce.</span></span>


<span data-ttu-id="f1543-288">[![O GridView inclui preço + 10% e preço -10% botões](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image51.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image50.png)</span><span class="sxs-lookup"><span data-stu-id="f1543-288">[![The GridView Includes Price +10% and Price -10% Buttons](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image51.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image50.png)</span></span>

<span data-ttu-id="f1543-289">**Figura 20**: O preço do GridView inclui + 10% e botões de % do preço -10 ([clique para exibir a imagem em tamanho normal](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image52.png))</span><span class="sxs-lookup"><span data-stu-id="f1543-289">**Figure 20**: The GridView Includes Price +10% and Price -10% Buttons ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image52.png))</span></span>


<span data-ttu-id="f1543-290">[![Os preços para o primeiro e terceiro produto foram atualizados por meio de preço + 10% e preço -10% botões](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image54.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image53.png)</span><span class="sxs-lookup"><span data-stu-id="f1543-290">[![The Prices for the First and Third Product Have Been Updated via the Price +10% and Price -10% Buttons](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image54.png)](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image53.png)</span></span>

<span data-ttu-id="f1543-291">**Figura 21**: os preços para o primeiro e terceiro produto foram atualizados por meio de preço + 10% e botões de % do preço -10 ([clique para exibir a imagem em tamanho normal](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image55.png))</span><span class="sxs-lookup"><span data-stu-id="f1543-291">**Figure 21**: The Prices for the First and Third Product Have Been Updated via the Price +10% and Price -10% Buttons ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-cs/_static/image55.png))</span></span>


> [!NOTE]
> <span data-ttu-id="f1543-292">O GridView (e DetailsView) também podem ter botões, botões de link ou ImageButtons adicionado ao seu TemplateFields.</span><span class="sxs-lookup"><span data-stu-id="f1543-292">The GridView (and DetailsView) can also have Buttons, LinkButtons, or ImageButtons added to their TemplateFields.</span></span> <span data-ttu-id="f1543-293">Como com BoundField, esses botões, quando clicado, serão induzir um postback, gerando o GridView `RowCommand` eventos.</span><span class="sxs-lookup"><span data-stu-id="f1543-293">As with the BoundField, these Buttons, when clicked, will induce a postback, raising the GridView's `RowCommand` event.</span></span> <span data-ttu-id="f1543-294">Quando adicionar botões em um TemplateField, no entanto, o botão `CommandArgument` não são definidos automaticamente para o índice da linha conforme ela é ao usar ButtonFields.</span><span class="sxs-lookup"><span data-stu-id="f1543-294">When adding buttons in a TemplateField, however, the Button's `CommandArgument` is not automatically set to the index of the row as it is when using ButtonFields.</span></span> <span data-ttu-id="f1543-295">Se você precisar determinar o índice da linha do botão que foi clicado dentro de `RowCommand` manipulador de eventos, você precisará definir manualmente no botão `CommandArgument` propriedade em sua sintaxe declarativa em um TemplateField, usando um código como:</span><span class="sxs-lookup"><span data-stu-id="f1543-295">If you need to determine the row index of the button that was clicked within the `RowCommand` event handler, you'll need to manually set the Button's `CommandArgument` property in its declarative syntax within the TemplateField, using code like:</span></span>  
> <span data-ttu-id="f1543-296">`<asp:Button runat="server" ... CommandArgument='<%# ((GridViewRow) Container).RowIndex %>'`.</span><span class="sxs-lookup"><span data-stu-id="f1543-296">`<asp:Button runat="server" ... CommandArgument='<%# ((GridViewRow) Container).RowIndex %>'`.</span></span>


## <a name="summary"></a><span data-ttu-id="f1543-297">Resumo</span><span class="sxs-lookup"><span data-stu-id="f1543-297">Summary</span></span>

<span data-ttu-id="f1543-298">Os controles GridView, DetailsView e FormView podem incluir os botões, botões de link ou ImageButtons.</span><span class="sxs-lookup"><span data-stu-id="f1543-298">The GridView, DetailsView, and FormView controls all can include Buttons, LinkButtons, or ImageButtons.</span></span> <span data-ttu-id="f1543-299">Esses botões, quando clicado, fazer com que um postback e disparar o `ItemCommand` eventos nos controles de FormView e DetailsView e o `RowCommand` evento no GridView.</span><span class="sxs-lookup"><span data-stu-id="f1543-299">Such buttons, when clicked, cause a postback and raise the `ItemCommand` event in the FormView and DetailsView controls and the `RowCommand` event in the GridView.</span></span> <span data-ttu-id="f1543-300">Esses controles da Web de dados tem uma funcionalidade interna para lidar com ações comuns relacionadas ao comando, como excluir ou editar registros.</span><span class="sxs-lookup"><span data-stu-id="f1543-300">These data Web controls have built-in functionality to handle common command-related actions, such as deleting or editing records.</span></span> <span data-ttu-id="f1543-301">No entanto, também podemos usar botões que, quando clicado, responda com nosso próprio código personalizado em execução.</span><span class="sxs-lookup"><span data-stu-id="f1543-301">However, we can also use buttons that, when clicked, respond with executing our own custom code.</span></span>

<span data-ttu-id="f1543-302">Para fazer isso, precisamos criar um manipulador de eventos para o `ItemCommand` ou `RowCommand` eventos.</span><span class="sxs-lookup"><span data-stu-id="f1543-302">To accomplish this, we need to create an event handler for the `ItemCommand` or `RowCommand` event.</span></span> <span data-ttu-id="f1543-303">Nesse manipulador de eventos, verificamos primeiro a entrada `CommandName` valor para determinar qual botão foi clicado e, em seguida, tomar as devidas providências de personalizado.</span><span class="sxs-lookup"><span data-stu-id="f1543-303">In this event handler we first check the incoming `CommandName` value to determine which button was clicked and then take appropriate custom action.</span></span> <span data-ttu-id="f1543-304">Neste tutorial vimos como usar os botões e ButtonFields para interromper todos os produtos para um fornecedor especificado ou para aumentar ou diminuir o preço de um produto específico, 10%.</span><span class="sxs-lookup"><span data-stu-id="f1543-304">In this tutorial we saw how to use buttons and ButtonFields to discontinue all products for a specified supplier or to increase or decrease the price of a particular product by 10%.</span></span>

<span data-ttu-id="f1543-305">Boa programação!</span><span class="sxs-lookup"><span data-stu-id="f1543-305">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="f1543-306">Sobre o autor</span><span class="sxs-lookup"><span data-stu-id="f1543-306">About the Author</span></span>

<span data-ttu-id="f1543-307">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de sete livros sobre ASP/ASP.NET e fundador da [4GuysFromRolla.com](http://www.4guysfromrolla.com), tem trabalhado com tecnologias Microsoft Web desde 1998.</span><span class="sxs-lookup"><span data-stu-id="f1543-307">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="f1543-308">Scott funciona como um consultor independente, instrutor e escritor.</span><span class="sxs-lookup"><span data-stu-id="f1543-308">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="f1543-309">Seu livro mais recente é [ *Sams Teach por conta própria ASP.NET 2.0 em 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="f1543-309">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="f1543-310">Ele pode ser contatado pelo [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="f1543-310">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="f1543-311">ou por meio de seu blog, que pode ser encontrado em [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="f1543-311">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="f1543-312">Avançar</span><span class="sxs-lookup"><span data-stu-id="f1543-312">Next</span></span>](adding-and-responding-to-buttons-to-a-gridview-vb.md)

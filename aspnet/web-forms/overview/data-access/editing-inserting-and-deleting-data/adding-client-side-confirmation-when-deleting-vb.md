---
uid: web-forms/overview/data-access/editing-inserting-and-deleting-data/adding-client-side-confirmation-when-deleting-vb
title: Adicionando confirmação do lado do cliente ao excluir (VB) | Microsoft Docs
author: rick-anderson
description: As interfaces que criamos até agora, um usuário pode excluir acidentalmente dados clicando no botão Excluir quando pretendiam clicar no botão Editar. Nesse t...
ms.author: aspnetcontent
manager: wpickett
ms.date: 07/17/2006
ms.topic: article
ms.assetid: 6331e02e-c465-4cdf-bd3f-f07680c289d6
ms.technology: dotnet-webforms
msc.legacyurl: /web-forms/overview/data-access/editing-inserting-and-deleting-data/adding-client-side-confirmation-when-deleting-vb
msc.type: authoredcontent
ms.openlocfilehash: acab34cb362bd3e3351156a41a6826d03e5a749f
ms.sourcegitcommit: 953ff9ea4369f154d6fd0239599279ddd3280009
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 07/03/2018
ms.locfileid: "37388261"
---
<a name="adding-client-side-confirmation-when-deleting-vb"></a><span data-ttu-id="456fe-104">Adicionando confirmação do lado do cliente ao excluir (VB)</span><span class="sxs-lookup"><span data-stu-id="456fe-104">Adding Client-Side Confirmation When Deleting (VB)</span></span>
====================
<span data-ttu-id="456fe-105">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="456fe-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="456fe-106">[Baixe o aplicativo de exemplo](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_22_VB.exe) ou [baixar PDF](adding-client-side-confirmation-when-deleting-vb/_static/datatutorial22vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="456fe-106">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_22_VB.exe) or [Download PDF](adding-client-side-confirmation-when-deleting-vb/_static/datatutorial22vb1.pdf)</span></span>

> <span data-ttu-id="456fe-107">As interfaces que criamos até agora, um usuário pode excluir acidentalmente dados clicando no botão Excluir quando pretendiam clicar no botão Editar.</span><span class="sxs-lookup"><span data-stu-id="456fe-107">In the interfaces we've created so far, a user can accidentally delete data by clicking the Delete button when they meant to click the Edit button.</span></span> <span data-ttu-id="456fe-108">Neste tutorial, adicionaremos uma caixa de diálogo de confirmação do lado do cliente que é exibido quando o botão Excluir é clicado.</span><span class="sxs-lookup"><span data-stu-id="456fe-108">In this tutorial we'll add a client-side confirmation dialog box that appears when the Delete button is clicked.</span></span>


## <a name="introduction"></a><span data-ttu-id="456fe-109">Introdução</span><span class="sxs-lookup"><span data-stu-id="456fe-109">Introduction</span></span>

<span data-ttu-id="456fe-110">Sobre os últimos tutoriais de vários nós ve viu como usar nossa arquitetura de aplicativo, ObjectDataSource e os dados de controles da Web em conjunto para fornecer a inserção, edição e exclusão de recursos.</span><span class="sxs-lookup"><span data-stu-id="456fe-110">Over the past several tutorials we ve seen how to use our application architecture, ObjectDataSource, and the data Web controls in concert to provide inserting, editing, and deleting capabilities.</span></span> <span data-ttu-id="456fe-111">A exclusão de interfaces podemos ve examinada até agora foram composto de uma exclusão de botão que, quando clicado, faz com que um postback e invoca o s ObjectDataSource `Delete()` método.</span><span class="sxs-lookup"><span data-stu-id="456fe-111">The deleting interfaces we ve examined thus far have been composed of a Delete button that, when clicked, causes a postback and invokes the ObjectDataSource s `Delete()` method.</span></span> <span data-ttu-id="456fe-112">O `Delete()` método, em seguida, invoca o método configurado da camada de lógica de negócios, que propaga a chamada para baixo até a camada de acesso a dados, o valor real de emissão `DELETE` instrução no banco de dados.</span><span class="sxs-lookup"><span data-stu-id="456fe-112">The `Delete()` method then invokes the configured method from the Business Logic Layer, which propagates the call down to the Data Access Layer, issuing the actual `DELETE` statement to the database.</span></span>

<span data-ttu-id="456fe-113">Embora essa interface do usuário permite que os visitantes excluir registros pelos controles GridView, DetailsView ou FormView, ele não tem qualquer tipo de confirmação quando o usuário clica no botão Excluir.</span><span class="sxs-lookup"><span data-stu-id="456fe-113">While this user interface enables visitors to delete records through the GridView, DetailsView, or FormView controls, it lacks any sort of confirmation when the user clicks the Delete button.</span></span> <span data-ttu-id="456fe-114">Se um usuário acidentalmente clicar no botão Excluir quando pretendiam clicar em Editar, o registro que eles devem atualizar em vez disso, será excluído.</span><span class="sxs-lookup"><span data-stu-id="456fe-114">If a user accidentally clicks the Delete button when they meant to click Edit, the record they meant to update will instead be deleted.</span></span> <span data-ttu-id="456fe-115">Para evitar isso, neste tutorial, adicionaremos uma caixa de diálogo de confirmação do lado do cliente que é exibido quando o botão Excluir é clicado.</span><span class="sxs-lookup"><span data-stu-id="456fe-115">To help prevent this, in this tutorial we'll add a client-side confirmation dialog box that appears when the Delete button is clicked.</span></span>

<span data-ttu-id="456fe-116">O JavaScript `confirm(string)` função exibe seu parâmetro de entrada de cadeia de caracteres como o texto dentro de uma caixa de diálogo modal que vem equipado com dois botões - Okey e Cancelar (veja a Figura 1).</span><span class="sxs-lookup"><span data-stu-id="456fe-116">The JavaScript `confirm(string)` function displays its string input parameter as the text inside a modal dialog box that comes equipped with two buttons - OK and Cancel (see Figure 1).</span></span> <span data-ttu-id="456fe-117">O `confirm(string)` função retorna um valor booliano, dependendo de qual botão é clicado (`true`, se o usuário clica em Okey, e `false` clicando em ' Cancelar ').</span><span class="sxs-lookup"><span data-stu-id="456fe-117">The `confirm(string)` function returns a Boolean value depending on what button is clicked (`true`, if the user clicks OK, and `false` if they click Cancel).</span></span>


![O método de confirm(string) de JavaScript exibe uma Modal Messagebox do lado do cliente](adding-client-side-confirmation-when-deleting-vb/_static/image1.png)

<span data-ttu-id="456fe-119">**Figura 1**: O JavaScript `confirm(string)` método exibe uma caixa de mensagem Modal, no lado do cliente</span><span class="sxs-lookup"><span data-stu-id="456fe-119">**Figure 1**: The JavaScript `confirm(string)` Method Displays a Modal, Client-Side Messagebox</span></span>


<span data-ttu-id="456fe-120">Durante o envio de um formulário, se o valor de `false` é retornado de um manipulador de eventos do lado do cliente, em seguida, o envio do formulário é cancelado.</span><span class="sxs-lookup"><span data-stu-id="456fe-120">During a form submission, if a value of `false` is returned from a client-side event handler then the form submission is cancelled.</span></span> <span data-ttu-id="456fe-121">Usando esse recurso, podemos ter exclusão botão s lado do cliente `onclick` manipulador de eventos retornar o valor de uma chamada para `confirm("Are you sure you want to delete this product?")`.</span><span class="sxs-lookup"><span data-stu-id="456fe-121">Using this feature, we can have the Delete button s client-side `onclick` event handler return the value of a call to `confirm("Are you sure you want to delete this product?")`.</span></span> <span data-ttu-id="456fe-122">Se o usuário clicar em Cancelar, `confirm(string)` retornará false e, portanto, fazendo com que o envio do formulário Cancelar.</span><span class="sxs-lookup"><span data-stu-id="456fe-122">If the user clicks Cancel, `confirm(string)` will return false, thereby causing the form submission to cancel.</span></span> <span data-ttu-id="456fe-123">Com nenhum postback, o produto cuja exclusão foi clicada ganhou um t ser excluído.</span><span class="sxs-lookup"><span data-stu-id="456fe-123">With no postback, the product whose Delete button was clicked won t be deleted.</span></span> <span data-ttu-id="456fe-124">Se, no entanto, o usuário clica Okey na caixa de diálogo de confirmação, o postback continua sem interrupções e o produto será excluído.</span><span class="sxs-lookup"><span data-stu-id="456fe-124">If, however, the user clicks OK in the confirmation dialog box, the postback will continue unabated and the product will be deleted.</span></span> <span data-ttu-id="456fe-125">Consultar [s usando JavaScript `confirm()` método de envio do formulário de controle](http://www.webreference.com/programming/javascript/confirm/) para obter mais informações sobre essa técnica.</span><span class="sxs-lookup"><span data-stu-id="456fe-125">Consult [Using JavaScript s `confirm()` Method to Control Form Submission](http://www.webreference.com/programming/javascript/confirm/) for more information on this technique.</span></span>

<span data-ttu-id="456fe-126">Adicionar o script do lado do cliente necessário um pouco diferente se usando modelos que ao usar um CommandField.</span><span class="sxs-lookup"><span data-stu-id="456fe-126">Adding the necessary client-side script differs slightly if using templates than when using a CommandField.</span></span> <span data-ttu-id="456fe-127">Portanto, neste tutorial vamos examinar um FormView e GridView de exemplo.</span><span class="sxs-lookup"><span data-stu-id="456fe-127">Therefore, in this tutorial we will look at both a FormView and GridView example.</span></span>

> [!NOTE]
> <span data-ttu-id="456fe-128">Usando técnicas de confirmação do lado do cliente, como aquelas discutidas neste tutorial pressupõe que seus usuários estão visitando com navegadores que oferecem suporte a JavaScript e que tenham JavaScript habilitado.</span><span class="sxs-lookup"><span data-stu-id="456fe-128">Using client-side confirmation techniques, like the ones discussed in this tutorial, assumes that your users are visiting with browsers that support JavaScript and that they have JavaScript enabled.</span></span> <span data-ttu-id="456fe-129">Se qualquer uma dessas suposições não forem verdadeira para um usuário específico, clicando no botão Excluir imediatamente causará um postback (não exibir uma messagebox de confirmar).</span><span class="sxs-lookup"><span data-stu-id="456fe-129">If either of these assumptions are not true for a particular user, clicking the Delete button will immediately cause a postback (not displaying a confirm messagebox).</span></span>


## <a name="step-1-creating-a-formview-that-supports-deletion"></a><span data-ttu-id="456fe-130">Etapa 1: Criando um FormView que dá suporte à exclusão</span><span class="sxs-lookup"><span data-stu-id="456fe-130">Step 1: Creating a FormView That Supports Deletion</span></span>

<span data-ttu-id="456fe-131">Comece adicionando um FormView para o `ConfirmationOnDelete.aspx` página no `EditInsertDelete` pasta, associação a um novo ObjectDataSource que extrai as informações do produto por meio de `ProductsBLL` classe s `GetProducts()` método.</span><span class="sxs-lookup"><span data-stu-id="456fe-131">Start by adding a FormView to the `ConfirmationOnDelete.aspx` page in the `EditInsertDelete` folder, binding it to a new ObjectDataSource that pulls back the product information via the `ProductsBLL` class s `GetProducts()` method.</span></span> <span data-ttu-id="456fe-132">Também configurar o ObjectDataSource para que o `ProductsBLL` classe s `DeleteProduct(productID)` método é mapeado para o s ObjectDataSource `Delete()` método; Certifique-se de que as guias INSERT e UPDATE listas suspensas são definidas como (nenhum).</span><span class="sxs-lookup"><span data-stu-id="456fe-132">Also configure the ObjectDataSource so that the `ProductsBLL` class s `DeleteProduct(productID)` method is mapped to the ObjectDataSource s `Delete()` method; ensure that the INSERT and UPDATE tabs drop-down lists are set to (None).</span></span> <span data-ttu-id="456fe-133">Por fim, marque a caixa de seleção Habilitar paginação na marca inteligente s FormView.</span><span class="sxs-lookup"><span data-stu-id="456fe-133">Finally, check the Enable Paging checkbox in the FormView s smart tag.</span></span>

<span data-ttu-id="456fe-134">Após essas etapas, o novo ObjectDataSource s marcação declarativa ficará semelhante ao seguinte:</span><span class="sxs-lookup"><span data-stu-id="456fe-134">After these steps, the new ObjectDataSource s declarative markup will look like the following:</span></span>


[!code-aspx[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample1.aspx)]

<span data-ttu-id="456fe-135">Como em nossos exemplos anteriores que não usou a simultaneidade otimista, reserve um tempo para limpar o s ObjectDataSource `OldValuesParameterFormatString` propriedade.</span><span class="sxs-lookup"><span data-stu-id="456fe-135">As in our past examples that did not use optimistic concurrency, take a moment to clear out the ObjectDataSource s `OldValuesParameterFormatString` property.</span></span>

<span data-ttu-id="456fe-136">Uma vez que ele foi associado a um controle ObjectDataSource que dá suporte somente a exclusão, o s FormView `ItemTemplate` oferece apenas o botão de exclusão, que não tem os botões novo e atualização.</span><span class="sxs-lookup"><span data-stu-id="456fe-136">Since it has been bound to an ObjectDataSource control that only supports deleting, the FormView s `ItemTemplate` offers only the Delete button, lacking the New and Update buttons.</span></span> <span data-ttu-id="456fe-137">No entanto, FormView s marcação declarativa, inclui um supérfluo `EditItemTemplate` e `InsertItemTemplate`, que pode ser removido.</span><span class="sxs-lookup"><span data-stu-id="456fe-137">The FormView s declarative markup, however, includes a superfluous `EditItemTemplate` and `InsertItemTemplate`, which can be removed.</span></span> <span data-ttu-id="456fe-138">Dedique uns momentos para personalizar o `ItemTemplate` é assim que mostra os campos de dados de apenas um subconjunto do produto.</span><span class="sxs-lookup"><span data-stu-id="456fe-138">Take a moment to customize the `ItemTemplate` so that is shows only a subset of the product data fields.</span></span> <span data-ttu-id="456fe-139">Eu ve configurado meu para mostrar o nome do produto s em um `<h3>` título acima seus nomes de categoria e fornecedor (juntamente com o botão Excluir).</span><span class="sxs-lookup"><span data-stu-id="456fe-139">I ve configured mine to show the product s name in an `<h3>` heading above its supplier and category names (along with the Delete button).</span></span>


[!code-aspx[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample2.aspx)]

<span data-ttu-id="456fe-140">Com essas alterações, temos uma página da web totalmente funcional que permite que um usuário alternar entre os produtos de uma vez, com a capacidade de excluir um produto, simplesmente clicando no botão Excluir.</span><span class="sxs-lookup"><span data-stu-id="456fe-140">With these changes, we have a fully functional web page that allows a user to toggle through the products one at a time, with the ability to delete a product by simply clicking the Delete button.</span></span> <span data-ttu-id="456fe-141">Figura 2 mostra uma captura de tela de nosso progresso até o momento quando visualizado por meio de um navegador.</span><span class="sxs-lookup"><span data-stu-id="456fe-141">Figure 2 shows a screen shot of our progress thus far when viewed through a browser.</span></span>


<span data-ttu-id="456fe-142">[![FormView mostra informações sobre um único produto](adding-client-side-confirmation-when-deleting-vb/_static/image3.png)](adding-client-side-confirmation-when-deleting-vb/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="456fe-142">[![The FormView Shows Information About a Single Product](adding-client-side-confirmation-when-deleting-vb/_static/image3.png)](adding-client-side-confirmation-when-deleting-vb/_static/image2.png)</span></span>

<span data-ttu-id="456fe-143">**Figura 2**: O FormView mostra informações sobre um único produto ([clique para exibir a imagem em tamanho normal](adding-client-side-confirmation-when-deleting-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="456fe-143">**Figure 2**: The FormView Shows Information About a Single Product ([Click to view full-size image](adding-client-side-confirmation-when-deleting-vb/_static/image4.png))</span></span>


## <a name="step-2-calling-the-confirmstring-function-from-the-delete-buttons-client-side-onclick-event"></a><span data-ttu-id="456fe-144">Etapa 2: Chamando a função confirm(string) da excluir botões onclick de cliente eventos</span><span class="sxs-lookup"><span data-stu-id="456fe-144">Step 2: Calling the confirm(string) Function from the Delete Buttons Client-Side onclick Event</span></span>

<span data-ttu-id="456fe-145">FormView criado, a etapa final é configurar o botão excluir tais que, quando ele s clicado pelo visitante, o JavaScript `confirm(string)` função é invocada.</span><span class="sxs-lookup"><span data-stu-id="456fe-145">With the FormView created, the final step is to configure the Delete button such that when it s clicked by the visitor, the JavaScript `confirm(string)` function is invoked.</span></span> <span data-ttu-id="456fe-146">Adicionar script do lado do cliente a um botão, LinkButton ou ImageButton s lado do cliente `onclick` evento pode ser feito por meio do uso do `OnClientClick property`, que é nova para o ASP.NET 2.0.</span><span class="sxs-lookup"><span data-stu-id="456fe-146">Adding client-side script to a Button, LinkButton, or ImageButton s client-side `onclick` event can be accomplished through the use of the `OnClientClick property`, which is new to ASP.NET 2.0.</span></span> <span data-ttu-id="456fe-147">Como queremos ter o valor da `confirm(string)` simplesmente retornado da função, defina essa propriedade como: `return confirm('Are you certain that you want to delete this product?');`</span><span class="sxs-lookup"><span data-stu-id="456fe-147">Since we want to have the value of the `confirm(string)` function returned, simply set this property to: `return confirm('Are you certain that you want to delete this product?');`</span></span>

<span data-ttu-id="456fe-148">Após essa alteração a sintaxe declarativa do LinkButton excluir s deve ser semelhante:</span><span class="sxs-lookup"><span data-stu-id="456fe-148">After this change the Delete LinkButton s declarative syntax should look something like:</span></span>


[!code-aspx[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample3.aspx)]

<span data-ttu-id="456fe-149">Tudo que s é a ele!</span><span class="sxs-lookup"><span data-stu-id="456fe-149">That s all there is to it!</span></span> <span data-ttu-id="456fe-150">Figura 3 mostra uma captura de tela dessa confirmação em ação.</span><span class="sxs-lookup"><span data-stu-id="456fe-150">Figure 3 shows a screen shot of this confirmation in action.</span></span> <span data-ttu-id="456fe-151">Clicando no botão Excluir abre a caixa de diálogo Confirmar.</span><span class="sxs-lookup"><span data-stu-id="456fe-151">Clicking the Delete button brings up the confirm dialog box.</span></span> <span data-ttu-id="456fe-152">Se o usuário clicar em Cancelar, o postback será cancelado e o produto não é excluído.</span><span class="sxs-lookup"><span data-stu-id="456fe-152">If the user clicks Cancel, the postback is cancelled and the product is not deleted.</span></span> <span data-ttu-id="456fe-153">Se, no entanto, o usuário clica Okey, o postback continua e o s ObjectDataSource `Delete()` método é invocado, culminando no registro de banco de dados que está sendo excluído.</span><span class="sxs-lookup"><span data-stu-id="456fe-153">If, however, the user clicks OK, the postback continues and the ObjectDataSource s `Delete()` method is invoked, culminating in the database record being deleted.</span></span>

> [!NOTE]
> <span data-ttu-id="456fe-154">A cadeia de caracteres passada para o `confirm(string)` função JavaScript é delimitada com apóstrofos (em vez de aspas).</span><span class="sxs-lookup"><span data-stu-id="456fe-154">The string passed into the `confirm(string)` JavaScript function is delimited with apostrophes (rather than quotation marks).</span></span> <span data-ttu-id="456fe-155">No JavaScript, cadeias de caracteres podem ser delimitadas usando qualquer um dos caracteres.</span><span class="sxs-lookup"><span data-stu-id="456fe-155">In JavaScript, strings can be delimited using either character.</span></span> <span data-ttu-id="456fe-156">Usamos apóstrofos aqui para que os delimitadores para a cadeia de caracteres passada para `confirm(string)` não introduzem ambiguidade com os delimitadores usados para o `OnClientClick` valor da propriedade.</span><span class="sxs-lookup"><span data-stu-id="456fe-156">We use apostrophes here so that the delimiters for the string passed into `confirm(string)` do not introduce an ambiguity with the delimiters used for the `OnClientClick` property value.</span></span>


<span data-ttu-id="456fe-157">[![Uma confirmação é agora exibido ao clicar no botão Excluir](adding-client-side-confirmation-when-deleting-vb/_static/image6.png)](adding-client-side-confirmation-when-deleting-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="456fe-157">[![A Confirmation is Now Displayed When Clicking the Delete Button](adding-client-side-confirmation-when-deleting-vb/_static/image6.png)](adding-client-side-confirmation-when-deleting-vb/_static/image5.png)</span></span>

<span data-ttu-id="456fe-158">**Figura 3**: A confirmação é agora exibido ao clicar no botão Excluir ([clique para exibir a imagem em tamanho normal](adding-client-side-confirmation-when-deleting-vb/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="456fe-158">**Figure 3**: A Confirmation is Now Displayed When Clicking the Delete Button ([Click to view full-size image](adding-client-side-confirmation-when-deleting-vb/_static/image7.png))</span></span>


## <a name="step-3-configuring-the-onclientclick-property-for-the-delete-button-in-a-commandfield"></a><span data-ttu-id="456fe-159">Etapa 3: Configurando a propriedade OnClientClick do botão Delete em um CommandField</span><span class="sxs-lookup"><span data-stu-id="456fe-159">Step 3: Configuring the OnClientClick Property for the Delete Button in a CommandField</span></span>

<span data-ttu-id="456fe-160">Ao trabalhar com um botão, LinkButton ou ImageButton diretamente em um modelo, uma caixa de diálogo de confirmação pode ser associada a ele simplesmente configurando seus `OnClientClick` propriedade para retornar os resultados do JavaScript `confirm(string)` função.</span><span class="sxs-lookup"><span data-stu-id="456fe-160">When working with a Button, LinkButton, or ImageButton directly in a template, a confirmation dialog box can be associated with it by simply configuring its `OnClientClick` property to return the results of the JavaScript `confirm(string)` function.</span></span> <span data-ttu-id="456fe-161">No entanto, o CommandField - que adiciona um campo de botões de exclusão a um GridView ou DetailsView - não tem um `OnClientClick` propriedade que pode ser definida declarativamente.</span><span class="sxs-lookup"><span data-stu-id="456fe-161">However, the CommandField - which adds a field of Delete buttons to a GridView or DetailsView - does not have an `OnClientClick` property that can be set declaratively.</span></span> <span data-ttu-id="456fe-162">Em vez disso, podemos deve referenciar programaticamente no botão Excluir em s GridView ou DetailsView apropriado `DataBound` manipulador de eventos e defina seu `OnClientClick` propriedade existe.</span><span class="sxs-lookup"><span data-stu-id="456fe-162">Instead, we must programmatically reference the Delete button in the GridView or DetailsView s appropriate `DataBound` event handler, and then set its `OnClientClick` property there.</span></span>

> [!NOTE]
> <span data-ttu-id="456fe-163">Ao definir o botão excluir s `OnClientClick` propriedade no respectivo `DataBound` manipulador de eventos, temos acesso a dados foi associados ao registro atual.</span><span class="sxs-lookup"><span data-stu-id="456fe-163">When setting the Delete button s `OnClientClick` property in the appropriate `DataBound` event handler, we have access to the data was bound to the current record.</span></span> <span data-ttu-id="456fe-164">Isso significa que podemos estender a mensagem de confirmação para incluir detalhes sobre o registro específico, como "Tem certeza de que deseja excluir o produto Chai?"</span><span class="sxs-lookup"><span data-stu-id="456fe-164">This means we can extend the confirmation message to include details about the particular record, such as, "Are you sure you want to delete the Chai product?"</span></span> <span data-ttu-id="456fe-165">Tal personalização também é possível em modelos usando a sintaxe de associação de dados.</span><span class="sxs-lookup"><span data-stu-id="456fe-165">Such customization is also possible in templates using databinding syntax.</span></span>


<span data-ttu-id="456fe-166">A configuração de prática de `OnClientClick` propriedade para a exclusão correspondentes em um CommandField, s permitem que adicione um controle GridView à página.</span><span class="sxs-lookup"><span data-stu-id="456fe-166">To practice setting the `OnClientClick` property for the Delete button(s) in a CommandField, let s add a GridView to the page.</span></span> <span data-ttu-id="456fe-167">Configure este GridView para usar o controle ObjectDataSource mesmo que usa o FormView.</span><span class="sxs-lookup"><span data-stu-id="456fe-167">Configure this GridView to use the same ObjectDataSource control that the FormView uses.</span></span> <span data-ttu-id="456fe-168">Também limite o s GridView BoundFields para incluir apenas o nome do produto s, categoria e fornecedor.</span><span class="sxs-lookup"><span data-stu-id="456fe-168">Also limit the GridView s BoundFields to only include the product s name, category, and supplier.</span></span> <span data-ttu-id="456fe-169">Por fim, marque a caixa de seleção Habilitar exclusão da marca inteligente s GridView.</span><span class="sxs-lookup"><span data-stu-id="456fe-169">Lastly, check the Enable Deleting checkbox from the GridView s smart tag.</span></span> <span data-ttu-id="456fe-170">Isso adicionará um CommandField s o GridView `Columns` coleção com seus `ShowDeleteButton` propriedade definida como `true`.</span><span class="sxs-lookup"><span data-stu-id="456fe-170">This will add a CommandField to the GridView s `Columns` collection with its `ShowDeleteButton` property set to `true`.</span></span>

<span data-ttu-id="456fe-171">Depois de fazer essas alterações, sua marcação declarativa do GridView s deve ser semelhante ao seguinte:</span><span class="sxs-lookup"><span data-stu-id="456fe-171">After making these changes, your GridView s declarative markup should look like the following:</span></span>


[!code-aspx[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample4.aspx)]

<span data-ttu-id="456fe-172">O CommandField contém uma única instância de excluir LinkButton que pode ser acessada por meio de programação de s GridView `RowDataBound` manipulador de eventos.</span><span class="sxs-lookup"><span data-stu-id="456fe-172">The CommandField contains a single Delete LinkButton instance that can be accessed programmatically from the GridView s `RowDataBound` event handler.</span></span> <span data-ttu-id="456fe-173">Quando referenciado, podemos definir seu `OnClientClick` propriedade adequadamente.</span><span class="sxs-lookup"><span data-stu-id="456fe-173">Once referenced, we can set its `OnClientClick` property accordingly.</span></span> <span data-ttu-id="456fe-174">Crie um manipulador de eventos para o `RowDataBound` eventos usando o seguinte código:</span><span class="sxs-lookup"><span data-stu-id="456fe-174">Create an event handler for the `RowDataBound` event using the following code:</span></span>


[!code-vb[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample5.vb)]

<span data-ttu-id="456fe-175">Esse manipulador de eventos funciona com linhas de dados (aquelas que terá o botão de exclusão) e começa fazendo referência programaticamente no botão Excluir.</span><span class="sxs-lookup"><span data-stu-id="456fe-175">This event handler works with data rows (those that will have the Delete button) and begins by programmatically referencing the Delete button.</span></span> <span data-ttu-id="456fe-176">Em geral, use o seguinte padrão:</span><span class="sxs-lookup"><span data-stu-id="456fe-176">In general use the following pattern:</span></span>


[!code-vb[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample6.vb)]

<span data-ttu-id="456fe-177">*ButtonType* é o tipo de botão que está sendo usado por CommandField - Button, LinkButton ou ImageButton.</span><span class="sxs-lookup"><span data-stu-id="456fe-177">*ButtonType* is the type of button being used by the CommandField - Button, LinkButton, or ImageButton.</span></span> <span data-ttu-id="456fe-178">Por padrão, o CommandField usa LinkButtons, mas isso pode ser personalizado por meio de s CommandField `ButtonType property`.</span><span class="sxs-lookup"><span data-stu-id="456fe-178">By default, the CommandField uses LinkButtons, but this can be customized via the CommandField s `ButtonType property`.</span></span> <span data-ttu-id="456fe-179">O *commandFieldIndex* é o índice ordinal do CommandField dentro de s GridView `Columns` coleção, enquanto o *controlIndex* é o índice do botão Delete dentro de s CommandField `Controls` coleção.</span><span class="sxs-lookup"><span data-stu-id="456fe-179">The *commandFieldIndex* is the ordinal index of the CommandField within the GridView s `Columns` collection, whereas the *controlIndex* is the index of the Delete button within the CommandField s `Controls` collection.</span></span> <span data-ttu-id="456fe-180">O *controlIndex* valor depende da posição do botão s em relação a outros botões no CommandField.</span><span class="sxs-lookup"><span data-stu-id="456fe-180">The *controlIndex* value depends on the button s position relative to other buttons in the CommandField.</span></span> <span data-ttu-id="456fe-181">Por exemplo, se o único botão exibido no CommandField for o botão de exclusão, use um índice de 0.</span><span class="sxs-lookup"><span data-stu-id="456fe-181">For example, if the only button displayed in the CommandField is the Delete button, use an index of 0.</span></span> <span data-ttu-id="456fe-182">Se, no entanto, há s um botão Editar que precede o botão Excluir, use um índice de 2.</span><span class="sxs-lookup"><span data-stu-id="456fe-182">If, however, there s an Edit button that precedes the Delete button, use an index of 2.</span></span> <span data-ttu-id="456fe-183">O motivo pelo qual um índice de 2 é usado é porque os dois controles são adicionados pelo CommandField antes do botão de exclusão: o botão de edição e uma LiteralControl que s usada para adicionar algum espaço entre os botões Editar e excluir.</span><span class="sxs-lookup"><span data-stu-id="456fe-183">The reason an index of 2 is used is because two controls are added by the CommandField before the Delete button: the Edit button and a LiteralControl that s used to add some space between the Edit and Delete buttons.</span></span>

<span data-ttu-id="456fe-184">Para nosso exemplo específico, o CommandField usa LinkButtons e, sendo o campo mais à esquerda, tem um *commandFieldIndex* igual a 0.</span><span class="sxs-lookup"><span data-stu-id="456fe-184">For our particular example, the CommandField uses LinkButtons and, being the left-most field, has a *commandFieldIndex* of 0.</span></span> <span data-ttu-id="456fe-185">Como não há nenhum outro botão, mas o botão Excluir no CommandField, usamos uma *controlIndex* igual a 0.</span><span class="sxs-lookup"><span data-stu-id="456fe-185">Since there are no other buttons but the Delete button in the CommandField, we use a *controlIndex* of 0.</span></span>

<span data-ttu-id="456fe-186">Depois de referenciar o botão Excluir no CommandField, em seguida capturamos informações sobre o produto associado à linha atual do GridView.</span><span class="sxs-lookup"><span data-stu-id="456fe-186">After referencing the Delete button in the CommandField, we next grab information about the product bound to the current GridView row.</span></span> <span data-ttu-id="456fe-187">Finalmente, definimos o botão excluir s `OnClientClick` propriedade para o JavaScript apropriado, o que inclui o nome do produto s.</span><span class="sxs-lookup"><span data-stu-id="456fe-187">Finally, we set the Delete button s `OnClientClick` property to the appropriate JavaScript, which includes the product s name.</span></span> <span data-ttu-id="456fe-188">Uma vez que a cadeia de caracteres de JavaScript é passado para o `confirm(string)` função é delimitada usando apóstrofos, precisa fazer o escape de todos os apóstrofos que aparecem dentro do nome do produto s.</span><span class="sxs-lookup"><span data-stu-id="456fe-188">Since the JavaScript string passed into the `confirm(string)` function is delimited using apostrophes we must escape any apostrophes that appear within the product s name.</span></span> <span data-ttu-id="456fe-189">Em particular, todos os apóstrofos no nome do produto s serão ignorados com "`\'`".</span><span class="sxs-lookup"><span data-stu-id="456fe-189">In particular, any apostrophes in the product s name are escaped with "`\'`".</span></span>

<span data-ttu-id="456fe-190">Com essas alterações completas, clicando em um botão Excluir no GridView mostre uma caixa de diálogo de confirmação personalizado caixa (veja a Figura 4).</span><span class="sxs-lookup"><span data-stu-id="456fe-190">With these changes complete, clicking on a Delete button in the GridView displays a customized confirmation dialog box (see Figure 4).</span></span> <span data-ttu-id="456fe-191">Como com messagebox confirmação de FormView, se o usuário clicar em Cancelar o postback é cancelado, impedindo assim a exclusão ocorra.</span><span class="sxs-lookup"><span data-stu-id="456fe-191">As with the confirmation messagebox from the FormView, if the user clicks Cancel the postback is cancelled, thereby preventing the deletion from occurring.</span></span>

> [!NOTE]
> <span data-ttu-id="456fe-192">Essa técnica também pode ser usada para acessar programaticamente o botão Excluir no CommandField em um DetailsView.</span><span class="sxs-lookup"><span data-stu-id="456fe-192">This technique can also be used to programmatically access the Delete button in the CommandField in a DetailsView.</span></span> <span data-ttu-id="456fe-193">Para DetailsView, no entanto, você d cria um manipulador de eventos para o `DataBound` evento, como DetailsView não tem um `RowDataBound` eventos.</span><span class="sxs-lookup"><span data-stu-id="456fe-193">For the DetailsView, however, you d create an event handler for the `DataBound` event, since the DetailsView does not have a `RowDataBound` event.</span></span>


<span data-ttu-id="456fe-194">[![Clicar no botão de exclusão de s GridView exibe uma caixa de diálogo de confirmação personalizado](adding-client-side-confirmation-when-deleting-vb/_static/image9.png)](adding-client-side-confirmation-when-deleting-vb/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="456fe-194">[![Clicking the GridView s Delete Button Displays a Customized Confirmation Dialog Box](adding-client-side-confirmation-when-deleting-vb/_static/image9.png)](adding-client-side-confirmation-when-deleting-vb/_static/image8.png)</span></span>

<span data-ttu-id="456fe-195">**Figura 4**: clicar o botão de exclusão do s GridView exibe uma caixa de diálogo de confirmação personalizado ([clique para exibir a imagem em tamanho normal](adding-client-side-confirmation-when-deleting-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="456fe-195">**Figure 4**: Clicking the GridView s Delete Button Displays a Customized Confirmation Dialog Box ([Click to view full-size image](adding-client-side-confirmation-when-deleting-vb/_static/image10.png))</span></span>


## <a name="using-templatefields"></a><span data-ttu-id="456fe-196">Usando TemplateFields</span><span class="sxs-lookup"><span data-stu-id="456fe-196">Using TemplateFields</span></span>

<span data-ttu-id="456fe-197">Uma das desvantagens do CommandField é que seus botões devem ser acessados por meio de indexação e que o objeto resultante deve ser convertido para o tipo de botão apropriado (Button, LinkButton ou ImageButton).</span><span class="sxs-lookup"><span data-stu-id="456fe-197">One of the disadvantages of the CommandField is that its buttons must be accessed through indexing and that the resulting object must be cast to the appropriate button type (Button, LinkButton, or ImageButton).</span></span> <span data-ttu-id="456fe-198">Usando tipos de embutido em código e "números mágicos" convida problemas que não podem ser descobertos até o tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="456fe-198">Using "magic numbers" and hard-coded types invites problems that cannot be discovered until runtime.</span></span> <span data-ttu-id="456fe-199">Por exemplo, se você ou outro desenvolvedor, adiciona novos botões a CommandField em algum momento no futuro (como um botão Editar) ou alterações a `ButtonType` propriedade, o código existente ainda será compilado sem erros, mas visitando a página pode causar uma exceção ou comportamento inesperado, dependendo de como seu código foi escrito e quais alterações foram feitas.</span><span class="sxs-lookup"><span data-stu-id="456fe-199">For example, if you, or another developer, adds new buttons to the CommandField at some point in the future (such as an Edit button) or changes the `ButtonType` property, the existing code will still compile without error, but visiting the page may cause an exception or unexpected behavior, depending on how your code was written and what changes were made.</span></span>

<span data-ttu-id="456fe-200">Uma abordagem alternativa é converter o GridView e DetailsView s CommandFields em TemplateFields.</span><span class="sxs-lookup"><span data-stu-id="456fe-200">An alternative approach is to convert the GridView and DetailsView s CommandFields into TemplateFields.</span></span> <span data-ttu-id="456fe-201">Isso irá gerar um TemplateField com um `ItemTemplate` que tem um LinkButton (ou botão ou ImageButton) para cada botão no CommandField.</span><span class="sxs-lookup"><span data-stu-id="456fe-201">This will generate a TemplateField with an `ItemTemplate` that has a LinkButton (or Button or ImageButton) for each button in the CommandField.</span></span> <span data-ttu-id="456fe-202">Esses botões `OnClientClick` propriedades podem ser atribuídas de forma declarativa, conforme é visto com FormView ou podem ser acessados por meio de programação no respectivo `DataBound` manipulador de eventos usando o seguinte padrão:</span><span class="sxs-lookup"><span data-stu-id="456fe-202">These buttons `OnClientClick` properties can be assigned declaratively, as we saw with the FormView, or can be programmatically accessed in the appropriate `DataBound` event handler using the following pattern:</span></span>


[!code-vb[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample7.vb)]

<span data-ttu-id="456fe-203">Em que *controlID* é o valor do botão s `ID` propriedade.</span><span class="sxs-lookup"><span data-stu-id="456fe-203">Where *controlID* is the value of the button s `ID` property.</span></span> <span data-ttu-id="456fe-204">Embora esse padrão ainda requer um tipo embutido em código para a conversão, ele elimina a necessidade de indexação, permitindo o layout alterar sem provocar um erro de tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="456fe-204">While this pattern still requires a hard-coded type for the cast, it removes the need for indexing, allowing for the layout to change without resulting in a runtime error.</span></span>

## <a name="summary"></a><span data-ttu-id="456fe-205">Resumo</span><span class="sxs-lookup"><span data-stu-id="456fe-205">Summary</span></span>

<span data-ttu-id="456fe-206">O JavaScript `confirm(string)` função é uma técnica normalmente usada para controlar fluxo de trabalho de envio de formulário.</span><span class="sxs-lookup"><span data-stu-id="456fe-206">The JavaScript `confirm(string)` function is a commonly used technique for controlling form submission workflow.</span></span> <span data-ttu-id="456fe-207">Quando executada, a função exibe uma caixa de diálogo modal, no lado do cliente que inclui dois botões, Okey e Cancelar.</span><span class="sxs-lookup"><span data-stu-id="456fe-207">When executed, the function displays a modal, client-side dialog box that includes two buttons, OK and Cancel.</span></span> <span data-ttu-id="456fe-208">Se o usuário clica em Okey, o `confirm(string)` retornos de função `true`; clique em Cancel retorna `false`.</span><span class="sxs-lookup"><span data-stu-id="456fe-208">If the user clicks OK, the `confirm(string)` function returns `true`; clicking Cancel returns `false`.</span></span> <span data-ttu-id="456fe-209">Essa funcionalidade, juntamente com um comportamento do navegador s para cancelar o envio de um formulário se retorna um manipulador de eventos durante o processo de envio `false`, pode ser usado para exibir uma caixa de mensagem de confirmação ao excluir um registro.</span><span class="sxs-lookup"><span data-stu-id="456fe-209">This functionality, coupled with a browser s behavior to cancel a form submission if an event handler during the submission process returns `false`, can be used to display a confirmation messagebox when deleting a record.</span></span>

<span data-ttu-id="456fe-210">O `confirm(string)` função pode ser associada um cliente da Web de botão controle s lado `onclick` manipulador de eventos por meio do controle s `OnClientClick` propriedade.</span><span class="sxs-lookup"><span data-stu-id="456fe-210">The `confirm(string)` function can be associated with a Button Web control s client-side `onclick` event handler through the control s `OnClientClick` property.</span></span> <span data-ttu-id="456fe-211">Ao trabalhar com um botão Excluir em um modelo: em um dos modelos FormView s ou em um TemplateField no DetailsView ou GridView - essa propriedade pode ser definida ou declarativamente por meio de programação, como vimos neste tutorial.</span><span class="sxs-lookup"><span data-stu-id="456fe-211">When working with a Delete button in a template - either in one of the FormView s templates or in a TemplateField in the DetailsView or GridView - this property can be set either declaratively or programmatically, as we saw in this tutorial.</span></span>

<span data-ttu-id="456fe-212">Boa programação!</span><span class="sxs-lookup"><span data-stu-id="456fe-212">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="456fe-213">Sobre o autor</span><span class="sxs-lookup"><span data-stu-id="456fe-213">About the Author</span></span>

<span data-ttu-id="456fe-214">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de sete livros sobre ASP/ASP.NET e fundador da [4GuysFromRolla.com](http://www.4guysfromrolla.com), tem trabalhado com tecnologias Microsoft Web desde 1998.</span><span class="sxs-lookup"><span data-stu-id="456fe-214">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="456fe-215">Scott funciona como um consultor independente, instrutor e escritor.</span><span class="sxs-lookup"><span data-stu-id="456fe-215">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="456fe-216">Seu livro mais recente é [ *Sams Teach por conta própria ASP.NET 2.0 em 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="456fe-216">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="456fe-217">Ele pode ser contatado pelo [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="456fe-217">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="456fe-218">ou por meio de seu blog, que pode ser encontrado em [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="456fe-218">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="456fe-219">[Anterior](implementing-optimistic-concurrency-vb.md)
> [Próximo](limiting-data-modification-functionality-based-on-the-user-vb.md)</span><span class="sxs-lookup"><span data-stu-id="456fe-219">[Previous](implementing-optimistic-concurrency-vb.md)
[Next](limiting-data-modification-functionality-based-on-the-user-vb.md)</span></span>

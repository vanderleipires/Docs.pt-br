---
uid: web-forms/overview/data-access/filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs
title: Mestre/detalhes usando uma lista com marcadores de registros mestre com um DataList de detalhes (c#) | Microsoft Docs
author: rick-anderson
description: Neste tutorial serão compactados o relatório de duas páginas mestre/detalhes do tutorial anterior em uma única página, mostrando uma lista com marcadores de nomes de categoria em t...
ms.author: aspnetcontent
ms.date: 10/17/2006
ms.assetid: c727bb73-7b59-41a1-8dc3-623c6d69e7c2
msc.legacyurl: /web-forms/overview/data-access/filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs
msc.type: authoredcontent
ms.openlocfilehash: 0be6a03b2fbbf71a1f1d1e13bd4b9118981d0715
ms.sourcegitcommit: b28cd0313af316c051c2ff8549865bff67f2fbb4
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 07/05/2018
ms.locfileid: "37841057"
---
<a name="masterdetail-using-a-bulleted-list-of-master-records-with-a-details-datalist-c"></a><span data-ttu-id="99d37-103">Mestre/detalhes usando uma lista com marcadores de registros mestre com um DataList de detalhes (c#)</span><span class="sxs-lookup"><span data-stu-id="99d37-103">Master/Detail Using a Bulleted List of Master Records with a Details DataList (C#)</span></span>
====================
<span data-ttu-id="99d37-104">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="99d37-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="99d37-105">[Baixe o aplicativo de exemplo](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_35_CS.exe) ou [baixar PDF](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/datatutorial35cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="99d37-105">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_35_CS.exe) or [Download PDF](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/datatutorial35cs1.pdf)</span></span>

> <span data-ttu-id="99d37-106">Neste tutorial serão compactados o relatório de duas páginas mestre/detalhes do tutorial anterior em uma única página, mostrando uma lista com marcadores de nomes de categoria no lado esquerdo da tela e produtos da categoria selecionada no lado direito da tela.</span><span class="sxs-lookup"><span data-stu-id="99d37-106">In this tutorial we'll compress the two-page master/detail report of the previous tutorial into a single page, showing a bulleted list of category names on the left side of the screen and the selected category's products on the right of the screen.</span></span>


## <a name="introduction"></a><span data-ttu-id="99d37-107">Introdução</span><span class="sxs-lookup"><span data-stu-id="99d37-107">Introduction</span></span>

<span data-ttu-id="99d37-108">No [tutorial anterior](master-detail-filtering-acess-two-pages-datalist-cs.md) analisamos como separar um relatório mestre/detalhes em duas páginas.</span><span class="sxs-lookup"><span data-stu-id="99d37-108">In the [preceding tutorial](master-detail-filtering-acess-two-pages-datalist-cs.md) we looked at how to separate a master/detail report across two pages.</span></span> <span data-ttu-id="99d37-109">Na página mestra, usamos um controle Repeater para renderizar uma lista com marcadores de categorias.</span><span class="sxs-lookup"><span data-stu-id="99d37-109">In the master page we used a Repeater control to render a bulleted list of categories.</span></span> <span data-ttu-id="99d37-110">Cada nome de categoria foi um hiperlink que, quando clicado, seria fazer o usuário para a página de detalhes, onde um DataList de duas colunas mostrou os produtos que pertencem à categoria selecionada.</span><span class="sxs-lookup"><span data-stu-id="99d37-110">Each category name was a hyperlink that, when clicked, would take the user to the details page, where a two-column DataList showed those products belonging to the selected category.</span></span>

<span data-ttu-id="99d37-111">Neste tutorial serão compactados o tutorial de duas páginas em uma única página, mostrando uma lista com marcadores de nomes de categoria no lado esquerdo da tela com cada nome de categoria renderizado como um LinkButton.</span><span class="sxs-lookup"><span data-stu-id="99d37-111">In this tutorial we'll compress the two-page tutorial into a single page, showing a bulleted list of category names on the left side of the screen with each category name rendered as a LinkButton.</span></span> <span data-ttu-id="99d37-112">Clicar em um dos botões de link do nome da categoria induz um postback e associa os produtos a categoria selecionada a um DataList de duas colunas à direita da tela.</span><span class="sxs-lookup"><span data-stu-id="99d37-112">Clicking one of the category name LinkButtons induces a postback and binds the selected category s products to a two-column DataList on the right of the screen.</span></span> <span data-ttu-id="99d37-113">Além de exibir cada nome de categoria s, repetidor à esquerda mostra o número total de produtos lá é para uma determinada categoria (veja a Figura 1).</span><span class="sxs-lookup"><span data-stu-id="99d37-113">In addition to displaying each category s name, the Repeater on the left shows how many total products there are for a given category (see Figure 1).</span></span>


<span data-ttu-id="99d37-114">[![A categoria s nome e o número Total de produtos são exibidos à esquerda](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image2.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="99d37-114">[![The Category s Name and Total Number of Products are Displayed on the Left](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image2.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image1.png)</span></span>

<span data-ttu-id="99d37-115">**Figura 1**: A categoria s nome e o número Total de produtos são exibidos à esquerda ([clique para exibir a imagem em tamanho normal](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="99d37-115">**Figure 1**: The Category s Name and Total Number of Products are Displayed on the Left ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image3.png))</span></span>


## <a name="step-1-displaying-a-repeater-in-the-left-portion-of-the-screen"></a><span data-ttu-id="99d37-116">Etapa 1: Exibindo um repetidor na parte esquerda da tela</span><span class="sxs-lookup"><span data-stu-id="99d37-116">Step 1: Displaying a Repeater in the Left Portion of the Screen</span></span>

<span data-ttu-id="99d37-117">Para este tutorial, é necessário ter a lista com marcadores de categorias aparecem à esquerda dos produtos s categoria selecionada.</span><span class="sxs-lookup"><span data-stu-id="99d37-117">For this tutorial we need to have the bulleted list of categories appear to the left of the selected category s products.</span></span> <span data-ttu-id="99d37-118">Conteúdo dentro de uma página da web pode ser posicionado usando marcas HTML padrão elementos parágrafo, espaços não separáveis, `<table>` s e assim por diante ou por meio de técnicas de (CSS) de folha de estilos em cascata.</span><span class="sxs-lookup"><span data-stu-id="99d37-118">Content within a web page can be positioned using standard HTML elements paragraph tags, non-breaking spaces, `<table>` s, and so on or through cascading stylesheet (CSS) techniques.</span></span> <span data-ttu-id="99d37-119">Todos os nossos tutoriais até o momento usaram técnicas CSS para posicionamento.</span><span class="sxs-lookup"><span data-stu-id="99d37-119">All of our tutorials thus far have used CSS techniques for positioning.</span></span> <span data-ttu-id="99d37-120">Quando criamos a interface do usuário de navegação em nossa página mestre na [páginas mestras e navegação no Site](../introduction/master-pages-and-site-navigation-cs.md) tutorial, usamos *posicionamento absoluto*, indicando o deslocamento de pixel precisos para a navegação lista e o conteúdo principal.</span><span class="sxs-lookup"><span data-stu-id="99d37-120">When we built the navigation user interface in our master page in the [Master Pages and Site Navigation](../introduction/master-pages-and-site-navigation-cs.md) tutorial we used *absolute positioning*, indicating the precise pixel offset for the navigation list and the main content.</span></span> <span data-ttu-id="99d37-121">Como alternativa, o CSS pode ser usado para posicionar um elemento para a direita ou esquerda do outro por meio *flutuante*.</span><span class="sxs-lookup"><span data-stu-id="99d37-121">Alternatively, CSS can be used to position one element to the right or left of another through *floating*.</span></span> <span data-ttu-id="99d37-122">Podemos ter a lista com marcadores de categorias aparecem à esquerda dos produtos s categoria selecionada pelo flutuante repetidor para a esquerda do DataList</span><span class="sxs-lookup"><span data-stu-id="99d37-122">We can have the bulleted list of categories appear to the left of the selected category s products by floating the Repeater to the left of the DataList</span></span>

<span data-ttu-id="99d37-123">Abra o `CategoriesAndProducts.aspx` página do `DataListRepeaterFiltering` pasta e adicionar à página um Repeater e DataList.</span><span class="sxs-lookup"><span data-stu-id="99d37-123">Open the `CategoriesAndProducts.aspx` page from the `DataListRepeaterFiltering` folder and add to the page a Repeater and a DataList.</span></span> <span data-ttu-id="99d37-124">Defina o Repeater s `ID` à `Categories` e DataList s para `CategoryProducts`.</span><span class="sxs-lookup"><span data-stu-id="99d37-124">Set the Repeater s `ID` to `Categories` and the DataList s to `CategoryProducts`.</span></span> <span data-ttu-id="99d37-125">Vá para a exibição de fonte e os controles Repeater e DataList dentro de suas próprias `<div>` elementos.</span><span class="sxs-lookup"><span data-stu-id="99d37-125">Go to the Source view and put the Repeater and DataList controls within their own `<div>` elements.</span></span> <span data-ttu-id="99d37-126">Ou seja, coloque o Repeater dentro de um `<div>` elemento primeiro e, em seguida, DataList em seu próprio `<div>` elemento diretamente após o Repeater.</span><span class="sxs-lookup"><span data-stu-id="99d37-126">That is, enclose the Repeater within a `<div>` element first and then the DataList in its own `<div>` element directly after the Repeater.</span></span> <span data-ttu-id="99d37-127">Sua marcação neste ponto deve ser semelhante ao seguinte:</span><span class="sxs-lookup"><span data-stu-id="99d37-127">Your markup at this point should look similar to the following:</span></span>


[!code-aspx[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/samples/sample1.aspx)]

<span data-ttu-id="99d37-128">Para desencaixar o Repeater à esquerda do DataList, precisamos usar o `float` atributo de estilo CSS, da seguinte forma:</span><span class="sxs-lookup"><span data-stu-id="99d37-128">To float the Repeater to the left of the DataList, we need to use the `float` CSS style attribute, like so:</span></span>


[!code-html[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/samples/sample2.html)]

<span data-ttu-id="99d37-129">O `float: left;` flutua primeiro `<div>` elemento à esquerda de um segundo.</span><span class="sxs-lookup"><span data-stu-id="99d37-129">The `float: left;` floats the first `<div>` element to the left of the second one.</span></span> <span data-ttu-id="99d37-130">O `width` e `padding-right` configurações indicam a primeira `<div>` s `width` e a quantidade de preenchimento é adicionado entre o `<div>` conteúdo do elemento s e a margem direita.</span><span class="sxs-lookup"><span data-stu-id="99d37-130">The `width` and `padding-right` settings indicate the first `<div>` s `width` and how much padding is added between the `<div>` element s content and its right margin.</span></span> <span data-ttu-id="99d37-131">Para obter mais informações sobre flutuante elementos no CSS Confira as [Floatutorial](http://css.maxdesign.com.au/floatutorial/).</span><span class="sxs-lookup"><span data-stu-id="99d37-131">For more information on floating elements in CSS check out the [Floatutorial](http://css.maxdesign.com.au/floatutorial/).</span></span>

<span data-ttu-id="99d37-132">Em vez de especificar a configuração de estilo diretamente por meio do primeiro `<p>` elemento s `style` atributo, permitem que o s em vez disso, crie uma nova classe CSS no `Styles.css` denominada `FloatLeft`:</span><span class="sxs-lookup"><span data-stu-id="99d37-132">Rather than specify the style setting directly through the first `<p>` element s `style` attribute, let s instead create a new CSS class in `Styles.css` named `FloatLeft`:</span></span>


[!code-css[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/samples/sample3.css)]

<span data-ttu-id="99d37-133">Em seguida, substituímos o `<div>` com `<div class="FloatLeft">`.</span><span class="sxs-lookup"><span data-stu-id="99d37-133">Then we can replace the `<div>` with `<div class="FloatLeft">`.</span></span>

<span data-ttu-id="99d37-134">Depois de adicionar a classe CSS e configurando a marcação no `CategoriesAndProducts.aspx` página, vá para o Designer.</span><span class="sxs-lookup"><span data-stu-id="99d37-134">After adding the CSS class and configuring the markup in the `CategoriesAndProducts.aspx` page, go to the Designer.</span></span> <span data-ttu-id="99d37-135">Você deve ver o Repeater flutuante à esquerda do DataList (embora direita agora ambos são exibidos como caixas cinzas desde que criamos ve ainda para configurar suas fontes de dados ou modelos).</span><span class="sxs-lookup"><span data-stu-id="99d37-135">You should see the Repeater floating to the left of the DataList (although right now both just appear as gray boxes since we ve yet to configure their data sources or templates).</span></span>


<span data-ttu-id="99d37-136">[![O Repeater é flutuante à esquerda do DataList](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image5.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="99d37-136">[![The Repeater is Floated to the Left of the DataList](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image5.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image4.png)</span></span>

<span data-ttu-id="99d37-137">**Figura 2**: O Repeater é flutuante à esquerda do DataList ([clique para exibir a imagem em tamanho normal](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="99d37-137">**Figure 2**: The Repeater is Floated to the Left of the DataList ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image6.png))</span></span>


## <a name="step-2-determining-the-number-of-products-for-each-category"></a><span data-ttu-id="99d37-138">Etapa 2: Determinando o número de produtos para cada categoria</span><span class="sxs-lookup"><span data-stu-id="99d37-138">Step 2: Determining the Number of Products for Each Category</span></span>

<span data-ttu-id="99d37-139">Com o s Repeater e DataList que cercam a marcação completa, está pronto para associar os dados da categoria a repetidor controlamos.</span><span class="sxs-lookup"><span data-stu-id="99d37-139">With the Repeater and DataList s surrounding markup complete, we re ready to bind the category data to the Repeater control.</span></span> <span data-ttu-id="99d37-140">No entanto, como mostra a lista com marcadores de categorias na Figura 1, além de cada nome de categoria s também é necessário exibir o número de produtos associados à categoria.</span><span class="sxs-lookup"><span data-stu-id="99d37-140">However, as the bulleted list of categories in Figure 1 shows, in addition to each category s name we also need to display the number of products associated with the category.</span></span> <span data-ttu-id="99d37-141">Para acessar essas informações é possível:</span><span class="sxs-lookup"><span data-stu-id="99d37-141">To access this information we can either:</span></span>

- <span data-ttu-id="99d37-142">**Determine essas informações de classe de code-behind da página s ASP.NET.**</span><span class="sxs-lookup"><span data-stu-id="99d37-142">**Determine this information from the ASP.NET page s code-behind class.**</span></span> <span data-ttu-id="99d37-143">Dada uma determinada *`categoryID`* podemos determinar o número de produtos associados ao chamar o `ProductsBLL` classe s `GetProductsByCategoryID(categoryID)` método.</span><span class="sxs-lookup"><span data-stu-id="99d37-143">Given a particular *`categoryID`* we can determine the number of associated products by calling the `ProductsBLL` class s `GetProductsByCategoryID(categoryID)` method.</span></span> <span data-ttu-id="99d37-144">Esse método retorna um `ProductsDataTable` do objeto cuja `Count` propriedade indica quantos `ProductsRow` s existir, o que é o número de produtos para especificado *`categoryID`*.</span><span class="sxs-lookup"><span data-stu-id="99d37-144">This method returns a `ProductsDataTable` object whose `Count` property indicates how many `ProductsRow` s exists, which is the number of products for the specified *`categoryID`*.</span></span> <span data-ttu-id="99d37-145">Podemos criar uma `ItemDataBound` manipulador de eventos para o Repeater que, para cada categoria associada a Repeater, chama o `ProductsBLL` classe s `GetProductsByCategoryID(categoryID)` método e inclui a contagem na saída.</span><span class="sxs-lookup"><span data-stu-id="99d37-145">We can create an `ItemDataBound` event handler for the Repeater that, for each category bound to the Repeater, calls the `ProductsBLL` class s `GetProductsByCategoryID(categoryID)` method and includes its count in the output.</span></span>
- <span data-ttu-id="99d37-146">**Atualizar o `CategoriesDataTable` no conjunto de dados tipado para incluir um `NumberOfProducts` coluna.**</span><span class="sxs-lookup"><span data-stu-id="99d37-146">**Update the `CategoriesDataTable` in the Typed DataSet to include a `NumberOfProducts` column.**</span></span> <span data-ttu-id="99d37-147">Em seguida, podemos atualizar o `GetCategories()` método na `CategoriesDataTable` para incluir essas informações ou, como alternativa, deixar `GetCategories()` como-está e criar um novo `CategoriesDataTable` método chamado `GetCategoriesAndNumberOfProducts()`.</span><span class="sxs-lookup"><span data-stu-id="99d37-147">We can then update the `GetCategories()` method in the `CategoriesDataTable` to include this information or, alternatively, leave `GetCategories()` as-is and create a new `CategoriesDataTable` method called `GetCategoriesAndNumberOfProducts()`.</span></span>

<span data-ttu-id="99d37-148">Deixe o s explorar ambas as técnicas.</span><span class="sxs-lookup"><span data-stu-id="99d37-148">Let s explore both of these techniques.</span></span> <span data-ttu-id="99d37-149">A primeira abordagem é mais simples de implementar já que estamos não t é necessário atualizar a camada de acesso a dados; No entanto, ele requer mais comunicações com o banco de dados.</span><span class="sxs-lookup"><span data-stu-id="99d37-149">The first approach is simpler to implement since we don t need to update the Data Access Layer; however, it requires more communications with the database.</span></span> <span data-ttu-id="99d37-150">A chamada para o `ProductsBLL` classe s `GetProductsByCategoryID(categoryID)` método o `ItemDataBound` manipulador de eventos adiciona uma chamada de banco de dados extra para cada categoria exibida no Repetidor.</span><span class="sxs-lookup"><span data-stu-id="99d37-150">The call to the `ProductsBLL` class s `GetProductsByCategoryID(categoryID)` method in the `ItemDataBound` event handler adds an extra database call for each category displayed in the Repeater.</span></span> <span data-ttu-id="99d37-151">Com essa técnica há *N* + chamadas de banco de 1 dados, onde *N* é o número de categorias exibidas no Repetidor.</span><span class="sxs-lookup"><span data-stu-id="99d37-151">With this technique there are *N* + 1 database calls, where *N* is the number of categories displayed in the Repeater.</span></span> <span data-ttu-id="99d37-152">Com a segunda abordagem, a contagem de produto é retornada com informações sobre cada categoria do `CategoriesBLL` classe s `GetCategories()` (ou `GetCategoriesAndNumberOfProducts()`) método, resultando em apenas uma viagem ao banco de dados.</span><span class="sxs-lookup"><span data-stu-id="99d37-152">With the second approach, the product count is returned with information about each category from the `CategoriesBLL` class s `GetCategories()` (or `GetCategoriesAndNumberOfProducts()`) method, thereby resulting in just one trip to the database.</span></span>

## <a name="determining-the-number-of-products-in-the-itemdatabound-event-handler"></a><span data-ttu-id="99d37-153">Determinando o número de produtos no manipulador de evento ItemDataBound</span><span class="sxs-lookup"><span data-stu-id="99d37-153">Determining the Number of Products in the ItemDataBound Event Handler</span></span>

<span data-ttu-id="99d37-154">Determinando o número de produtos para cada categoria no repetidor s `ItemDataBound` manipulador de eventos não requer quaisquer modificações em nossa camada de acesso de dados existente.</span><span class="sxs-lookup"><span data-stu-id="99d37-154">Determining the number of products for each category in the Repeater s `ItemDataBound` event handler does not require any modifications to our existing Data Access Layer.</span></span> <span data-ttu-id="99d37-155">Todas as modificações podem ser feitas diretamente a `CategoriesAndProducts.aspx` página.</span><span class="sxs-lookup"><span data-stu-id="99d37-155">All modifications can be made directly within the `CategoriesAndProducts.aspx` page.</span></span> <span data-ttu-id="99d37-156">Comece adicionando um novo ObjectDataSource chamado `CategoriesDataSource` por meio de marca inteligente Repeater s.</span><span class="sxs-lookup"><span data-stu-id="99d37-156">Start by adding a new ObjectDataSource named `CategoriesDataSource` via the Repeater s smart tag.</span></span> <span data-ttu-id="99d37-157">Em seguida, configure a `CategoriesDataSource` ObjectDataSource para que ele recupera seus dados a partir de `CategoriesBLL` classe s `GetCategories()` método.</span><span class="sxs-lookup"><span data-stu-id="99d37-157">Next, configure the `CategoriesDataSource` ObjectDataSource so that it retrieves its data from the `CategoriesBLL` class s `GetCategories()` method.</span></span>


<span data-ttu-id="99d37-158">[![Configurar o ObjectDataSource para usar a classe CategoriesBLL s GetCategories() método](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image8.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="99d37-158">[![Configure the ObjectDataSource to Use the CategoriesBLL class s GetCategories() Method](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image8.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image7.png)</span></span>

<span data-ttu-id="99d37-159">**Figura 3**: configurar o ObjectDataSource para usar o `CategoriesBLL` classe s `GetCategories()` método ([clique para exibir a imagem em tamanho normal](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="99d37-159">**Figure 3**: Configure the ObjectDataSource to Use the `CategoriesBLL` class s `GetCategories()` Method ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image9.png))</span></span>


<span data-ttu-id="99d37-160">Cada item na `Categories` Repeater precisa ser clicáveis e, quando clicado, fazer com que o `CategoryProducts` DataList para exibir esses produtos para a categoria selecionada.</span><span class="sxs-lookup"><span data-stu-id="99d37-160">Each item in the `Categories` Repeater needs to be clickable and, when clicked, cause the `CategoryProducts` DataList to display those products for the selected category.</span></span> <span data-ttu-id="99d37-161">Isso pode ser feito fazendo um hiperlink, vinculação de volta para esta página mesma para cada categoria (`CategoriesAndProducts.aspx`), mas passando o `CategoryID` por meio da cadeia de consulta, assim como o que vimos no tutorial anterior.</span><span class="sxs-lookup"><span data-stu-id="99d37-161">This can be accomplished by making each category a hyperlink, linking back to this same page (`CategoriesAndProducts.aspx`), but passing the `CategoryID` through the querystring, much like we saw in the previous tutorial.</span></span> <span data-ttu-id="99d37-162">A vantagem dessa abordagem é que uma página que exibe produtos de uma determinada categoria s pode ser marcada e indexada por um mecanismo de pesquisa.</span><span class="sxs-lookup"><span data-stu-id="99d37-162">The advantage of this approach is that a page displaying a particular category s products can be bookmarked and indexed by a search engine.</span></span>

<span data-ttu-id="99d37-163">Como alternativa, podemos tornar cada categoria LinkButton, que é a abordagem que usaremos para este tutorial.</span><span class="sxs-lookup"><span data-stu-id="99d37-163">Alternatively, we can make each category a LinkButton, which is the approach we'll use for this tutorial.</span></span> <span data-ttu-id="99d37-164">No botão LinkButton é renderizado no navegador do usuário s como um hiperlink, mas, quando clicado, induz um postback; no postback, o s DataList ObjectDataSource precisa ser atualizado para exibir os produtos que pertencem à categoria selecionada.</span><span class="sxs-lookup"><span data-stu-id="99d37-164">The LinkButton renders in the user s browser as a hyperlink but, when clicked, induces a postback; on postback, the DataList s ObjectDataSource needs to be refreshed to display those products belonging to the selected category.</span></span> <span data-ttu-id="99d37-165">Para este tutorial, usar um hiperlink que faz mais sentido do que usando LinkButton; No entanto, pode haver outros cenários em que é mais vantajoso usar LinkButton.</span><span class="sxs-lookup"><span data-stu-id="99d37-165">For this tutorial, using a hyperlink makes more sense than using a LinkButton; however, there may be other scenarios where using a LinkButton is more advantageous.</span></span> <span data-ttu-id="99d37-166">Embora a abordagem de hiperlink seria ideal para este exemplo, permite que s em vez disso, explorar usando o LinkButton.</span><span class="sxs-lookup"><span data-stu-id="99d37-166">While the hyperlink approach would be ideal for this example, let s instead explore using the LinkButton.</span></span> <span data-ttu-id="99d37-167">Como veremos, usar um LinkButton apresenta alguns desafios que não se surgiria, caso contrário, com um hiperlink.</span><span class="sxs-lookup"><span data-stu-id="99d37-167">As we'll see, using a LinkButton introduces some challenges that would not otherwise arise with a hyperlink.</span></span> <span data-ttu-id="99d37-168">Portanto, usar um LinkButton neste tutorial será realce esses desafios e ajudar a fornecer soluções para esses cenários em que podemos querer usar um LinkButton em vez de um hiperlink.</span><span class="sxs-lookup"><span data-stu-id="99d37-168">Therefore, using a LinkButton in this tutorial will highlight these challenges and help provide solutions for those scenarios where we may want to use a LinkButton instead of a hyperlink.</span></span>

> [!NOTE]
> <span data-ttu-id="99d37-169">Você é incentivado a repetir este tutorial usando um controle de hiperlink ou `<a>` elemento em vez de no botão LinkButton.</span><span class="sxs-lookup"><span data-stu-id="99d37-169">You are encouraged to repeat this tutorial using a HyperLink control or `<a>` element in lieu of the LinkButton.</span></span>


<span data-ttu-id="99d37-170">A marcação a seguir mostra a sintaxe declarativa para repetidor e ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="99d37-170">The following markup shows the declarative syntax for the Repeater and the ObjectDataSource.</span></span> <span data-ttu-id="99d37-171">Observe que os modelos de s Repeater renderizam uma lista com marcadores com cada item como um LinkButton:</span><span class="sxs-lookup"><span data-stu-id="99d37-171">Note that the Repeater s templates render a bulleted list with each item as a LinkButton:</span></span>


[!code-aspx[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/samples/sample4.aspx)]

> [!NOTE]
> <span data-ttu-id="99d37-172">Para este tutorial o Repeater deve ter seu estado de exibição habilitado (Observe a omissão do `EnableViewState="False"` da sintaxe declarativa Repeater s).</span><span class="sxs-lookup"><span data-stu-id="99d37-172">For this tutorial the Repeater must have its view state enabled (note the omission of the `EnableViewState="False"` from the Repeater s declarative syntax).</span></span> <span data-ttu-id="99d37-173">Na etapa 3, criaremos um manipulador de eventos para o s Repeater `ItemCommand` eventos nos quais vamos atualizar DataList s s ObjectDataSource `SelectParameters` coleção.</span><span class="sxs-lookup"><span data-stu-id="99d37-173">In step 3 we'll be creating an event handler for the Repeater s `ItemCommand` event in which we'll be updating the DataList s ObjectDataSource s `SelectParameters` collection.</span></span> <span data-ttu-id="99d37-174">O Repeater s `ItemCommand`, no entanto, ganha incêndio t, se o estado de exibição está desabilitado.</span><span class="sxs-lookup"><span data-stu-id="99d37-174">The Repeater s `ItemCommand`, however, won t fire if view state is disabled.</span></span> <span data-ttu-id="99d37-175">Ver [um desafio de uma pergunta do ASP.NET](http://scottonwriting.net/sowblog/posts/1263.aspx) e [sua solução](http://scottonwriting.net/sowBlog/posts/1268.aspx) para obter mais informações sobre por que o estado de exibição deve ser habilitado para um repetidor s `ItemCommand` evento seja acionado.</span><span class="sxs-lookup"><span data-stu-id="99d37-175">See [A Stumper of an ASP.NET Question](http://scottonwriting.net/sowblog/posts/1263.aspx) and [its solution](http://scottonwriting.net/sowBlog/posts/1268.aspx) for more information on why view state must be enabled for a Repeater s `ItemCommand` event to fire.</span></span>


<span data-ttu-id="99d37-176">No LinkButton com o `ID` valor da propriedade de `ViewCategory` não tem seu `Text` conjunto de propriedades.</span><span class="sxs-lookup"><span data-stu-id="99d37-176">The LinkButton with the `ID` property value of `ViewCategory` does not have its `Text` property set.</span></span> <span data-ttu-id="99d37-177">Se podemos apenas quisesse exibir o nome da categoria, seria definimos a propriedade Text declarativamente, por meio da sintaxe de associação de dados, da seguinte forma:</span><span class="sxs-lookup"><span data-stu-id="99d37-177">If we had just wanted to display the category name, we would have set the Text property declaratively, through databinding syntax, like so:</span></span>


[!code-aspx[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/samples/sample5.aspx)]

<span data-ttu-id="99d37-178">No entanto, queremos mostrar o nome de categoria s *e* o número de produtos que pertencem a essa categoria.</span><span class="sxs-lookup"><span data-stu-id="99d37-178">However, we want to show both the category s name *and* the number of products belonging to that category.</span></span> <span data-ttu-id="99d37-179">Essas informações podem ser recuperadas do repetidor s `ItemDataBound` manipulador de eventos, fazendo uma chamada para o `ProductBLL` classe s `GetCategoriesByProductID(categoryID)` método e determinar quantos registros é retornado em resultante `ProductsDataTable`, como o código a seguir ilustra:</span><span class="sxs-lookup"><span data-stu-id="99d37-179">This information can be retrieved from the Repeater s `ItemDataBound` event handler by making a call to the `ProductBLL` class s `GetCategoriesByProductID(categoryID)` method and determining how many records are returned in the resulting `ProductsDataTable`, as the following code illustrates:</span></span>


[!code-csharp[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/samples/sample6.cs)]

<span data-ttu-id="99d37-180">Começamos, garantindo que podemos está trabalhando com um item de dados (um cujos `ItemType` é `Item` ou `AlternatingItem`) e, em seguida, fazer referência a `CategoriesRow` instância que tenha sido associada apenas à atual `RepeaterItem`.</span><span class="sxs-lookup"><span data-stu-id="99d37-180">We start out by ensuring that we re working with a data item (one whose `ItemType` is `Item` or `AlternatingItem`) and then reference the `CategoriesRow` instance that has just been bound to the current `RepeaterItem`.</span></span> <span data-ttu-id="99d37-181">Em seguida, podemos determinar o número de produtos dessa categoria com a criação de uma instância das `ProductsBLL` classe, chamando seu `GetCategoriesByProductID(categoryID)` método e determinar o número de registros retornados usando o `Count` propriedade.</span><span class="sxs-lookup"><span data-stu-id="99d37-181">Next, we determine the number of products for this category by creating an instance of the `ProductsBLL` class, calling its `GetCategoriesByProductID(categoryID)` method, and determining the number of records returned using the `Count` property.</span></span> <span data-ttu-id="99d37-182">Por fim, o `ViewCategory` LinkButton ItemTemplate é references e sua `Text` estiver definida como *CategoryName* (*NumberOfProductsInCategory*), onde  *NumberOfProductsInCategory* é formatado como um número com zero casas decimais.</span><span class="sxs-lookup"><span data-stu-id="99d37-182">Finally, the `ViewCategory` LinkButton in the ItemTemplate is references and its `Text` property is set to *CategoryName* (*NumberOfProductsInCategory*), where *NumberOfProductsInCategory* is formatted as a number with zero decimal places.</span></span>

> [!NOTE]
> <span data-ttu-id="99d37-183">Como alternativa, podemos poderia ter adicionado uma *função de formatação* para a classe de code-behind de s de página ASP.NET que aceita uma categoria s `CategoryName` e `CategoryID` valores e retorna o `CategoryName` concatenado com o número de produtos na categoria (conforme determinado por meio da chamada a `GetCategoriesByProductID(categoryID)` método).</span><span class="sxs-lookup"><span data-stu-id="99d37-183">Alternatively, we could have added a *formatting function* to the ASP.NET page s code-behind class that accepts a category s `CategoryName` and `CategoryID` values and returns the `CategoryName` concatenated with the number of products in the category (as determined by calling the `GetCategoriesByProductID(categoryID)` method).</span></span> <span data-ttu-id="99d37-184">Os resultados de uma função formatação podem ser atribuídos declarativamente para o s LinkButton propriedade de texto, substituindo a necessidade do `ItemDataBound` manipulador de eventos.</span><span class="sxs-lookup"><span data-stu-id="99d37-184">The results of such a formatting function could be declaratively assigned to the LinkButton s Text property replacing the need for the `ItemDataBound` event handler.</span></span> <span data-ttu-id="99d37-185">Consulte a [Usando TemplateFields no controle GridView](../custom-formatting/using-templatefields-in-the-gridview-control-cs.md) ou [formatação do DataList e Repeater com base em dados](../displaying-data-with-the-datalist-and-repeater/formatting-the-datalist-and-repeater-based-upon-data-cs.md) tutoriais para obter mais informações sobre como usar funções de formatação.</span><span class="sxs-lookup"><span data-stu-id="99d37-185">Refer to the [Using TemplateFields in the GridView Control](../custom-formatting/using-templatefields-in-the-gridview-control-cs.md) or [Formatting the DataList and Repeater Based Upon Data](../displaying-data-with-the-datalist-and-repeater/formatting-the-datalist-and-repeater-based-upon-data-cs.md) tutorials for more information on using formatting functions.</span></span>


<span data-ttu-id="99d37-186">Depois de adicionar esse manipulador de eventos, reserve um tempo para testar a página por meio de um navegador.</span><span class="sxs-lookup"><span data-stu-id="99d37-186">After adding this event handler, take a moment to test the page through a browser.</span></span> <span data-ttu-id="99d37-187">Observe como cada categoria é listada em uma lista com marcadores, exibindo o nome da categoria s e o número de produtos associados à categoria (consulte a Figura 4).</span><span class="sxs-lookup"><span data-stu-id="99d37-187">Note how each category is listed in a bulleted list, displaying the category s name and the number of products associated with the category (see Figure 4).</span></span>


<span data-ttu-id="99d37-188">[![Cada categoria s nome e o número de produtos são exibidos](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image11.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="99d37-188">[![Each Category s Name and Number of Products are Displayed](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image11.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image10.png)</span></span>

<span data-ttu-id="99d37-189">**Figura 4**: cada categoria s nome e o número de produtos são exibidos ([clique para exibir a imagem em tamanho normal](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="99d37-189">**Figure 4**: Each Category s Name and Number of Products are Displayed ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image12.png))</span></span>


## <a name="updating-thecategoriesdatatableandcategoriestableadapterto-include-the-number-of-products-for-each-category"></a><span data-ttu-id="99d37-190">Atualizando o`CategoriesDataTable`e`CategoriesTableAdapter`para incluir o número de produtos para cada categoria</span><span class="sxs-lookup"><span data-stu-id="99d37-190">Updating the`CategoriesDataTable`and`CategoriesTableAdapter`to Include the Number of Products for Each Category</span></span>

<span data-ttu-id="99d37-191">Em vez de determinar o número de produtos para cada categoria como ela s associados a Repeater, podemos pode simplificar esse processo, ajustando a `CategoriesDataTable` e `CategoriesTableAdapter` na camada de acesso a dados para incluir essas informações nativamente.</span><span class="sxs-lookup"><span data-stu-id="99d37-191">Rather than determining the number of products for each category as it s bound to the Repeater, we can streamline this process by adjusting the `CategoriesDataTable` and `CategoriesTableAdapter` in the Data Access Layer to include this information natively.</span></span> <span data-ttu-id="99d37-192">Para conseguir isso, devemos adicionar uma nova coluna à `CategoriesDataTable` para manter o número de produtos associados.</span><span class="sxs-lookup"><span data-stu-id="99d37-192">To achieve this, we must add a new column to `CategoriesDataTable` to hold the number of associated products.</span></span> <span data-ttu-id="99d37-193">Para adicionar uma nova coluna a um DataTable, abra o conjunto de dados tipado (`App_Code\DAL\Northwind.xsd`), clique com botão direito na DataTable para modificar e escolha Adicionar / coluna.</span><span class="sxs-lookup"><span data-stu-id="99d37-193">To add a new column to a DataTable, open the Typed DataSet (`App_Code\DAL\Northwind.xsd`), right-click on the DataTable to modify, and choose Add / Column.</span></span> <span data-ttu-id="99d37-194">Adicionar uma nova coluna para o `CategoriesDataTable` (consulte a Figura 5).</span><span class="sxs-lookup"><span data-stu-id="99d37-194">Add a new column to the `CategoriesDataTable` (see Figure 5).</span></span>


<span data-ttu-id="99d37-195">[![Adicionar uma nova coluna para o CategoriesDataSource](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image14.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="99d37-195">[![Add a New Column to the CategoriesDataSource](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image14.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image13.png)</span></span>

<span data-ttu-id="99d37-196">**Figura 5**: adicionar uma nova coluna para o `CategoriesDataSource` ([clique para exibir a imagem em tamanho normal](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="99d37-196">**Figure 5**: Add a New Column to the `CategoriesDataSource` ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image15.png))</span></span>


<span data-ttu-id="99d37-197">Isso adicionará uma nova coluna chamada `Column1`, que pode ser alterado, simplesmente digitando um nome diferente.</span><span class="sxs-lookup"><span data-stu-id="99d37-197">This will add a new column named `Column1`, which you can change by simply typing in a different name.</span></span> <span data-ttu-id="99d37-198">Renomeie esta coluna nova para `NumberOfProducts`.</span><span class="sxs-lookup"><span data-stu-id="99d37-198">Rename this new column to `NumberOfProducts`.</span></span> <span data-ttu-id="99d37-199">Em seguida, precisamos configurar propriedades essa coluna s.</span><span class="sxs-lookup"><span data-stu-id="99d37-199">Next, we need to configure this column s properties.</span></span> <span data-ttu-id="99d37-200">Clique na nova coluna e vá para a janela de propriedades.</span><span class="sxs-lookup"><span data-stu-id="99d37-200">Click on the new column and go to the Properties window.</span></span> <span data-ttu-id="99d37-201">Alterar a coluna s `DataType` propriedade de `System.String` para `System.Int32` e defina o `ReadOnly` propriedade `True`, conforme mostrado na Figura 6.</span><span class="sxs-lookup"><span data-stu-id="99d37-201">Change the column s `DataType` property from `System.String` to `System.Int32` and set the `ReadOnly` property to `True`, as shown in Figure 6.</span></span>


![Definir as propriedades de somente leitura da nova coluna e tipo de dados](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image16.png)

<span data-ttu-id="99d37-203">**Figura 6**: defina o `DataType` e `ReadOnly` propriedades da nova coluna</span><span class="sxs-lookup"><span data-stu-id="99d37-203">**Figure 6**: Set the `DataType` and `ReadOnly` Properties of the New Column</span></span>


<span data-ttu-id="99d37-204">Enquanto o `CategoriesDataTable` agora tem um `NumberOfProducts` coluna, seu valor não é definido por qualquer uma das consultas do s correspondentes do TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="99d37-204">While the `CategoriesDataTable` now has a `NumberOfProducts` column, its value is not set by any of the corresponding TableAdapter s queries.</span></span> <span data-ttu-id="99d37-205">Podemos atualizar o `GetCategories()` retornado de método para retornar essa informação se quisermos que tais informações toda vez que as informações de categoria são recuperadas.</span><span class="sxs-lookup"><span data-stu-id="99d37-205">We can update the `GetCategories()` method to return this information if we want such information returned every time category information is retrieved.</span></span> <span data-ttu-id="99d37-206">Se, no entanto, precisamos pegar o número de produtos associados para as categorias em casos raros, (por exemplo, apenas como para este tutorial), então podemos deixar `GetCategories()` como-está e criar um novo método que retorna essas informações.</span><span class="sxs-lookup"><span data-stu-id="99d37-206">If, however, we only need to grab the number of associated products for the categories in rare instances (such as just for this tutorial), then we can leave `GetCategories()` as-is and create a new method that returns this information.</span></span> <span data-ttu-id="99d37-207">Let s usam essa última abordagem, criando um novo método chamado `GetCategoriesAndNumberOfProducts()`.</span><span class="sxs-lookup"><span data-stu-id="99d37-207">Let s use this latter approach, creating a new method named `GetCategoriesAndNumberOfProducts()`.</span></span>

<span data-ttu-id="99d37-208">Para adicionar essa nova `GetCategoriesAndNumberOfProducts()` método, o botão direito do mouse no `CategoriesTableAdapter` e escolha a nova consulta.</span><span class="sxs-lookup"><span data-stu-id="99d37-208">To add this new `GetCategoriesAndNumberOfProducts()` method, right-click on the `CategoriesTableAdapter` and choose New Query.</span></span> <span data-ttu-id="99d37-209">Isso abre o TableAdapter consultar o Assistente de configuração, o qual estamos ve usado várias vezes nos tutoriais anteriores.</span><span class="sxs-lookup"><span data-stu-id="99d37-209">This brings up the TableAdapter Query Configuration Wizard, which we ve used numerous times in previous tutorials.</span></span> <span data-ttu-id="99d37-210">Para esse método, inicie o assistente, indicando que a consulta usa uma instrução SQL ad hoc que retorna linhas.</span><span class="sxs-lookup"><span data-stu-id="99d37-210">For this method, start the wizard by indicating that the query uses an ad-hoc SQL statement that returns rows.</span></span>


<span data-ttu-id="99d37-211">[![Crie o método usando uma instrução de SQL Ad Hoc](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image18.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="99d37-211">[![Create the Method Using an Ad-Hoc SQL Statement](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image18.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image17.png)</span></span>

<span data-ttu-id="99d37-212">**Figura 7**: criar o método usando uma instrução de SQL Ad Hoc ([clique para exibir a imagem em tamanho normal](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image19.png))</span><span class="sxs-lookup"><span data-stu-id="99d37-212">**Figure 7**: Create the Method Using an Ad-Hoc SQL Statement ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image19.png))</span></span>


<span data-ttu-id="99d37-213">[![A instrução SQL retorna linhas](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image21.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="99d37-213">[![The SQL Statement Returns Rows](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image21.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image20.png)</span></span>

<span data-ttu-id="99d37-214">**Figura 8**: O SQL instrução retorna linhas ([clique para exibir a imagem em tamanho normal](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="99d37-214">**Figure 8**: The SQL Statement Returns Rows ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image22.png))</span></span>


<span data-ttu-id="99d37-215">A próxima tela do assistente solicita que nós da consulta usar.</span><span class="sxs-lookup"><span data-stu-id="99d37-215">The next wizard screen prompts us for the query to use.</span></span> <span data-ttu-id="99d37-216">Para retornar cada categoria s `CategoryID`, `CategoryName`, e `Description` campos, juntamente com o número de produtos associados à categoria, usam o seguinte `SELECT` instrução:</span><span class="sxs-lookup"><span data-stu-id="99d37-216">To return each category s `CategoryID`, `CategoryName`, and `Description` fields, along with the number of products associated with the category, use the following `SELECT` statement:</span></span>


[!code-sql[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/samples/sample7.sql)]


<span data-ttu-id="99d37-217">[![Especifique a consulta para uso](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image24.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="99d37-217">[![Specify the Query to Use](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image24.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image23.png)</span></span>

<span data-ttu-id="99d37-218">**Figura 9**: especifique a consulta para uso ([clique para exibir a imagem em tamanho normal](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image25.png))</span><span class="sxs-lookup"><span data-stu-id="99d37-218">**Figure 9**: Specify the Query to Use ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image25.png))</span></span>


<span data-ttu-id="99d37-219">Observe que a subconsulta que calcula o número de produtos associados com a categoria é um alias como `NumberOfProducts`.</span><span class="sxs-lookup"><span data-stu-id="99d37-219">Note that the subquery that computes the number of products associated with the category is aliased as `NumberOfProducts`.</span></span> <span data-ttu-id="99d37-220">Essa correspondência nomenclatura faz com que o valor retornado por esta subconsulta a ser associada com o `CategoriesDataTable` s `NumberOfProducts` coluna.</span><span class="sxs-lookup"><span data-stu-id="99d37-220">This naming match causes the value returned by this subquery to be associated with the `CategoriesDataTable` s `NumberOfProducts` column.</span></span>

<span data-ttu-id="99d37-221">Depois de inserir essa consulta, a última etapa é escolher o nome para o novo método.</span><span class="sxs-lookup"><span data-stu-id="99d37-221">After entering this query, the last step is to choose the name for the new method.</span></span> <span data-ttu-id="99d37-222">Use `FillWithNumberOfProducts` e `GetCategoriesAndNumberOfProducts` para o preenchimento uma DataTable e retornar uma DataTable padrões, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="99d37-222">Use `FillWithNumberOfProducts` and `GetCategoriesAndNumberOfProducts` for the Fill a DataTable and Return a DataTable patterns, respectively.</span></span>


<span data-ttu-id="99d37-223">[![Nome de métodos FillWithNumberOfProducts novo do TableAdapter s e GetCategoriesAndNumberOfProducts](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image27.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="99d37-223">[![Name the New TableAdapter s Methods FillWithNumberOfProducts and GetCategoriesAndNumberOfProducts](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image27.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image26.png)</span></span>

<span data-ttu-id="99d37-224">**Figura 10**: nomear o TableAdapter novo s métodos `FillWithNumberOfProducts` e `GetCategoriesAndNumberOfProducts` ([clique para exibir a imagem em tamanho normal](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="99d37-224">**Figure 10**: Name the New TableAdapter s Methods `FillWithNumberOfProducts` and `GetCategoriesAndNumberOfProducts` ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image28.png))</span></span>


<span data-ttu-id="99d37-225">Neste momento a camada de acesso a dados foi estendida para incluir o número de produtos por categoria.</span><span class="sxs-lookup"><span data-stu-id="99d37-225">At this point the Data Access Layer has been extended to include the number of products per category.</span></span> <span data-ttu-id="99d37-226">Uma vez que nossa camada de apresentação encaminha todas as chamadas para o DAL por meio de uma camada de lógica de negócios separadas, precisamos adicionar um correspondente `GetCategoriesAndNumberOfProducts` método para o `CategoriesBLL` classe:</span><span class="sxs-lookup"><span data-stu-id="99d37-226">Since all our presentation layer routes all calls to the DAL through a separate Business Logic Layer we need to add a corresponding `GetCategoriesAndNumberOfProducts` method to the `CategoriesBLL` class:</span></span>


[!code-csharp[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/samples/sample8.cs)]

<span data-ttu-id="99d37-227">Com o DAL e BLL completa, podemos re pronto para associar esses dados para o `Categories` Repeater em `CategoriesAndProducts.aspx`!</span><span class="sxs-lookup"><span data-stu-id="99d37-227">With the DAL and BLL complete, we re ready to bind this data to the `Categories` Repeater in `CategoriesAndProducts.aspx`!</span></span> <span data-ttu-id="99d37-228">Se ve você já criou um ObjectDataSource para repetidor do determinando o número de produtos na `ItemDataBound` seção do manipulador de eventos, excluir esse ObjectDataSource e remover o Repeater s `DataSourceID` propriedade definindo; sem confusão também o Repeater s `ItemDataBound` evento do manipulador de eventos, removendo o `Handles Categories.OnItemDataBound` sintaxe na classe code-behind ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="99d37-228">If you ve already created an ObjectDataSource for the Repeater from the Determining the Number of Products in the `ItemDataBound` Event Handler section, delete this ObjectDataSource and remove the Repeater s `DataSourceID` property setting; also unwire the Repeater s `ItemDataBound` event from the event handler by removing the `Handles Categories.OnItemDataBound` syntax in the ASP.NET code-behind class.</span></span>

<span data-ttu-id="99d37-229">Com o repetidor de volta em seu estado original, adicione um novo ObjectDataSource chamado `CategoriesDataSource` por meio de marca inteligente Repeater s.</span><span class="sxs-lookup"><span data-stu-id="99d37-229">With the Repeater back in its original state, add a new ObjectDataSource named `CategoriesDataSource` via the Repeater s smart tag.</span></span> <span data-ttu-id="99d37-230">Configurar o ObjectDataSource para usar o `CategoriesBLL` classe, mas em vez de fazer com que ele use o `GetCategories()` método, ele tem usar `GetCategoriesAndNumberOfProducts()` em vez disso (veja a Figura 11).</span><span class="sxs-lookup"><span data-stu-id="99d37-230">Configure the ObjectDataSource to use the `CategoriesBLL` class, but instead of having it use the `GetCategories()` method, have it use `GetCategoriesAndNumberOfProducts()` instead (see Figure 11).</span></span>


<span data-ttu-id="99d37-231">[![Configurar o ObjectDataSource para usar o método GetCategoriesAndNumberOfProducts](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image30.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="99d37-231">[![Configure the ObjectDataSource to Use the GetCategoriesAndNumberOfProducts Method](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image30.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image29.png)</span></span>

<span data-ttu-id="99d37-232">**Figura 11**: configurar o ObjectDataSource para usar o `GetCategoriesAndNumberOfProducts` método ([clique para exibir a imagem em tamanho normal](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image31.png))</span><span class="sxs-lookup"><span data-stu-id="99d37-232">**Figure 11**: Configure the ObjectDataSource to Use the `GetCategoriesAndNumberOfProducts` Method ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image31.png))</span></span>


<span data-ttu-id="99d37-233">Em seguida, atualize o `ItemTemplate` para que o s LinkButton `Text` propriedade é atribuída declarativamente usando a sintaxe de associação de dados e inclui tanto o `CategoryName` e `NumberOfProducts` campos de dados.</span><span class="sxs-lookup"><span data-stu-id="99d37-233">Next, update the `ItemTemplate` so that the LinkButton s `Text` property is declaratively assigned using databinding syntax and includes both the `CategoryName` and `NumberOfProducts` data fields.</span></span> <span data-ttu-id="99d37-234">A marcação declarativa completa para o Repeater e o `CategoriesDataSource` ObjectDataSource seguem:</span><span class="sxs-lookup"><span data-stu-id="99d37-234">The complete declarative markup for the Repeater and the `CategoriesDataSource` ObjectDataSource follow:</span></span>


[!code-aspx[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/samples/sample9.aspx)]

<span data-ttu-id="99d37-235">A saída renderizada atualizando a DAL para incluir um `NumberOfProducts` coluna é o mesmo que usar o `ItemDataBound` abordagem do manipulador de eventos (consulte a Figura 4 para ver uma tela de captura do repetidor mostrando os nomes de categoria e o número de produtos).</span><span class="sxs-lookup"><span data-stu-id="99d37-235">The output rendered by updating the DAL to include a `NumberOfProducts` column is the same as using the `ItemDataBound` event handler approach (refer back to Figure 4 to see a screen shot of the Repeater showing the category names and number of products).</span></span>

## <a name="step-3-displaying-the-selected-category-s-products"></a><span data-ttu-id="99d37-236">Etapa 3: Exibindo produtos a categoria selecionada</span><span class="sxs-lookup"><span data-stu-id="99d37-236">Step 3: Displaying the Selected Category s Products</span></span>

<span data-ttu-id="99d37-237">Neste ponto, temos o `Categories` Repeater para exibir a lista de categorias, juntamente com o número de produtos em cada categoria.</span><span class="sxs-lookup"><span data-stu-id="99d37-237">At this point we have the `Categories` Repeater displaying the list of categories along with the number of products in each category.</span></span> <span data-ttu-id="99d37-238">O Repeater usa LinkButton para cada categoria que, quando clicado, faz com que uma postagem, no qual ponto podemos precisar exibir esses produtos para a categoria selecionada no `CategoryProducts` DataList.</span><span class="sxs-lookup"><span data-stu-id="99d37-238">The Repeater uses a LinkButton for each category that, when clicked, causes a postback, at which point we need to display those products for the selected category in the `CategoryProducts` DataList.</span></span>

<span data-ttu-id="99d37-239">Um desafio voltados para nós é como ter DataList exibir apenas esses produtos para a categoria selecionada.</span><span class="sxs-lookup"><span data-stu-id="99d37-239">One challenge facing us is how to have the DataList display just those products for the selected category.</span></span> <span data-ttu-id="99d37-240">No [mestre/detalhes usando um GridView mestre selecionável com um DetailsView detalhes](../masterdetail/master-detail-using-a-selectable-master-gridview-with-a-details-detailview-cs.md) tutorial vimos como criar um GridView cujas linhas pode ser selecionada, com a linha selecionada s detalha sendo exibida em um DetailsView na mesma página.</span><span class="sxs-lookup"><span data-stu-id="99d37-240">In the [Master/Detail Using a Selectable Master GridView with a Details DetailsView](../masterdetail/master-detail-using-a-selectable-master-gridview-with-a-details-detailview-cs.md) tutorial we saw how to build a GridView whose rows could be selected, with the selected row s details being displayed in a DetailsView on the same page.</span></span> <span data-ttu-id="99d37-241">O s GridView ObjectDataSource retornadas informações sobre todos os produtos usando o `ProductsBLL` s `GetProducts()` método enquanto o s DetailsView ObjectDataSource recuperar informações sobre o produto selecionado usando o `GetProductsByProductID(productID)` método.</span><span class="sxs-lookup"><span data-stu-id="99d37-241">The GridView s ObjectDataSource returned information about all products using the `ProductsBLL` s `GetProducts()` method while the DetailsView s ObjectDataSource retrieved information about the selected product using the `GetProductsByProductID(productID)` method.</span></span> <span data-ttu-id="99d37-242">O *`productID`* o valor do parâmetro foi fornecido declarativamente por meio de associação com o valor de s o GridView `SelectedValue` propriedade.</span><span class="sxs-lookup"><span data-stu-id="99d37-242">The *`productID`* parameter value was provided declaratively by associating it with the value of the GridView s `SelectedValue` property.</span></span> <span data-ttu-id="99d37-243">Infelizmente, o Repeater não tem um `SelectedValue` propriedade e não pode servir como uma fonte de parâmetro.</span><span class="sxs-lookup"><span data-stu-id="99d37-243">Unfortunately, the Repeater does not have a `SelectedValue` property and cannot serve as a parameter source.</span></span>

> [!NOTE]
> <span data-ttu-id="99d37-244">Esse é um dos desafios que aparecem quando uso o LinkButton em um repetidor.</span><span class="sxs-lookup"><span data-stu-id="99d37-244">This is one of those challenges that appear when using the LinkButton in a Repeater.</span></span> <span data-ttu-id="99d37-245">Podemos tivesse usado um hiperlink para passar o `CategoryID` por meio da cadeia de consulta em vez disso, poderíamos usar esse campo de cadeia de consulta como a origem para o valor do parâmetro s.</span><span class="sxs-lookup"><span data-stu-id="99d37-245">Had we used a hyperlink to pass in the `CategoryID` through the querystring instead, we could use that QueryString field as the source for the parameter s value.</span></span>


<span data-ttu-id="99d37-246">Antes de nos preocupamos a falta de um `SelectedValue` propriedade para o Repeater, no entanto, permita s primeiro associar um ObjectDataSource DataList e especifique seu `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="99d37-246">Before we worry about the lack of a `SelectedValue` property for the Repeater, though, let s first bind the DataList to an ObjectDataSource and specify its `ItemTemplate`.</span></span>

<span data-ttu-id="99d37-247">Da marca inteligente DataList s, optar por adicionar um novo ObjectDataSource denominado `CategoryProductsDataSource` e configurá-lo para usar o `ProductsBLL` classe s `GetProductsByCategoryID(categoryID)` método.</span><span class="sxs-lookup"><span data-stu-id="99d37-247">From the DataList s smart tag, opt to add a new ObjectDataSource named `CategoryProductsDataSource` and configure it to use the `ProductsBLL` class s `GetProductsByCategoryID(categoryID)` method.</span></span> <span data-ttu-id="99d37-248">Uma vez que DataList neste tutorial oferece uma interface somente leitura, fique à vontade definir as listas suspensas em INSERT, UPDATE e excluir guias como (nenhum).</span><span class="sxs-lookup"><span data-stu-id="99d37-248">Since the DataList in this tutorial offers a read-only interface, feel free to set the drop-down lists in the INSERT, UPDATE, and DELETE tabs to (None).</span></span>


<span data-ttu-id="99d37-249">[![Configurar o ObjectDataSource para usar a classe ProductsBLL s GetProductsByCategoryID(categoryID) método](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image33.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image32.png)</span><span class="sxs-lookup"><span data-stu-id="99d37-249">[![Configure the ObjectDataSource to Use ProductsBLL Class s GetProductsByCategoryID(categoryID) Method](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image33.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image32.png)</span></span>

<span data-ttu-id="99d37-250">**Figura 12**: configurar o ObjectDataSource para uso `ProductsBLL` classe s `GetProductsByCategoryID(categoryID)` método ([clique para exibir a imagem em tamanho normal](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image34.png))</span><span class="sxs-lookup"><span data-stu-id="99d37-250">**Figure 12**: Configure the ObjectDataSource to Use `ProductsBLL` Class s `GetProductsByCategoryID(categoryID)` Method ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image34.png))</span></span>


<span data-ttu-id="99d37-251">Uma vez que o `GetProductsByCategoryID(categoryID)` método espera um parâmetro de entrada (*`categoryID`*), o Assistente Configurar fonte de dados nos permite especificar a origem do parâmetro s.</span><span class="sxs-lookup"><span data-stu-id="99d37-251">Since the `GetProductsByCategoryID(categoryID)` method expects an input parameter (*`categoryID`*), the Configure Data Source wizard allows us to specify the parameter s source.</span></span> <span data-ttu-id="99d37-252">As categorias tinham sido listadas em um GridView ou DataList, d definimos a lista de lista suspensa de origem do parâmetro para o controle e a ID de controle para o `ID` dos dados de controle da Web.</span><span class="sxs-lookup"><span data-stu-id="99d37-252">Had the categories been listed in a GridView or a DataList, we d set the Parameter source drop-down list to Control and the ControlID to the `ID` of the data Web control.</span></span> <span data-ttu-id="99d37-253">No entanto, como a falta de Repeater um `SelectedValue` propriedade, ele não pode ser usado como uma fonte de parâmetro.</span><span class="sxs-lookup"><span data-stu-id="99d37-253">However, since the Repeater lacks a `SelectedValue` property it cannot be used as a parameter source.</span></span> <span data-ttu-id="99d37-254">Se você verificar, você encontrará a lista de suspensa ControlID só contém um controle `ID``CategoryProducts`, o `ID` do DataList.</span><span class="sxs-lookup"><span data-stu-id="99d37-254">If you check, you'll find that the ControlID drop-down list only contains one control `ID``CategoryProducts`, the `ID` of the DataList.</span></span>

<span data-ttu-id="99d37-255">Por enquanto, defina a lista de lista suspensa de origem do parâmetro como None.</span><span class="sxs-lookup"><span data-stu-id="99d37-255">For now, set the Parameter source drop-down list to None.</span></span> <span data-ttu-id="99d37-256">Poderemos programaticamente atribuir esse valor de parâmetro quando uma categoria que LinkButton é clicado no Repetidor.</span><span class="sxs-lookup"><span data-stu-id="99d37-256">We'll end up programmatically assigning this parameter value when a category LinkButton is clicked in the Repeater.</span></span>


<span data-ttu-id="99d37-257">[![Fazer não especificar uma fonte de parâmetro para o parâmetro categoryID](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image36.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="99d37-257">[![Do Not Specify a Parameter Source for the categoryID Parameter](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image36.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image35.png)</span></span>

<span data-ttu-id="99d37-258">**Figura 13**: não especificar uma fonte de parâmetro para o *`categoryID`* parâmetro ([clique para exibir a imagem em tamanho normal](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image37.png))</span><span class="sxs-lookup"><span data-stu-id="99d37-258">**Figure 13**: Do Not Specify a Parameter Source for the *`categoryID`* Parameter ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image37.png))</span></span>


<span data-ttu-id="99d37-259">Depois de concluir o Assistente Configurar fonte de dados, o Visual Studio gera automaticamente DataList s `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="99d37-259">After completing the Configure Data Source wizard, Visual Studio auto-generates the DataList s `ItemTemplate`.</span></span> <span data-ttu-id="99d37-260">Substituir esse padrão `ItemTemplate` com o modelo usado no tutorial anterior; Além disso, defina DataList s `RepeatColumns` propriedade como 2.</span><span class="sxs-lookup"><span data-stu-id="99d37-260">Replace this default `ItemTemplate` with the template we used in the preceding tutorial; also, set the DataList s `RepeatColumns` property to 2.</span></span> <span data-ttu-id="99d37-261">Depois de fazer essas alterações, a marcação declarativa para seu controle DataList e o seu ObjectDataSource associado deve ser semelhante ao seguinte:</span><span class="sxs-lookup"><span data-stu-id="99d37-261">After making these changes the declarative markup for your DataList and its associated ObjectDataSource should look like the following:</span></span>


[!code-aspx[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/samples/sample10.aspx)]

<span data-ttu-id="99d37-262">Atualmente, o `CategoryProductsDataSource` s ObjectDataSource *`categoryID`* parâmetro nunca é definido para nenhum produto sejam exibido ao exibir a página.</span><span class="sxs-lookup"><span data-stu-id="99d37-262">Currently, the `CategoryProductsDataSource` ObjectDataSource s *`categoryID`* parameter is never set, so no products are displayed when viewing the page.</span></span> <span data-ttu-id="99d37-263">O que precisamos fazer é ter esse valor de parâmetro definido com base no `CategoryID` da categoria clicada no Repetidor.</span><span class="sxs-lookup"><span data-stu-id="99d37-263">What we need to do is have this parameter value set based on the `CategoryID` of the clicked category in the Repeater.</span></span> <span data-ttu-id="99d37-264">Isso apresenta dois desafios: primeiro, como podemos determinar quando um LinkButton em s repetidor `ItemTemplate` foi clicado; e segundo, como podemos determinar a `CategoryID` da categoria correspondente cujo LinkButton foi clicado?</span><span class="sxs-lookup"><span data-stu-id="99d37-264">This introduces two challenges: first, how do we determine when a LinkButton in the Repeater s `ItemTemplate` has been clicked; and second, how can we determine the `CategoryID` of the corresponding category whose LinkButton was clicked?</span></span>

<span data-ttu-id="99d37-265">No botão LinkButton como os controles de botão e ImageButton tem um `Click` evento e uma [ `Command` evento](https://msdn.microsoft.com/library/system.web.ui.webcontrols.linkbutton.command.aspx).</span><span class="sxs-lookup"><span data-stu-id="99d37-265">The LinkButton like the Button and ImageButton controls has a `Click` event and a [`Command` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.linkbutton.command.aspx).</span></span> <span data-ttu-id="99d37-266">O `Click` evento foi projetado para simplesmente observam que foi clicado no botão LinkButton.</span><span class="sxs-lookup"><span data-stu-id="99d37-266">The `Click` event is designed to simply note that the LinkButton has been clicked.</span></span> <span data-ttu-id="99d37-267">Às vezes, no entanto, além de observar o que foi clicado no botão LinkButton também precisamos passar algumas informações extras para o manipulador de eventos.</span><span class="sxs-lookup"><span data-stu-id="99d37-267">At times, however, in addition to noting that the LinkButton has been clicked we also need to pass some extra information to the event handler.</span></span> <span data-ttu-id="99d37-268">Se esse for o caso, o s LinkButton [ `CommandName` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.linkbutton.commandname.aspx) e [ `CommandArgument` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.linkbutton.commandargument.aspx) propriedades podem ser atribuídas a essas informações extras.</span><span class="sxs-lookup"><span data-stu-id="99d37-268">If this is the case, the LinkButton s [`CommandName`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.linkbutton.commandname.aspx) and [`CommandArgument`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.linkbutton.commandargument.aspx) properties can be assigned this extra information.</span></span> <span data-ttu-id="99d37-269">Em seguida, quando você clica no botão LinkButton, sua `Command` evento é acionado (em vez de seu `Click` eventos) e o manipulador de eventos recebe os valores da `CommandName` e `CommandArgument` propriedades.</span><span class="sxs-lookup"><span data-stu-id="99d37-269">Then, when the LinkButton is clicked, its `Command` event fires (instead of its `Click` event) and the event handler is passed the values of the `CommandName` and `CommandArgument` properties.</span></span>

<span data-ttu-id="99d37-270">Quando um `Command` é gerado de dentro de um modelo no repetidor, s o Repeater [ `ItemCommand` evento](https://msdn.microsoft.com/library/system.web.ui.webcontrols.repeater.itemcommand.aspx) é acionado e é passado a `CommandName` e `CommandArgument` valores no LinkButton clicado (ou botão ou ImageButton).</span><span class="sxs-lookup"><span data-stu-id="99d37-270">When a `Command` event is raised from within a template in the Repeater, the Repeater s [`ItemCommand` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.repeater.itemcommand.aspx) fires and is passed the `CommandName` and `CommandArgument` values of the clicked LinkButton (or Button or ImageButton).</span></span> <span data-ttu-id="99d37-271">Portanto, para determinar quando uma categoria LinkButton no repetidor foi clicada, é preciso fazer o seguinte:</span><span class="sxs-lookup"><span data-stu-id="99d37-271">Therefore, to determine when a category LinkButton in the Repeater has been clicked, we need to do the following:</span></span>

1. <span data-ttu-id="99d37-272">Defina a `CommandName` propriedade no LinkButton no repetidor s `ItemTemplate` para algum valor (eu ve usado ListProducts).</span><span class="sxs-lookup"><span data-stu-id="99d37-272">Set the `CommandName` property of the LinkButton in the Repeater s `ItemTemplate` to some value (I ve used ListProducts ).</span></span> <span data-ttu-id="99d37-273">Definindo isso `CommandName` de valor, o s LinkButton `Command` evento é acionado quando o usuário clica no botão LinkButton.</span><span class="sxs-lookup"><span data-stu-id="99d37-273">By setting this `CommandName` value, the LinkButton s `Command` event fires when the LinkButton is clicked.</span></span>
2. <span data-ttu-id="99d37-274">Definir o s LinkButton `CommandArgument` propriedade para o valor do item atual s `CategoryID`.</span><span class="sxs-lookup"><span data-stu-id="99d37-274">Set the LinkButton s `CommandArgument` property to the value of the current item s `CategoryID`.</span></span>
3. <span data-ttu-id="99d37-275">Criar um manipulador de eventos para o Repeater s `ItemCommand` eventos.</span><span class="sxs-lookup"><span data-stu-id="99d37-275">Create an event handler for the Repeater s `ItemCommand` event.</span></span> <span data-ttu-id="99d37-276">No conjunto de eventos manipulador, o `CategoryProductsDataSource` s ObjectDataSource `CategoryID` parâmetro para o valor passado na `CommandArgument`.</span><span class="sxs-lookup"><span data-stu-id="99d37-276">In the event handler, set the `CategoryProductsDataSource` ObjectDataSource s `CategoryID` parameter to the value of the passed-in `CommandArgument`.</span></span>

<span data-ttu-id="99d37-277">O seguinte `ItemTemplate` marcação para o Repeater categorias implementa as etapas 1 e 2.</span><span class="sxs-lookup"><span data-stu-id="99d37-277">The following `ItemTemplate` markup for the Categories Repeater implements steps 1 and 2.</span></span> <span data-ttu-id="99d37-278">Observe como o `CommandArgument` valor é atribuído o item de dados s `CategoryID` usando a sintaxe de associação de dados:</span><span class="sxs-lookup"><span data-stu-id="99d37-278">Note how the `CommandArgument` value is assigned the data item s `CategoryID` using databinding syntax:</span></span>


[!code-aspx[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/samples/sample11.aspx)]

<span data-ttu-id="99d37-279">Sempre que criar uma `ItemCommand` manipulador de eventos é prudente sempre primeiro, verifique a entrada `CommandName` valor porque *qualquer* `Command` evento gerado por *qualquer* botão, LinkButton, ou ImageButton dentro do repetidor fará com que o `ItemCommand` evento seja acionado.</span><span class="sxs-lookup"><span data-stu-id="99d37-279">Whenever creating an `ItemCommand` event handler it is prudent to always first check the incoming `CommandName` value because *any* `Command` event raised by *any* Button, LinkButton, or ImageButton within the Repeater will cause the `ItemCommand` event to fire.</span></span> <span data-ttu-id="99d37-280">Enquanto atualmente só temos um tal LinkButton agora, no futuro nós (ou outro desenvolvedor em nossa equipe) pode adicionar controles de Web de botão adicionais para o Repeater que, quando clicado, gera o mesmo `ItemCommand` manipulador de eventos.</span><span class="sxs-lookup"><span data-stu-id="99d37-280">While we currently only have one such LinkButton now, in the future we (or another developer on our team) might add additional button Web controls to the Repeater that, when clicked, raises the same `ItemCommand` event handler.</span></span> <span data-ttu-id="99d37-281">Portanto, ele s melhor sempre verifique se você o `CommandName` propriedade e que apenas prosseguir com sua lógica de programação se ele corresponde ao valor esperado.</span><span class="sxs-lookup"><span data-stu-id="99d37-281">Therefore, it s best to always make sure you check the `CommandName` property and only proceed with your programmatic logic if it matches up to the value expected.</span></span>

<span data-ttu-id="99d37-282">Depois de garantir que o passado `CommandName` ListProducts é igual a, o manipulador de eventos, em seguida, atribui o `CategoryProductsDataSource` s ObjectDataSource `CategoryID` parâmetro para o valor passado na `CommandArgument`.</span><span class="sxs-lookup"><span data-stu-id="99d37-282">After ensuring that the passed-in `CommandName` value equals ListProducts, the event handler then assigns the `CategoryProductsDataSource` ObjectDataSource s `CategoryID` parameter to the value of the passed-in `CommandArgument`.</span></span> <span data-ttu-id="99d37-283">Essa modificação no s ObjectDataSource `SelectParameters` automaticamente faz com que DataList reassociar próprio à fonte de dados, mostrando os produtos para a categoria selecionada recentemente.</span><span class="sxs-lookup"><span data-stu-id="99d37-283">This modification to the ObjectDataSource s `SelectParameters` automatically causes the DataList to rebind itself to the data source, showing the products for the newly selected category.</span></span>


[!code-csharp[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/samples/sample12.cs)]

<span data-ttu-id="99d37-284">Com essas adições, nosso tutorial está completo!</span><span class="sxs-lookup"><span data-stu-id="99d37-284">With these additions, our tutorial is complete!</span></span> <span data-ttu-id="99d37-285">Reserve um tempo para testá-lo em um navegador.</span><span class="sxs-lookup"><span data-stu-id="99d37-285">Take a moment to test it out in a browser.</span></span> <span data-ttu-id="99d37-286">Figura 14 mostra a tela quando o primeiro visitando a página.</span><span class="sxs-lookup"><span data-stu-id="99d37-286">Figure 14 shows the screen when first visiting the page.</span></span> <span data-ttu-id="99d37-287">Uma vez que uma categoria ainda deve ser selecionado, não há produtos são exibidos.</span><span class="sxs-lookup"><span data-stu-id="99d37-287">Since a category has yet to be selected, no products are displayed.</span></span> <span data-ttu-id="99d37-288">Clicar em uma categoria, como produzir, exibe os produtos na categoria de produto em uma exibição de duas colunas (veja a Figura 15).</span><span class="sxs-lookup"><span data-stu-id="99d37-288">Clicking on a category, such as Produce, displays those products in the Product category in a two-column view (see Figure 15).</span></span>


<span data-ttu-id="99d37-289">[![Nenhum produto é exibidas quando primeiro visitando a página](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image39.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image38.png)</span><span class="sxs-lookup"><span data-stu-id="99d37-289">[![No Products are Displayed When First Visiting the Page](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image39.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image38.png)</span></span>

<span data-ttu-id="99d37-290">**Figura 14**: os produtos não são exibidos quando primeiro visitando a página ([clique para exibir a imagem em tamanho normal](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image40.png))</span><span class="sxs-lookup"><span data-stu-id="99d37-290">**Figure 14**: No Products are Displayed When First Visiting the Page ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image40.png))</span></span>


<span data-ttu-id="99d37-291">[![Clicar em listas de categorias de produzir os produtos correspondentes à direita](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image42.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image41.png)</span><span class="sxs-lookup"><span data-stu-id="99d37-291">[![Clicking the Produce Category Lists the Matching Products to the Right](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image42.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image41.png)</span></span>

<span data-ttu-id="99d37-292">**Figura 15**: clicando na categoria de produzir lista os produtos de correspondência para a direita ([clique para exibir a imagem em tamanho normal](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image43.png))</span><span class="sxs-lookup"><span data-stu-id="99d37-292">**Figure 15**: Clicking the Produce Category Lists the Matching Products to the Right ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs/_static/image43.png))</span></span>


## <a name="summary"></a><span data-ttu-id="99d37-293">Resumo</span><span class="sxs-lookup"><span data-stu-id="99d37-293">Summary</span></span>

<span data-ttu-id="99d37-294">Como vimos neste tutorial e anterior, relatórios mestre/detalhes podem ser distribuídas em duas páginas ou consolidados em um.</span><span class="sxs-lookup"><span data-stu-id="99d37-294">As we saw in this tutorial and the preceding one, master/detail reports can be spread out across two pages, or consolidated on one.</span></span> <span data-ttu-id="99d37-295">Exibindo um relatório de detalhes/mestre em uma única página, no entanto, apresenta alguns desafios sobre como melhor layout mestre e registros de detalhes na página.</span><span class="sxs-lookup"><span data-stu-id="99d37-295">Displaying a master/details report on a single page, however, introduces some challenges on how best to layout the master and details records on the page.</span></span> <span data-ttu-id="99d37-296">No *mestre/detalhes usando um GridView mestre selecionável com um DetailsView detalhes* tutorial tínhamos os registros de detalhes são exibidos acima os registros mestres; neste tutorial, usamos as técnicas de CSS para ter o float registros mestre para o à esquerda dos detalhes.</span><span class="sxs-lookup"><span data-stu-id="99d37-296">In the *Master/Detail Using a Selectable Master GridView with a Details DetailsView* tutorial we had the details records appear above the master records; in this tutorial we used CSS techniques to have the master records float to the left of the details.</span></span>

<span data-ttu-id="99d37-297">Juntamente com exibindo relatórios de detalhes/mestre, também tivemos a oportunidade de explorar como recuperar o número de produtos associados com cada categoria, bem como executar a lógica do lado do servidor quando um LinkButton (ou botão ou ImageButton) é clicado de dentro um Repetidor.</span><span class="sxs-lookup"><span data-stu-id="99d37-297">Along with displaying master/details reports, we also had the opportunity to explore how to retrieve the number of products associated with each category as well as how to perform server-side logic when a LinkButton (or Button or ImageButton) is clicked from within a Repeater.</span></span>

<span data-ttu-id="99d37-298">Esse tutorial conclui nossa análise do relatórios mestre/detalhes com o DataList e Repeater.</span><span class="sxs-lookup"><span data-stu-id="99d37-298">This tutorial completes our examination of master/detail reports with the DataList and Repeater.</span></span> <span data-ttu-id="99d37-299">Nosso próximo conjunto de tutoriais ilustrará como adicionar, editar e excluir recursos para o controle DataList.</span><span class="sxs-lookup"><span data-stu-id="99d37-299">Our next set of tutorials will illustrate how to add editing and deleting capabilities to the DataList control.</span></span>

<span data-ttu-id="99d37-300">Boa programação!</span><span class="sxs-lookup"><span data-stu-id="99d37-300">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="99d37-301">Leitura adicional</span><span class="sxs-lookup"><span data-stu-id="99d37-301">Further Reading</span></span>

<span data-ttu-id="99d37-302">Para obter mais informações sobre os tópicos abordados neste tutorial, consulte os seguintes recursos:</span><span class="sxs-lookup"><span data-stu-id="99d37-302">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- <span data-ttu-id="99d37-303">[Floatutorial](http://css.maxdesign.com.au/floatutorial/) um tutorial sobre flutuante elementos CSS com CSS</span><span class="sxs-lookup"><span data-stu-id="99d37-303">[Floatutorial](http://css.maxdesign.com.au/floatutorial/) a tutorial on floating CSS elements with CSS</span></span>
- <span data-ttu-id="99d37-304">[O posicionamento de CSS](http://www.brainjar.com/css/positioning/) obter mais informações sobre o posicionamento de elementos com CSS</span><span class="sxs-lookup"><span data-stu-id="99d37-304">[CSS Positioning](http://www.brainjar.com/css/positioning/) more information on positioning elements with CSS</span></span>
- <span data-ttu-id="99d37-305">[Definindo o layout Out conteúdo com HTML](http://www.w3schools.com/html/html_layout.asp) usando `<table>` s e outros elementos HTML para posicionamento</span><span class="sxs-lookup"><span data-stu-id="99d37-305">[Laying Out Content with HTML](http://www.w3schools.com/html/html_layout.asp) using `<table>` s and other HTML elements for positioning</span></span>

## <a name="about-the-author"></a><span data-ttu-id="99d37-306">Sobre o autor</span><span class="sxs-lookup"><span data-stu-id="99d37-306">About the Author</span></span>

<span data-ttu-id="99d37-307">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de sete livros sobre ASP/ASP.NET e fundador da [4GuysFromRolla.com](http://www.4guysfromrolla.com), tem trabalhado com tecnologias Microsoft Web desde 1998.</span><span class="sxs-lookup"><span data-stu-id="99d37-307">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="99d37-308">Scott funciona como um consultor independente, instrutor e escritor.</span><span class="sxs-lookup"><span data-stu-id="99d37-308">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="99d37-309">Seu livro mais recente é [ *Sams Teach por conta própria ASP.NET 2.0 em 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="99d37-309">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="99d37-310">Ele pode ser contatado pelo [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="99d37-310">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="99d37-311">ou por meio de seu blog, que pode ser encontrado em [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="99d37-311">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="99d37-312">Agradecimentos especiais a</span><span class="sxs-lookup"><span data-stu-id="99d37-312">Special Thanks To</span></span>

<span data-ttu-id="99d37-313">Esta série de tutoriais foi revisada por muitos revisores úteis.</span><span class="sxs-lookup"><span data-stu-id="99d37-313">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="99d37-314">Revisor de avanço para este tutorial foi Zack Jones.</span><span class="sxs-lookup"><span data-stu-id="99d37-314">Lead reviewer for this tutorial was Zack Jones.</span></span> <span data-ttu-id="99d37-315">Você está interessado na revisão Meus próximos artigos do MSDN?</span><span class="sxs-lookup"><span data-stu-id="99d37-315">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="99d37-316">Nesse caso, me descartar uma linha na [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="99d37-316">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="99d37-317">[Anterior](master-detail-filtering-acess-two-pages-datalist-cs.md)
> [Próximo](master-detail-filtering-with-a-dropdownlist-datalist-vb.md)</span><span class="sxs-lookup"><span data-stu-id="99d37-317">[Previous](master-detail-filtering-acess-two-pages-datalist-cs.md)
[Next](master-detail-filtering-with-a-dropdownlist-datalist-vb.md)</span></span>

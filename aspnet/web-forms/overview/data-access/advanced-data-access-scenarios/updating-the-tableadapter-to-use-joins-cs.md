---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/updating-the-tableadapter-to-use-joins-cs
title: Atualizando o TableAdapter para usar JOINs (c#) | Microsoft Docs
author: rick-anderson
description: Ao trabalhar com um banco de dados é comum para solicitar os dados são distribuídos entre várias tabelas. Para recuperar dados de duas tabelas diferentes, pode usar qualquer um...
ms.author: aspnetcontent
ms.date: 07/18/2007
ms.assetid: 675531a7-cb54-4dd6-89ac-2636e4c285a5
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/updating-the-tableadapter-to-use-joins-cs
msc.type: authoredcontent
ms.openlocfilehash: c59ab13eb5e5e548055c6c8c9343a8d5c4cabe7d
ms.sourcegitcommit: b28cd0313af316c051c2ff8549865bff67f2fbb4
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 07/05/2018
ms.locfileid: "37841115"
---
<a name="updating-the-tableadapter-to-use-joins-c"></a><span data-ttu-id="25f09-104">Atualizando o TableAdapter para usar JOINs (c#)</span><span class="sxs-lookup"><span data-stu-id="25f09-104">Updating the TableAdapter to Use JOINs (C#)</span></span>
====================
<span data-ttu-id="25f09-105">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="25f09-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="25f09-106">[Baixar o código](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_69_CS.zip) ou [baixar PDF](updating-the-tableadapter-to-use-joins-cs/_static/datatutorial69cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="25f09-106">[Download Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_69_CS.zip) or [Download PDF](updating-the-tableadapter-to-use-joins-cs/_static/datatutorial69cs1.pdf)</span></span>

> <span data-ttu-id="25f09-107">Ao trabalhar com um banco de dados é comum para solicitar os dados são distribuídos entre várias tabelas.</span><span class="sxs-lookup"><span data-stu-id="25f09-107">When working with a database it is common to request data that is spread across multiple tables.</span></span> <span data-ttu-id="25f09-108">Para recuperar dados de duas tabelas diferentes, pode usar uma subconsulta correlacionada ou uma operação de junção.</span><span class="sxs-lookup"><span data-stu-id="25f09-108">To retrieve data from two different tables we can use either a correlated subquery or a JOIN operation.</span></span> <span data-ttu-id="25f09-109">Neste tutorial comparamos subconsultas correlacionadas e a sintaxe de junção antes de examinar como criar um TableAdapter que inclui uma junção em sua consulta principal.</span><span class="sxs-lookup"><span data-stu-id="25f09-109">In this tutorial we compare correlated subqueries and the JOIN syntax before looking at how to create a TableAdapter that includes a JOIN in its main query.</span></span>


## <a name="introduction"></a><span data-ttu-id="25f09-110">Introdução</span><span class="sxs-lookup"><span data-stu-id="25f09-110">Introduction</span></span>

<span data-ttu-id="25f09-111">Com bancos de dados relacionais os dados que estamos interessados em trabalhar com muitas vezes são distribuídos em várias tabelas.</span><span class="sxs-lookup"><span data-stu-id="25f09-111">With relational databases the data we are interested in working with is often spread across multiple tables.</span></span> <span data-ttu-id="25f09-112">Por exemplo, ao exibir as informações de produto provavelmente queremos listar cada categoria do produto s correspondente e nomes de s do fornecedor.</span><span class="sxs-lookup"><span data-stu-id="25f09-112">For example, when displaying product information we likely want to list each product s corresponding category and supplier s names.</span></span> <span data-ttu-id="25f09-113">O `Products` a tabela tem `CategoryID` e `SupplierID` valores, mas os nomes de categoria e fornecedor reais estão no `Categories` e `Suppliers` tabelas, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="25f09-113">The `Products` table has `CategoryID` and `SupplierID` values, but the actual category and supplier names are in the `Categories` and `Suppliers` tables, respectively.</span></span>

<span data-ttu-id="25f09-114">Para recuperar informações de outra tabela relacionada, podemos pode usar *subconsultas correlacionadas* ou `JOIN` *s*.</span><span class="sxs-lookup"><span data-stu-id="25f09-114">To retrieve information from another, related table, we can either use *correlated subqueries* or `JOIN`*s*.</span></span> <span data-ttu-id="25f09-115">Uma subconsulta correlacionada é aninhado `SELECT` consulta que faz referência a colunas na consulta externa.</span><span class="sxs-lookup"><span data-stu-id="25f09-115">A correlated subquery is a nested `SELECT` query that references columns in the outer query.</span></span> <span data-ttu-id="25f09-116">Por exemplo, nos [criando uma camada de acesso de dados](../introduction/creating-a-data-access-layer-cs.md) tutorial, usamos duas subconsultas correlacionadas no `ProductsTableAdapter` a consulta principal s para retornar os nomes de categoria e fornecedor para cada produto.</span><span class="sxs-lookup"><span data-stu-id="25f09-116">For example, in the [Creating a Data Access Layer](../introduction/creating-a-data-access-layer-cs.md) tutorial we used two correlated subqueries in the `ProductsTableAdapter` s main query to return the category and supplier names for each product.</span></span> <span data-ttu-id="25f09-117">Um `JOIN` é uma construção SQL que mescla as linhas relacionadas de duas tabelas diferentes.</span><span class="sxs-lookup"><span data-stu-id="25f09-117">A `JOIN` is a SQL construct that merges related rows from two different tables.</span></span> <span data-ttu-id="25f09-118">Usamos uma `JOIN` no [consultando dados com o controle SqlDataSource](../accessing-the-database-directly-from-an-aspnet-page/querying-data-with-the-sqldatasource-control-cs.md) tutorial para exibir informações de categoria ao lado de cada produto.</span><span class="sxs-lookup"><span data-stu-id="25f09-118">We used a `JOIN` in the [Querying Data with the SqlDataSource Control](../accessing-the-database-directly-from-an-aspnet-page/querying-data-with-the-sqldatasource-control-cs.md) tutorial to display category information alongside each product.</span></span>

<span data-ttu-id="25f09-119">O motivo pelo qual podemos ter abstenção usem `JOIN` s com os TableAdapters é devido às limitações no Assistente para gerar automaticamente correspondente s TableAdapter `INSERT`, `UPDATE`, e `DELETE` instruções.</span><span class="sxs-lookup"><span data-stu-id="25f09-119">The reason we have abstained from using `JOIN` s with the TableAdapters is because of limitations in the TableAdapter s wizard to auto-generate corresponding `INSERT`, `UPDATE`, and `DELETE` statements.</span></span> <span data-ttu-id="25f09-120">Mais especificamente, se a consulta principal do TableAdapter s contiver quaisquer `JOIN` s, o TableAdapter não é possível criar automaticamente as instruções SQL ad hoc ou procedimentos armazenados para seus `InsertCommand`, `UpdateCommand`, e `DeleteCommand` propriedades.</span><span class="sxs-lookup"><span data-stu-id="25f09-120">More specifically, if the TableAdapter s main query contains any `JOIN` s, the TableAdapter cannot auto-create the ad-hoc SQL statements or stored procedures for its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties.</span></span>

<span data-ttu-id="25f09-121">Neste tutorial, vamos comparar rapidamente e contraste subconsultas correlacionadas e `JOIN` s antes de explorar como criar um TableAdapter que inclui `JOIN` s em sua consulta principal.</span><span class="sxs-lookup"><span data-stu-id="25f09-121">In this tutorial we will briefly compare and contrast correlated subqueries and `JOIN` s before exploring how to create a TableAdapter that includes `JOIN` s in its main query.</span></span>

## <a name="comparing-and-contrasting-correlated-subqueries-andjoin-s"></a><span data-ttu-id="25f09-122">Subconsultas correlacionadas de comparar e contrastar e`JOIN` s</span><span class="sxs-lookup"><span data-stu-id="25f09-122">Comparing and Contrasting Correlated Subqueries and`JOIN` s</span></span>

<span data-ttu-id="25f09-123">Lembre-se de que o `ProductsTableAdapter` criado no primeiro tutorial de `Northwind` subconsultas correlacionadas usa o conjunto de dados para trazer de volta cada nome de categoria e fornecedor de correspondente do produto s.</span><span class="sxs-lookup"><span data-stu-id="25f09-123">Recall that the `ProductsTableAdapter` created in the first tutorial in the `Northwind` DataSet uses correlated subqueries to bring back each product s corresponding category and supplier name.</span></span> <span data-ttu-id="25f09-124">O `ProductsTableAdapter` consulta principal de s é mostrada abaixo.</span><span class="sxs-lookup"><span data-stu-id="25f09-124">The `ProductsTableAdapter` s main query is shown below.</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample1.sql)]

<span data-ttu-id="25f09-125">Os dois correlacionados subconsultas - `(SELECT CategoryName FROM Categories WHERE Categories.CategoryID = Products.CategoryID)` e `(SELECT CompanyName FROM Suppliers WHERE Suppliers.SupplierID = Products.SupplierID)` -são `SELECT` consultas que retornam um valor único por produto como uma coluna adicional no externo `SELECT` lista de colunas da instrução s.</span><span class="sxs-lookup"><span data-stu-id="25f09-125">The two correlated subqueries - `(SELECT CategoryName FROM Categories WHERE Categories.CategoryID = Products.CategoryID)` and `(SELECT CompanyName FROM Suppliers WHERE Suppliers.SupplierID = Products.SupplierID)` - are `SELECT` queries that return a single value per product as an additional column in the outer `SELECT` statement s column list.</span></span>

<span data-ttu-id="25f09-126">Como alternativa, um `JOIN` pode ser usado para retornar cada nome de fornecedor e a categoria de produto s.</span><span class="sxs-lookup"><span data-stu-id="25f09-126">Alternatively, a `JOIN` can be used to return each product s supplier and category name.</span></span> <span data-ttu-id="25f09-127">A consulta a seguir retorna as mesmas saída que aquele acima, mas usa `JOIN` s em vez de subconsultas:</span><span class="sxs-lookup"><span data-stu-id="25f09-127">The following query returns the same output as the above one, but uses `JOIN` s in place of subqueries:</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample2.sql)]

<span data-ttu-id="25f09-128">Um `JOIN` mescla os registros de uma tabela com registros de outra tabela com base em alguns critérios.</span><span class="sxs-lookup"><span data-stu-id="25f09-128">A `JOIN` merges the records from one table with records from another table based on some criteria.</span></span> <span data-ttu-id="25f09-129">Na consulta acima, por exemplo, o `LEFT JOIN Categories ON Categories.CategoryID = Products.CategoryID` instrui o SQL Server para mesclar cada registro de produto com a categoria registre cuja `CategoryID` valor corresponde ao produto s `CategoryID` valor.</span><span class="sxs-lookup"><span data-stu-id="25f09-129">In the above query, for example, the `LEFT JOIN Categories ON Categories.CategoryID = Products.CategoryID` instructs SQL Server to merge each product record with the category record whose `CategoryID` value matches the product s `CategoryID` value.</span></span> <span data-ttu-id="25f09-130">O resultado mesclado nos permite trabalhar com os campos de categoria correspondente para cada produto (como `CategoryName`).</span><span class="sxs-lookup"><span data-stu-id="25f09-130">The merged result allows us to work with the corresponding category fields for each product (such as `CategoryName`).</span></span>

> [!NOTE]
> <span data-ttu-id="25f09-131">`JOIN` s são usadas ao consultar dados de bancos de dados relacionais.</span><span class="sxs-lookup"><span data-stu-id="25f09-131">`JOIN` s are commonly used when querying data from relational databases.</span></span> <span data-ttu-id="25f09-132">Se você estiver familiarizado com o `JOIN` sintaxe ou necessidade para falar um pouco sobre seu uso, d recomendo o [tutorial SQL Join](http://www.w3schools.com/sql/sql_join.asp) na [W3 escolas](http://www.w3schools.com/).</span><span class="sxs-lookup"><span data-stu-id="25f09-132">If you are new to the `JOIN` syntax or need to brush up a bit on its usage, I d recommend the [SQL Join tutorial](http://www.w3schools.com/sql/sql_join.asp) at [W3 Schools](http://www.w3schools.com/).</span></span> <span data-ttu-id="25f09-133">Também vale a pena ler são os [ `JOIN` fundamentos](https://msdn.microsoft.com/library/ms191517.aspx) e [conceitos básicos de subconsulta](https://msdn.microsoft.com/library/ms189575.aspx) seções do [Manuais Online do SQL](https://msdn.microsoft.com/library/ms130214.aspx).</span><span class="sxs-lookup"><span data-stu-id="25f09-133">Also worth reading are the [`JOIN` Fundamentals](https://msdn.microsoft.com/library/ms191517.aspx) and [Subquery Fundamentals](https://msdn.microsoft.com/library/ms189575.aspx) sections of the [SQL Books Online](https://msdn.microsoft.com/library/ms130214.aspx).</span></span>


<span data-ttu-id="25f09-134">Uma vez que `JOIN` s e subconsultas correlacionadas podem ser usadas para recuperar dados relacionados de outras tabelas, muitos desenvolvedores são deixados uma pequena de cabeça e imaginando qual abordagem usar.</span><span class="sxs-lookup"><span data-stu-id="25f09-134">Since `JOIN` s and correlated subqueries can both be used to retrieve related data from other tables, many developers are left scratching their heads and wondering which approach to use.</span></span> <span data-ttu-id="25f09-135">Todos as especialistas em SQL eu ve falou disseram aproximadamente a mesma coisa, que ele t importava em termos de desempenho como o SQL Server irá gerar planos de execução aproximadamente idênticos.</span><span class="sxs-lookup"><span data-stu-id="25f09-135">All of the SQL gurus I ve talked to have said roughly the same thing, that it doesn t really matter performance-wise as SQL Server will produce roughly identical execution plans.</span></span> <span data-ttu-id="25f09-136">Seu conselho, em seguida, é usar a técnica que você e sua equipe estão mais familiarizados.</span><span class="sxs-lookup"><span data-stu-id="25f09-136">Their advice, then, is to use the technique that you and your team are most comfortable with.</span></span> <span data-ttu-id="25f09-137">Ele merece observar que após dar esse conselho esses especialistas imediatamente expressam suas preferências de `JOIN` s sobre subconsultas correlacionadas.</span><span class="sxs-lookup"><span data-stu-id="25f09-137">It merits noting that after imparting this advice these experts immediately express their preference of `JOIN` s over correlated subqueries.</span></span>

<span data-ttu-id="25f09-138">Ao criar uma camada de acesso a dados usando conjuntos de dados tipados, as ferramentas funcionam melhor quando o uso de subconsultas.</span><span class="sxs-lookup"><span data-stu-id="25f09-138">When building a Data Access Layer using Typed DataSets, the tools work better when using subqueries.</span></span> <span data-ttu-id="25f09-139">Em particular, o Assistente de s TableAdapter não gerará automaticamente correspondente `INSERT`, `UPDATE`, e `DELETE` instruções se a consulta principal contiver quaisquer `JOIN` s, mas irá gerar automaticamente essas instruções quando correlacionadas subconsultas são usados.</span><span class="sxs-lookup"><span data-stu-id="25f09-139">In particular, the TableAdapter s wizard will not auto-generate corresponding `INSERT`, `UPDATE`, and `DELETE` statements if the main query contains any `JOIN` s, but will auto-generate these statements when correlated subqueries are used.</span></span>

<span data-ttu-id="25f09-140">Para explorar essa deficiência, crie um conjunto de dados tipado temporário no `~/App_Code/DAL` pasta.</span><span class="sxs-lookup"><span data-stu-id="25f09-140">To explore this shortcoming, create a temporary Typed DataSet in the `~/App_Code/DAL` folder.</span></span> <span data-ttu-id="25f09-141">Durante o Assistente de configuração do TableAdapter, optar por usar instruções SQL ad hoc e insira o seguinte `SELECT` consulta (consulte a Figura 1):</span><span class="sxs-lookup"><span data-stu-id="25f09-141">During the TableAdapter Configuration wizard, choose to use ad-hoc SQL statements and enter the following `SELECT` query (see Figure 1):</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample3.sql)]


<span data-ttu-id="25f09-142">[![Insira uma consulta principal que contém associações](updating-the-tableadapter-to-use-joins-cs/_static/image2.png)](updating-the-tableadapter-to-use-joins-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="25f09-142">[![Enter a Main Query that Contains JOINs](updating-the-tableadapter-to-use-joins-cs/_static/image2.png)](updating-the-tableadapter-to-use-joins-cs/_static/image1.png)</span></span>

<span data-ttu-id="25f09-143">**Figura 1**: insira uma consulta principal que contém `JOIN` s ([clique para exibir a imagem em tamanho normal](updating-the-tableadapter-to-use-joins-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="25f09-143">**Figure 1**: Enter a Main Query that Contains `JOIN` s ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image3.png))</span></span>


<span data-ttu-id="25f09-144">Por padrão, o TableAdapter automaticamente criará `INSERT`, `UPDATE`, e `DELETE` instruções com base em consulta principal.</span><span class="sxs-lookup"><span data-stu-id="25f09-144">By default, the TableAdapter will automatically create `INSERT`, `UPDATE`, and `DELETE` statements based on the main query.</span></span> <span data-ttu-id="25f09-145">Se você clicar no botão Avançado, que você pode ver que esse recurso está habilitado.</span><span class="sxs-lookup"><span data-stu-id="25f09-145">If you click the Advanced button you can see that this feature is enabled.</span></span> <span data-ttu-id="25f09-146">Apesar dessa configuração, o TableAdapter não será possível criar o `INSERT`, `UPDATE`, e `DELETE` instruções porque a consulta principal contém um `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="25f09-146">Despite this setting, the TableAdapter will not be able to create the `INSERT`, `UPDATE`, and `DELETE` statements because the main query contains a `JOIN`.</span></span>


![Insira uma consulta principal que contém associações](updating-the-tableadapter-to-use-joins-cs/_static/image4.png)

<span data-ttu-id="25f09-148">**Figura 2**: insira uma consulta principal que contém `JOIN` s</span><span class="sxs-lookup"><span data-stu-id="25f09-148">**Figure 2**: Enter a Main Query that Contains `JOIN` s</span></span>


<span data-ttu-id="25f09-149">Clique em Concluir para concluir o assistente.</span><span class="sxs-lookup"><span data-stu-id="25f09-149">Click Finish to complete the wizard.</span></span> <span data-ttu-id="25f09-150">Neste ponto seu Designer de s do conjunto de dados incluirá um único TableAdapter com uma DataTable com colunas para cada um dos campos retornados no `SELECT` lista de colunas de consulta s.</span><span class="sxs-lookup"><span data-stu-id="25f09-150">At this point your DataSet s Designer will include a single TableAdapter with a DataTable with columns for each of the fields returned in the `SELECT` query s column list.</span></span> <span data-ttu-id="25f09-151">Isso inclui o `CategoryName` e `SupplierName`, como mostra a Figura 3.</span><span class="sxs-lookup"><span data-stu-id="25f09-151">This includes the `CategoryName` and `SupplierName`, as Figure 3 shows.</span></span>


![A DataTable inclui uma coluna para cada campo retornado na lista de colunas](updating-the-tableadapter-to-use-joins-cs/_static/image5.png)

<span data-ttu-id="25f09-153">**Figura 3**: DataTable inclui uma coluna para cada campo retornado na lista de colunas</span><span class="sxs-lookup"><span data-stu-id="25f09-153">**Figure 3**: The DataTable Includes a Column for Each Field Returned in the Column List</span></span>


<span data-ttu-id="25f09-154">Enquanto a DataTable tem as colunas apropriadas, o TableAdapter não possui valores para seus `InsertCommand`, `UpdateCommand`, e `DeleteCommand` propriedades.</span><span class="sxs-lookup"><span data-stu-id="25f09-154">While the DataTable has the appropriate columns, the TableAdapter lacks values for its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties.</span></span> <span data-ttu-id="25f09-155">Para confirmar isso, clique no TableAdapter no Designer e, em seguida, vá para a janela de propriedades.</span><span class="sxs-lookup"><span data-stu-id="25f09-155">To confirm this, click on the TableAdapter in the Designer and then go to the Properties window.</span></span> <span data-ttu-id="25f09-156">Lá você verá que o `InsertCommand`, `UpdateCommand`, e `DeleteCommand` propriedades são definidas como (nenhum).</span><span class="sxs-lookup"><span data-stu-id="25f09-156">There you will see that the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties are set to (None) .</span></span>


<span data-ttu-id="25f09-157">[![O InsertCommand, UpdateCommand e DeleteCommand propriedades são definidas como (nenhum)](updating-the-tableadapter-to-use-joins-cs/_static/image7.png)](updating-the-tableadapter-to-use-joins-cs/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="25f09-157">[![The InsertCommand, UpdateCommand, and DeleteCommand Properties are Set to (None)](updating-the-tableadapter-to-use-joins-cs/_static/image7.png)](updating-the-tableadapter-to-use-joins-cs/_static/image6.png)</span></span>

<span data-ttu-id="25f09-158">**Figura 4**: O `InsertCommand`, `UpdateCommand`, e `DeleteCommand` propriedades são definidas como (nenhum) ([clique para exibir a imagem em tamanho normal](updating-the-tableadapter-to-use-joins-cs/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="25f09-158">**Figure 4**: The `InsertCommand`, `UpdateCommand`, and `DeleteCommand` Properties are Set to (None) ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image8.png))</span></span>


<span data-ttu-id="25f09-159">Para contornar essa deficiência, podemos pode fornecer manualmente as instruções SQL e os parâmetros para o `InsertCommand`, `UpdateCommand`, e `DeleteCommand` propriedades por meio da janela Propriedades.</span><span class="sxs-lookup"><span data-stu-id="25f09-159">To work around this shortcoming, we can manually provide the SQL statements and parameters for the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties via the Properties window.</span></span> <span data-ttu-id="25f09-160">Como alternativa, podemos poderia começar configurando a consulta principal do TableAdapter s para *não* incluir qualquer `JOIN` s.</span><span class="sxs-lookup"><span data-stu-id="25f09-160">Alternatively, we could start by configuring the TableAdapter s main query to *not* include any `JOIN` s.</span></span> <span data-ttu-id="25f09-161">Isso permitirá que o `INSERT`, `UPDATE`, e `DELETE` instruções para ser gerado automaticamente para nós.</span><span class="sxs-lookup"><span data-stu-id="25f09-161">This will allow the `INSERT`, `UPDATE`, and `DELETE` statements to be auto-generated for us.</span></span> <span data-ttu-id="25f09-162">Depois de concluir o assistente, podemos pode, em seguida, atualizar manualmente o TableAdapter s `SelectCommand` na janela Propriedades para que ela inclua o `JOIN` sintaxe.</span><span class="sxs-lookup"><span data-stu-id="25f09-162">After completing the wizard, we could then manually update the TableAdapter s `SelectCommand` from the Properties window so that it includes the `JOIN` syntax.</span></span>

<span data-ttu-id="25f09-163">Embora essa abordagem funciona, é muito frágil ao usar consultas SQL ad hoc porque sempre que a consulta principal do TableAdapter s é configurado novamente por meio do assistente, geradas automaticamente `INSERT`, `UPDATE`, e `DELETE` instruções são recriadas.</span><span class="sxs-lookup"><span data-stu-id="25f09-163">While this approach works, it is very brittle when using ad-hoc SQL queries because any time the TableAdapter s main query is re-configured through the wizard, the auto-generated `INSERT`, `UPDATE`, and `DELETE` statements are recreated.</span></span> <span data-ttu-id="25f09-164">Isso significa que todas as personalizações feitas posteriormente seriam perdidas se podemos pequeno no TableAdapter, escolher configurar o menu de contexto e concluir o assistente novamente.</span><span class="sxs-lookup"><span data-stu-id="25f09-164">That means all of the customizations we later made would be lost if we right-clicked on the TableAdapter, chose Configure from the context menu, and completed the wizard again.</span></span>

<span data-ttu-id="25f09-165">Fragilidade da s TableAdapter geradas automaticamente `INSERT`, `UPDATE`, e `DELETE` instruções for, Felizmente, limitado a instruções SQL ad hoc.</span><span class="sxs-lookup"><span data-stu-id="25f09-165">The brittleness of the TableAdapter s auto-generated `INSERT`, `UPDATE`, and `DELETE` statements is, fortunately, limited to ad-hoc SQL statements.</span></span> <span data-ttu-id="25f09-166">Se seu TableAdapter usa procedimentos armazenados, você pode personalizar o `SelectCommand`, `InsertCommand`, `UpdateCommand`, ou `DeleteCommand` procedimentos armazenados e execute novamente o Assistente de configuração do TableAdapter sem ter que temem que serão os procedimentos armazenados modificado.</span><span class="sxs-lookup"><span data-stu-id="25f09-166">If your TableAdapter uses stored procedures, you can customize the `SelectCommand`, `InsertCommand`, `UpdateCommand`, or `DeleteCommand` stored procedures and re-run the TableAdapter Configuration wizard without having to fear that the stored procedures will be modified.</span></span>

<span data-ttu-id="25f09-167">Ao longo dos próximos várias etapas, criaremos um TableAdapter que, inicialmente, usa uma consulta principal que omite qualquer `JOIN` s, de modo que correspondente inserir, atualizar e procedimentos armazenado de exclusão será gerado automaticamente.</span><span class="sxs-lookup"><span data-stu-id="25f09-167">Over the next several steps we will create a TableAdapter that, initially, uses a main query that omits any `JOIN` s so that the corresponding insert, update, and delete stored procedures will be auto-generated.</span></span> <span data-ttu-id="25f09-168">Em seguida, atualizaremos o `SelectCommand` assim que usa um `JOIN` que retorna mais colunas de tabelas relacionadas.</span><span class="sxs-lookup"><span data-stu-id="25f09-168">We will then update the `SelectCommand` so that uses a `JOIN` that returns additional columns from related tables.</span></span> <span data-ttu-id="25f09-169">Por fim, vamos criar uma classe de camada de lógica comercial correspondente e demonstram como usar o TableAdapter em uma página da web ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="25f09-169">Finally, we'll create a corresponding Business Logic Layer class and demonstrate using the TableAdapter in an ASP.NET web page.</span></span>

## <a name="step-1-creating-the-tableadapter-using-a-simplified-main-query"></a><span data-ttu-id="25f09-170">Etapa 1: Criar o TableAdapter usando uma consulta principal simplificada</span><span class="sxs-lookup"><span data-stu-id="25f09-170">Step 1: Creating the TableAdapter Using a Simplified Main Query</span></span>

<span data-ttu-id="25f09-171">Para este tutorial, adicionaremos um TableAdapter e uma DataTable fortemente tipada para o `Employees` na tabela a `NorthwindWithSprocs` conjunto de dados.</span><span class="sxs-lookup"><span data-stu-id="25f09-171">For this tutorial we will add a TableAdapter and strongly-typed DataTable for the `Employees` table in the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="25f09-172">O `Employees` tabela contém uma `ReportsTo` campo que especificou o `EmployeeID` do gerente do funcionário s.</span><span class="sxs-lookup"><span data-stu-id="25f09-172">The `Employees` table contains a `ReportsTo` field that specified the `EmployeeID` of the employee s manager.</span></span> <span data-ttu-id="25f09-173">Por exemplo, o funcionário Anne Dodsworth tem um `ReportTo` valor de 5, que é o `EmployeeID` de Steven Buchanan.</span><span class="sxs-lookup"><span data-stu-id="25f09-173">For example, employee Anne Dodsworth has a `ReportTo` value of 5, which is the `EmployeeID` of Steven Buchanan.</span></span> <span data-ttu-id="25f09-174">Consequentemente, Anne reporta a Steven, seu gerente.</span><span class="sxs-lookup"><span data-stu-id="25f09-174">Consequently, Anne reports to Steven, her manager.</span></span> <span data-ttu-id="25f09-175">Juntamente com relatórios de cada funcionário s `ReportsTo` valor, também queremos recuperar o nome do seu gerente.</span><span class="sxs-lookup"><span data-stu-id="25f09-175">Along with reporting each employee s `ReportsTo` value, we might also want to retrieve the name of their manager.</span></span> <span data-ttu-id="25f09-176">Isso pode ser feito usando um `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="25f09-176">This can be accomplished using a `JOIN`.</span></span> <span data-ttu-id="25f09-177">Mas o uso um `JOIN` quando criar inicialmente o TableAdapter impede o Assistente de geração automática de inserção correspondente, atualizar e excluir recursos.</span><span class="sxs-lookup"><span data-stu-id="25f09-177">But using a `JOIN` when initially creating the TableAdapter precludes the wizard from automatically generating the corresponding insert, update, and delete capabilities.</span></span> <span data-ttu-id="25f09-178">Portanto, vamos começar criando um TableAdapter cuja consulta principal não contém nenhum `JOIN` s.</span><span class="sxs-lookup"><span data-stu-id="25f09-178">Therefore, we will start by creating a TableAdapter whose main query does not contain any `JOIN` s.</span></span> <span data-ttu-id="25f09-179">Em seguida, na etapa 2, atualizaremos o procedimento armazenado de consulta principal para recuperar o nome do gerente s por meio de um `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="25f09-179">Then, in Step 2, we will update the main query stored procedure to retrieve the manager s name via a `JOIN`.</span></span>

<span data-ttu-id="25f09-180">Comece abrindo o `NorthwindWithSprocs` conjunto de dados a `~/App_Code/DAL` pasta.</span><span class="sxs-lookup"><span data-stu-id="25f09-180">Start by opening the `NorthwindWithSprocs` DataSet in the `~/App_Code/DAL` folder.</span></span> <span data-ttu-id="25f09-181">Com o botão direito no Designer, selecione a opção Adicionar no menu de contexto e escolha o item de menu do TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="25f09-181">Right-click on the Designer, select the Add option from the context menu, and pick the TableAdapter menu item.</span></span> <span data-ttu-id="25f09-182">Isso iniciará o Assistente de configuração do TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="25f09-182">This will launch the TableAdapter Configuration wizard.</span></span> <span data-ttu-id="25f09-183">Conforme mostra a Figura 5, que o assistente criar novos procedimentos armazenados e clique em Avançar.</span><span class="sxs-lookup"><span data-stu-id="25f09-183">As Figure 5 depicts, have the wizard create new stored procedures and click Next.</span></span> <span data-ttu-id="25f09-184">Para relembrar criando novos procedimentos do Assistente de s TableAdapter de armazenados, consulte o [criando novos procedimentos armazenados para o s TableAdapters do conjunto de dados tipado](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) tutorial.</span><span class="sxs-lookup"><span data-stu-id="25f09-184">For a refresher on creating new stored procedures from the TableAdapter s wizard, consult the [Creating New Stored Procedures for the Typed DataSet s TableAdapters](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) tutorial.</span></span>


<span data-ttu-id="25f09-185">[![Selecione os procedimentos armazenados nova opção de criar](updating-the-tableadapter-to-use-joins-cs/_static/image10.png)](updating-the-tableadapter-to-use-joins-cs/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="25f09-185">[![Select the Create new stored procedures Option](updating-the-tableadapter-to-use-joins-cs/_static/image10.png)](updating-the-tableadapter-to-use-joins-cs/_static/image9.png)</span></span>

<span data-ttu-id="25f09-186">**Figura 5**: selecione Criar novo armazenados procedimentos opção ([clique para exibir a imagem em tamanho normal](updating-the-tableadapter-to-use-joins-cs/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="25f09-186">**Figure 5**: Select the Create new stored procedures Option ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image11.png))</span></span>


<span data-ttu-id="25f09-187">Use o seguinte `SELECT` instrução da consulta principal do TableAdapter s:</span><span class="sxs-lookup"><span data-stu-id="25f09-187">Use the following `SELECT` statement for the TableAdapter s main query:</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample4.sql)]

<span data-ttu-id="25f09-188">Uma vez que essa consulta não inclui nenhum `JOIN` s, o TableAdapter assistente criará automaticamente os procedimentos armazenados com correspondente `INSERT`, `UPDATE`, e `DELETE` instruções, bem como um procedimento armazenado para a execução de principal consulta.</span><span class="sxs-lookup"><span data-stu-id="25f09-188">Since this query does not include any `JOIN` s, the TableAdapter wizard will automatically create stored procedures with corresponding `INSERT`, `UPDATE`, and `DELETE` statements, as well as a stored procedure for executing the main query.</span></span>

<span data-ttu-id="25f09-189">A seguinte etapa nos permite nomear os procedimentos de s armazenados TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="25f09-189">The following step allows us to name the TableAdapter s stored procedures.</span></span> <span data-ttu-id="25f09-190">Use os nomes `Employees_Select`, `Employees_Insert`, `Employees_Update`, e `Employees_Delete`, conforme mostrado na Figura 6.</span><span class="sxs-lookup"><span data-stu-id="25f09-190">Use the names `Employees_Select`, `Employees_Insert`, `Employees_Update`, and `Employees_Delete`, as shown in Figure 6.</span></span>


<span data-ttu-id="25f09-191">[![Os procedimentos do TableAdapter s armazenados de nome](updating-the-tableadapter-to-use-joins-cs/_static/image13.png)](updating-the-tableadapter-to-use-joins-cs/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="25f09-191">[![Name the TableAdapter s Stored Procedures](updating-the-tableadapter-to-use-joins-cs/_static/image13.png)](updating-the-tableadapter-to-use-joins-cs/_static/image12.png)</span></span>

<span data-ttu-id="25f09-192">**Figura 6**: nomear os procedimentos armazenados do TableAdapter s ([clique para exibir a imagem em tamanho normal](updating-the-tableadapter-to-use-joins-cs/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="25f09-192">**Figure 6**: Name the TableAdapter s Stored Procedures ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image14.png))</span></span>


<span data-ttu-id="25f09-193">A etapa final nos solicita para nomear os métodos do TableAdapter s.</span><span class="sxs-lookup"><span data-stu-id="25f09-193">The final step prompts us to name the TableAdapter s methods.</span></span> <span data-ttu-id="25f09-194">Use `Fill` e `GetEmployees` como os nomes de método.</span><span class="sxs-lookup"><span data-stu-id="25f09-194">Use `Fill` and `GetEmployees` as the method names.</span></span> <span data-ttu-id="25f09-195">Também Certifique-se de deixar os crie métodos para enviar atualizações diretamente para a caixa de seleção de banco de dados (GenerateDBDirectMethods) marcada.</span><span class="sxs-lookup"><span data-stu-id="25f09-195">Also be sure to leave the Create methods to send updates directly to the database (GenerateDBDirectMethods) checkbox checked.</span></span>


<span data-ttu-id="25f09-196">[![Nome do preenchimento de métodos do TableAdapter s e GetEmployees](updating-the-tableadapter-to-use-joins-cs/_static/image16.png)](updating-the-tableadapter-to-use-joins-cs/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="25f09-196">[![Name the TableAdapter s Methods Fill and GetEmployees](updating-the-tableadapter-to-use-joins-cs/_static/image16.png)](updating-the-tableadapter-to-use-joins-cs/_static/image15.png)</span></span>

<span data-ttu-id="25f09-197">**Figura 7**: nomear os métodos do TableAdapter s `Fill` e `GetEmployees` ([clique para exibir a imagem em tamanho normal](updating-the-tableadapter-to-use-joins-cs/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="25f09-197">**Figure 7**: Name the TableAdapter s Methods `Fill` and `GetEmployees` ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image17.png))</span></span>


<span data-ttu-id="25f09-198">Depois de concluir o assistente, reserve um tempo para examinar os procedimentos armazenados no banco de dados.</span><span class="sxs-lookup"><span data-stu-id="25f09-198">After completing the wizard, take a moment to examine the stored procedures in the database.</span></span> <span data-ttu-id="25f09-199">Você deverá ver quatro novas: `Employees_Select`, `Employees_Insert`, `Employees_Update`, e `Employees_Delete`.</span><span class="sxs-lookup"><span data-stu-id="25f09-199">You should see four new ones: `Employees_Select`, `Employees_Insert`, `Employees_Update`, and `Employees_Delete`.</span></span> <span data-ttu-id="25f09-200">Em seguida, inspecione a `EmployeesDataTable` e `EmployeesTableAdapter` acabou de criar.</span><span class="sxs-lookup"><span data-stu-id="25f09-200">Next, inspect the `EmployeesDataTable` and `EmployeesTableAdapter` just created.</span></span> <span data-ttu-id="25f09-201">A DataTable contém uma coluna para cada campo retornado pela consulta principal.</span><span class="sxs-lookup"><span data-stu-id="25f09-201">The DataTable contains a column for each field returned by the main query.</span></span> <span data-ttu-id="25f09-202">Clique no TableAdapter e, em seguida, vá para a janela de propriedades.</span><span class="sxs-lookup"><span data-stu-id="25f09-202">Click on the TableAdapter and then go to the Properties window.</span></span> <span data-ttu-id="25f09-203">Lá você verá que o `InsertCommand`, `UpdateCommand`, e `DeleteCommand` propriedades estão configuradas corretamente para chamar os procedimentos armazenados correspondentes.</span><span class="sxs-lookup"><span data-stu-id="25f09-203">There you will see that the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties are correctly configured to call the corresponding stored procedures.</span></span>


<span data-ttu-id="25f09-204">[![O TableAdapter inclui Insert, Update e excluir recursos](updating-the-tableadapter-to-use-joins-cs/_static/image19.png)](updating-the-tableadapter-to-use-joins-cs/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="25f09-204">[![The TableAdapter Includes Insert, Update, and Delete Capabilities](updating-the-tableadapter-to-use-joins-cs/_static/image19.png)](updating-the-tableadapter-to-use-joins-cs/_static/image18.png)</span></span>

<span data-ttu-id="25f09-205">**Figura 8**: O TableAdapter inclui inserir, atualizar e excluir recursos ([clique para exibir a imagem em tamanho normal](updating-the-tableadapter-to-use-joins-cs/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="25f09-205">**Figure 8**: The TableAdapter Includes Insert, Update, and Delete Capabilities ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image20.png))</span></span>


<span data-ttu-id="25f09-206">Com a inserção, atualização e exclusão de procedimentos armazenados criados automaticamente e o `InsertCommand`, `UpdateCommand`, e `DeleteCommand` propriedades configuradas corretamente, você está pronto para personalizar o `SelectCommand` s procedimento armazenado para retornar adicionais informações sobre cada gerente do funcionário s.</span><span class="sxs-lookup"><span data-stu-id="25f09-206">With the insert, update, and delete stored procedures automatically created and the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties correctly configured, we are ready to customize the `SelectCommand` s stored procedure to return additional information about each employee s manager.</span></span> <span data-ttu-id="25f09-207">Especificamente, precisamos atualizar o `Employees_Select` procedimento armazenado para usar um `JOIN` e retornar o Gerenciador de s `FirstName` e `LastName` valores.</span><span class="sxs-lookup"><span data-stu-id="25f09-207">Specifically, we need to update the `Employees_Select` stored procedure to use a `JOIN` and return the manager s `FirstName` and `LastName` values.</span></span> <span data-ttu-id="25f09-208">Depois que o procedimento armazenado tiver sido atualizado, precisamos atualizar a DataTable para que ele inclua essas colunas adicionais.</span><span class="sxs-lookup"><span data-stu-id="25f09-208">After the stored procedure has been updated, we will need to update the DataTable so that it includes these additional columns.</span></span> <span data-ttu-id="25f09-209">Que abordaremos essas duas tarefas nas etapas 2 e 3.</span><span class="sxs-lookup"><span data-stu-id="25f09-209">We'll tackle these two tasks in Steps 2 and 3.</span></span>

## <a name="step-2-customizing-the-stored-procedure-to-include-ajoin"></a><span data-ttu-id="25f09-210">Etapa 2: Personalizar o procedimento armazenado para incluir um`JOIN`</span><span class="sxs-lookup"><span data-stu-id="25f09-210">Step 2: Customizing the Stored Procedure to Include a`JOIN`</span></span>

<span data-ttu-id="25f09-211">Comece indo para o Gerenciador de servidores, drill-down até a pasta de procedimentos armazenados do banco de dados s Northwind e abrindo o `Employees_Select` procedimento armazenado.</span><span class="sxs-lookup"><span data-stu-id="25f09-211">Start by going to the Server Explorer, drilling down into the Northwind database s Stored Procedures folder, and opening the `Employees_Select` stored procedure.</span></span> <span data-ttu-id="25f09-212">Se você não vir esse procedimento armazenado, clique com botão direito na pasta de procedimentos armazenados e escolha atualizar.</span><span class="sxs-lookup"><span data-stu-id="25f09-212">If you do not see this stored procedure, right-click on the Stored Procedures folder and choose Refresh.</span></span> <span data-ttu-id="25f09-213">Atualize o procedimento armazenado para que ele use um `LEFT JOIN` para retornar o Gerenciador de s primeiro nome e sobrenome:</span><span class="sxs-lookup"><span data-stu-id="25f09-213">Update the stored procedure so that it uses a `LEFT JOIN` to return the manager s first and last name:</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample5.sql)]

<span data-ttu-id="25f09-214">Depois de atualizar o `SELECT` instrução, salve as alterações no menu Arquivo e escolhendo Salvar `Employees_Select`.</span><span class="sxs-lookup"><span data-stu-id="25f09-214">After updating the `SELECT` statement, save the changes by going to the File menu and choosing Save `Employees_Select`.</span></span> <span data-ttu-id="25f09-215">Como alternativa, você pode clique no ícone Salvar na barra de ferramentas ou pressione Ctrl + S.</span><span class="sxs-lookup"><span data-stu-id="25f09-215">Alternatively, you can click the Save icon in the toolbar or hit Ctrl+S.</span></span> <span data-ttu-id="25f09-216">Depois de salvar suas alterações, clique com botão direito no `Employees_Select` procedimento armazenado no Gerenciador de servidores e escolha Executar.</span><span class="sxs-lookup"><span data-stu-id="25f09-216">After saving your changes, right-click on the `Employees_Select` stored procedure in the Server Explorer and choose Execute.</span></span> <span data-ttu-id="25f09-217">Isso irá executar o procedimento armazenado e mostrar seus resultados na janela de saída (veja a Figura 9).</span><span class="sxs-lookup"><span data-stu-id="25f09-217">This will run the stored procedure and show its results in the Output window (see Figure 9).</span></span>


<span data-ttu-id="25f09-218">[![Os resultados de procedimentos armazenados são exibidos na janela de saída](updating-the-tableadapter-to-use-joins-cs/_static/image22.png)](updating-the-tableadapter-to-use-joins-cs/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="25f09-218">[![The Stored Procedures Results are Displayed in the Output Window](updating-the-tableadapter-to-use-joins-cs/_static/image22.png)](updating-the-tableadapter-to-use-joins-cs/_static/image21.png)</span></span>

<span data-ttu-id="25f09-219">**Figura 9**: os resultados de procedimentos armazenados são exibidos na janela de saída ([clique para exibir a imagem em tamanho normal](updating-the-tableadapter-to-use-joins-cs/_static/image23.png))</span><span class="sxs-lookup"><span data-stu-id="25f09-219">**Figure 9**: The Stored Procedures Results are Displayed in the Output Window ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image23.png))</span></span>


## <a name="step-3-updating-the-datatable-s-columns"></a><span data-ttu-id="25f09-220">Etapa 3: Atualizar as colunas de s de DataTable</span><span class="sxs-lookup"><span data-stu-id="25f09-220">Step 3: Updating the DataTable s Columns</span></span>

<span data-ttu-id="25f09-221">Neste ponto, o `Employees_Select` procedimento armazenado retorna `ManagerFirstName` e `ManagerLastName` valores, mas o `EmployeesDataTable` está faltando a essas colunas.</span><span class="sxs-lookup"><span data-stu-id="25f09-221">At this point, the `Employees_Select` stored procedure returns `ManagerFirstName` and `ManagerLastName` values, but the `EmployeesDataTable` is missing these columns.</span></span> <span data-ttu-id="25f09-222">Essas colunas ausentes podem ser adicionadas à tabela de dados em uma das duas maneiras:</span><span class="sxs-lookup"><span data-stu-id="25f09-222">These missing columns can be added to the DataTable in one of two ways:</span></span>

- <span data-ttu-id="25f09-223">**Manualmente** - o com o botão direito na DataTable no DataSet Designer e, no menu Adicionar, escolha a coluna.</span><span class="sxs-lookup"><span data-stu-id="25f09-223">**Manually** - right-click on the DataTable in the DataSet Designer and, from the Add menu, choose Column.</span></span> <span data-ttu-id="25f09-224">Em seguida, você pode nomear a coluna e definir suas propriedades de acordo.</span><span class="sxs-lookup"><span data-stu-id="25f09-224">You can then name the column and set its properties accordingly.</span></span>
- <span data-ttu-id="25f09-225">**Automaticamente** -o Assistente de configuração do TableAdapter atualizará as colunas de s DataTable para refletir os campos retornados pela `SelectCommand` procedimento armazenado.</span><span class="sxs-lookup"><span data-stu-id="25f09-225">**Automatically** - the TableAdapter Configuration wizard will update the DataTable s columns to reflect the fields returned by the `SelectCommand` stored procedure.</span></span> <span data-ttu-id="25f09-226">Ao usar instruções SQL ad hoc, o assistente também removerá o `InsertCommand`, `UpdateCommand`, e `DeleteCommand` propriedades desde o `SelectCommand` agora contém um `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="25f09-226">When using ad-hoc SQL statements, the wizard will also remove the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties since the `SelectCommand` now contains a `JOIN`.</span></span> <span data-ttu-id="25f09-227">Mas, ao usar procedimentos armazenados, essas propriedades de comando permanecem intactas.</span><span class="sxs-lookup"><span data-stu-id="25f09-227">But when using stored procedures, these command properties remain intact.</span></span>

<span data-ttu-id="25f09-228">Exploramos manualmente adicionando colunas de tabela de dados nos tutoriais anteriores, incluindo [mestre/detalhes usando uma lista com marcadores de registros de mestre com um DataList de detalhes](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md) e [carregar arquivos](../working-with-binary-files/uploading-files-cs.md), e iremos Examine esse processo novamente em mais detalhes em nosso próximo tutorial.</span><span class="sxs-lookup"><span data-stu-id="25f09-228">We have explored manually adding DataTable columns in previous tutorials, including [Master/Detail Using a Bulleted List of Master Records with a Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md) and [Uploading Files](../working-with-binary-files/uploading-files-cs.md), and we will look at this process again in more detail in our next tutorial.</span></span> <span data-ttu-id="25f09-229">Para este tutorial, porém, deixe s use a abordagem automática por meio do Assistente de configuração do TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="25f09-229">For this tutorial, however, let s use the automatic approach via the TableAdapter Configuration wizard.</span></span>

<span data-ttu-id="25f09-230">Comece clicando com o `EmployeesTableAdapter` e selecionando configurar no menu de contexto.</span><span class="sxs-lookup"><span data-stu-id="25f09-230">Start by right-clicking on the `EmployeesTableAdapter` and selecting Configure from the context menu.</span></span> <span data-ttu-id="25f09-231">Isso abre o Assistente de configuração do TableAdapter, que lista os procedimentos armazenados usados para selecionar, inserir, atualizar e excluir, junto com seus valores de retorno e parâmetros (se houver).</span><span class="sxs-lookup"><span data-stu-id="25f09-231">This brings up the TableAdapter Configuration wizard, which lists the stored procedures used for selecting, inserting, updating, and deleting, along with their return values and parameters (if any).</span></span> <span data-ttu-id="25f09-232">Figura 10 mostra esse assistente.</span><span class="sxs-lookup"><span data-stu-id="25f09-232">Figure 10 shows this wizard.</span></span> <span data-ttu-id="25f09-233">Aqui podemos ver que o `Employees_Select` procedimento armazenado agora retorna o `ManagerFirstName` e `ManagerLastName` campos.</span><span class="sxs-lookup"><span data-stu-id="25f09-233">Here we can see that the `Employees_Select` stored procedure now returns the `ManagerFirstName` and `ManagerLastName` fields.</span></span>


<span data-ttu-id="25f09-234">[![Procedimento de armazenado mostra o Assistente para a lista de coluna atualizada para o Employees_Select](updating-the-tableadapter-to-use-joins-cs/_static/image25.png)](updating-the-tableadapter-to-use-joins-cs/_static/image24.png)</span><span class="sxs-lookup"><span data-stu-id="25f09-234">[![The Wizard Shows the Updated Column List for the Employees_Select Stored Procedure](updating-the-tableadapter-to-use-joins-cs/_static/image25.png)](updating-the-tableadapter-to-use-joins-cs/_static/image24.png)</span></span>

<span data-ttu-id="25f09-235">**Figura 10**: O assistente mostra a lista de coluna atualizada para o `Employees_Select` procedimento armazenado ([clique para exibir a imagem em tamanho normal](updating-the-tableadapter-to-use-joins-cs/_static/image26.png))</span><span class="sxs-lookup"><span data-stu-id="25f09-235">**Figure 10**: The Wizard Shows the Updated Column List for the `Employees_Select` Stored Procedure ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image26.png))</span></span>


<span data-ttu-id="25f09-236">Conclua o assistente clicando em Finish.</span><span class="sxs-lookup"><span data-stu-id="25f09-236">Complete the wizard by clicking Finish.</span></span> <span data-ttu-id="25f09-237">Ao retornar para o Designer de conjunto de dados, o `EmployeesDataTable` inclui duas colunas adicionais: `ManagerFirstName` e `ManagerLastName`.</span><span class="sxs-lookup"><span data-stu-id="25f09-237">Upon returning to the DataSet Designer, the `EmployeesDataTable` includes two additional columns: `ManagerFirstName` and `ManagerLastName`.</span></span>


<span data-ttu-id="25f09-238">[![O EmployeesDataTable contém duas novas colunas](updating-the-tableadapter-to-use-joins-cs/_static/image28.png)](updating-the-tableadapter-to-use-joins-cs/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="25f09-238">[![The EmployeesDataTable Contains Two New Columns](updating-the-tableadapter-to-use-joins-cs/_static/image28.png)](updating-the-tableadapter-to-use-joins-cs/_static/image27.png)</span></span>

<span data-ttu-id="25f09-239">**Figura 11**: O `EmployeesDataTable` contém duas novas colunas ([clique para exibir a imagem em tamanho normal](updating-the-tableadapter-to-use-joins-cs/_static/image29.png))</span><span class="sxs-lookup"><span data-stu-id="25f09-239">**Figure 11**: The `EmployeesDataTable` Contains Two New Columns ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image29.png))</span></span>


<span data-ttu-id="25f09-240">Para ilustrar que a atualização `Employees_Select` procedimento armazenado está em vigor e que a inserção, atualização e exclusão de recursos do TableAdapter são funcionais, permitir que o s crie uma página da web que permite aos usuários exibir e excluir os funcionários.</span><span class="sxs-lookup"><span data-stu-id="25f09-240">To illustrate that the updated `Employees_Select` stored procedure is in effect and that the insert, update, and delete capabilities of the TableAdapter are still functional, let s create a web page that allows users to view and delete employees.</span></span> <span data-ttu-id="25f09-241">Antes de criarmos uma página como essa, no entanto, é necessário primeiro criar uma nova classe na camada de lógica de negócios para trabalhar com os funcionários a `NorthwindWithSprocs` conjunto de dados.</span><span class="sxs-lookup"><span data-stu-id="25f09-241">Before we create such a page, however, we need to first create a new class in the Business Logic Layer for working with employees from the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="25f09-242">Na etapa 4, criaremos um `EmployeesBLLWithSprocs` classe.</span><span class="sxs-lookup"><span data-stu-id="25f09-242">In Step 4, we will create an `EmployeesBLLWithSprocs` class.</span></span> <span data-ttu-id="25f09-243">Na etapa 5, usaremos essa classe em uma página ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="25f09-243">In Step 5, we will use this class from an ASP.NET page.</span></span>

## <a name="step-4-implementing-the-business-logic-layer"></a><span data-ttu-id="25f09-244">Etapa 4: Implementando a camada de lógica de negócios</span><span class="sxs-lookup"><span data-stu-id="25f09-244">Step 4: Implementing the Business Logic Layer</span></span>

<span data-ttu-id="25f09-245">Criar um novo arquivo de classe na `~/App_Code/BLL` pasta chamada `EmployeesBLLWithSprocs.cs`.</span><span class="sxs-lookup"><span data-stu-id="25f09-245">Create a new class file in the `~/App_Code/BLL` folder named `EmployeesBLLWithSprocs.cs`.</span></span> <span data-ttu-id="25f09-246">Essa classe imita a semântica de existente `EmployeesBLL` classe, somente esse novo uma fornece menos métodos e usa o `NorthwindWithSprocs` conjunto de dados (em vez do `Northwind` conjunto de dados).</span><span class="sxs-lookup"><span data-stu-id="25f09-246">This class mimics the semantics of the existing `EmployeesBLL` class, only this new one provides fewer methods and uses the `NorthwindWithSprocs` DataSet (instead of the `Northwind` DataSet).</span></span> <span data-ttu-id="25f09-247">Adicione o seguinte código para o `EmployeesBLLWithSprocs` classe.</span><span class="sxs-lookup"><span data-stu-id="25f09-247">Add the following code to the `EmployeesBLLWithSprocs` class.</span></span>


[!code-csharp[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample6.cs)]

<span data-ttu-id="25f09-248">O `EmployeesBLLWithSprocs` classe s `Adapter` propriedade retorna uma instância das `NorthwindWithSprocs` DataSet s `EmployeesTableAdapter`.</span><span class="sxs-lookup"><span data-stu-id="25f09-248">The `EmployeesBLLWithSprocs` class s `Adapter` property returns an instance of the `NorthwindWithSprocs` DataSet s `EmployeesTableAdapter`.</span></span> <span data-ttu-id="25f09-249">Isso é usado pela classe s `GetEmployees` e `DeleteEmployee` métodos.</span><span class="sxs-lookup"><span data-stu-id="25f09-249">This is used by the class s `GetEmployees` and `DeleteEmployee` methods.</span></span> <span data-ttu-id="25f09-250">O `GetEmployees` chamadas de método de `EmployeesTableAdapter` s correspondente `GetEmployees` método, que invoca o `Employees_Select` procedimento armazenado e preenche seus resultados em um `EmployeeDataTable`.</span><span class="sxs-lookup"><span data-stu-id="25f09-250">The `GetEmployees` method calls the `EmployeesTableAdapter` s corresponding `GetEmployees` method, which invokes the `Employees_Select` stored procedure and populates its results in an `EmployeeDataTable`.</span></span> <span data-ttu-id="25f09-251">O `DeleteEmployee` chamadas de método da mesma forma a `EmployeesTableAdapter` s `Delete` método, que invoca o `Employees_Delete` procedimento armazenado.</span><span class="sxs-lookup"><span data-stu-id="25f09-251">The `DeleteEmployee` method similarly calls the `EmployeesTableAdapter` s `Delete` method, which invokes the `Employees_Delete` stored procedure.</span></span>

## <a name="step-5-working-with-the-data-in-the-presentation-layer"></a><span data-ttu-id="25f09-252">Etapa 5: Trabalhar com os dados na camada de apresentação</span><span class="sxs-lookup"><span data-stu-id="25f09-252">Step 5: Working with the Data in the Presentation Layer</span></span>

<span data-ttu-id="25f09-253">Com o `EmployeesBLLWithSprocs` classe concluída, podemos está pronto para trabalhar com dados de funcionários por meio de uma página ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="25f09-253">With the `EmployeesBLLWithSprocs` class complete, we re ready to work with employee data through an ASP.NET page.</span></span> <span data-ttu-id="25f09-254">Abra o `JOINs.aspx` página na `AdvancedDAL` pasta e arraste um controle GridView da caixa de ferramentas para o Designer, definindo seu `ID` propriedade para `Employees`.</span><span class="sxs-lookup"><span data-stu-id="25f09-254">Open the `JOINs.aspx` page in the `AdvancedDAL` folder and drag a GridView from the Toolbox onto the Designer, setting its `ID` property to `Employees`.</span></span> <span data-ttu-id="25f09-255">Em seguida, associar a grade para um novo controle ObjectDataSource chamado de GridView s marca inteligente, `EmployeesDataSource`.</span><span class="sxs-lookup"><span data-stu-id="25f09-255">Next, from the GridView s smart tag, bind the grid to a new ObjectDataSource control named `EmployeesDataSource`.</span></span>

<span data-ttu-id="25f09-256">Configurar o ObjectDataSource para usar o `EmployeesBLLWithSprocs` de classe e, nas guias SELECT e DELETE, certifique-se de que o `GetEmployees` e `DeleteEmployee` métodos são selecionados das listas de lista suspensa.</span><span class="sxs-lookup"><span data-stu-id="25f09-256">Configure the ObjectDataSource to use the `EmployeesBLLWithSprocs` class and, from the SELECT and DELETE tabs, ensure that the `GetEmployees` and `DeleteEmployee` methods are selected from the drop-down lists.</span></span> <span data-ttu-id="25f09-257">Clique em Concluir para concluir a configuração de s ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="25f09-257">Click Finish to complete the ObjectDataSource s configuration.</span></span>


<span data-ttu-id="25f09-258">[![Configurar o ObjectDataSource para usar a classe EmployeesBLLWithSprocs](updating-the-tableadapter-to-use-joins-cs/_static/image31.png)](updating-the-tableadapter-to-use-joins-cs/_static/image30.png)</span><span class="sxs-lookup"><span data-stu-id="25f09-258">[![Configure the ObjectDataSource to Use the EmployeesBLLWithSprocs Class](updating-the-tableadapter-to-use-joins-cs/_static/image31.png)](updating-the-tableadapter-to-use-joins-cs/_static/image30.png)</span></span>

<span data-ttu-id="25f09-259">**Figura 12**: configurar o ObjectDataSource para usar o `EmployeesBLLWithSprocs` classe ([clique para exibir a imagem em tamanho normal](updating-the-tableadapter-to-use-joins-cs/_static/image32.png))</span><span class="sxs-lookup"><span data-stu-id="25f09-259">**Figure 12**: Configure the ObjectDataSource to Use the `EmployeesBLLWithSprocs` Class ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image32.png))</span></span>


<span data-ttu-id="25f09-260">[![Poderá usar o ObjectDataSource os métodos de DeleteEmployee e GetEmployees](updating-the-tableadapter-to-use-joins-cs/_static/image34.png)](updating-the-tableadapter-to-use-joins-cs/_static/image33.png)</span><span class="sxs-lookup"><span data-stu-id="25f09-260">[![Have the ObjectDataSource Use the GetEmployees and DeleteEmployee Methods](updating-the-tableadapter-to-use-joins-cs/_static/image34.png)](updating-the-tableadapter-to-use-joins-cs/_static/image33.png)</span></span>

<span data-ttu-id="25f09-261">**Figura 13**: pode usar o ObjectDataSource a `GetEmployees` e `DeleteEmployee` métodos ([clique para exibir a imagem em tamanho normal](updating-the-tableadapter-to-use-joins-cs/_static/image35.png))</span><span class="sxs-lookup"><span data-stu-id="25f09-261">**Figure 13**: Have the ObjectDataSource Use the `GetEmployees` and `DeleteEmployee` Methods ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image35.png))</span></span>


<span data-ttu-id="25f09-262">Visual Studio adicionará um BoundField ao GridView para cada um do `EmployeesDataTable` colunas s.</span><span class="sxs-lookup"><span data-stu-id="25f09-262">Visual Studio will add a BoundField to the GridView for each of the `EmployeesDataTable` s columns.</span></span> <span data-ttu-id="25f09-263">Remover todos esses BoundFields, exceto `Title`, `LastName`, `FirstName`, `ManagerFirstName`, e `ManagerLastName` e renomeie o `HeaderText` propriedades para os últimos quatro BoundFields sobrenome, nome, nome Manager s, e Gerenciador de s Last Name, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="25f09-263">Remove all of these BoundFields except for `Title`, `LastName`, `FirstName`, `ManagerFirstName`, and `ManagerLastName` and rename the `HeaderText` properties for the last four BoundFields to Last Name, First Name, Manager s First Name, and Manager s Last Name, respectively.</span></span>

<span data-ttu-id="25f09-264">Para permitir que os usuários excluam os funcionários dessa página que precisamos fazer duas coisas.</span><span class="sxs-lookup"><span data-stu-id="25f09-264">To allow users to delete employees from this page we need to do two things.</span></span> <span data-ttu-id="25f09-265">Primeiro, instrua o GridView para fornecer recursos de exclusão, marcando a opção de habilitar a exclusão de sua marca inteligente.</span><span class="sxs-lookup"><span data-stu-id="25f09-265">First, instruct the GridView to provide deleting capabilities by checking the Enable Deleting option from its smart tag.</span></span> <span data-ttu-id="25f09-266">Em segundo lugar, altere o s ObjectDataSource `OldValuesParameterFormatString` propriedade do valor definidos pelo assistente ObjectDataSource (`original_{0}`) para seu valor padrão (`{0}`).</span><span class="sxs-lookup"><span data-stu-id="25f09-266">Second, change the ObjectDataSource s `OldValuesParameterFormatString` property from the value set by the ObjectDataSource wizard (`original_{0}`) to its default value (`{0}`).</span></span> <span data-ttu-id="25f09-267">Depois de fazer essas alterações, sua marcação declarativa de s do GridView e ObjectDataSource deve ser semelhante ao seguinte:</span><span class="sxs-lookup"><span data-stu-id="25f09-267">After making these changes, your GridView and ObjectDataSource s declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample7.aspx)]

<span data-ttu-id="25f09-268">Testar a página visitando-lo por meio de um navegador.</span><span class="sxs-lookup"><span data-stu-id="25f09-268">Test out the page by visiting it through a browser.</span></span> <span data-ttu-id="25f09-269">Como mostra a Figura 14, a página listará cada funcionário e seu nome do s Gerenciador (supondo que eles tenham um).</span><span class="sxs-lookup"><span data-stu-id="25f09-269">As Figure 14 shows, the page will list each employee and his or her manager s name (assuming they have one).</span></span>


<span data-ttu-id="25f09-270">[![A junção no Employees_Select procedimento armazenado retorna o nome do Gerenciador de s](updating-the-tableadapter-to-use-joins-cs/_static/image37.png)](updating-the-tableadapter-to-use-joins-cs/_static/image36.png)</span><span class="sxs-lookup"><span data-stu-id="25f09-270">[![The JOIN in the Employees_Select Stored Procedure Returns the Manager s Name](updating-the-tableadapter-to-use-joins-cs/_static/image37.png)](updating-the-tableadapter-to-use-joins-cs/_static/image36.png)</span></span>

<span data-ttu-id="25f09-271">**Figura 14**: O `JOIN` na `Employees_Select` procedimento armazenado retorna o nome do Gerenciador ([clique para exibir a imagem em tamanho normal](updating-the-tableadapter-to-use-joins-cs/_static/image38.png))</span><span class="sxs-lookup"><span data-stu-id="25f09-271">**Figure 14**: The `JOIN` in the `Employees_Select` Stored Procedure Returns the Manager s Name ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image38.png))</span></span>


<span data-ttu-id="25f09-272">Clicando no botão Excluir inicia o fluxo de trabalho excluindo, culmina na execução do `Employees_Delete` procedimento armazenado.</span><span class="sxs-lookup"><span data-stu-id="25f09-272">Clicking the Delete button starts the deleting workflow, which culminates in the execution of the `Employees_Delete` stored procedure.</span></span> <span data-ttu-id="25f09-273">No entanto, a tentativa `DELETE` instrução no procedimento armazenado falhará devido a uma violação de restrição de chave estrangeira (consulte a Figura 15).</span><span class="sxs-lookup"><span data-stu-id="25f09-273">However, the attempted `DELETE` statement in the stored procedure fails because of a foreign key constraint violation (see Figure 15).</span></span> <span data-ttu-id="25f09-274">Especificamente, cada funcionário tem um ou mais registros no `Orders` tabela, fazendo com que a exclusão falha.</span><span class="sxs-lookup"><span data-stu-id="25f09-274">Specifically, each employee has one or more records in the `Orders` table, causing the delete to fail.</span></span>


<span data-ttu-id="25f09-275">[![Exclusão de um funcionário que tem resultados correspondentes de pedidos em uma violação de restrição de chave estrangeira](updating-the-tableadapter-to-use-joins-cs/_static/image40.png)](updating-the-tableadapter-to-use-joins-cs/_static/image39.png)</span><span class="sxs-lookup"><span data-stu-id="25f09-275">[![Deleting an Employee That has Corresponding Orders Results in a Foreign Key Constraint Violation](updating-the-tableadapter-to-use-joins-cs/_static/image40.png)](updating-the-tableadapter-to-use-joins-cs/_static/image39.png)</span></span>

<span data-ttu-id="25f09-276">**Figura 15**: exclusão de um funcionário que tem resultados correspondentes de pedidos em uma violação de restrição de chave estrangeira ([clique para exibir a imagem em tamanho normal](updating-the-tableadapter-to-use-joins-cs/_static/image41.png))</span><span class="sxs-lookup"><span data-stu-id="25f09-276">**Figure 15**: Deleting an Employee That has Corresponding Orders Results in a Foreign Key Constraint Violation ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image41.png))</span></span>


<span data-ttu-id="25f09-277">Para permitir que um funcionário para ser excluído, você pode:</span><span class="sxs-lookup"><span data-stu-id="25f09-277">To allow an employee to be deleted you could:</span></span>

- <span data-ttu-id="25f09-278">Atualizar a restrição de chave estrangeira para propagar exclusões,</span><span class="sxs-lookup"><span data-stu-id="25f09-278">Update the foreign key constraint to cascade deletes,</span></span>
- <span data-ttu-id="25f09-279">Exclua manualmente os registros da `Orders` tabela para o funcionário (s) que deseja excluir, ou</span><span class="sxs-lookup"><span data-stu-id="25f09-279">Manually delete the records from the `Orders` table for the employee(s) you want to delete, or</span></span>
- <span data-ttu-id="25f09-280">Atualização do `Employees_Delete` procedimento armazenado para primeiro excluir os registros relacionados do `Orders` tabela antes de excluir o `Employees` registro.</span><span class="sxs-lookup"><span data-stu-id="25f09-280">Update the `Employees_Delete` stored procedure to first delete the related records from the `Orders` table before deleting the `Employees` record.</span></span> <span data-ttu-id="25f09-281">Abordamos essa técnica na [usando procedimentos armazenados existentes para o s TableAdapters do conjunto de dados tipado](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) tutorial.</span><span class="sxs-lookup"><span data-stu-id="25f09-281">We discussed this technique in the [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) tutorial.</span></span>

<span data-ttu-id="25f09-282">Posso deixar isso como um exercício para o leitor.</span><span class="sxs-lookup"><span data-stu-id="25f09-282">I leave this as an exercise for the reader.</span></span>

## <a name="summary"></a><span data-ttu-id="25f09-283">Resumo</span><span class="sxs-lookup"><span data-stu-id="25f09-283">Summary</span></span>

<span data-ttu-id="25f09-284">Ao trabalhar com bancos de dados relacionais, é comum para consultas efetuar pull de seus dados de várias tabelas relacionadas.</span><span class="sxs-lookup"><span data-stu-id="25f09-284">When working with relational databases, it is common for queries to pull their data from multiple, related tables.</span></span> <span data-ttu-id="25f09-285">Subconsultas correlacionadas e `JOIN` s fornecem duas técnicas diferentes para acessar dados de tabelas relacionadas em uma consulta.</span><span class="sxs-lookup"><span data-stu-id="25f09-285">Correlated subqueries and `JOIN` s provide two different techniques for accessing data from related tables in a query.</span></span> <span data-ttu-id="25f09-286">Nos tutoriais anteriores, fizemos mais comumente usam de subconsultas correlacionadas porque o TableAdapter não é possível gerar automaticamente `INSERT`, `UPDATE`, e `DELETE` instruções para consultas que envolvem `JOIN` s.</span><span class="sxs-lookup"><span data-stu-id="25f09-286">In previous tutorials we most commonly made use of correlated subqueries because the TableAdapter cannot auto-generate `INSERT`, `UPDATE`, and `DELETE` statements for queries involving `JOIN` s.</span></span> <span data-ttu-id="25f09-287">Embora esses valores podem ser fornecidos manualmente, ao usar instruções SQL ad hoc todas as personalizações serão substituídas quando o Assistente de configuração do TableAdapter é concluído.</span><span class="sxs-lookup"><span data-stu-id="25f09-287">While these values can be provided manually, when using ad-hoc SQL statements any customizations will be overwritten when the TableAdapter Configuration wizard is completed.</span></span>

<span data-ttu-id="25f09-288">Felizmente, TableAdapters criados usando procedimentos armazenados não sofrem das mesma fragilidade como aqueles criados usando instruções SQL ad hoc.</span><span class="sxs-lookup"><span data-stu-id="25f09-288">Fortunately, TableAdapters created using stored procedures do not suffer from the same brittleness as those created using ad-hoc SQL statements.</span></span> <span data-ttu-id="25f09-289">Portanto, é possível criar um TableAdapter cuja consulta principal usa um `JOIN` ao usar procedimentos armazenados.</span><span class="sxs-lookup"><span data-stu-id="25f09-289">Therefore, it is feasible to create a TableAdapter whose main query uses a `JOIN` when using stored procedures.</span></span> <span data-ttu-id="25f09-290">Neste tutorial vimos como criar tal um TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="25f09-290">In this tutorial we saw how to create such a TableAdapter.</span></span> <span data-ttu-id="25f09-291">Começamos usando um `JOIN`-menos `SELECT` consulta para a consulta principal do TableAdapter s para que os correspondente insert, update e procedimentos armazenado de delete seria criado automaticamente.</span><span class="sxs-lookup"><span data-stu-id="25f09-291">We started by using a `JOIN`-less `SELECT` query for the TableAdapter s main query so that the corresponding insert, update, and delete stored procedures would be auto-created.</span></span> <span data-ttu-id="25f09-292">Com a TableAdapter s configuração inicial completa, aumentássemos o `SelectCommand` procedimento armazenado para usar um `JOIN` e executar novamente o Assistente de configuração do TableAdapter para atualizar o `EmployeesDataTable` colunas s.</span><span class="sxs-lookup"><span data-stu-id="25f09-292">With the TableAdapter s initial configuration complete, we augmented the `SelectCommand` stored procedure to use a `JOIN` and re-ran the TableAdapter Configuration wizard to update the `EmployeesDataTable` s columns.</span></span>

<span data-ttu-id="25f09-293">Executar novamente o Assistente de configuração do TableAdapter atualizado automaticamente a `EmployeesDataTable` colunas para refletir os campos de dados retornados pelo `Employees_Select` procedimento armazenado.</span><span class="sxs-lookup"><span data-stu-id="25f09-293">Re-running the TableAdapter Configuration wizard automatically updated the `EmployeesDataTable` columns to reflect the data fields returned by the `Employees_Select` stored procedure.</span></span> <span data-ttu-id="25f09-294">Como alternativa, podemos poderia ter adicionado essas colunas manualmente à tabela de dados.</span><span class="sxs-lookup"><span data-stu-id="25f09-294">Alternatively, we could have added these columns manually to the DataTable.</span></span> <span data-ttu-id="25f09-295">Vamos explorar manualmente adicionando colunas à tabela de dados no próximo tutorial.</span><span class="sxs-lookup"><span data-stu-id="25f09-295">We will explore manually adding columns to the DataTable in the next tutorial.</span></span>

<span data-ttu-id="25f09-296">Boa programação!</span><span class="sxs-lookup"><span data-stu-id="25f09-296">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="25f09-297">Sobre o autor</span><span class="sxs-lookup"><span data-stu-id="25f09-297">About the Author</span></span>

<span data-ttu-id="25f09-298">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de sete livros sobre ASP/ASP.NET e fundador da [4GuysFromRolla.com](http://www.4guysfromrolla.com), tem trabalhado com tecnologias Microsoft Web desde 1998.</span><span class="sxs-lookup"><span data-stu-id="25f09-298">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="25f09-299">Scott funciona como um consultor independente, instrutor e escritor.</span><span class="sxs-lookup"><span data-stu-id="25f09-299">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="25f09-300">Seu livro mais recente é [ *Sams Teach por conta própria ASP.NET 2.0 em 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="25f09-300">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="25f09-301">Ele pode ser contatado pelo [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="25f09-301">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="25f09-302">ou por meio de seu blog, que pode ser encontrado em [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="25f09-302">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="25f09-303">Agradecimentos especiais a</span><span class="sxs-lookup"><span data-stu-id="25f09-303">Special Thanks To</span></span>

<span data-ttu-id="25f09-304">Esta série de tutoriais foi revisada por muitos revisores úteis.</span><span class="sxs-lookup"><span data-stu-id="25f09-304">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="25f09-305">Os revisores de avanço para este tutorial foram Teresa Murphy, David Suru e Geisenow Hilton.</span><span class="sxs-lookup"><span data-stu-id="25f09-305">Lead reviewers for this tutorial were Hilton Geisenow, David Suru, and Teresa Murphy.</span></span> <span data-ttu-id="25f09-306">Você está interessado na revisão Meus próximos artigos do MSDN?</span><span class="sxs-lookup"><span data-stu-id="25f09-306">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="25f09-307">Nesse caso, me descartar uma linha na [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="25f09-307">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="25f09-308">[Anterior](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md)
> [Próximo](adding-additional-datatable-columns-cs.md)</span><span class="sxs-lookup"><span data-stu-id="25f09-308">[Previous](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md)
[Next](adding-additional-datatable-columns-cs.md)</span></span>

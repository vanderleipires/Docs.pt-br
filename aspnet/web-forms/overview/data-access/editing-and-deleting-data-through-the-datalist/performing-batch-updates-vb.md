---
uid: web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/performing-batch-updates-vb
title: Executar atualizações em lote (VB) | Microsoft Docs
author: rick-anderson
description: Saiba como criar um totalmente editáveis DataList onde todos os seus itens estão no modo de edição e cujos valores podem ser salvos, clicando em um botão 'Atualizar tudo' na...
ms.author: riande
ms.date: 10/30/2006
ms.assetid: 8dac22a7-91de-4e3b-888f-a4c438b03851
msc.legacyurl: /web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/performing-batch-updates-vb
msc.type: authoredcontent
ms.openlocfilehash: 67ab034880c8140e6156721956059b7cdd3f077b
ms.sourcegitcommit: 45ac74e400f9f2b7dbded66297730f6f14a4eb25
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/16/2018
ms.locfileid: "41834521"
---
<a name="performing-batch-updates-vb"></a><span data-ttu-id="2d9fc-103">Executar atualizações em lote (VB)</span><span class="sxs-lookup"><span data-stu-id="2d9fc-103">Performing Batch Updates (VB)</span></span>
====================
<span data-ttu-id="2d9fc-104">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="2d9fc-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="2d9fc-105">[Baixe o aplicativo de exemplo](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_37_VB.exe) ou [baixar PDF](performing-batch-updates-vb/_static/datatutorial37vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="2d9fc-105">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_37_VB.exe) or [Download PDF](performing-batch-updates-vb/_static/datatutorial37vb1.pdf)</span></span>

> <span data-ttu-id="2d9fc-106">Saiba como criar um totalmente editáveis DataList onde todos os seus itens estão no modo de edição e cujos valores podem ser salvos, clicando em um botão "Atualizar tudo" na página.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-106">Learn how to create a fully-editable DataList where all of its items are in edit mode and whose values can be saved by clicking an "Update All" button on the page.</span></span>


## <a name="introduction"></a><span data-ttu-id="2d9fc-107">Introdução</span><span class="sxs-lookup"><span data-stu-id="2d9fc-107">Introduction</span></span>

<span data-ttu-id="2d9fc-108">No [tutorial anterior](an-overview-of-editing-and-deleting-data-in-the-datalist-vb.md) , examinamos como criar um DataList de nível de item.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-108">In the [preceding tutorial](an-overview-of-editing-and-deleting-data-in-the-datalist-vb.md) we examined how to create an item-level DataList.</span></span> <span data-ttu-id="2d9fc-109">Como o GridView editável padrão, cada item no DataList incluído uma edição botão que, quando clicado, seria tornar o item editável.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-109">Like the standard editable GridView, each item in the DataList included an Edit button that, when clicked, would make the item editable.</span></span> <span data-ttu-id="2d9fc-110">Embora esse nível de item edição funciona bem para dados que só são atualizadas ocasionalmente, determinados cenários de caso de uso exigem que o usuário editar vários registros.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-110">While this item-level editing works well for data that is only updated occasionally, certain use case scenarios require the user to edit many records.</span></span> <span data-ttu-id="2d9fc-111">Se um usuário precise editar dezenas de registros e é forçado a clicar em Editar, fazer suas alterações e clique em atualizar para cada um deles, a quantidade de clicar em pode dificultar sua produtividade.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-111">If a user needs to edit dozens of records and is forced to click Edit, make their changes, and click Update for each one, the amount of clicking can hamper her productivity.</span></span> <span data-ttu-id="2d9fc-112">Em tais situações, uma opção melhor é fornecer uma DataList totalmente editável, aquele em que *todos os* seus itens estão no modo de edição e cujos valores podem ser editados clicando em um botão Atualizar tudo na página (consulte a Figura 1).</span><span class="sxs-lookup"><span data-stu-id="2d9fc-112">In such situations, a better option is to provide a fully-editable DataList, one where *all* of its items are in edit mode and whose values can be edited by clicking an Update All button on the page (see Figure 1).</span></span>


<span data-ttu-id="2d9fc-113">[![Cada Item em uma DataList totalmente editáveis pode ser modificado.](performing-batch-updates-vb/_static/image2.png)](performing-batch-updates-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="2d9fc-113">[![Each Item in a Fully Editable DataList can be Modified](performing-batch-updates-vb/_static/image2.png)](performing-batch-updates-vb/_static/image1.png)</span></span>

<span data-ttu-id="2d9fc-114">**Figura 1**: cada Item em uma DataList totalmente editáveis podem ser modificado ([clique para exibir a imagem em tamanho normal](performing-batch-updates-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="2d9fc-114">**Figure 1**: Each Item in a Fully Editable DataList can be Modified ([Click to view full-size image](performing-batch-updates-vb/_static/image3.png))</span></span>


<span data-ttu-id="2d9fc-115">Neste tutorial, examinaremos como habilitar usuários atualizar informações de endereço de fornecedores usando uma DataList totalmente editável.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-115">In this tutorial we'll examine how to enable users to update suppliers address information using a fully editable DataList.</span></span>

## <a name="step-1-create-the-editable-user-interface-in-the-datalist-s-itemtemplate"></a><span data-ttu-id="2d9fc-116">Etapa 1: Criar a Interface do usuário editável ItemTemplate s DataList</span><span class="sxs-lookup"><span data-stu-id="2d9fc-116">Step 1: Create the Editable User Interface in the DataList s ItemTemplate</span></span>

<span data-ttu-id="2d9fc-117">No tutorial anterior, em que estamos criando uma DataList editável padrão, o nível de item, usamos dois modelos:</span><span class="sxs-lookup"><span data-stu-id="2d9fc-117">In the preceding tutorial, where we creating a standard, item-level editable DataList, we used two templates:</span></span>

- <span data-ttu-id="2d9fc-118">`ItemTemplate` contido a interface de usuário somente leitura (os controles da Web de rótulo para exibir cada s nome do produto e preço).</span><span class="sxs-lookup"><span data-stu-id="2d9fc-118">`ItemTemplate` contained the read-only user interface (the Label Web controls for displaying each product s name and price).</span></span>
- <span data-ttu-id="2d9fc-119">`EditItemTemplate` contido a interface de usuário do modo de edição (os dois controles de TextBox Web).</span><span class="sxs-lookup"><span data-stu-id="2d9fc-119">`EditItemTemplate` contained the edit mode user interface (the two TextBox Web controls).</span></span>

<span data-ttu-id="2d9fc-120">S DataList `EditItemIndex` propriedade determina quais `DataListItem` (se houver) é renderizado utilizando o `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-120">The DataList s `EditItemIndex` property dictates what `DataListItem` (if any) is rendered using the `EditItemTemplate`.</span></span> <span data-ttu-id="2d9fc-121">Em particular, o `DataListItem` cujos `ItemIndex` valor corresponde à DataList s `EditItemIndex` propriedade é renderizada utilizando o `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-121">In particular, the `DataListItem` whose `ItemIndex` value matches the DataList s `EditItemIndex` property is rendered using the `EditItemTemplate`.</span></span> <span data-ttu-id="2d9fc-122">Esse modelo funciona bem quando apenas um item pode ser editado em uma hora, mas voltará distância durante a criação de um DataList totalmente editável.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-122">This model works well when only one item can be edited at a time, but falls apart when creating a fully-editable DataList.</span></span>

<span data-ttu-id="2d9fc-123">Para uma DataList totalmente editável, queremos *todos os* da `DataListItem` s para processar usando a interface editável.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-123">For a fully editable DataList, we want *all* of the `DataListItem` s to render using the editable interface.</span></span> <span data-ttu-id="2d9fc-124">A maneira mais simples de fazer isso é definir a interface editável no `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-124">The simplest way to accomplish this is to define the editable interface in the `ItemTemplate`.</span></span> <span data-ttu-id="2d9fc-125">Para modificar as informações de endereço de fornecedores, a interface editável contém o nome de fornecedor como texto e, em seguida, caixas de texto para o endereço, cidade e valores de país.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-125">For modifying the suppliers address information, the editable interface contains the supplier name as text and then TextBoxes for the address, city, and country values.</span></span>

<span data-ttu-id="2d9fc-126">Comece abrindo o `BatchUpdate.aspx` página, adicione um controle DataList e defina sua `ID` propriedade `Suppliers`.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-126">Start by opening the `BatchUpdate.aspx` page, add a DataList control, and set its `ID` property to `Suppliers`.</span></span> <span data-ttu-id="2d9fc-127">Da marca inteligente DataList s, optar por adicionar um novo controle ObjectDataSource chamado `SuppliersDataSource`.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-127">From the DataList s smart tag, opt to add a new ObjectDataSource control named `SuppliersDataSource`.</span></span>


<span data-ttu-id="2d9fc-128">[![Criar um novo ObjectDataSource chamado SuppliersDataSource](performing-batch-updates-vb/_static/image5.png)](performing-batch-updates-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="2d9fc-128">[![Create a New ObjectDataSource Named SuppliersDataSource](performing-batch-updates-vb/_static/image5.png)](performing-batch-updates-vb/_static/image4.png)</span></span>

<span data-ttu-id="2d9fc-129">**Figura 2**: criar um novo ObjectDataSource nomeado `SuppliersDataSource` ([clique para exibir a imagem em tamanho normal](performing-batch-updates-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="2d9fc-129">**Figure 2**: Create a New ObjectDataSource Named `SuppliersDataSource` ([Click to view full-size image](performing-batch-updates-vb/_static/image6.png))</span></span>


<span data-ttu-id="2d9fc-130">Configurar o ObjectDataSource para recuperar dados usando o `SuppliersBLL` classe s `GetSuppliers()` método (veja a Figura 3).</span><span class="sxs-lookup"><span data-stu-id="2d9fc-130">Configure the ObjectDataSource to retrieve data using the `SuppliersBLL` class s `GetSuppliers()` method (see Figure 3).</span></span> <span data-ttu-id="2d9fc-131">Assim como acontece com o tutorial anterior, em vez de atualizar as informações de fornecedor por meio do ObjectDataSource, trabalharemos diretamente com a camada de lógica de negócios.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-131">As with the preceding tutorial, rather than updating the supplier information through the ObjectDataSource, we'll work directly with the Business Logic Layer.</span></span> <span data-ttu-id="2d9fc-132">Portanto, definir a lista suspensa como (nenhum) no guia de atualização (consulte a Figura 4).</span><span class="sxs-lookup"><span data-stu-id="2d9fc-132">Therefore, set the drop-down list to (None) in the UPDATE tab (see Figure 4).</span></span>


<span data-ttu-id="2d9fc-133">[![Recuperar informações de fornecedor usando o método GetSuppliers()](performing-batch-updates-vb/_static/image8.png)](performing-batch-updates-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="2d9fc-133">[![Retrieve Supplier Information Using the GetSuppliers() Method](performing-batch-updates-vb/_static/image8.png)](performing-batch-updates-vb/_static/image7.png)</span></span>

<span data-ttu-id="2d9fc-134">**Figura 3**: recupere informações do fornecedor usando a `GetSuppliers()` método ([clique para exibir a imagem em tamanho normal](performing-batch-updates-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="2d9fc-134">**Figure 3**: Retrieve Supplier Information Using the `GetSuppliers()` Method ([Click to view full-size image](performing-batch-updates-vb/_static/image9.png))</span></span>


<span data-ttu-id="2d9fc-135">[![Definir a lista suspensa como (nenhum) no guia de atualização](performing-batch-updates-vb/_static/image11.png)](performing-batch-updates-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="2d9fc-135">[![Set the Drop-Down List to (None) in the UPDATE Tab](performing-batch-updates-vb/_static/image11.png)](performing-batch-updates-vb/_static/image10.png)</span></span>

<span data-ttu-id="2d9fc-136">**Figura 4**: defina a lista suspensa como (nenhum) no guia de atualização ([clique para exibir a imagem em tamanho normal](performing-batch-updates-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="2d9fc-136">**Figure 4**: Set the Drop-Down List to (None) in the UPDATE Tab ([Click to view full-size image](performing-batch-updates-vb/_static/image12.png))</span></span>


<span data-ttu-id="2d9fc-137">Depois de concluir o assistente, o Visual Studio gera automaticamente DataList s `ItemTemplate` para exibir cada campo de dados retornado pela fonte de dados em um controle de rótulo.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-137">After completing the wizard, Visual Studio automatically generates the DataList s `ItemTemplate` to display each data field returned by the data source in a Label Web control.</span></span> <span data-ttu-id="2d9fc-138">Precisamos modificar esse modelo para que ele fornece a interface de edição em vez disso.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-138">We need to modify this template so that it provides the editing interface instead.</span></span> <span data-ttu-id="2d9fc-139">O `ItemTemplate` pode ser personalizado por meio do Designer usando a opção de editar modelos da marca inteligente DataList s ou diretamente por meio da sintaxe declarativa.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-139">The `ItemTemplate` can be customized through the Designer using the Edit Templates option from the DataList s smart tag or directly through the declarative syntax.</span></span>

<span data-ttu-id="2d9fc-140">Reserve um tempo para criar uma interface de edição que exibe o nome do fornecedor s como texto, mas inclui caixas de texto para o fornecedor s endereço, cidade e valores de país.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-140">Take a moment to create an editing interface that displays the supplier s name as text, but includes TextBoxes for the supplier s address, city, and country values.</span></span> <span data-ttu-id="2d9fc-141">Depois de fazer essas alterações, sua sintaxe declarativa de s de página deve ser semelhante ao seguinte:</span><span class="sxs-lookup"><span data-stu-id="2d9fc-141">After making these changes, your page s declarative syntax should look similar to the following:</span></span>


[!code-aspx[Main](performing-batch-updates-vb/samples/sample1.aspx)]

> [!NOTE]
> <span data-ttu-id="2d9fc-142">Como com o tutorial anterior, DataList neste tutorial deverá ter seu estado de exibição habilitado.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-142">As with the preceding tutorial, the DataList in this tutorial must have its view state enabled.</span></span>


<span data-ttu-id="2d9fc-143">No `ItemTemplate` eu m usando duas novas classes CSS, `SupplierPropertyLabel` e `SupplierPropertyValue`, que foram adicionado ao `Styles.css` classe e configurado para usar as mesmas configurações de estilo que o `ProductPropertyLabel` e `ProductPropertyValue` classes CSS.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-143">In the `ItemTemplate` I m using two new CSS classes, `SupplierPropertyLabel` and `SupplierPropertyValue`, which have been added to the `Styles.css` class and configured to use the same style settings as the `ProductPropertyLabel` and `ProductPropertyValue` CSS classes.</span></span>


[!code-css[Main](performing-batch-updates-vb/samples/sample2.css)]

<span data-ttu-id="2d9fc-144">Depois de fazer essas alterações, visite esta página por meio de um navegador.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-144">After making these changes, visit this page through a browser.</span></span> <span data-ttu-id="2d9fc-145">Como mostra a Figura 5, cada item DataList exibe o nome do fornecedor como texto e usa caixas de texto para exibir o endereço, cidade e país.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-145">As Figure 5 shows, each DataList item displays the supplier name as text and uses TextBoxes to display the address, city, and country.</span></span>


<span data-ttu-id="2d9fc-146">[![Cada fornecedor no DataList é editável](performing-batch-updates-vb/_static/image14.png)](performing-batch-updates-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="2d9fc-146">[![Each Supplier in the DataList is Editable](performing-batch-updates-vb/_static/image14.png)](performing-batch-updates-vb/_static/image13.png)</span></span>

<span data-ttu-id="2d9fc-147">**Figura 5**: cada fornecedor no DataList é editável ([clique para exibir a imagem em tamanho normal](performing-batch-updates-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="2d9fc-147">**Figure 5**: Each Supplier in the DataList is Editable ([Click to view full-size image](performing-batch-updates-vb/_static/image15.png))</span></span>


## <a name="step-2-adding-an-update-all-button"></a><span data-ttu-id="2d9fc-148">Etapa 2: Adicionando uma atualização de todos os botões</span><span class="sxs-lookup"><span data-stu-id="2d9fc-148">Step 2: Adding an Update All Button</span></span>

<span data-ttu-id="2d9fc-149">Embora cada fornecedor na Figura 5 tem seu endereço, cidade e campos de país, exibidos em uma caixa de texto, no momento, não há nenhum botão de atualização disponível.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-149">While each supplier in Figure 5 has its address, city, and country fields displayed in a TextBox, there currently is no Update button available.</span></span> <span data-ttu-id="2d9fc-150">Em vez de ter um botão de atualização por item, com DataLists totalmente editáveis normalmente há um único botão Atualizar tudo na página que, quando clicado, atualiza *todos os* dos registros no DataList.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-150">Rather than having an Update button per item, with fully editable DataLists there is typically a single Update All button on the page that, when clicked, updates *all* of the records in the DataList.</span></span> <span data-ttu-id="2d9fc-151">Para este tutorial, deixe s adicionar dois botões Atualizar tudo - uma na parte superior da página e outra na parte inferior (embora clicando em um dos botões terá o mesmo efeito).</span><span class="sxs-lookup"><span data-stu-id="2d9fc-151">For this tutorial, let s add two Update All buttons - one at the top of the page and one at the bottom (although clicking either button will have the same effect).</span></span>

<span data-ttu-id="2d9fc-152">Comece adicionando um controle da Web de botão acima do DataList e o conjunto de seu `ID` propriedade para `UpdateAll1`.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-152">Start by adding a Button Web control above the DataList and set its `ID` property to `UpdateAll1`.</span></span> <span data-ttu-id="2d9fc-153">Em seguida, adicione o segundo controle da Web de botão embaixo do DataList, definindo sua `ID` para `UpdateAll2`.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-153">Next, add the second Button Web control beneath the DataList, setting its `ID` to `UpdateAll2`.</span></span> <span data-ttu-id="2d9fc-154">Defina o `Text` propriedades para os dois botões Atualizar tudo.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-154">Set the `Text` properties for the two Buttons to Update All.</span></span> <span data-ttu-id="2d9fc-155">Por fim, criar manipuladores de eventos para ambos os botões `Click` eventos.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-155">Lastly, create event handlers for both Buttons `Click` events.</span></span> <span data-ttu-id="2d9fc-156">Em vez de duplicar a lógica de atualização em cada um dos manipuladores de eventos, let s refatorar essa lógica para um terceiro método, `UpdateAllSupplierAddresses`, tendo os manipuladores de eventos simplesmente invocar esse método de terceiro.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-156">Rather than duplicating the update logic in each of the event handlers, let s refactor that logic to a third method, `UpdateAllSupplierAddresses`, having the event handlers simply invoking this third method.</span></span>


[!code-vb[Main](performing-batch-updates-vb/samples/sample3.vb)]

<span data-ttu-id="2d9fc-157">Figura 6 mostra a página após os atualização de todos os botões foram adicionados.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-157">Figure 6 shows the page after the Update All buttons have been added.</span></span>


<span data-ttu-id="2d9fc-158">[![Dois atualização todos os botões foram adicionados à página](performing-batch-updates-vb/_static/image17.png)](performing-batch-updates-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="2d9fc-158">[![Two Update All Buttons have been Added to the Page](performing-batch-updates-vb/_static/image17.png)](performing-batch-updates-vb/_static/image16.png)</span></span>

<span data-ttu-id="2d9fc-159">**Figura 6**: dois atualização todos os botões foram adicionados à página ([clique para exibir a imagem em tamanho normal](performing-batch-updates-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="2d9fc-159">**Figure 6**: Two Update All Buttons have been Added to the Page ([Click to view full-size image](performing-batch-updates-vb/_static/image18.png))</span></span>


## <a name="step-3-updating-all-of-the-suppliers-address-information"></a><span data-ttu-id="2d9fc-160">Etapa 3: Atualizar todas as informações de endereço de fornecedores</span><span class="sxs-lookup"><span data-stu-id="2d9fc-160">Step 3: Updating All of the Suppliers Address Information</span></span>

<span data-ttu-id="2d9fc-161">Com todos os itens de s DataList exibindo a interface de edição e a adição dos botões Atualizar tudo, tudo o que resta é escrever o código para executar a atualização em lotes.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-161">With all of the DataList s items displaying the editing interface and with the addition of the Update All buttons, all that remains is writing the code to perform the batch update.</span></span> <span data-ttu-id="2d9fc-162">Especificamente, é necessário executar um loop por meio de itens DataList s e chamar o `SuppliersBLL` classe s `UpdateSupplierAddress` método para cada um deles.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-162">Specifically, we need to loop through the DataList s items and call the `SuppliersBLL` class s `UpdateSupplierAddress` method for each one.</span></span>

<span data-ttu-id="2d9fc-163">A coleção de `DataListItem` instâncias essa composição DataList pode ser acessado por meio do DataList s [ `Items` propriedade](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.items.aspx).</span><span class="sxs-lookup"><span data-stu-id="2d9fc-163">The collection of `DataListItem` instances that makeup the DataList can be accessed via the DataList s [`Items` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.items.aspx).</span></span> <span data-ttu-id="2d9fc-164">Com uma referência a um `DataListItem`, pode capturamos correspondente `SupplierID` da `DataKeys` referência TextBox Web controles dentro de coleção e programaticamente o `ItemTemplate` como o código a seguir ilustra:</span><span class="sxs-lookup"><span data-stu-id="2d9fc-164">With a reference to a `DataListItem`, we can grab the corresponding `SupplierID` from the `DataKeys` collection and programmatically reference the TextBox Web controls within the `ItemTemplate` as the following code illustrates:</span></span>


[!code-vb[Main](performing-batch-updates-vb/samples/sample4.vb)]

<span data-ttu-id="2d9fc-165">Quando o usuário clica em um dos botões Atualizar tudo, o `UpdateAllSupplierAddresses` método percorre cada `DataListItem` na `Suppliers` DataList e chama o `SuppliersBLL` classe s `UpdateSupplierAddress` método, passando os valores correspondentes.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-165">When the user clicks one of the Update All buttons, the `UpdateAllSupplierAddresses` method iterates through each `DataListItem` in the `Suppliers` DataList and calls the `SuppliersBLL` class s `UpdateSupplierAddress` method, passing in the corresponding values.</span></span> <span data-ttu-id="2d9fc-166">Um valor não digitado para o endereço, cidade ou país passes é um valor de `Nothing` à `UpdateSupplierAddress` (em vez de uma cadeia de caracteres vazia), que resulta em um banco de dados `NULL` para os campos de registro s subjacentes.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-166">A non-entered value for address, city, or country passes is a value of `Nothing` to `UpdateSupplierAddress` (rather than a blank string), which results in a database `NULL` for the underlying record s fields.</span></span>

> [!NOTE]
> <span data-ttu-id="2d9fc-167">Como um aprimoramento, você talvez queira adicionar um controle da Web do rótulo de status para a página que fornece alguma mensagem de confirmação após a atualização em lotes é executada.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-167">As an enhancement, you may want to add a status Label Web control to the page that provides some confirmation message after the batch update is performed.</span></span>


## <a name="updating-only-those-addresses-that-have-been-modified"></a><span data-ttu-id="2d9fc-168">Atualizar apenas os endereços que foram modificados</span><span class="sxs-lookup"><span data-stu-id="2d9fc-168">Updating Only Those Addresses That Have Been Modified</span></span>

<span data-ttu-id="2d9fc-169">O algoritmo de atualização de lote usado para este tutorial chamadas a `UpdateSupplierAddress` método para *cada* supplier no DataList, independentemente se as informações de endereço foi alteradas.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-169">The batch update algorithm used for this tutorial calls the `UpdateSupplierAddress` method for *every* supplier in the DataList, regardless of whether their address information has been changed.</span></span> <span data-ttu-id="2d9fc-170">Enquanto essa blind atualiza t são inválidas normalmente um problema de desempenho, eles podem levar supérfluos registros se você está a auditoria for alterado para a tabela de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-170">While such blind updates aren t usually a performance issue, they can lead to superfluous records if you re auditing changes to the database table.</span></span> <span data-ttu-id="2d9fc-171">Por exemplo, se você usar gatilhos para registrar todos os `UPDATE` s para o `Suppliers` tabela para uma tabela de auditoria, sempre que um usuário clica no botão Atualizar tudo que um novo registro de auditoria será criado para cada fornecedor no sistema, independentemente se o usuário tiver feito uma alterações.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-171">For example, if you use triggers to record all `UPDATE` s to the `Suppliers` table to an auditing table, every time a user clicks the Update All button a new audit record will be created for each supplier in the system, regardless of whether the user made any changes.</span></span>

<span data-ttu-id="2d9fc-172">As classes de DataTable do ADO.NET e DataAdapter são projetadas para dar suporte a atualizações em lotes em que registros novos, excluídos e modificados apenas resulta em qualquer comunicação de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-172">The ADO.NET DataTable and DataAdapter classes are designed to support batch updates where only modified, deleted, and new records results in any database communication.</span></span> <span data-ttu-id="2d9fc-173">Cada linha na DataTable tem um [ `RowState` propriedade](https://msdn.microsoft.com/library/system.data.datarow.rowstate.aspx) que indica se a linha foi adicionada à DataTable, excluído, modificados, ou permanece inalterada.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-173">Each row in the DataTable has a [`RowState` property](https://msdn.microsoft.com/library/system.data.datarow.rowstate.aspx) that indicates whether the row has been added to the DataTable, deleted from it, modified, or remains unchanged.</span></span> <span data-ttu-id="2d9fc-174">Quando um DataTable é preenchido inicialmente, todas as linhas são marcadas inalteradas.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-174">When a DataTable is initially populated, all rows are marked unchanged.</span></span> <span data-ttu-id="2d9fc-175">Alterar o valor de qualquer uma das colunas s linha marca a linha como modificada.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-175">Changing the value of any of the row s columns marks the row as modified.</span></span>

<span data-ttu-id="2d9fc-176">No `SuppliersBLL` classe, podemos atualizar as informações de endereço de fornecedor especificado s com a primeira leitura no registro único fornecedor em um `SuppliersDataTable` e, em seguida, defina o `Address`, `City`, e `Country` valores de coluna usando o código a seguir:</span><span class="sxs-lookup"><span data-stu-id="2d9fc-176">In the `SuppliersBLL` class we update the specified supplier s address information by first reading in the single supplier record into a `SuppliersDataTable` and then set the `Address`, `City`, and `Country` column values using the following code:</span></span>


[!code-vb[Main](performing-batch-updates-vb/samples/sample5.vb)]

<span data-ttu-id="2d9fc-177">Esse código ingenuamente atribui o passado no endereço, cidade e valores de país para o `SuppliersRow` no `SuppliersDataTable` , independentemente de estarem ou não os valores foram alterados.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-177">This code naively assigns the passed-in address, city, and country values to the `SuppliersRow` in the `SuppliersDataTable` regardless of whether or not the values have changed.</span></span> <span data-ttu-id="2d9fc-178">Fazer com que essas modificações a `SuppliersRow` s `RowState` propriedade a ser marcada como modificada.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-178">These modifications cause the `SuppliersRow` s `RowState` property to be marked as modified.</span></span> <span data-ttu-id="2d9fc-179">Quando a camada de acesso a dados s `Update` método é chamado, ele vê que o `SupplierRow` foi modificada e, portanto, envia um `UPDATE` comando no banco de dados.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-179">When the Data Access Layer s `Update` method is called, it sees that the `SupplierRow` has been modified and therefore sends an `UPDATE` command to the database.</span></span>

<span data-ttu-id="2d9fc-180">No entanto, imagine que adicionamos código para este método para atribuir apenas a passado no endereço, cidade e valores de país, se eles forem diferentes do `SuppliersRow` valores existentes de s.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-180">Imagine, however, that we added code to this method to only assign the passed-in address, city, and country values if they differ from the `SuppliersRow` s existing values.</span></span> <span data-ttu-id="2d9fc-181">No caso em que o endereço, cidade e país são o mesmo que os dados existentes, nenhuma alteração será feita e o `SupplierRow` s `RowState` não podem ser esquerda marcada como alterada.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-181">In the case where the address, city, and country are the same as the existing data, no changes will be made and the `SupplierRow` s `RowState` will be left marked as unchanged.</span></span> <span data-ttu-id="2d9fc-182">O resultado líquido é que quando o s DAL `Update` método é chamado, não será feita nenhuma chamada de banco de dados porque o `SuppliersRow` não foi modificado.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-182">The net result is that when the DAL s `Update` method is called, no database call will be made because the `SuppliersRow` has not been modified.</span></span>

<span data-ttu-id="2d9fc-183">Para aplicar essa alteração, substitua as instruções que atribuir cegamente o passado no endereço, cidade e valores de país com o código a seguir:</span><span class="sxs-lookup"><span data-stu-id="2d9fc-183">To enact this change, replace the statements that blindly assign the passed-in address, city, and country values with the following code:</span></span>


[!code-vb[Main](performing-batch-updates-vb/samples/sample6.vb)]

<span data-ttu-id="2d9fc-184">Com esse código adicionado, o s DAL `Update` método envia uma `UPDATE` instrução no banco de dados para somente os registros cujos valores de endereço foram alterados.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-184">With this added code, the DAL s `Update` method sends an `UPDATE` statement to the database for only those records whose address-related values have changed.</span></span>

<span data-ttu-id="2d9fc-185">Como alternativa, poderíamos controlar de se houver alguma diferença entre os campos de endereço passado e do banco de dados e, se não houver nenhum, basta ignorar a chamada para o s DAL `Update` método.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-185">Alternatively, we could keep track of whether there are any differences between the passed-in address fields and the database data and, if there are none, simply bypass the call to the DAL s `Update` method.</span></span> <span data-ttu-id="2d9fc-186">Essa abordagem funciona bem se você está usando o banco de dados direcionar o método, já que não seja o método direto de DB passado um `SuppliersRow` instância cujo `RowState` pode ser verificada para determinar se uma chamada de banco de dados, na verdade, é necessário.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-186">This approach works well if you re using the DB direct method, since the DB direct method isn t passed a `SuppliersRow` instance whose `RowState` can be checked to determine whether a database call is actually needed.</span></span>

> [!NOTE]
> <span data-ttu-id="2d9fc-187">Cada vez que o `UpdateSupplierAddress` método é invocado, é feita uma chamada para o banco de dados para recuperar informações sobre o registro atualizado.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-187">Each time the `UpdateSupplierAddress` method is invoked, a call is made to the database to retrieve information about the updated record.</span></span> <span data-ttu-id="2d9fc-188">Em seguida, se houver alterações nos dados, outra chamada para o banco de dados é feita para atualizar a linha da tabela.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-188">Then, if there are any changes in data, another call to the database is made to update the table row.</span></span> <span data-ttu-id="2d9fc-189">Esse fluxo de trabalho poderia ser otimizado com a criação de um `UpdateSupplierAddress` sobrecarga de método que aceita um `EmployeesDataTable` instância que tem *todos os* das alterações a `BatchUpdate.aspx` página.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-189">This workflow could be optimized by creating an `UpdateSupplierAddress` method overload that accepts an `EmployeesDataTable` instance that has *all* of the changes from the `BatchUpdate.aspx` page.</span></span> <span data-ttu-id="2d9fc-190">Em seguida, ele poderia fazer uma chamada para o banco de dados para obter todos os registros da `Suppliers` tabela.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-190">Then, it could make one call to the database to get all of the records from the `Suppliers` table.</span></span> <span data-ttu-id="2d9fc-191">Os dois conjuntos de resultados, em seguida, poderiam ser enumerados e somente os registros em que ocorreram alterações pode ser atualizados.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-191">The two resultsets could then be enumerated and only those records where changes have occurred could be updated.</span></span>


## <a name="summary"></a><span data-ttu-id="2d9fc-192">Resumo</span><span class="sxs-lookup"><span data-stu-id="2d9fc-192">Summary</span></span>

<span data-ttu-id="2d9fc-193">Neste tutorial vimos como criar uma DataList totalmente editável, que permite ao usuário modificar rapidamente as informações de endereço para vários fornecedores.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-193">In this tutorial we saw how to create a fully editable DataList, allowing a user to quickly modify the address information for multiple suppliers.</span></span> <span data-ttu-id="2d9fc-194">Começamos definindo a interface de edição para o fornecedor s endereço, cidade e valores de país, um controle de TextBox Web no DataList s `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-194">We started by defining the editing interface a TextBox Web control for the supplier s address, city, and country values in the DataList s `ItemTemplate`.</span></span> <span data-ttu-id="2d9fc-195">Em seguida, adicionamos botões Atualizar tudo acima e abaixo do DataList.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-195">Next, we added Update All buttons above and below the DataList.</span></span> <span data-ttu-id="2d9fc-196">Depois que um usuário tiver feito suas alterações e clicou em um dos botões Atualizar tudo, o `DataListItem` s são enumerados e uma chamada para o `SuppliersBLL` classe s `UpdateSupplierAddress` método é feito.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-196">After a user has made his changes and clicked one of the Update All buttons, the `DataListItem` s are enumerated and a call to the `SuppliersBLL` class s `UpdateSupplierAddress` method is made.</span></span>

<span data-ttu-id="2d9fc-197">Boa programação!</span><span class="sxs-lookup"><span data-stu-id="2d9fc-197">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="2d9fc-198">Sobre o autor</span><span class="sxs-lookup"><span data-stu-id="2d9fc-198">About the Author</span></span>

<span data-ttu-id="2d9fc-199">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de sete livros sobre ASP/ASP.NET e fundador da [4GuysFromRolla.com](http://www.4guysfromrolla.com), tem trabalhado com tecnologias Microsoft Web desde 1998.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-199">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="2d9fc-200">Scott funciona como um consultor independente, instrutor e escritor.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-200">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="2d9fc-201">Seu livro mais recente é [ *Sams Teach por conta própria ASP.NET 2.0 em 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="2d9fc-201">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="2d9fc-202">Ele pode ser contatado pelo [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="2d9fc-202">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="2d9fc-203">ou por meio de seu blog, que pode ser encontrado em [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="2d9fc-203">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="2d9fc-204">Agradecimentos especiais a</span><span class="sxs-lookup"><span data-stu-id="2d9fc-204">Special Thanks To</span></span>

<span data-ttu-id="2d9fc-205">Esta série de tutoriais foi revisada por muitos revisores úteis.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-205">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="2d9fc-206">Os revisores de avanço para este tutorial foram Zack Jones e Ken Pespisa.</span><span class="sxs-lookup"><span data-stu-id="2d9fc-206">Lead reviewers for this tutorial were Zack Jones and Ken Pespisa.</span></span> <span data-ttu-id="2d9fc-207">Você está interessado na revisão Meus próximos artigos do MSDN?</span><span class="sxs-lookup"><span data-stu-id="2d9fc-207">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="2d9fc-208">Nesse caso, me descartar uma linha na [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="2d9fc-208">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="2d9fc-209">[Anterior](an-overview-of-editing-and-deleting-data-in-the-datalist-vb.md)
> [Próximo](handling-bll-and-dal-level-exceptions-vb.md)</span><span class="sxs-lookup"><span data-stu-id="2d9fc-209">[Previous](an-overview-of-editing-and-deleting-data-in-the-datalist-vb.md)
[Next](handling-bll-and-dal-level-exceptions-vb.md)</span></span>

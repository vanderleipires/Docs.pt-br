---
uid: web-forms/overview/older-versions-security/admin/building-an-interface-to-select-one-user-account-from-many-cs
title: Criação de uma Interface para selecionar uma conta de usuário dentre muitas (c#) | Microsoft Docs
author: rick-anderson
description: Neste tutorial, vamos criar uma interface do usuário com uma grade paginável, que podem ser filtrada. Em particular, nossa interface do usuário consistirá em uma série de botões de link para...
ms.author: riande
ms.date: 04/01/2008
ms.assetid: 9e4e687c-b4ec-434f-a4ef-edb0b8f365e4
msc.legacyurl: /web-forms/overview/older-versions-security/admin/building-an-interface-to-select-one-user-account-from-many-cs
msc.type: authoredcontent
ms.openlocfilehash: 863ac36ae6a94ece841088db925c04deb3bf36c9
ms.sourcegitcommit: 45ac74e400f9f2b7dbded66297730f6f14a4eb25
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/16/2018
ms.locfileid: "41834483"
---
<a name="building-an-interface-to-select-one-user-account-from-many-c"></a><span data-ttu-id="5b44e-104">Criação de uma Interface para selecionar uma conta de usuário dentre muitas (c#)</span><span class="sxs-lookup"><span data-stu-id="5b44e-104">Building an Interface to Select One User Account from Many (C#)</span></span>
====================
<span data-ttu-id="5b44e-105">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="5b44e-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="5b44e-106">[Baixar o código](http://download.microsoft.com/download/6/0/e/60e1bd94-e5f9-4d5a-a079-f23c98f4f67d/CS.12.zip) ou [baixar PDF](http://download.microsoft.com/download/6/0/e/60e1bd94-e5f9-4d5a-a079-f23c98f4f67d/aspnet_tutorial12_SelectUser_cs.pdf)</span><span class="sxs-lookup"><span data-stu-id="5b44e-106">[Download Code](http://download.microsoft.com/download/6/0/e/60e1bd94-e5f9-4d5a-a079-f23c98f4f67d/CS.12.zip) or [Download PDF](http://download.microsoft.com/download/6/0/e/60e1bd94-e5f9-4d5a-a079-f23c98f4f67d/aspnet_tutorial12_SelectUser_cs.pdf)</span></span>

> <span data-ttu-id="5b44e-107">Neste tutorial, vamos criar uma interface do usuário com uma grade paginável, que podem ser filtrada.</span><span class="sxs-lookup"><span data-stu-id="5b44e-107">In this tutorial we will build a user interface with a paged, filterable grid.</span></span> <span data-ttu-id="5b44e-108">Em particular, a nossa interface do usuário consistirá de uma série de botões de link para filtrar os resultados com base na letra inicial do nome de usuário e um controle GridView para mostrar os usuários correspondentes.</span><span class="sxs-lookup"><span data-stu-id="5b44e-108">In particular, our user interface will consist of a series of LinkButtons for filtering the results based on the starting letter of the username, and a GridView control to show the matching users.</span></span> <span data-ttu-id="5b44e-109">Vamos começar listando todas as contas de usuário em um GridView.</span><span class="sxs-lookup"><span data-stu-id="5b44e-109">We'll start by listing all of the user accounts in a GridView.</span></span> <span data-ttu-id="5b44e-110">Em seguida, na etapa 3, vamos adicionar o filtro de botões de link.</span><span class="sxs-lookup"><span data-stu-id="5b44e-110">Then, in Step 3, we will add the filter LinkButtons.</span></span> <span data-ttu-id="5b44e-111">Etapa 4 examina os resultados filtrados de paginação.</span><span class="sxs-lookup"><span data-stu-id="5b44e-111">Step 4 looks at paging the filtered results.</span></span> <span data-ttu-id="5b44e-112">A interface criada nas etapas 2 a 4 será ser usada nos próximos tutoriais para executar tarefas administrativas para uma determinada conta de usuário.</span><span class="sxs-lookup"><span data-stu-id="5b44e-112">The interface constructed in Steps 2 through 4 will be used in the subsequent tutorials to perform administrative tasks for a particular user account.</span></span>


## <a name="introduction"></a><span data-ttu-id="5b44e-113">Introdução</span><span class="sxs-lookup"><span data-stu-id="5b44e-113">Introduction</span></span>

<span data-ttu-id="5b44e-114">No <a id="_msoanchor_1"> </a> [ *atribuir funções a usuários* ](../roles/assigning-roles-to-users-cs.md) tutorial, criamos uma interface rudimentar para um administrador para selecionar um usuário e gerenciar suas funções.</span><span class="sxs-lookup"><span data-stu-id="5b44e-114">In the <a id="_msoanchor_1"></a>[*Assigning Roles to Users*](../roles/assigning-roles-to-users-cs.md) tutorial, we created a rudimentary interface for an administrator to select a user and manage her roles.</span></span> <span data-ttu-id="5b44e-115">Especificamente, a interface apresentada o administrador com uma lista suspensa de todos os usuários.</span><span class="sxs-lookup"><span data-stu-id="5b44e-115">Specifically, the interface presented the administrator with a drop-down list of all of the users.</span></span> <span data-ttu-id="5b44e-116">Tal interface é adequado quando existem, mas o usuário de uma dúzia ou mais contas, mas é complicado para sites com centenas ou milhares de contas.</span><span class="sxs-lookup"><span data-stu-id="5b44e-116">Such an interface is suitable when there are but a dozen or so user accounts, but is unwieldy for sites with hundreds or thousands of accounts.</span></span> <span data-ttu-id="5b44e-117">Uma grade paginada, filtrável é a interface do usuário mais adequada para sites com bases de usuários grandes.</span><span class="sxs-lookup"><span data-stu-id="5b44e-117">A paged, filterable grid is more suitable user interface for websites with large user bases.</span></span>

<span data-ttu-id="5b44e-118">Neste tutorial, vamos criar tal uma interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="5b44e-118">In this tutorial we will build such a user interface.</span></span> <span data-ttu-id="5b44e-119">Em particular, a nossa interface do usuário consistirá de uma série de botões de link para filtrar os resultados com base na letra inicial do nome de usuário e um controle GridView para mostrar os usuários correspondentes.</span><span class="sxs-lookup"><span data-stu-id="5b44e-119">In particular, our user interface will consist of a series of LinkButtons for filtering the results based on the starting letter of the username, and a GridView control to show the matching users.</span></span> <span data-ttu-id="5b44e-120">Vamos começar listando todas as contas de usuário em um GridView.</span><span class="sxs-lookup"><span data-stu-id="5b44e-120">We'll start by listing all of the user accounts in a GridView.</span></span> <span data-ttu-id="5b44e-121">Em seguida, na etapa 3, vamos adicionar o filtro de botões de link.</span><span class="sxs-lookup"><span data-stu-id="5b44e-121">Then, in Step 3, we will add the filter LinkButtons.</span></span> <span data-ttu-id="5b44e-122">Etapa 4 examina os resultados filtrados de paginação.</span><span class="sxs-lookup"><span data-stu-id="5b44e-122">Step 4 looks at paging the filtered results.</span></span> <span data-ttu-id="5b44e-123">A interface criada nas etapas 2 a 4 será ser usada nos próximos tutoriais para executar tarefas administrativas para uma determinada conta de usuário.</span><span class="sxs-lookup"><span data-stu-id="5b44e-123">The interface constructed in Steps 2 through 4 will be used in the subsequent tutorials to perform administrative tasks for a particular user account.</span></span>

<span data-ttu-id="5b44e-124">Vamos começar!</span><span class="sxs-lookup"><span data-stu-id="5b44e-124">Let's get started!</span></span>

## <a name="step-1-adding-new-aspnet-pages"></a><span data-ttu-id="5b44e-125">Etapa 1: Adicionar novas páginas do ASP.NET</span><span class="sxs-lookup"><span data-stu-id="5b44e-125">Step 1: Adding New ASP.NET Pages</span></span>

<span data-ttu-id="5b44e-126">Este tutorial e as próximas duas podemos será examinando vários recursos e funções relacionadas à administração.</span><span class="sxs-lookup"><span data-stu-id="5b44e-126">In this tutorial and the next two we will be examining various administration-related functions and capabilities.</span></span> <span data-ttu-id="5b44e-127">Precisaremos de uma série de páginas do ASP.NET para implementar os tópicos examinados durante esses tutoriais.</span><span class="sxs-lookup"><span data-stu-id="5b44e-127">We will need a series of ASP.NET pages to implement the topics examined throughout these tutorials.</span></span> <span data-ttu-id="5b44e-128">Vamos criar essas páginas e atualizar o mapa de site.</span><span class="sxs-lookup"><span data-stu-id="5b44e-128">Let's create these pages and update the site map.</span></span>

<span data-ttu-id="5b44e-129">Comece criando uma nova pasta no projeto chamado `Administration`.</span><span class="sxs-lookup"><span data-stu-id="5b44e-129">Start by creating a new folder in the project named `Administration`.</span></span> <span data-ttu-id="5b44e-130">Em seguida, adicione duas novas páginas do ASP.NET para a pasta, vinculando cada página com o `Site.master` página mestra.</span><span class="sxs-lookup"><span data-stu-id="5b44e-130">Next, add two new ASP.NET pages to the folder, linking each page with the `Site.master` master page.</span></span> <span data-ttu-id="5b44e-131">Nomeie as páginas:</span><span class="sxs-lookup"><span data-stu-id="5b44e-131">Name the pages:</span></span>

- `ManageUsers.aspx`
- `UserInformation.aspx`

<span data-ttu-id="5b44e-132">Também adicione duas páginas para o diretório de raiz do site: `ChangePassword.aspx` e `RecoverPassword.aspx`.</span><span class="sxs-lookup"><span data-stu-id="5b44e-132">Also add two pages to the website's root directory: `ChangePassword.aspx` and `RecoverPassword.aspx`.</span></span>

<span data-ttu-id="5b44e-133">Esses quatro páginas neste ponto, devem, tem dois controles de conteúdo, uma para cada um dos ContentPlaceHolders da página mestra: `MainContent` e `LoginContent`.</span><span class="sxs-lookup"><span data-stu-id="5b44e-133">These four pages should, at this point, have two Content controls, one for each of the master page's ContentPlaceHolders: `MainContent` and `LoginContent`.</span></span>

[!code-aspx[Main](building-an-interface-to-select-one-user-account-from-many-cs/samples/sample1.aspx)]

<span data-ttu-id="5b44e-134">Queremos mostrar a marcação de padrão da página mestra para o `LoginContent` ContentPlaceHolder para essas páginas.</span><span class="sxs-lookup"><span data-stu-id="5b44e-134">We want to show the master page's default markup for the `LoginContent` ContentPlaceHolder for these pages.</span></span> <span data-ttu-id="5b44e-135">Portanto, remova a marcação declarativa para a `Content2` controle de conteúdo.</span><span class="sxs-lookup"><span data-stu-id="5b44e-135">Therefore, remove the declarative markup for the `Content2` Content control.</span></span> <span data-ttu-id="5b44e-136">Depois de fazer isso, a marcação de páginas deve conter apenas um controle de conteúdo.</span><span class="sxs-lookup"><span data-stu-id="5b44e-136">After doing so, the pages' markup should contain just one Content control.</span></span>

<span data-ttu-id="5b44e-137">As páginas do ASP.NET no `Administration` pasta destinam-se exclusivamente para os usuários administrativos.</span><span class="sxs-lookup"><span data-stu-id="5b44e-137">The ASP.NET pages in the `Administration` folder are intended solely for administrative users.</span></span> <span data-ttu-id="5b44e-138">Adicionamos uma função de administradores de sistema na <a id="_msoanchor_2"> </a> [ *criando e gerenciando funções* ](../roles/creating-and-managing-roles-cs.md) tutorial; restringir o acesso a essas duas páginas a essa função.</span><span class="sxs-lookup"><span data-stu-id="5b44e-138">We added an Administrators role to the system in the <a id="_msoanchor_2"></a>[*Creating and Managing Roles*](../roles/creating-and-managing-roles-cs.md) tutorial; restrict access to these two pages to this role.</span></span> <span data-ttu-id="5b44e-139">Para fazer isso, adicione uma `Web.config` o arquivo para o `Administration` pasta e configure seu `<authorization>` elemento admitir que os usuários na função de administradores e para negar a todos os outros.</span><span class="sxs-lookup"><span data-stu-id="5b44e-139">To accomplish this, add a `Web.config` file to the `Administration` folder and configure its `<authorization>` element to admit users in the Administrators role and to deny all others.</span></span>

[!code-xml[Main](building-an-interface-to-select-one-user-account-from-many-cs/samples/sample2.xml)]

<span data-ttu-id="5b44e-140">Neste ponto, Gerenciador de soluções do seu projeto deve ser semelhante à mostrada na Figura 1 de captura de tela.</span><span class="sxs-lookup"><span data-stu-id="5b44e-140">At this point your project's Solution Explorer should look similar to the screen shot shown in Figure 1.</span></span>


<span data-ttu-id="5b44e-141">[![Quatro novas páginas e um arquivo Web. config foram adicionados ao site](building-an-interface-to-select-one-user-account-from-many-cs/_static/image2.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="5b44e-141">[![Four New Pages and a Web.config File Have Been Added to the Website](building-an-interface-to-select-one-user-account-from-many-cs/_static/image2.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image1.png)</span></span>

<span data-ttu-id="5b44e-142">**Figura 1**: quatro novas páginas e uma `Web.config` arquivo foram adicionados ao site ([clique para exibir a imagem em tamanho normal](building-an-interface-to-select-one-user-account-from-many-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="5b44e-142">**Figure 1**: Four New Pages and a `Web.config` File Have Been Added to the Website  ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-cs/_static/image3.png))</span></span>


<span data-ttu-id="5b44e-143">Por fim, atualize o mapa do site (`Web.sitemap`) para incluir uma entrada para o `ManageUsers.aspx` página.</span><span class="sxs-lookup"><span data-stu-id="5b44e-143">Finally, update the site map (`Web.sitemap`) to include an entry to the `ManageUsers.aspx` page.</span></span> <span data-ttu-id="5b44e-144">Adicione o seguinte XML após o `<siteMapNode>` adicionamos para os tutoriais de funções.</span><span class="sxs-lookup"><span data-stu-id="5b44e-144">Add the following XML after the `<siteMapNode>` we added for the Roles tutorials.</span></span>

[!code-xml[Main](building-an-interface-to-select-one-user-account-from-many-cs/samples/sample3.xml)]

<span data-ttu-id="5b44e-145">Com o mapa de site atualizado, visite o site por meio de um navegador.</span><span class="sxs-lookup"><span data-stu-id="5b44e-145">With the site map updated, visit the site through a browser.</span></span> <span data-ttu-id="5b44e-146">Como mostra a Figura 2, a navegação à esquerda agora inclui itens para os tutoriais de administração.</span><span class="sxs-lookup"><span data-stu-id="5b44e-146">As Figure 2 shows, the navigation on the left now includes items for the Administration tutorials.</span></span>


<span data-ttu-id="5b44e-147">[![O mapa do Site inclui um nó chamado administração de usuários](building-an-interface-to-select-one-user-account-from-many-cs/_static/image5.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="5b44e-147">[![The Site Map Includes a Node Titled User Administration](building-an-interface-to-select-one-user-account-from-many-cs/_static/image5.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image4.png)</span></span>

<span data-ttu-id="5b44e-148">**Figura 2**: O mapa do Site inclui um nó intitulada administração do usuário ([clique para exibir a imagem em tamanho normal](building-an-interface-to-select-one-user-account-from-many-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="5b44e-148">**Figure 2**: The Site Map Includes a Node Titled User Administration  ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-cs/_static/image6.png))</span></span>


## <a name="step-2-listing-all-user-accounts-in-a-gridview"></a><span data-ttu-id="5b44e-149">Etapa 2: Listando todas as contas de usuário em um GridView</span><span class="sxs-lookup"><span data-stu-id="5b44e-149">Step 2: Listing All User Accounts in a GridView</span></span>

<span data-ttu-id="5b44e-150">Nossa meta final para este tutorial é criar uma grade paginável, que podem ser filtrada por meio do qual um administrador pode selecionar uma conta de usuário para gerenciar.</span><span class="sxs-lookup"><span data-stu-id="5b44e-150">Our end goal for this tutorial is to create a paged, filterable grid through which an administrator can select a user account to manage.</span></span> <span data-ttu-id="5b44e-151">Vamos começar listando *todos os* usuários em um GridView.</span><span class="sxs-lookup"><span data-stu-id="5b44e-151">Let's start by listing *all* users in a GridView.</span></span> <span data-ttu-id="5b44e-152">Quando isso for concluído, vamos adicionar as interfaces e funcionalidade de filtragem e paginação.</span><span class="sxs-lookup"><span data-stu-id="5b44e-152">Once this is complete, we will add the filtering and paging interfaces and functionality.</span></span>

<span data-ttu-id="5b44e-153">Abra o `ManageUsers.aspx` página na `Administration` pasta e adicione um GridView, definindo seu `ID` para `UserAccounts`.</span><span class="sxs-lookup"><span data-stu-id="5b44e-153">Open the `ManageUsers.aspx` page in the `Administration` folder and add a GridView, setting its `ID` to `UserAccounts`.</span></span> <span data-ttu-id="5b44e-154">Daqui a pouco, vamos escrever código para associar o conjunto de contas de usuário para o GridView usando o `Membership` da classe `GetAllUsers` método.</span><span class="sxs-lookup"><span data-stu-id="5b44e-154">In a moment, we will write code to bind the set of user accounts to the GridView using the `Membership` class's `GetAllUsers` method.</span></span> <span data-ttu-id="5b44e-155">Conforme discutido nos tutoriais anteriores, o método GetAllUsers retorna um `MembershipUserCollection` objeto, que é uma coleção de `MembershipUser` objetos.</span><span class="sxs-lookup"><span data-stu-id="5b44e-155">As discussed in earlier tutorials, the GetAllUsers method returns a `MembershipUserCollection` object, which is a collection of `MembershipUser` objects.</span></span> <span data-ttu-id="5b44e-156">Cada `MembershipUser` na coleção inclui propriedades como `UserName`, `Email`, `IsApproved`e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="5b44e-156">Each `MembershipUser` in the collection includes properties like `UserName`, `Email`, `IsApproved`, and so on.</span></span>

<span data-ttu-id="5b44e-157">Para exibir as informações de conta de usuário desejado em GridView, defina o GridView `AutoGenerateColumns` a propriedade como False e adicionar BoundFields para o `UserName`, `Email`, e `Comment` propriedades e CheckBoxFields para o `IsApproved`, `IsLockedOut`, e `IsOnline` propriedades.</span><span class="sxs-lookup"><span data-stu-id="5b44e-157">In order to display the desired user account information in the GridView, set the GridView's `AutoGenerateColumns` property to False and add BoundFields for the `UserName`, `Email`, and `Comment` properties and CheckBoxFields for the `IsApproved`, `IsLockedOut`, and `IsOnline` properties.</span></span> <span data-ttu-id="5b44e-158">Essa configuração pode ser aplicada por meio de marcação declarativa do controle ou da caixa de diálogo de campos.</span><span class="sxs-lookup"><span data-stu-id="5b44e-158">This configuration can be applied through the control's declarative markup or via the Fields dialog box.</span></span> <span data-ttu-id="5b44e-159">Figura 3 mostra uma captura de tela dos campos de caixa de diálogo depois que a caixa de seleção de campos de geração automática foi desmarcada e o BoundFields e CheckBoxFields foram adicionadas e configuradas.</span><span class="sxs-lookup"><span data-stu-id="5b44e-159">Figure 3 shows a screen shot of the Fields dialog box after the Auto-generate fields checkbox has been unchecked and the BoundFields and CheckBoxFields have been added and configured.</span></span>


<span data-ttu-id="5b44e-160">[![Adicione três BoundFields e três CheckBoxFields a GridView](building-an-interface-to-select-one-user-account-from-many-cs/_static/image8.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="5b44e-160">[![Add Three BoundFields and Three CheckBoxFields to the GridView](building-an-interface-to-select-one-user-account-from-many-cs/_static/image8.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image7.png)</span></span>

<span data-ttu-id="5b44e-161">**Figura 3**: adicionar três BoundFields e três CheckBoxFields a GridView ([clique para exibir a imagem em tamanho normal](building-an-interface-to-select-one-user-account-from-many-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="5b44e-161">**Figure 3**: Add Three BoundFields and Three CheckBoxFields to the GridView  ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-cs/_static/image9.png))</span></span>


<span data-ttu-id="5b44e-162">Depois de configurar o GridView, certifique-se de que sua marcação declarativa é semelhante à seguinte:</span><span class="sxs-lookup"><span data-stu-id="5b44e-162">After configuring your GridView, ensure that its declarative markup resembles the following:</span></span>

[!code-aspx[Main](building-an-interface-to-select-one-user-account-from-many-cs/samples/sample4.aspx)]

<span data-ttu-id="5b44e-163">Em seguida, precisamos escrever código que associa as contas de usuário para o GridView.</span><span class="sxs-lookup"><span data-stu-id="5b44e-163">Next, we need to write code that binds the user accounts to the GridView.</span></span> <span data-ttu-id="5b44e-164">Crie um método chamado `BindUserAccounts` para executar essa tarefa e, em seguida, chamá-lo no `Page_Load` manipulador de eventos na primeira visita de página.</span><span class="sxs-lookup"><span data-stu-id="5b44e-164">Create a method named `BindUserAccounts` to perform this task and then call it from the `Page_Load` event handler on the first page visit.</span></span>

[!code-csharp[Main](building-an-interface-to-select-one-user-account-from-many-cs/samples/sample5.cs)]

<span data-ttu-id="5b44e-165">Reserve um tempo para testar a página por meio de um navegador.</span><span class="sxs-lookup"><span data-stu-id="5b44e-165">Take a moment to test the page through a browser.</span></span> <span data-ttu-id="5b44e-166">Como mostra a Figura 4, o `UserAccounts` GridView lista o nome de usuário, endereço de email e outras informações de conta pertinentes para todos os usuários no sistema.</span><span class="sxs-lookup"><span data-stu-id="5b44e-166">As Figure 4 shows, the `UserAccounts` GridView lists the username, email address, and other pertinent account information for all users in the system.</span></span>


<span data-ttu-id="5b44e-167">[![As contas de usuário estão listadas em GridView](building-an-interface-to-select-one-user-account-from-many-cs/_static/image11.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="5b44e-167">[![The User Accounts are Listed in the GridView](building-an-interface-to-select-one-user-account-from-many-cs/_static/image11.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image10.png)</span></span>

<span data-ttu-id="5b44e-168">**Figura 4**: as contas de usuário são listadas no GridView ([clique para exibir a imagem em tamanho normal](building-an-interface-to-select-one-user-account-from-many-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="5b44e-168">**Figure 4**: The User Accounts are Listed in the GridView  ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-cs/_static/image12.png))</span></span>


## <a name="step-3-filtering-the-results-by-the-first-letter-of-the-username"></a><span data-ttu-id="5b44e-169">Etapa 3: Filtrando os resultados pela primeira letra do nome de usuário</span><span class="sxs-lookup"><span data-stu-id="5b44e-169">Step 3: Filtering the Results by the First Letter of the Username</span></span>

<span data-ttu-id="5b44e-170">Atualmente, o `UserAccounts` GridView mostra *todos os* das contas de usuário.</span><span class="sxs-lookup"><span data-stu-id="5b44e-170">Currently the `UserAccounts` GridView shows *all* of the user accounts.</span></span> <span data-ttu-id="5b44e-171">Para sites com centenas ou milhares de contas de usuário, é imperativo que o usuário seja capaz de reduzir rapidamente as contas exibidas.</span><span class="sxs-lookup"><span data-stu-id="5b44e-171">For websites with hundreds or thousands of user accounts, it is imperative that user be able to quickly pare down the displayed accounts.</span></span> <span data-ttu-id="5b44e-172">Isso pode ser feito adicionando-se a filtragem de botões de link para a página.</span><span class="sxs-lookup"><span data-stu-id="5b44e-172">This can be accomplished by adding filtering LinkButtons to the page.</span></span> <span data-ttu-id="5b44e-173">Vamos adicionar botões de 27 link para a página: um denominado tudo junto com um LinkButton para cada letra do alfabeto.</span><span class="sxs-lookup"><span data-stu-id="5b44e-173">Let's add 27 LinkButtons to the page: one titled All along with one LinkButton for each letter of the alphabet.</span></span> <span data-ttu-id="5b44e-174">Se um visitante clicar no LinkButton todos, GridView mostrará todos os usuários.</span><span class="sxs-lookup"><span data-stu-id="5b44e-174">If a visitor clicks the All LinkButton, the GridView will show all of the users.</span></span> <span data-ttu-id="5b44e-175">Se eles clicarem em uma determinada letra, somente os usuários cujo nome de usuário começa com a letra selecionada serão exibidos.</span><span class="sxs-lookup"><span data-stu-id="5b44e-175">If they click a particular letter, only those users whose username starts with the selected letter will be displayed.</span></span>

<span data-ttu-id="5b44e-176">Nossa primeira tarefa é adicionar os controles LinkButton 27.</span><span class="sxs-lookup"><span data-stu-id="5b44e-176">Our first task is to add the 27 LinkButton controls.</span></span> <span data-ttu-id="5b44e-177">Uma opção seria criar 27 LinkButtons declarativamente, um de cada vez.</span><span class="sxs-lookup"><span data-stu-id="5b44e-177">One option would be to create the 27 LinkButtons declaratively, one at a time.</span></span> <span data-ttu-id="5b44e-178">Uma abordagem mais flexível é usar um controle Repeater com um `ItemTemplate` que renderiza um LinkButton e, em seguida, associa as opções de filtragem para o Repeater como um `string` matriz.</span><span class="sxs-lookup"><span data-stu-id="5b44e-178">A more flexible approach is to use a Repeater control with an `ItemTemplate` that renders a LinkButton and then binds the filtering options to the Repeater as a `string` array.</span></span>

<span data-ttu-id="5b44e-179">Iniciar com a adição de um controle Repeater para a página acima a `UserAccounts` GridView.</span><span class="sxs-lookup"><span data-stu-id="5b44e-179">Start by adding a Repeater control to the page above the `UserAccounts` GridView.</span></span> <span data-ttu-id="5b44e-180">Defina o Repeater `ID` propriedade para `FilteringUI`.</span><span class="sxs-lookup"><span data-stu-id="5b44e-180">Set the Repeater's `ID` property to `FilteringUI`.</span></span> <span data-ttu-id="5b44e-181">Configurar modelos do repetidor para que seu `ItemTemplate` renderiza um LinkButton cujos `Text` e `CommandName` propriedades são associadas ao elemento de matriz atual.</span><span class="sxs-lookup"><span data-stu-id="5b44e-181">Configure the Repeater's templates so that its `ItemTemplate` renders a LinkButton whose `Text` and `CommandName` properties are bound to the current array element.</span></span> <span data-ttu-id="5b44e-182">Como vimos na <a id="_msoanchor_3"> </a> [ *atribuir funções a usuários* ](../roles/assigning-roles-to-users-cs.md) tutorial, isso pode ser feito usando o `Container.DataItem` sintaxe de associação de dados.</span><span class="sxs-lookup"><span data-stu-id="5b44e-182">As we saw in the <a id="_msoanchor_3"></a>[*Assigning Roles to Users*](../roles/assigning-roles-to-users-cs.md) tutorial, this can be accomplished using the `Container.DataItem` databinding syntax.</span></span> <span data-ttu-id="5b44e-183">Use o Repeater `SeparatorTemplate` para exibir uma linha vertical entre cada link.</span><span class="sxs-lookup"><span data-stu-id="5b44e-183">Use the Repeater's `SeparatorTemplate` to display a vertical line between each link.</span></span>

[!code-aspx[Main](building-an-interface-to-select-one-user-account-from-many-cs/samples/sample6.aspx)]

<span data-ttu-id="5b44e-184">Para preencher essa repetidor com as opções de filtragem desejadas, crie um método chamado `BindFilteringUI`.</span><span class="sxs-lookup"><span data-stu-id="5b44e-184">To populate this Repeater with the desired filtering options, create a method named `BindFilteringUI`.</span></span> <span data-ttu-id="5b44e-185">Certifique-se de chamar esse método a partir de `Page_Load` manipulador de eventos no primeiro carregamento de página.</span><span class="sxs-lookup"><span data-stu-id="5b44e-185">Be sure to call this method from the `Page_Load` event handler on the first page load.</span></span>

[!code-csharp[Main](building-an-interface-to-select-one-user-account-from-many-cs/samples/sample7.cs)]

<span data-ttu-id="5b44e-186">Esse método Especifica as opções de filtragem como elementos na `string` matriz `filterOptions`.</span><span class="sxs-lookup"><span data-stu-id="5b44e-186">This method specifies the filtering options as elements in the `string` array `filterOptions`.</span></span> <span data-ttu-id="5b44e-187">Para cada elemento na matriz, o Repeater renderizará um LinkButton com seu `Text` e `CommandName` propriedades atribuídas ao valor do elemento da matriz.</span><span class="sxs-lookup"><span data-stu-id="5b44e-187">For each element in the array, the Repeater will render a LinkButton with its `Text` and `CommandName` properties assigned to the value of the array element.</span></span>

<span data-ttu-id="5b44e-188">A Figura 5 mostra o `ManageUsers.aspx` página quando visualizado por meio de um navegador.</span><span class="sxs-lookup"><span data-stu-id="5b44e-188">Figure 5 shows the `ManageUsers.aspx` page when viewed through a browser.</span></span>


<span data-ttu-id="5b44e-189">[![O Repeater lista LinkButtons filtragem 27](building-an-interface-to-select-one-user-account-from-many-cs/_static/image14.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="5b44e-189">[![The Repeater Lists 27 Filtering LinkButtons](building-an-interface-to-select-one-user-account-from-many-cs/_static/image14.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image13.png)</span></span>

<span data-ttu-id="5b44e-190">**Figura 5**: O Repeater lista 27 filtragem LinkButtons ([clique para exibir a imagem em tamanho normal](building-an-interface-to-select-one-user-account-from-many-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="5b44e-190">**Figure 5**: The Repeater Lists 27 Filtering LinkButtons  ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-cs/_static/image15.png))</span></span>


> [!NOTE]
> <span data-ttu-id="5b44e-191">Os nomes de usuário podem iniciar com qualquer caractere, incluindo números e pontuação.</span><span class="sxs-lookup"><span data-stu-id="5b44e-191">Usernames may start with any character, including numbers and punctuation.</span></span> <span data-ttu-id="5b44e-192">Para exibir essas contas, o administrador terá que usar a opção de todos os LinkButton.</span><span class="sxs-lookup"><span data-stu-id="5b44e-192">In order to view these accounts, the administrator will have to use the All LinkButton option.</span></span> <span data-ttu-id="5b44e-193">Como alternativa, você pode adicionar um botão LinkButton para retornar todas as contas de usuário que começam com um número.</span><span class="sxs-lookup"><span data-stu-id="5b44e-193">Alternatively, you could add a LinkButton to return all user accounts that start with a number.</span></span> <span data-ttu-id="5b44e-194">Posso deixar isso como um exercício para o leitor.</span><span class="sxs-lookup"><span data-stu-id="5b44e-194">I leave this as an exercise for the reader.</span></span>


<span data-ttu-id="5b44e-195">Clicar em qualquer um de LinkButtons filtragem faz com que um postback e aciona o Repeater `ItemCommand` evento, mas não há nenhuma alteração na grade, porque ainda não encontramos escrever nenhum código para filtrar os resultados.</span><span class="sxs-lookup"><span data-stu-id="5b44e-195">Clicking any of the filtering LinkButtons causes a postback and raises the Repeater's `ItemCommand` event, but there's no change in the grid because we've yet to write any code to filter the results.</span></span> <span data-ttu-id="5b44e-196">O `Membership` classe inclui um [ `FindUsersByName` método](https://technet.microsoft.com/library/system.web.security.membership.findusersbyname.aspx) que retorna as contas de usuário cujo nome de usuário corresponde a um padrão de pesquisa especificado.</span><span class="sxs-lookup"><span data-stu-id="5b44e-196">The `Membership` class includes a [`FindUsersByName` method](https://technet.microsoft.com/library/system.web.security.membership.findusersbyname.aspx) that returns those user accounts whose username matches a specified search pattern.</span></span> <span data-ttu-id="5b44e-197">Podemos usar esse método para recuperar apenas as contas de usuário cujos nomes começam com a letra especificada pelo `CommandName` no LinkButton filtrado que foi clicado.</span><span class="sxs-lookup"><span data-stu-id="5b44e-197">We can use this method to retrieve just those user accounts whose usernames start with the letter specified by the `CommandName` of the filtered LinkButton that was clicked.</span></span>

<span data-ttu-id="5b44e-198">Comece Atualizando as `ManageUser.aspx` de lógica da página de classe para que ele inclua uma propriedade chamada `UsernameToMatch`.</span><span class="sxs-lookup"><span data-stu-id="5b44e-198">Start by updating the `ManageUser.aspx` page's code-behind class so that it includes a property named `UsernameToMatch`.</span></span> <span data-ttu-id="5b44e-199">Essa propriedade persiste a cadeia de caracteres de filtro de nome de usuário entre postbacks:</span><span class="sxs-lookup"><span data-stu-id="5b44e-199">This property persists the username filter string across postbacks:</span></span>

[!code-csharp[Main](building-an-interface-to-select-one-user-account-from-many-cs/samples/sample8.cs)]

<span data-ttu-id="5b44e-200">O `UsernameToMatch` propriedade armazena o valor será atribuído para o `ViewState` coleção usando a chave UsernameToMatch.</span><span class="sxs-lookup"><span data-stu-id="5b44e-200">The `UsernameToMatch` property stores its value it is assigned into the `ViewState` collection using the key UsernameToMatch.</span></span> <span data-ttu-id="5b44e-201">Quando o valor desta propriedade é lido, ele verifica se existe um valor no `ViewState` coleção; caso contrário, ele retorna o valor padrão, uma cadeia de caracteres vazia.</span><span class="sxs-lookup"><span data-stu-id="5b44e-201">When this property's value is read, it checks to see if a value exists in the `ViewState` collection; if not, it returns the default value, an empty string.</span></span> <span data-ttu-id="5b44e-202">O `UsernameToMatch` propriedade apresenta um padrão comum, ou seja, persistência de um valor para exibir o estado, de modo que todas as alterações à propriedade são persistentes entre postbacks.</span><span class="sxs-lookup"><span data-stu-id="5b44e-202">The `UsernameToMatch` property exhibits a common pattern, namely persisting a value to view state so that any changes to the property are persisted across postbacks.</span></span> <span data-ttu-id="5b44e-203">Para obter mais informações sobre esse padrão, leia [Noções básicas sobre estado de exibição de ASP.NET](https://msdn.microsoft.com/library/ms972976.aspx).</span><span class="sxs-lookup"><span data-stu-id="5b44e-203">For more information on this pattern, read [Understanding ASP.NET View State](https://msdn.microsoft.com/library/ms972976.aspx).</span></span>

<span data-ttu-id="5b44e-204">Em seguida, atualize o `BindUserAccounts` método para que em vez de chamar `Membership.GetAllUsers`, ele chama `Membership.FindUsersByName`, passando o valor da `UsernameToMatch` property acrescentada com o caractere curinga SQL, %.</span><span class="sxs-lookup"><span data-stu-id="5b44e-204">Next, update the `BindUserAccounts` method so that instead of calling `Membership.GetAllUsers`, it calls `Membership.FindUsersByName`, passing in the value of the `UsernameToMatch` property appended with the SQL wildcard character, %.</span></span>

[!code-csharp[Main](building-an-interface-to-select-one-user-account-from-many-cs/samples/sample9.cs)]

<span data-ttu-id="5b44e-205">Para exibir apenas os usuários cujo nome de usuário começa com a letra A, defina as `UsernameToMatch` propriedade para um e, em seguida, chamar `BindUserAccounts`.</span><span class="sxs-lookup"><span data-stu-id="5b44e-205">To display just those users whose username starts with the letter A, set the `UsernameToMatch` property to A and then call `BindUserAccounts`.</span></span> <span data-ttu-id="5b44e-206">Isso resultaria em uma chamada para `Membership.FindUsersByName("A%")`, que retornará todos os usuários cujo nome de usuário começa com A. da mesma forma, para retornar *todos os* usuários, atribuir uma cadeia de caracteres vazia para o `UsernameToMatch` propriedade para que o `BindUserAccounts` será de método invocar `Membership.FindUsersByName("%")`e, portanto, retornando todas as contas de usuário.</span><span class="sxs-lookup"><span data-stu-id="5b44e-206">This would result in a call to `Membership.FindUsersByName("A%")`, which will return all users whose username starts with A. Likewise, to return *all* users, assign an empty string to the `UsernameToMatch` property so that the `BindUserAccounts` method will invoke `Membership.FindUsersByName("%")`, thereby returning all user accounts.</span></span>

<span data-ttu-id="5b44e-207">Criar um manipulador de eventos para o Repeater `ItemCommand` eventos.</span><span class="sxs-lookup"><span data-stu-id="5b44e-207">Create an event handler for the Repeater's `ItemCommand` event.</span></span> <span data-ttu-id="5b44e-208">Esse evento é gerado sempre que um dos filtros de botões de link é clicado; ele é passado no LinkButton clicado `CommandName` de valor por meio de `RepeaterCommandEventArgs` objeto.</span><span class="sxs-lookup"><span data-stu-id="5b44e-208">This event is raised whenever one of the filter LinkButtons is clicked; it is passed the clicked LinkButton's `CommandName` value through the `RepeaterCommandEventArgs` object.</span></span> <span data-ttu-id="5b44e-209">É necessário atribuir o valor apropriado para o `UsernameToMatch` propriedade e, em seguida, chame o `BindUserAccounts` método.</span><span class="sxs-lookup"><span data-stu-id="5b44e-209">We need to assign the appropriate value to the `UsernameToMatch` property and then call the `BindUserAccounts` method.</span></span> <span data-ttu-id="5b44e-210">Se o `CommandName` é All, atribuir uma cadeia de caracteres vazia para `UsernameToMatch` para que todas as contas de usuário sejam exibidas.</span><span class="sxs-lookup"><span data-stu-id="5b44e-210">If the `CommandName` is All, assign an empty string to `UsernameToMatch` so that all user accounts are displayed.</span></span> <span data-ttu-id="5b44e-211">Caso contrário, atribui a `CommandName` valor `UsernameToMatch`.</span><span class="sxs-lookup"><span data-stu-id="5b44e-211">Otherwise, assign the `CommandName` value to `UsernameToMatch`.</span></span>

[!code-csharp[Main](building-an-interface-to-select-one-user-account-from-many-cs/samples/sample10.cs)]

<span data-ttu-id="5b44e-212">Com esse código funcionando, teste a funcionalidade de filtragem.</span><span class="sxs-lookup"><span data-stu-id="5b44e-212">With this code in place, test out the filtering functionality.</span></span> <span data-ttu-id="5b44e-213">Quando a página é visitada primeiro, todas as contas de usuário são exibidas (consulte novamente a Figura 5).</span><span class="sxs-lookup"><span data-stu-id="5b44e-213">When the page is first visited, all user accounts are displayed (refer back to Figure 5).</span></span> <span data-ttu-id="5b44e-214">Clicar no LinkButton um faz com que um postback e filtra os resultados, exibindo apenas as contas de usuário que começam com um.</span><span class="sxs-lookup"><span data-stu-id="5b44e-214">Clicking the A LinkButton causes a postback and filters the results, displaying only those user accounts that start with A .</span></span>


<span data-ttu-id="5b44e-215">[![Use filtragem LinkButtons para exibir os usuários cujo nome de usuário começa com uma determinada letra](building-an-interface-to-select-one-user-account-from-many-cs/_static/image17.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="5b44e-215">[![Use the Filtering LinkButtons to Display those Users Whose Username Starts with a Certain Letter](building-an-interface-to-select-one-user-account-from-many-cs/_static/image17.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image16.png)</span></span>

<span data-ttu-id="5b44e-216">**Figura 6**: Use LinkButtons filtragem para exibir os usuários cujo nome de usuário começa com uma letra de determinados ([clique para exibir a imagem em tamanho normal](building-an-interface-to-select-one-user-account-from-many-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="5b44e-216">**Figure 6**: Use the Filtering LinkButtons to Display those Users Whose Username Starts with a Certain Letter  ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-cs/_static/image18.png))</span></span>


## <a name="step-4-updating-the-gridview-to-use-paging"></a><span data-ttu-id="5b44e-217">Etapa 4: Atualizando o GridView para usar a paginação</span><span class="sxs-lookup"><span data-stu-id="5b44e-217">Step 4: Updating the GridView to Use Paging</span></span>

<span data-ttu-id="5b44e-218">O GridView mostrado nas figuras 5 e 6 lista todos os registros retornados do `FindUsersByName` método.</span><span class="sxs-lookup"><span data-stu-id="5b44e-218">The GridView shown in Figures 5 and 6 lists all of the records returned from the `FindUsersByName` method.</span></span> <span data-ttu-id="5b44e-219">Se não houver centenas ou milhares de contas de usuário, isso pode levar a sobrecarga de informações ao exibir todas as contas (como é o caso quando clicar no LinkButton todos ou quando inicialmente visitando a página).</span><span class="sxs-lookup"><span data-stu-id="5b44e-219">If there are hundreds or thousands of user accounts this can lead to information overload when viewing all of the accounts (as is the case when clicking the All LinkButton or when initially visiting the page).</span></span> <span data-ttu-id="5b44e-220">Para ajudar a apresentar as contas de usuário em partes mais gerenciáveis, vamos configurar o GridView para exibir os 10 contas de usuário por vez.</span><span class="sxs-lookup"><span data-stu-id="5b44e-220">To help present the user accounts in more manageable chunks, let's configure the GridView to display 10 user accounts at a time.</span></span>

<span data-ttu-id="5b44e-221">O controle GridView oferece dois tipos de paginação:</span><span class="sxs-lookup"><span data-stu-id="5b44e-221">The GridView control offers two types of paging:</span></span>

- <span data-ttu-id="5b44e-222">**Paginação padrão** – fácil de implementar, mas ineficiente.</span><span class="sxs-lookup"><span data-stu-id="5b44e-222">**Default paging** - easy to implement, but inefficient.</span></span> <span data-ttu-id="5b44e-223">Em resumo, com a paginação GridView padrão espera *todos os* os registros da fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="5b44e-223">In a nutshell, with default paging the GridView expects *all* of the records from its data source.</span></span> <span data-ttu-id="5b44e-224">Ele, em seguida, exibe apenas a página apropriada de registros.</span><span class="sxs-lookup"><span data-stu-id="5b44e-224">It then only displays the appropriate page of records.</span></span>
- <span data-ttu-id="5b44e-225">**Paginação personalizada** -requer mais trabalho para implementar, mas é mais eficiente do que o padrão de paginação como com personalizado paginar os dados fonte retorna apenas o conjunto exato de registros a serem exibidos.</span><span class="sxs-lookup"><span data-stu-id="5b44e-225">**Custom paging** - requires more work to implement, but is more efficient than default paging because with custom paging the data source returns only the precise set of records to display.</span></span>

<span data-ttu-id="5b44e-226">A diferença de desempenho entre padrão e a paginação personalizada pode ser muito significativa, quando a paginação por meio de milhares de registros.</span><span class="sxs-lookup"><span data-stu-id="5b44e-226">The performance difference between default and custom paging can be quite substantial when paging through thousands of records.</span></span> <span data-ttu-id="5b44e-227">Porque estamos criando essa interface, supondo que haja pode ter centenas ou milhares de contas de usuário, vamos usar a paginação personalizada.</span><span class="sxs-lookup"><span data-stu-id="5b44e-227">Because we are building this interface assuming that there may be hundreds or thousands of user accounts, let's use custom paging.</span></span>

> [!NOTE]
> <span data-ttu-id="5b44e-228">Para obter uma discussão mais completa sobre as diferenças entre a paginação personalizada e padrão, bem como os desafios envolvidos na implementação de paginação personalizada, consulte [com eficiência por meio de grandes quantidades de dados de paginação](https://asp.net/learn/data-access/tutorial-25-cs.aspx).</span><span class="sxs-lookup"><span data-stu-id="5b44e-228">For a more thorough discussion on the differences between default and custom paging, as well as the challenges involved in implementing custom paging, refer to [Efficiently Paging Through Large Amounts of Data](https://asp.net/learn/data-access/tutorial-25-cs.aspx).</span></span> <span data-ttu-id="5b44e-229">Para algumas análises de diferença de desempenho entre padrão e a paginação personalizada, consulte [paginação personalizada no ASP.NET com o SQL Server 2005](http://aspnet.4guysfromrolla.com/articles/031506-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="5b44e-229">For some analysis of the performance difference between default and custom paging, see [Custom Paging in ASP.NET with SQL Server 2005](http://aspnet.4guysfromrolla.com/articles/031506-1.aspx).</span></span>


<span data-ttu-id="5b44e-230">Para implementar a paginação personalizada, que primeiro precisamos de algum mecanismo pelo qual recuperar o subconjunto exato de registros que estão sendo exibidos pelo GridView.</span><span class="sxs-lookup"><span data-stu-id="5b44e-230">To implement custom paging we first need some mechanism by which to retrieve the precise subset of records being displayed by the GridView.</span></span> <span data-ttu-id="5b44e-231">A boa notícia é que o `Membership` da classe `FindUsersByName` método tem uma sobrecarga que nos permite especificar o índice da página e o tamanho de página e retorna apenas as contas de usuário que se enquadram dentro desse intervalo de registros.</span><span class="sxs-lookup"><span data-stu-id="5b44e-231">The good news is that the `Membership` class's `FindUsersByName` method has an overload that allows us to specify the page index and page size, and returns only those user accounts that fall within that range of records.</span></span>

<span data-ttu-id="5b44e-232">Em particular, essa sobrecarga tem a seguinte assinatura: [ `FindUsersByName(usernameToMatch, pageIndex, pageSize, totalRecords)` ](https://msdn.microsoft.com/library/fa5st8b2.aspx).</span><span class="sxs-lookup"><span data-stu-id="5b44e-232">In particular, this overload has the following signature: [`FindUsersByName(usernameToMatch, pageIndex, pageSize, totalRecords)`](https://msdn.microsoft.com/library/fa5st8b2.aspx).</span></span>

<span data-ttu-id="5b44e-233">O *pageIndex* parâmetro especifica a página de contas de usuário para retornar; *pageSize* indica quantos registros devem ser exibidos por página.</span><span class="sxs-lookup"><span data-stu-id="5b44e-233">The *pageIndex* parameter specifies the page of user accounts to return; *pageSize* indicates how many records to display per page.</span></span> <span data-ttu-id="5b44e-234">O *totalRecords* parâmetro é um `out` parâmetro que retorna o número de contas de usuário total no armazenamento do usuário.</span><span class="sxs-lookup"><span data-stu-id="5b44e-234">The *totalRecords* parameter is an `out` parameter that returns the number of total user accounts in the user store.</span></span>

> [!NOTE]
> <span data-ttu-id="5b44e-235">Os dados retornados pelo `FindUsersByName` é classificada por nome de usuário; os critérios de classificação não podem ser personalizados.</span><span class="sxs-lookup"><span data-stu-id="5b44e-235">The data returned by `FindUsersByName` is sorted by username; the sort criteria cannot be customized.</span></span>


<span data-ttu-id="5b44e-236">O GridView pode ser configurado para utilizar a paginação personalizada, mas somente quando associado a um controle ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="5b44e-236">The GridView can be configured to utilize custom paging, but only when bound to an ObjectDataSource control.</span></span> <span data-ttu-id="5b44e-237">Para o controle ObjectDataSource implementar a paginação personalizada, ele requer dois métodos: um que é passado um índice de linha de início e o número máximo de registros a serem exibidos, e retornará o subconjunto exato de registros que se enquadram dentro desse período; e um método que retorna o número total de registros por meio de pager.</span><span class="sxs-lookup"><span data-stu-id="5b44e-237">For the ObjectDataSource control to implement custom paging, it requires two methods: one that is passed a start row index and the maximum number of records to display, and returns the precise subset of records that fall within that span; and a method that returns the total number of records being paged through.</span></span> <span data-ttu-id="5b44e-238">O `FindUsersByName` sobrecarga aceita um índice de página e tamanho de página e retorna o número total de registros por meio de um `out` parâmetro.</span><span class="sxs-lookup"><span data-stu-id="5b44e-238">The `FindUsersByName` overload accepts a page index and page size, and returns the total number of records through an `out` parameter.</span></span> <span data-ttu-id="5b44e-239">Portanto, há uma incompatibilidade de interface aqui.</span><span class="sxs-lookup"><span data-stu-id="5b44e-239">So there is an interface mismatch here.</span></span>

<span data-ttu-id="5b44e-240">Uma opção seria criar uma classe de proxy que expõe a interface ObjectDataSource espera e, em seguida, chama internamente o `FindUsersByName` método.</span><span class="sxs-lookup"><span data-stu-id="5b44e-240">One option would be to create a proxy class that exposes the interface the ObjectDataSource expects, and then internally calls the `FindUsersByName` method.</span></span> <span data-ttu-id="5b44e-241">Outra opção – e aquele que usaremos para este artigo – é criar nossa própria interface de paginação e usá-lo em vez de interface de paginação interna do GridView.</span><span class="sxs-lookup"><span data-stu-id="5b44e-241">Another option - and the one we'll use for this article - is to create our own paging interface and use that instead of the GridView's built-in paging interface.</span></span>

### <a name="creating-a-first-previous-next-last-paging-interface"></a><span data-ttu-id="5b44e-242">Criando o primeiro, anterior, em seguida, da última Interface de paginação</span><span class="sxs-lookup"><span data-stu-id="5b44e-242">Creating a First, Previous, Next, Last Paging Interface</span></span>

<span data-ttu-id="5b44e-243">Vamos criar uma interface de paginação com a primeira, anterior, próximo e último LinkButtons.</span><span class="sxs-lookup"><span data-stu-id="5b44e-243">Let's build a paging interface with First, Previous, Next, and Last LinkButtons.</span></span> <span data-ttu-id="5b44e-244">A primeira LinkButton, quando clicado, levará o usuário para a primeira página de dados, enquanto que o anterior em contato com ele retornará à página anterior.</span><span class="sxs-lookup"><span data-stu-id="5b44e-244">The First LinkButton, when clicked, will take the user to the first page of data, whereas Previous will return him to the previous page.</span></span> <span data-ttu-id="5b44e-245">Da mesma forma, próximo e último moverá o usuário para a próxima e última página, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="5b44e-245">Likewise, Next and Last will move the user to the next and last page, respectively.</span></span> <span data-ttu-id="5b44e-246">Adicione os quatro controles LinkButton sob o `UserAccounts` GridView.</span><span class="sxs-lookup"><span data-stu-id="5b44e-246">Add the four LinkButton controls beneath the `UserAccounts` GridView.</span></span>

[!code-aspx[Main](building-an-interface-to-select-one-user-account-from-many-cs/samples/sample11.aspx)]

<span data-ttu-id="5b44e-247">Em seguida, crie um manipulador de eventos para cada um no LinkButton `Click` eventos.</span><span class="sxs-lookup"><span data-stu-id="5b44e-247">Next, create an event handler for each of the LinkButton's `Click` events.</span></span>

<span data-ttu-id="5b44e-248">Figura 7 mostra quatro botões de link quando visualizado por meio da exibição de Design Visual de desenvolvedor da Web.</span><span class="sxs-lookup"><span data-stu-id="5b44e-248">Figure 7 shows the four LinkButtons when viewed through the Visual Web Developer Design view.</span></span>


<span data-ttu-id="5b44e-249">[![Adicionar o primeiro, anterior, em seguida, e o último LinkButtons abaixo de GridView](building-an-interface-to-select-one-user-account-from-many-cs/_static/image20.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="5b44e-249">[![Add First, Previous, Next, and Last LinkButtons Beneath the GridView](building-an-interface-to-select-one-user-account-from-many-cs/_static/image20.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image19.png)</span></span>

<span data-ttu-id="5b44e-250">**Figura 7**: adicionar primeiro, anterior, próximo e último LinkButtons sob o controle GridView ([clique para exibir a imagem em tamanho normal](building-an-interface-to-select-one-user-account-from-many-cs/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="5b44e-250">**Figure 7**: Add First, Previous, Next, and Last LinkButtons Beneath the GridView  ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-cs/_static/image21.png))</span></span>


### <a name="keeping-track-of-the-current-page-index"></a><span data-ttu-id="5b44e-251">Manter o controle do índice da página atual</span><span class="sxs-lookup"><span data-stu-id="5b44e-251">Keeping Track of the Current Page Index</span></span>

<span data-ttu-id="5b44e-252">Quando um usuário visita primeiro o `ManageUsers.aspx` página ou clica em um da filtragem de botões, queremos exibir a primeira página de dados em um GridView.</span><span class="sxs-lookup"><span data-stu-id="5b44e-252">When a user first visits the `ManageUsers.aspx` page or clicks one of the filtering buttons, we want to display the first page of data in the GridView.</span></span> <span data-ttu-id="5b44e-253">Quando o usuário clica em um dos botões de link de navegação, no entanto, precisamos atualizar o índice de página.</span><span class="sxs-lookup"><span data-stu-id="5b44e-253">When the user clicks one of the navigation LinkButtons, however, we need to update the page index.</span></span> <span data-ttu-id="5b44e-254">Para manter o índice de página e o número de registros a serem exibidos por página, adicione as duas propriedades a seguir à classe de code-behind da página:</span><span class="sxs-lookup"><span data-stu-id="5b44e-254">To maintain the page index and the number of records to display per page, add the following two properties to the page's code-behind class:</span></span>

[!code-csharp[Main](building-an-interface-to-select-one-user-account-from-many-cs/samples/sample12.cs)]

<span data-ttu-id="5b44e-255">Como o `UsernameToMatch` propriedade, o `PageIndex` propriedade persiste seu valor para o estado de exibição.</span><span class="sxs-lookup"><span data-stu-id="5b44e-255">Like the `UsernameToMatch` property, the `PageIndex` property persists its value to view state.</span></span> <span data-ttu-id="5b44e-256">Somente leitura `PageSize` propriedade retorna um valor embutido em código, 10.</span><span class="sxs-lookup"><span data-stu-id="5b44e-256">The read-only `PageSize` property returns a hard-coded value, 10.</span></span> <span data-ttu-id="5b44e-257">Os leitores interessados atualizar esta propriedade para usar o mesmo padrão que eu o convido `PageIndex`e, em seguida, para aumentar o `ManageUsers.aspx` página, de modo que a pessoa que visitar a página pode especificar quantas contas de usuário serem exibidos por página.</span><span class="sxs-lookup"><span data-stu-id="5b44e-257">I invite the interested reader to update this property to use the same pattern as `PageIndex`, and then to augment the `ManageUsers.aspx` page such that the person visiting the page can specify how many user accounts to display per page.</span></span>

### <a name="retrieving-just-the-current-pages-records-updating-the-page-index-and-enabling-and-disabling-the-paging-interface-linkbuttons"></a><span data-ttu-id="5b44e-258">Recuperar apenas os registros da página atual, atualizando o índice de página e habilitando e desabilitando os botões de link de Interface de paginação</span><span class="sxs-lookup"><span data-stu-id="5b44e-258">Retrieving Just the Current Page's Records, Updating the Page Index, and Enabling and Disabling the Paging Interface LinkButtons</span></span>

<span data-ttu-id="5b44e-259">Com a interface de paginação no lugar e o `PageIndex` e `PageSize` propriedades adicionadas, estamos prontos para atualizar o `BindUserAccounts` , de modo que ele usa apropriado `FindUsersByName` de sobrecarga.</span><span class="sxs-lookup"><span data-stu-id="5b44e-259">With the paging interface in place and the `PageIndex` and `PageSize` properties added, we are ready to update the `BindUserAccounts` method so that it uses the appropriate `FindUsersByName` overload.</span></span> <span data-ttu-id="5b44e-260">Além disso, é necessário ter esse método habilitar ou desabilitar a interface de paginação, dependendo de qual página está sendo exibida.</span><span class="sxs-lookup"><span data-stu-id="5b44e-260">Additionally, we need to have this method enable or disable the paging interface depending on what page is being displayed.</span></span> <span data-ttu-id="5b44e-261">Ao exibir a primeira página de dados, os links primeiro e anterior deve ser desabilitados; Em seguida e pela última vez deve ser desabilitada ao exibir a última página.</span><span class="sxs-lookup"><span data-stu-id="5b44e-261">When viewing the first page of data, the First and Previous links should be disabled; Next and Last should be disabled when viewing the last page.</span></span>

<span data-ttu-id="5b44e-262">Atualize o método `BindUserAccounts` pelo seguinte código:</span><span class="sxs-lookup"><span data-stu-id="5b44e-262">Update the `BindUserAccounts` method with the following code:</span></span>

[!code-csharp[Main](building-an-interface-to-select-one-user-account-from-many-cs/samples/sample13.cs)]

<span data-ttu-id="5b44e-263">Observe que o número total de registros sendo paginado por meio de é determinado pelo último parâmetro do `FindUsersByName` método.</span><span class="sxs-lookup"><span data-stu-id="5b44e-263">Note that the total number of records being paged through is determined by the last parameter of the `FindUsersByName` method.</span></span> <span data-ttu-id="5b44e-264">Esse é um `out` parâmetro, portanto, precisamos primeiro declarar uma variável para armazenar esse valor (`totalRecords`) e, em seguida, inclua um prefixo com o `out` palavra-chave.</span><span class="sxs-lookup"><span data-stu-id="5b44e-264">This is an `out` parameter, so we need to first declare a variable to hold this value (`totalRecords`) and then prefix it with the `out` keyword.</span></span>

<span data-ttu-id="5b44e-265">Depois que a página especificada de contas de usuário são retornados, os quatro botões de link são habilitados ou desabilitados, dependendo se a primeira ou última página de dados estiver sendo exibida.</span><span class="sxs-lookup"><span data-stu-id="5b44e-265">After the specified page of user accounts are returned, the four LinkButtons are either enabled or disabled, depending on whether the first or last page of data is being viewed.</span></span>

<span data-ttu-id="5b44e-266">A última etapa é escrever o código para 'LinkButtons quatro `Click` manipuladores de eventos.</span><span class="sxs-lookup"><span data-stu-id="5b44e-266">The last step is to write the code for the four LinkButtons' `Click` event handlers.</span></span> <span data-ttu-id="5b44e-267">Esses manipuladores de eventos precisam atualizar o `PageIndex` propriedade e, em seguida, associar novamente os dados para o GridView por meio de uma chamada para `BindUserAccounts`.</span><span class="sxs-lookup"><span data-stu-id="5b44e-267">These event handlers need to update the `PageIndex` property and then rebind the data to the GridView via a call to `BindUserAccounts`.</span></span> <span data-ttu-id="5b44e-268">A primeira, anterior e próxima manipuladores de eventos são muito simples.</span><span class="sxs-lookup"><span data-stu-id="5b44e-268">The First, Previous, and Next event handlers are very simple.</span></span> <span data-ttu-id="5b44e-269">O `Click` manipulador de eventos para o último LinkButton, no entanto, é um pouco mais complexo porque precisamos determinar quantos registros estão sendo exibido para determinar o último índice de página.</span><span class="sxs-lookup"><span data-stu-id="5b44e-269">The `Click` event handler for the Last LinkButton, however, is a bit more complex because we need to determine how many records are being displayed in order to determine the last page index.</span></span>

[!code-csharp[Main](building-an-interface-to-select-one-user-account-from-many-cs/samples/sample14.cs)]

<span data-ttu-id="5b44e-270">As figuras 8 e 9 mostram a interface de paginação personalizada em ação.</span><span class="sxs-lookup"><span data-stu-id="5b44e-270">Figures 8 and 9 show the custom paging interface in action.</span></span> <span data-ttu-id="5b44e-271">A Figura 8 mostra o `ManageUsers.aspx` página ao exibir a primeira página de dados para todas as contas de usuário.</span><span class="sxs-lookup"><span data-stu-id="5b44e-271">Figure 8 shows the `ManageUsers.aspx` page when viewing the first page of data for all user accounts.</span></span> <span data-ttu-id="5b44e-272">Observe que apenas 10 das contas de 13 são exibidos.</span><span class="sxs-lookup"><span data-stu-id="5b44e-272">Note that only 10 of the 13 accounts are displayed.</span></span> <span data-ttu-id="5b44e-273">Ao clicar no link próximo ou último faz com que um postback, as atualizações a `PageIndex` para 1 e o associa à segunda página do usuário de contas à grade (veja a Figura 9).</span><span class="sxs-lookup"><span data-stu-id="5b44e-273">Clicking the Next or Last link causes a postback, updates the `PageIndex` to 1, and binds the second page of user accounts to the grid (see Figure 9).</span></span>


<span data-ttu-id="5b44e-274">[![As contas de usuário de 10 primeiros são exibidas](building-an-interface-to-select-one-user-account-from-many-cs/_static/image23.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="5b44e-274">[![The First 10 User Accounts are Displayed](building-an-interface-to-select-one-user-account-from-many-cs/_static/image23.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image22.png)</span></span>

<span data-ttu-id="5b44e-275">**Figura 8**: as contas de usuário de 10 primeiros são exibidas ([clique para exibir a imagem em tamanho normal](building-an-interface-to-select-one-user-account-from-many-cs/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="5b44e-275">**Figure 8**: The First 10 User Accounts are Displayed  ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-cs/_static/image24.png))</span></span>


<span data-ttu-id="5b44e-276">[![Clicando no Link seguinte exibe a segunda página de contas de usuário](building-an-interface-to-select-one-user-account-from-many-cs/_static/image26.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="5b44e-276">[![Clicking the Next Link Displays the Second Page of User Accounts](building-an-interface-to-select-one-user-account-from-many-cs/_static/image26.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image25.png)</span></span>

<span data-ttu-id="5b44e-277">**Figura 9**: clicando no Link seguinte exibe a segunda página de contas de usuário ([clique para exibir a imagem em tamanho normal](building-an-interface-to-select-one-user-account-from-many-cs/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="5b44e-277">**Figure 9**: Clicking the Next Link Displays the Second Page of User Accounts  ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-cs/_static/image27.png))</span></span>


## <a name="summary"></a><span data-ttu-id="5b44e-278">Resumo</span><span class="sxs-lookup"><span data-stu-id="5b44e-278">Summary</span></span>

<span data-ttu-id="5b44e-279">Os administradores muitas vezes precisam selecionar um usuário na lista de contas.</span><span class="sxs-lookup"><span data-stu-id="5b44e-279">Administrators often need to select a user from the list of accounts.</span></span> <span data-ttu-id="5b44e-280">Nos tutoriais anteriores, nós examinamos usando uma lista suspensa preenchida com os usuários, mas essa abordagem não dimensiona bem.</span><span class="sxs-lookup"><span data-stu-id="5b44e-280">In previous tutorials we looked at using a drop-down list populated with the users, but this approach does not scale well.</span></span> <span data-ttu-id="5b44e-281">Neste tutorial, exploramos uma alternativa melhor: uma interface que podem ser filtrada cujos resultados são exibidos em um GridView paginado.</span><span class="sxs-lookup"><span data-stu-id="5b44e-281">In this tutorial we explored a better alternative: a filterable interface whose results are displayed in a paged GridView.</span></span> <span data-ttu-id="5b44e-282">Com essa interface do usuário, os administradores podem rapidamente e com eficiência Localize e selecione uma conta de usuário entre milhares.</span><span class="sxs-lookup"><span data-stu-id="5b44e-282">With this user interface, administrators can quickly and efficiently locate and select one user account among thousands.</span></span>

<span data-ttu-id="5b44e-283">Boa programação!</span><span class="sxs-lookup"><span data-stu-id="5b44e-283">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="5b44e-284">Leitura adicional</span><span class="sxs-lookup"><span data-stu-id="5b44e-284">Further Reading</span></span>

<span data-ttu-id="5b44e-285">Para obter mais informações sobre os tópicos abordados neste tutorial, consulte os seguintes recursos:</span><span class="sxs-lookup"><span data-stu-id="5b44e-285">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="5b44e-286">Paginação personalizada no ASP.NET com o SQL Server 2005</span><span class="sxs-lookup"><span data-stu-id="5b44e-286">Custom Paging in ASP.NET with SQL Server 2005</span></span>](http://aspnet.4guysfromrolla.com/articles/031506-1.aspx)
- [<span data-ttu-id="5b44e-287">Paginação de grandes quantidades de dados com eficiência</span><span class="sxs-lookup"><span data-stu-id="5b44e-287">Efficiently Paging Through Large Amounts of Data</span></span>](https://asp.net/learn/data-access/tutorial-25-cs.aspx)
- [<span data-ttu-id="5b44e-288">Sem interrupção de sua própria ferramenta de administração de site</span><span class="sxs-lookup"><span data-stu-id="5b44e-288">Rolling Your Own Website Administration Tool</span></span>](http://aspnet.4guysfromrolla.com/articles/052307-1.aspx)

### <a name="about-the-author"></a><span data-ttu-id="5b44e-289">Sobre o autor</span><span class="sxs-lookup"><span data-stu-id="5b44e-289">About the Author</span></span>

<span data-ttu-id="5b44e-290">Scott Mitchell, autor de vários livros sobre ASP/ASP.NET e fundador da 4GuysFromRolla.com, trabalha com tecnologias Web Microsoft desde 1998.</span><span class="sxs-lookup"><span data-stu-id="5b44e-290">Scott Mitchell, author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="5b44e-291">Scott funciona como um consultor independente, instrutor e escritor.</span><span class="sxs-lookup"><span data-stu-id="5b44e-291">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="5b44e-292">Seu livro mais recente é  *[Sams Teach por conta própria ASP.NET 2.0 em 24 horas](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span><span class="sxs-lookup"><span data-stu-id="5b44e-292">His latest book is *[Sams Teach Yourself ASP.NET 2.0 in 24 Hours](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span></span> <span data-ttu-id="5b44e-293">Scott pode ser contatado pelo [ mitchell@4guysfromrolla.com ](mailto:mitchell@4guysfromrolla.com) ou por meio de seu blog em [ http://ScottOnWriting.NET ](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="5b44e-293">Scott can be reached at [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="5b44e-294">Agradecimentos especiais a</span><span class="sxs-lookup"><span data-stu-id="5b44e-294">Special Thanks To</span></span>

<span data-ttu-id="5b44e-295">Esta série de tutoriais foi revisada por muitos revisores úteis.</span><span class="sxs-lookup"><span data-stu-id="5b44e-295">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="5b44e-296">Revisor de avanço para este tutorial foi Alicja Maziarz.</span><span class="sxs-lookup"><span data-stu-id="5b44e-296">Lead reviewer for this tutorial was Alicja Maziarz.</span></span> <span data-ttu-id="5b44e-297">Você está interessado na revisão Meus próximos artigos do MSDN?</span><span class="sxs-lookup"><span data-stu-id="5b44e-297">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="5b44e-298">Nesse caso, escreva-me em [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="5b44e-298">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="5b44e-299">Avançar</span><span class="sxs-lookup"><span data-stu-id="5b44e-299">Next</span></span>](recovering-and-changing-passwords-cs.md)

---
uid: web-forms/overview/older-versions-getting-started/getting-started-with-ef/the-entity-framework-and-aspnet-getting-started-part-7
title: Introdução ao banco de dados do Entity Framework 4.0 First e 4 do ASP.NET Web Forms - parte 7 | Microsoft Docs
author: tdykstra
description: Aplicativo web de exemplo Contoso University demonstra como criar aplicativos Web Forms do ASP.NET usando o Entity Framework. O aplicativo de exemplo é...
ms.author: aspnetcontent
ms.date: 12/03/2010
ms.assetid: f8afb245-b705-419c-8790-0b295e90d5e2
msc.legacyurl: /web-forms/overview/older-versions-getting-started/getting-started-with-ef/the-entity-framework-and-aspnet-getting-started-part-7
msc.type: authoredcontent
ms.openlocfilehash: bb1abe52b913785f47b7f8ec9822ed9db5ee8a05
ms.sourcegitcommit: b28cd0313af316c051c2ff8549865bff67f2fbb4
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 07/05/2018
ms.locfileid: "37823394"
---
<a name="getting-started-with-entity-framework-40-database-first-and-aspnet-4-web-forms---part-7"></a><span data-ttu-id="1ba3d-104">Introdução ao banco de dados do Entity Framework 4.0 First e 4 do Web Forms do ASP.NET – parte 7</span><span class="sxs-lookup"><span data-stu-id="1ba3d-104">Getting Started with Entity Framework 4.0 Database First and ASP.NET 4 Web Forms - Part 7</span></span>
====================
<span data-ttu-id="1ba3d-105">por [Tom Dykstra](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="1ba3d-105">by [Tom Dykstra](https://github.com/tdykstra)</span></span>

> <span data-ttu-id="1ba3d-106">Aplicativo web de exemplo Contoso University demonstra como criar aplicativos Web Forms do ASP.NET usando o Entity Framework 4.0 e o Visual Studio 2010.</span><span class="sxs-lookup"><span data-stu-id="1ba3d-106">The Contoso University sample web application demonstrates how to create ASP.NET Web Forms applications using the Entity Framework 4.0 and Visual Studio 2010.</span></span> <span data-ttu-id="1ba3d-107">Para obter informações sobre a série de tutoriais, consulte [o primeiro tutorial na série](the-entity-framework-and-aspnet-getting-started-part-1.md)</span><span class="sxs-lookup"><span data-stu-id="1ba3d-107">For information about the tutorial series, see [the first tutorial in the series](the-entity-framework-and-aspnet-getting-started-part-1.md)</span></span>


## <a name="using-stored-procedures"></a><span data-ttu-id="1ba3d-108">Usando procedimentos armazenados</span><span class="sxs-lookup"><span data-stu-id="1ba3d-108">Using Stored Procedures</span></span>

<span data-ttu-id="1ba3d-109">No tutorial anterior, você implementou um padrão de herança de tabela por hierarquia.</span><span class="sxs-lookup"><span data-stu-id="1ba3d-109">In the previous tutorial you implemented a table-per-hierarchy inheritance pattern.</span></span> <span data-ttu-id="1ba3d-110">Este tutorial mostra como usar procedimentos armazenados para obter mais controle sobre o acesso de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="1ba3d-110">This tutorial will show you how to use stored procedures to gain more control over database access.</span></span>

<span data-ttu-id="1ba3d-111">O Entity Framework permite que você especifique o que ele deve usar procedimentos armazenados para acesso ao banco de dados.</span><span class="sxs-lookup"><span data-stu-id="1ba3d-111">The Entity Framework lets you specify that it should use stored procedures for database access.</span></span> <span data-ttu-id="1ba3d-112">Para qualquer tipo de entidade, você pode especificar um procedimento armazenado a ser usado para criação, atualização ou exclusão de entidades desse tipo.</span><span class="sxs-lookup"><span data-stu-id="1ba3d-112">For any entity type, you can specify a stored procedure to use for creating, updating, or deleting entities of that type.</span></span> <span data-ttu-id="1ba3d-113">Em seguida, no modelo de dados, você pode adicionar referências a procedimentos armazenados que você pode usar para executar tarefas como recuperar conjuntos de entidades.</span><span class="sxs-lookup"><span data-stu-id="1ba3d-113">Then in the data model you can add references to stored procedures that you can use to perform tasks such as retrieving sets of entities.</span></span>

<span data-ttu-id="1ba3d-114">Usando procedimentos armazenados é um requisito comum para acesso ao banco de dados.</span><span class="sxs-lookup"><span data-stu-id="1ba3d-114">Using stored procedures is a common requirement for database access.</span></span> <span data-ttu-id="1ba3d-115">Em alguns casos, um administrador de banco de dados pode exigir que todo o acesso de banco de dados passar por procedimentos armazenados por motivos de segurança.</span><span class="sxs-lookup"><span data-stu-id="1ba3d-115">In some cases a database administrator may require that all database access go through stored procedures for security reasons.</span></span> <span data-ttu-id="1ba3d-116">Em outros casos, você talvez queira criar lógica de negócios para alguns dos processos que o Entity Framework usa quando ele atualiza o banco de dados.</span><span class="sxs-lookup"><span data-stu-id="1ba3d-116">In other cases you may want to build business logic into some of the processes that the Entity Framework uses when it updates the database.</span></span> <span data-ttu-id="1ba3d-117">Por exemplo, sempre que uma entidade é excluída, talvez queira copiá-lo para um banco de dados de arquivo morto.</span><span class="sxs-lookup"><span data-stu-id="1ba3d-117">For example, whenever an entity is deleted you might want to copy it to an archive database.</span></span> <span data-ttu-id="1ba3d-118">Ou sempre que uma linha é atualizada. você deseja gravar uma linha em uma tabela de log que registra que fez a alteração.</span><span class="sxs-lookup"><span data-stu-id="1ba3d-118">Or whenever a row is updated you might want to write a row to a logging table that records who made the change.</span></span> <span data-ttu-id="1ba3d-119">Você pode executar esses tipos de tarefas em um procedimento armazenado que é chamado sempre que o Entity Framework exclui uma entidade ou atualiza uma entidade.</span><span class="sxs-lookup"><span data-stu-id="1ba3d-119">You can perform these kinds of tasks in a stored procedure that's called whenever the Entity Framework deletes an entity or updates an entity.</span></span>

<span data-ttu-id="1ba3d-120">Como no tutorial anterior, você não criará novas páginas.</span><span class="sxs-lookup"><span data-stu-id="1ba3d-120">As in the previous tutorial, you'll not create any new pages.</span></span> <span data-ttu-id="1ba3d-121">Em vez disso, você vai alterar a forma como o Entity Framework acessa o banco de dados para algumas das páginas que você já criou.</span><span class="sxs-lookup"><span data-stu-id="1ba3d-121">Instead, you'll change the way the Entity Framework accesses the database for some of the pages you already created.</span></span>

<span data-ttu-id="1ba3d-122">Neste tutorial, você criará os procedimentos armazenados no banco de dados para a inserção `Student` e `Instructor` entidades.</span><span class="sxs-lookup"><span data-stu-id="1ba3d-122">In this tutorial you'll create stored procedures in the database for inserting `Student` and `Instructor` entities.</span></span> <span data-ttu-id="1ba3d-123">Você adicionará ao modelo de dados e especificará que o Entity Framework deve usá-los para a adição `Student` e `Instructor` entidades no banco de dados.</span><span class="sxs-lookup"><span data-stu-id="1ba3d-123">You'll add them to the data model, and you'll specify that the Entity Framework should use them for adding `Student` and `Instructor` entities to the database.</span></span> <span data-ttu-id="1ba3d-124">Você também criará um procedimento armazenado que você pode usar para recuperar `Course` entidades.</span><span class="sxs-lookup"><span data-stu-id="1ba3d-124">You'll also create a stored procedure that you can use to retrieve `Course` entities.</span></span>

## <a name="creating-stored-procedures-in-the-database"></a><span data-ttu-id="1ba3d-125">Criando procedimentos armazenados no banco de dados</span><span class="sxs-lookup"><span data-stu-id="1ba3d-125">Creating Stored Procedures in the Database</span></span>

<span data-ttu-id="1ba3d-126">(Se você estiver usando o *School.mdf* arquivo de projeto disponível para download com este tutorial, você poderá ignorar esta seção porque os procedimentos armazenados já existem.)</span><span class="sxs-lookup"><span data-stu-id="1ba3d-126">(If you're using the *School.mdf* file from the project available for download with this tutorial, you can skip this section because the stored procedures already exist.)</span></span>

<span data-ttu-id="1ba3d-127">Na **Gerenciador de servidores**, expanda *School.mdf*, clique com botão direito **Stored Procedures**e selecione **adicionar novo procedimento armazenado**.</span><span class="sxs-lookup"><span data-stu-id="1ba3d-127">In **Server Explorer**, expand *School.mdf*, right-click **Stored Procedures**, and select **Add New Stored Procedure**.</span></span>

<span data-ttu-id="1ba3d-128">[![image15](the-entity-framework-and-aspnet-getting-started-part-7/_static/image2.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="1ba3d-128">[![image15](the-entity-framework-and-aspnet-getting-started-part-7/_static/image2.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image1.png)</span></span>

<span data-ttu-id="1ba3d-129">Copie as seguintes instruções SQL e colá-los na janela de procedimento armazenado, substituindo o procedimento armazenado de esqueleto.</span><span class="sxs-lookup"><span data-stu-id="1ba3d-129">Copy the following SQL statements and paste them into the stored procedure window, replacing the skeleton stored procedure.</span></span>

[!code-sql[Main](the-entity-framework-and-aspnet-getting-started-part-7/samples/sample1.sql)]

<span data-ttu-id="1ba3d-130">[![image14](the-entity-framework-and-aspnet-getting-started-part-7/_static/image4.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="1ba3d-130">[![image14](the-entity-framework-and-aspnet-getting-started-part-7/_static/image4.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image3.png)</span></span>

<span data-ttu-id="1ba3d-131">`Student` entidades têm quatro propriedades: `PersonID`, `LastName`, `FirstName`, e `EnrollmentDate`.</span><span class="sxs-lookup"><span data-stu-id="1ba3d-131">`Student` entities have four properties: `PersonID`, `LastName`, `FirstName`, and `EnrollmentDate`.</span></span> <span data-ttu-id="1ba3d-132">O banco de dados gera o valor da ID automaticamente e o procedimento armazenado aceita parâmetros para as outras três.</span><span class="sxs-lookup"><span data-stu-id="1ba3d-132">The database generates the ID value automatically, and the stored procedure accepts parameters for the other three.</span></span> <span data-ttu-id="1ba3d-133">O procedimento armazenado retorna o valor da chave de registro da nova linha para que o Entity Framework pode manter o controle de que a versão da entidade mantém na memória.</span><span class="sxs-lookup"><span data-stu-id="1ba3d-133">The stored procedure returns the value of the new row's record key so that the Entity Framework can keep track of that in the version of the entity it keeps in memory.</span></span>

<span data-ttu-id="1ba3d-134">Salve e feche a janela de procedimento armazenado.</span><span class="sxs-lookup"><span data-stu-id="1ba3d-134">Save and close the stored procedure window.</span></span>

<span data-ttu-id="1ba3d-135">Criar um `InsertInstructor` procedimento armazenado da mesma maneira, usando as seguintes instruções SQL:</span><span class="sxs-lookup"><span data-stu-id="1ba3d-135">Create an `InsertInstructor` stored procedure in the same manner, using the following SQL statements:</span></span>

[!code-sql[Main](the-entity-framework-and-aspnet-getting-started-part-7/samples/sample2.sql)]

<span data-ttu-id="1ba3d-136">Crie `Update` procedimentos armazenados para o `Student` e `Instructor` entidades também.</span><span class="sxs-lookup"><span data-stu-id="1ba3d-136">Create `Update` stored procedures for `Student` and `Instructor` entities also.</span></span> <span data-ttu-id="1ba3d-137">(O banco de dados já tem um `DeletePerson` procedimento que funcionará para ambos armazenado `Instructor` e `Student` entidades.)</span><span class="sxs-lookup"><span data-stu-id="1ba3d-137">(The database already has a `DeletePerson` stored procedure which will work for both `Instructor` and `Student` entities.)</span></span>

[!code-sql[Main](the-entity-framework-and-aspnet-getting-started-part-7/samples/sample3.sql)]

[!code-sql[Main](the-entity-framework-and-aspnet-getting-started-part-7/samples/sample4.sql)]

<span data-ttu-id="1ba3d-138">Neste tutorial, você vai mapear todas as três funções – insert, update e delete – para cada tipo de entidade.</span><span class="sxs-lookup"><span data-stu-id="1ba3d-138">In this tutorial you'll map all three functions -- insert, update, and delete -- for each entity type.</span></span> <span data-ttu-id="1ba3d-139">O Entity Framework versão 4 permite mapear apenas um ou dois desses funções aos procedimentos armazenados sem mapear os outros, com uma exceção: se você mapear a função de atualização, mas não a função de exclusão, o Entity Framework gerará uma exceção quando você tentativa de excluir uma entidade.</span><span class="sxs-lookup"><span data-stu-id="1ba3d-139">The Entity Framework version 4 allows you to map just one or two of these functions to stored procedures without mapping the others, with one exception: if you map the update function but not the delete function, the Entity Framework will throw an exception when you attempt to delete an entity.</span></span> <span data-ttu-id="1ba3d-140">No Entity Framework versão 3.5, você não tem essa grande flexibilidade no mapeamento de procedimentos armazenados: se você mapeou a uma função, era necessário mapear todos os três.</span><span class="sxs-lookup"><span data-stu-id="1ba3d-140">In the Entity Framework version 3.5, you did not have this much flexibility in mapping stored procedures: if you mapped one function you were required to map all three.</span></span>

<span data-ttu-id="1ba3d-141">Para criar um procedimento armazenado que lê em vez de atualizações de dados, criar um que seleciona todos os `Course` entidades, usando as seguintes instruções SQL:</span><span class="sxs-lookup"><span data-stu-id="1ba3d-141">To create a stored procedure that reads rather than updates data, create one that selects all `Course` entities, using the following SQL statements:</span></span>

[!code-sql[Main](the-entity-framework-and-aspnet-getting-started-part-7/samples/sample5.sql)]

## <a name="adding-the-stored-procedures-to-the-data-model"></a><span data-ttu-id="1ba3d-142">Adicionar os procedimentos armazenados ao modelo de dados</span><span class="sxs-lookup"><span data-stu-id="1ba3d-142">Adding the Stored Procedures to the Data Model</span></span>

<span data-ttu-id="1ba3d-143">Agora, os procedimentos armazenados são definidos no banco de dados, mas eles devem ser adicionados ao modelo de dados para disponibilizá-las para o Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="1ba3d-143">The stored procedures are now defined in the database, but they must be added to the data model to make them available to the Entity Framework.</span></span> <span data-ttu-id="1ba3d-144">Abra *Schoolmodel*, clique com botão direito na superfície de design e selecione **atualizar o modelo de banco de dados**.</span><span class="sxs-lookup"><span data-stu-id="1ba3d-144">Open *SchoolModel.edmx*, right-click the design surface, and select **Update Model from Database**.</span></span> <span data-ttu-id="1ba3d-145">No **Add** guia do **Choose Your Database Objects** caixa de diálogo caixa, expanda **Stored Procedures**, selecione os procedimentos armazenados recém-criado e o `DeletePerson` procedimento armazenado e, em seguida, clique em **concluir**.</span><span class="sxs-lookup"><span data-stu-id="1ba3d-145">In the **Add** tab of the **Choose Your Database Objects** dialog box, expand **Stored Procedures**, select the newly created stored procedures and the `DeletePerson` stored procedure, and then click **Finish**.</span></span>

<span data-ttu-id="1ba3d-146">[![image20](the-entity-framework-and-aspnet-getting-started-part-7/_static/image6.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="1ba3d-146">[![image20](the-entity-framework-and-aspnet-getting-started-part-7/_static/image6.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image5.png)</span></span>

## <a name="mapping-the-stored-procedures"></a><span data-ttu-id="1ba3d-147">Os procedimentos armazenados de mapeamento</span><span class="sxs-lookup"><span data-stu-id="1ba3d-147">Mapping the Stored Procedures</span></span>

<span data-ttu-id="1ba3d-148">No designer de modelo de dados, clique com botão direito do `Student` entidade e selecione **mapeamento de procedimento armazenado**.</span><span class="sxs-lookup"><span data-stu-id="1ba3d-148">In the data model designer, right-click the `Student` entity and select **Stored Procedure Mapping**.</span></span>

<span data-ttu-id="1ba3d-149">[![image21](the-entity-framework-and-aspnet-getting-started-part-7/_static/image8.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="1ba3d-149">[![image21](the-entity-framework-and-aspnet-getting-started-part-7/_static/image8.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image7.png)</span></span>

<span data-ttu-id="1ba3d-150">O **Mapping Details** janela for exibida, na qual você pode especificar procedimentos armazenados que o Entity Framework devem usar para inserir, atualizar e excluir entidades desse tipo.</span><span class="sxs-lookup"><span data-stu-id="1ba3d-150">The **Mapping Details** window appears, in which you can specify stored procedures that the Entity Framework should use for inserting, updating, and deleting entities of this type.</span></span>

<span data-ttu-id="1ba3d-151">[![image22](the-entity-framework-and-aspnet-getting-started-part-7/_static/image10.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="1ba3d-151">[![image22](the-entity-framework-and-aspnet-getting-started-part-7/_static/image10.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image9.png)</span></span>

<span data-ttu-id="1ba3d-152">Defina as **inserir** função **InsertStudent**.</span><span class="sxs-lookup"><span data-stu-id="1ba3d-152">Set the **Insert** function to **InsertStudent**.</span></span> <span data-ttu-id="1ba3d-153">A janela mostra uma lista de parâmetros de procedimento armazenado, cada um deles deve ser mapeada para uma propriedade de entidade.</span><span class="sxs-lookup"><span data-stu-id="1ba3d-153">The window shows a list of stored procedure parameters, each of which must be mapped to an entity property.</span></span> <span data-ttu-id="1ba3d-154">Dois desses são mapeadas automaticamente porque os nomes são iguais.</span><span class="sxs-lookup"><span data-stu-id="1ba3d-154">Two of these are mapped automatically because the names are the same.</span></span> <span data-ttu-id="1ba3d-155">Não há nenhuma propriedade de entidade nomeada `FirstName`, portanto, você deve selecionar manualmente `FirstMidName` em uma lista suspensa que mostra as propriedades de entidade disponível.</span><span class="sxs-lookup"><span data-stu-id="1ba3d-155">There's no entity property named `FirstName`, so you must manually select `FirstMidName` from a drop-down list that shows available entity properties.</span></span> <span data-ttu-id="1ba3d-156">(Isso ocorre porque você alterou o nome da `FirstName` propriedade para `FirstMidName` no primeiro tutorial.)</span><span class="sxs-lookup"><span data-stu-id="1ba3d-156">(This is because you changed the name of the `FirstName` property to `FirstMidName` in the first tutorial.)</span></span>

<span data-ttu-id="1ba3d-157">[![image23](the-entity-framework-and-aspnet-getting-started-part-7/_static/image12.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="1ba3d-157">[![image23](the-entity-framework-and-aspnet-getting-started-part-7/_static/image12.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image11.png)</span></span>

<span data-ttu-id="1ba3d-158">No mesmo **Mapping Details** janela, o mapa o `Update` funcionar para o `UpdateStudent` procedimento armazenado (Verifique se você especificou `FirstMidName` como o valor de parâmetro para `FirstName`, como você fez o `Insert` procedimento armazenado) e o `Delete` função para o `DeletePerson` procedimento armazenado.</span><span class="sxs-lookup"><span data-stu-id="1ba3d-158">In the same **Mapping Details** window, map the `Update` function to the `UpdateStudent` stored procedure (make sure you specify `FirstMidName` as the parameter value for `FirstName`, as you did for the `Insert` stored procedure) and the `Delete` function to the `DeletePerson` stored procedure.</span></span>

<span data-ttu-id="1ba3d-159">[![image01](the-entity-framework-and-aspnet-getting-started-part-7/_static/image14.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="1ba3d-159">[![image01](the-entity-framework-and-aspnet-getting-started-part-7/_static/image14.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image13.png)</span></span>

<span data-ttu-id="1ba3d-160">Siga o mesmo procedimento para mapear o insert, update e delete de procedimentos armazenados para instrutores o `Instructor` entidade.</span><span class="sxs-lookup"><span data-stu-id="1ba3d-160">Follow the same procedure to map the insert, update, and delete stored procedures for instructors to the `Instructor` entity.</span></span>

<span data-ttu-id="1ba3d-161">[![image02](the-entity-framework-and-aspnet-getting-started-part-7/_static/image16.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="1ba3d-161">[![image02](the-entity-framework-and-aspnet-getting-started-part-7/_static/image16.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image15.png)</span></span>

<span data-ttu-id="1ba3d-162">Para procedimentos armazenados que leem em vez de atualização de dados, você deve usar o **Model Browser** janela para mapear o procedimento armazenado para a entidade digitá-lo retorna.</span><span class="sxs-lookup"><span data-stu-id="1ba3d-162">For stored procedures that read rather than update data, you use the **Model Browser** window to map the stored procedure to the entity type it returns.</span></span> <span data-ttu-id="1ba3d-163">No designer de modelo de dados, clique com botão direito a superfície de design e selecione **Model Browser**.</span><span class="sxs-lookup"><span data-stu-id="1ba3d-163">In the data model designer, right-click the design surface and select **Model Browser**.</span></span> <span data-ttu-id="1ba3d-164">Abra o **SchoolModel.Store** nó e abra o **Stored Procedures** nó.</span><span class="sxs-lookup"><span data-stu-id="1ba3d-164">Open the **SchoolModel.Store** node and then open the **Stored Procedures** node.</span></span> <span data-ttu-id="1ba3d-165">Em seguida, clique com botão direito do `GetCourses` procedimento armazenado e selecione **Adicionar importação de função**.</span><span class="sxs-lookup"><span data-stu-id="1ba3d-165">Then right-click the `GetCourses` stored procedure and select **Add Function Import**.</span></span>

<span data-ttu-id="1ba3d-166">[![image24](the-entity-framework-and-aspnet-getting-started-part-7/_static/image18.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="1ba3d-166">[![image24](the-entity-framework-and-aspnet-getting-started-part-7/_static/image18.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image17.png)</span></span>

<span data-ttu-id="1ba3d-167">No **Adicionar importação de função** caixa de diálogo **retorna uma coleção de** selecionar **entidades**e, em seguida, selecione `Course` como o tipo de entidade retornada.</span><span class="sxs-lookup"><span data-stu-id="1ba3d-167">In the **Add Function Import** dialog box, under **Returns a Collection Of** select **Entities**, and then select `Course` as the entity type returned.</span></span> <span data-ttu-id="1ba3d-168">Quando terminar, clique em **Okey**.</span><span class="sxs-lookup"><span data-stu-id="1ba3d-168">When you're done, click **OK**.</span></span> <span data-ttu-id="1ba3d-169">Salve e feche o *. edmx* arquivo.</span><span class="sxs-lookup"><span data-stu-id="1ba3d-169">Save and close the *.edmx* file.</span></span>

<span data-ttu-id="1ba3d-170">[![image25](the-entity-framework-and-aspnet-getting-started-part-7/_static/image20.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="1ba3d-170">[![image25](the-entity-framework-and-aspnet-getting-started-part-7/_static/image20.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image19.png)</span></span>

## <a name="using-insert-update-and-delete-stored-procedures"></a><span data-ttu-id="1ba3d-171">Usando Inserir, atualizar e excluir procedimentos armazenados</span><span class="sxs-lookup"><span data-stu-id="1ba3d-171">Using Insert, Update, and Delete Stored Procedures</span></span>

<span data-ttu-id="1ba3d-172">Procedimentos armazenados para inserir, atualizar e excluir os dados são usados pelo Entity Framework automaticamente depois de adicioná-las ao modelo de dados e mapeado-los para as entidades apropriadas.</span><span class="sxs-lookup"><span data-stu-id="1ba3d-172">Stored procedures to insert, update, and delete data are used by the Entity Framework automatically after you've added them to the data model and mapped them to the appropriate entities.</span></span> <span data-ttu-id="1ba3d-173">Agora você pode executar o *StudentsAdd.aspx* página, e sempre que você cria um novo aluno, o Entity Framework usará o `InsertStudent` procedimento armazenado para adicionar a nova linha para o `Student` tabela.</span><span class="sxs-lookup"><span data-stu-id="1ba3d-173">You can now run the *StudentsAdd.aspx* page, and every time you create a new student, the Entity Framework will use the `InsertStudent` stored procedure to add the new row to the `Student` table.</span></span>

<span data-ttu-id="1ba3d-174">[![image03](the-entity-framework-and-aspnet-getting-started-part-7/_static/image22.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="1ba3d-174">[![image03](the-entity-framework-and-aspnet-getting-started-part-7/_static/image22.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image21.png)</span></span>

<span data-ttu-id="1ba3d-175">Execute o *Students.aspx* página e o novo aluno aparece na lista.</span><span class="sxs-lookup"><span data-stu-id="1ba3d-175">Run the *Students.aspx* page and the new student appears in the list.</span></span>

<span data-ttu-id="1ba3d-176">[![image04](the-entity-framework-and-aspnet-getting-started-part-7/_static/image24.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="1ba3d-176">[![image04](the-entity-framework-and-aspnet-getting-started-part-7/_static/image24.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image23.png)</span></span>

<span data-ttu-id="1ba3d-177">Altere o nome para verificar se a função de atualização funciona e, em seguida, exclua o aluno para verificar se a função delete funciona.</span><span class="sxs-lookup"><span data-stu-id="1ba3d-177">Change the name to verify that the update function works, and then delete the student to verify that the delete function works.</span></span>

<span data-ttu-id="1ba3d-178">[![image05](the-entity-framework-and-aspnet-getting-started-part-7/_static/image26.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="1ba3d-178">[![image05](the-entity-framework-and-aspnet-getting-started-part-7/_static/image26.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image25.png)</span></span>

## <a name="using-select-stored-procedures"></a><span data-ttu-id="1ba3d-179">Usando procedimentos armazenados Select</span><span class="sxs-lookup"><span data-stu-id="1ba3d-179">Using Select Stored Procedures</span></span>

<span data-ttu-id="1ba3d-180">O Entity Framework não será executado automaticamente procedimentos armazenados, como `GetCourses`, e você não pode usá-los com o `EntityDataSource` controle.</span><span class="sxs-lookup"><span data-stu-id="1ba3d-180">The Entity Framework does not automatically run stored procedures such as `GetCourses`, and you cannot use them with the `EntityDataSource` control.</span></span> <span data-ttu-id="1ba3d-181">Para usá-las, chamá-los no código.</span><span class="sxs-lookup"><span data-stu-id="1ba3d-181">To use them, you call them from code.</span></span>

<span data-ttu-id="1ba3d-182">Abra o *InstructorsCourses.aspx.cs* arquivo.</span><span class="sxs-lookup"><span data-stu-id="1ba3d-182">Open the *InstructorsCourses.aspx.cs* file.</span></span> <span data-ttu-id="1ba3d-183">O `PopulateDropDownLists` método usa uma consulta LINQ to Entities para recuperar todas as entidades course para que ele pode executar um loop pela lista e determinar quais de um instrutor é atribuído e quais delas são não atribuídos:</span><span class="sxs-lookup"><span data-stu-id="1ba3d-183">The `PopulateDropDownLists` method uses a LINQ-to-Entities query to retrieve all course entities so that it can loop through the list and determine which ones an instructor is assigned to and which ones are unassigned:</span></span>

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-7/samples/sample6.cs)]

<span data-ttu-id="1ba3d-184">Substitua pelo código a seguir:</span><span class="sxs-lookup"><span data-stu-id="1ba3d-184">Replace this with the following code:</span></span>

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-7/samples/sample7.cs)]

<span data-ttu-id="1ba3d-185">A página agora usa o `GetCourses` procedimento armazenado para recuperar a lista de todos os cursos.</span><span class="sxs-lookup"><span data-stu-id="1ba3d-185">The page now uses the `GetCourses` stored procedure to retrieve the list of all courses.</span></span> <span data-ttu-id="1ba3d-186">Execute a página para verificar se ele funciona como antes.</span><span class="sxs-lookup"><span data-stu-id="1ba3d-186">Run the page to verify that it works as it did before.</span></span>

<span data-ttu-id="1ba3d-187">(Propriedades de navegação de entidades recuperadas por um procedimento armazenado não poderá ser populadas automaticamente com os dados relacionados a essas entidades, dependendo do `ObjectContext` configurações padrão.</span><span class="sxs-lookup"><span data-stu-id="1ba3d-187">(Navigation properties of entities retrieved by a stored procedure might not be automatically populated with the data related to those entities, depending on `ObjectContext` default settings.</span></span> <span data-ttu-id="1ba3d-188">Para obter mais informações, consulte [Carregando objetos relacionados](https://msdn.microsoft.com/library/bb896272.aspx) na biblioteca MSDN.)</span><span class="sxs-lookup"><span data-stu-id="1ba3d-188">For more information, see [Loading Related Objects](https://msdn.microsoft.com/library/bb896272.aspx) in the MSDN Library.)</span></span>

<span data-ttu-id="1ba3d-189">No próximo tutorial, você aprenderá a usar a funcionalidade de dados dinâmicos para tornar mais fácil para o programa e teste regras de formatação e validação de dados.</span><span class="sxs-lookup"><span data-stu-id="1ba3d-189">In the next tutorial, you'll learn how to use Dynamic Data functionality to make it easier to program and test data formatting and validation rules.</span></span> <span data-ttu-id="1ba3d-190">Em vez de especificar as regras de cada página da web, como cadeias de caracteres de formato de dados e ou não um campo é obrigatório, você pode especificar essas regras nos metadados do modelo de dados e eles são aplicados automaticamente em cada página.</span><span class="sxs-lookup"><span data-stu-id="1ba3d-190">Instead of specifying on each web page rules such as data format strings and whether or not a field is required, you can specify such rules in data model metadata and they're automatically applied on every page.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="1ba3d-191">[Anterior](the-entity-framework-and-aspnet-getting-started-part-6.md)
> [Próximo](the-entity-framework-and-aspnet-getting-started-part-8.md)</span><span class="sxs-lookup"><span data-stu-id="1ba3d-191">[Previous](the-entity-framework-and-aspnet-getting-started-part-6.md)
[Next](the-entity-framework-and-aspnet-getting-started-part-8.md)</span></span>

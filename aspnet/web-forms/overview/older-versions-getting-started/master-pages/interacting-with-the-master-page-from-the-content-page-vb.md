---
uid: web-forms/overview/older-versions-getting-started/master-pages/interacting-with-the-master-page-from-the-content-page-vb
title: Interagindo com a página mestra da página de conteúdo (VB) | Microsoft Docs
author: rick-anderson
description: Examina como chamar métodos, definir propriedades, etc. da página mestra do código na página de conteúdo.
ms.author: aspnetcontent
manager: wpickett
ms.date: 07/11/2008
ms.topic: article
ms.assetid: 081fe010-ba0f-4e7d-b4ba-774840b601c2
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/older-versions-getting-started/master-pages/interacting-with-the-master-page-from-the-content-page-vb
msc.type: authoredcontent
ms.openlocfilehash: 7e92e7abbc69a0998d7563db0d5b206d7ba3d6be
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/06/2018
---
<a name="interacting-with-the-master-page-from-the-content-page-vb"></a><span data-ttu-id="9ea0e-103">Interagindo com a página mestra da página de conteúdo (VB)</span><span class="sxs-lookup"><span data-stu-id="9ea0e-103">Interacting with the Master Page from the Content Page (VB)</span></span>
====================
<span data-ttu-id="9ea0e-104">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="9ea0e-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="9ea0e-105">[Baixar o código](http://download.microsoft.com/download/1/8/4/184e24fa-fcc8-47fa-ac99-4b6a52d41e97/ASPNET_MasterPages_Tutorial_06_VB.zip) ou [baixar PDF](http://download.microsoft.com/download/e/b/4/eb4abb10-c416-4ba4-9899-32577715b1bd/ASPNET_MasterPages_Tutorial_06_VB.pdf)</span><span class="sxs-lookup"><span data-stu-id="9ea0e-105">[Download Code](http://download.microsoft.com/download/1/8/4/184e24fa-fcc8-47fa-ac99-4b6a52d41e97/ASPNET_MasterPages_Tutorial_06_VB.zip) or [Download PDF](http://download.microsoft.com/download/e/b/4/eb4abb10-c416-4ba4-9899-32577715b1bd/ASPNET_MasterPages_Tutorial_06_VB.pdf)</span></span>

> <span data-ttu-id="9ea0e-106">Examina como chamar métodos, definir propriedades, etc. da página mestra do código na página de conteúdo.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-106">Examines how to call methods, set properties, etc. of the Master Page from code in the Content Page.</span></span>


## <a name="introduction"></a><span data-ttu-id="9ea0e-107">Introdução</span><span class="sxs-lookup"><span data-stu-id="9ea0e-107">Introduction</span></span>

<span data-ttu-id="9ea0e-108">Ao longo dos últimos cinco tutoriais que vimos como criar uma página mestre, definir áreas de conteúdo, associar páginas ASP.NET para uma página mestra e definir o conteúdo específico da página.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-108">Over the course of the past five tutorials we have looked at how to create a master page, define content regions, bind ASP.NET pages to a master page, and define page-specific content.</span></span> <span data-ttu-id="9ea0e-109">Quando um visitante solicita uma página de conteúdo particular, o conteúdo e a marcação de páginas mestras são combinadas em tempo de execução, resultando no processamento de uma hierarquia de controle unificada.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-109">When a visitor requests a particular content page, the content and master pages' markup are fused at runtime, resulting in the rendering of a unified control hierarchy.</span></span> <span data-ttu-id="9ea0e-110">Portanto, já vimos uma forma em que a página mestra e uma das suas páginas de conteúdo podem interagir: a página de conteúdo explica a marcação para transfuse em controles ContentPlaceHolder da página mestra.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-110">Therefore, we have already seen one way in which the master page and one of its content pages can interact: the content page spells out the markup to transfuse into the master page's ContentPlaceHolder controls.</span></span>

<span data-ttu-id="9ea0e-111">O que ainda precisamos examinar é como a página mestra e a página de conteúdo podem interagir programaticamente.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-111">What we have yet to examine is how the master page and content page can interact programmatically.</span></span> <span data-ttu-id="9ea0e-112">Além de definir a marcação para controles ContentPlaceHolder da página mestra, uma página de conteúdo também pode atribuir valores às propriedades públicas da sua página mestra e chamar seus métodos públicos.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-112">In addition to defining the markup for the master page's ContentPlaceHolder controls, a content page can also assign values to its master page's public properties and invoke its public methods.</span></span> <span data-ttu-id="9ea0e-113">Da mesma forma, uma página mestra pode interagir com suas páginas de conteúdo.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-113">Similarly, a master page may interact with its content pages.</span></span> <span data-ttu-id="9ea0e-114">Enquanto a interação entre uma página mestra e o conteúdo de modo programático é menos comum do que a interação entre suas marcações declarativas, há muitos cenários em que essa interação de modo programático é necessária.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-114">While programmatic interaction between a master and content page is less common than the interaction between their declarative markups, there are many scenarios where such programmatic interaction is needed.</span></span>

<span data-ttu-id="9ea0e-115">Neste tutorial, podemos examinar como uma página de conteúdo pode interagir programaticamente com sua página mestra; o seguinte tutorial, examinaremos como a página mestra da mesma forma pode interagir com suas páginas de conteúdo.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-115">In this tutorial we examine how a content page can programmatically interact with its master page; in the next tutorial we will look at how the master page can similarly interact with its content pages.</span></span>

## <a name="examples-of-programmatic-interaction-between-a-content-page-and-its-master-page"></a><span data-ttu-id="9ea0e-116">Exemplos de programação interação entre uma página de conteúdo e sua página mestra</span><span class="sxs-lookup"><span data-stu-id="9ea0e-116">Examples of Programmatic Interaction Between a Content Page and its Master Page</span></span>

<span data-ttu-id="9ea0e-117">Quando uma região específica de uma página precisa ser configurado em uma base de página por página, usamos um controle ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-117">When a particular region of a page needs to be configured on a page-by-page basis, we use a ContentPlaceHolder control.</span></span> <span data-ttu-id="9ea0e-118">Mas e quanto situações em que a maioria das páginas necessário para emitir um determinado tipo de saída, mas um pequeno número de páginas necessário personalizá-lo para mostrar algo mais?</span><span class="sxs-lookup"><span data-stu-id="9ea0e-118">But what about situations where the majority of pages need to emit a certain output, but a small number of pages need to customize it to show something else?</span></span> <span data-ttu-id="9ea0e-119">Um exemplo, que são examinados no [ *ContentPlaceHolders vários e conteúdo padrão* ](multiple-contentplaceholders-and-default-content-vb.md) envolve o tutorial, exibindo uma interface de logon em cada página.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-119">One such example, which we examined in the [*Multiple ContentPlaceHolders and Default Content*](multiple-contentplaceholders-and-default-content-vb.md) tutorial, involves displaying a login interface on each page.</span></span> <span data-ttu-id="9ea0e-120">Embora a maioria das páginas deve incluir uma interface de logon, ele deve ser suprimido para uma série de páginas, como: a página de logon principal (`Login.aspx`); a página de criação de conta; e outras páginas que são acessíveis apenas a usuários autenticados.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-120">While most pages should include a login interface, it should be suppressed for a handful of pages, such as: the main login page (`Login.aspx`); the Create Account page; and other pages that are only accessible to authenticated users.</span></span> <span data-ttu-id="9ea0e-121">O [ *ContentPlaceHolders vários e conteúdo padrão* ](multiple-contentplaceholders-and-default-content-vb.md) tutorial mostrou como definir o conteúdo padrão para um ContentPlaceHolder na página mestra e, em seguida, como substituí-la nas páginas onde o conteúdo padrão não foi desejado.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-121">The [*Multiple ContentPlaceHolders and Default Content*](multiple-contentplaceholders-and-default-content-vb.md) tutorial showed how to define the default content for a ContentPlaceHolder in the master page and then how to override it in those pages where the default content was not wanted.</span></span>

<span data-ttu-id="9ea0e-122">Outra opção é criar uma propriedade pública ou método dentro da página mestra que indica se deve mostrar ou ocultar a interface de logon.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-122">Another option is to create a public property or method within the master page that indicates whether to show or hide the login interface.</span></span> <span data-ttu-id="9ea0e-123">Por exemplo, a página mestra pode incluir uma propriedade pública denominada `ShowLoginUI` cujo valor foi usado para definir o `Visible` propriedade do controle de logon na página mestra.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-123">For example, the master page might include a public property named `ShowLoginUI` whose value was used to set the `Visible` property of the Login control in the master page.</span></span> <span data-ttu-id="9ea0e-124">Essas páginas de conteúdo em que a interface de usuário do logon deve ser suprimida depois podem definir programaticamente o `ShowLoginUI` propriedade `False`.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-124">Those content pages where the login user interface should be suppressed could then programmatically set the `ShowLoginUI` property to `False`.</span></span>

<span data-ttu-id="9ea0e-125">Talvez o exemplo mais comum de conteúdo e interação de página mestra ocorre quando os dados exibidos na página mestra precisa ser atualizada depois que alguma ação ocorridos na página de conteúdo.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-125">Perhaps the most common example of content and master page interaction occurs when data displayed in the master page needs to be refreshed after some action has transpired in the content page.</span></span> <span data-ttu-id="9ea0e-126">Considere uma página mestra que inclui um GridView que exibe os cinco mais recentemente adicionada registros de uma tabela de banco de dados específico e que uma das suas páginas de conteúdo inclui uma interface para adição de novos registros para a mesma tabela.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-126">Consider a master page that includes a GridView that displays the five most recently added records from a particular database table, and that one of its content pages includes an interface for adding new records to that same table.</span></span>

<span data-ttu-id="9ea0e-127">Quando um usuário acessa a página para adicionar um novo registro, ela vê que cinco adicionada mais recentemente registros exibidos na página mestra.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-127">When a user visits the page to add a new record, she sees the five most recently added records displayed in the master page.</span></span> <span data-ttu-id="9ea0e-128">Depois de preencher os valores para colunas do novo registro, ela envia o formulário.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-128">After filling in the values for the new record's columns, she submits the form.</span></span> <span data-ttu-id="9ea0e-129">Supondo que o GridView na página mestra tem seu `EnableViewState` propriedade definida como True (padrão), seu conteúdo é recarregado do estado de exibição e, consequentemente, os mesmos cinco registros são exibidos, mesmo que um novo registro acabou de ser adicionado ao banco de dados.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-129">Assuming that the GridView in the master page has its `EnableViewState` property set to True (the default), its content is reloaded from view state and, consequently, the five same records are displayed even though a newer record was just added to the database.</span></span> <span data-ttu-id="9ea0e-130">Isso pode confundir o usuário.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-130">This may confuse the user.</span></span>

> [!NOTE]
> <span data-ttu-id="9ea0e-131">Mesmo se você desabilitar o estado de exibição do GridView para que ele se reconecta à sua fonte de dados subjacente em cada postagem, ele ainda não mostrar o registro adicionados apenas porque os dados serão associados à GridView anteriormente no ciclo de vida de página que quando o novo registro é adicionado para o datab ASE.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-131">Even if you disable the GridView's view state so that it rebinds to its underlying data source on every postback, it still won't show the just-added record because the data is bound to the GridView earlier in the page lifecycle than when the new record is added to the database.</span></span>


<span data-ttu-id="9ea0e-132">Para corrigir isso para que o registro just-adicionado é exibido na página mestra do GridView, precisamos instruir o GridView associar novamente a fonte de dados de postagem *depois* o novo registro foi adicionado ao banco de dados.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-132">To remedy this so that the just-added record is displayed in the master page's GridView on postback we need to instruct the GridView to rebind to its data source *after* the new record has been added to the database.</span></span> <span data-ttu-id="9ea0e-133">Isso requer a interação entre o conteúdo e páginas mestras porque é a interface para adicionar que o novo registro (e seus manipuladores de eventos) estão em GridView que precisa ser atualizado, mas a página de conteúdo na página mestra.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-133">This requires interaction between the content and master pages because the interface for adding the new record (and its event handlers) are in the content page but the GridView that needs to be refreshed is in the master page.</span></span>

<span data-ttu-id="9ea0e-134">Como atualizar a exibição da página mestra de um manipulador de eventos na página de conteúdo é uma das necessidades mais comuns de conteúdo e interação de página mestra, vamos explorar esse tópico em mais detalhes.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-134">Because refreshing the master page's display from an event handler in the content page is one of the most common needs for content and master page interaction, let's explore this topic in more detail.</span></span> <span data-ttu-id="9ea0e-135">O download para este tutorial inclui um banco de dados do Microsoft SQL Server 2005 Express Edition denominado `NORTHWIND.MDF` do site `App_Data` pasta.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-135">The download for this tutorial includes a Microsoft SQL Server 2005 Express Edition database named `NORTHWIND.MDF` in the website's `App_Data` folder.</span></span> <span data-ttu-id="9ea0e-136">O banco de dados Northwind armazena informações de vendas de uma empresa fictícia, a Northwind Traders, funcionário e produto.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-136">The Northwind database stores product, employee, and sales information for a fictitious company, Northwind Traders.</span></span>

<span data-ttu-id="9ea0e-137">Etapa 1 aborda exibindo cinco mais recentemente adicionado produtos em um GridView na página mestra.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-137">Step 1 walks through displaying the five most recently added products in a GridView in the master page.</span></span> <span data-ttu-id="9ea0e-138">Etapa 2 cria uma página de conteúdo para a adição de novos produtos.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-138">Step 2 creates a content page for adding new products.</span></span> <span data-ttu-id="9ea0e-139">Etapa 3 explica como criar propriedades e métodos públicos na página mestra e etapa 4 ilustra como a interface programaticamente com essas propriedades e métodos da página de conteúdo.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-139">Step 3 looks at how to create public properties and methods in the master page, and Step 4 illustrates how to programmatically interface with these properties and methods from the content page.</span></span>

> [!NOTE]
> <span data-ttu-id="9ea0e-140">Este tutorial não Aprofunde-se as especificações de trabalhar com dados no ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-140">This tutorial does not delve into the specifics of working with data in ASP.NET.</span></span> <span data-ttu-id="9ea0e-141">As etapas para configurar a página mestra para exibir dados e a página de conteúdo para a inserção de dados estiverem concluídas, ainda breezy.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-141">The steps for setting up the master page to display data and the content page for inserting data are complete, yet breezy.</span></span> <span data-ttu-id="9ea0e-142">Para uma visão mais detalhada de exibição e inserção de dados e usando os controles de SqlDataSource e GridView, consulte os recursos na seção Leituras adicionais no final deste tutorial.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-142">For a more in-depth look at displaying and inserting data and using the SqlDataSource and GridView controls, consult the resources in the Further Readings section at the end of this tutorial.</span></span>


## <a name="step-1-displaying-the-five-most-recently-added-products-in-the-master-page"></a><span data-ttu-id="9ea0e-143">Etapa 1: Exibir os cinco mais recentemente adicionado produtos na página mestra</span><span class="sxs-lookup"><span data-stu-id="9ea0e-143">Step 1: Displaying the Five Most Recently Added Products in the Master Page</span></span>

<span data-ttu-id="9ea0e-144">Abra a página mestra Site.master e adicione um rótulo e um controle GridView para o `leftContent` `<div>`.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-144">Open the Site.master master page and add a Label and a GridView control to the `leftContent` `<div>`.</span></span> <span data-ttu-id="9ea0e-145">Desmarque fora do rótulo `Text` propriedade, definida seu `EnableViewState` propriedade para `False`e sua `ID` propriedade `GridMessage`; definir o GridView `ID` propriedade para `RecentProducts`.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-145">Clear out the Label's `Text` property, set its `EnableViewState` property to `False`, and its `ID` property to `GridMessage`; set the GridView's `ID` property to `RecentProducts`.</span></span> <span data-ttu-id="9ea0e-146">Em seguida, no Designer, expanda a marca inteligente do GridView e escolha para associá-lo para uma nova fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-146">Next, from the Designer, expand the GridView's smart tag and choose to bind it to a new data source.</span></span> <span data-ttu-id="9ea0e-147">Isso inicia o Assistente de configuração de fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-147">This launches the Data Source Configuration wizard.</span></span> <span data-ttu-id="9ea0e-148">Porque o banco de dados Northwind no `App_Data` pasta é um banco de dados do Microsoft SQL Server, optar por criar um SqlDataSource selecionando (consulte a Figura 1); nome SqlDataSource `RecentProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-148">Because the Northwind database in the `App_Data` folder is a Microsoft SQL Server database, choose to create a SqlDataSource by selecting (see Figure 1); name the SqlDataSource `RecentProductsDataSource`.</span></span>


<span data-ttu-id="9ea0e-149">[![Associar um controle SqlDataSource chamado RecentProductsDataSource GridView](interacting-with-the-master-page-from-the-content-page-vb/_static/image2.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="9ea0e-149">[![Bind the GridView to a SqlDataSource Control Named RecentProductsDataSource](interacting-with-the-master-page-from-the-content-page-vb/_static/image2.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image1.png)</span></span>

<span data-ttu-id="9ea0e-150">**Figura 01**: associar o GridView para um controle SqlDataSource chamado `RecentProductsDataSource` ([clique para exibir a imagem em tamanho normal](interacting-with-the-master-page-from-the-content-page-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="9ea0e-150">**Figure 01**: Bind the GridView to a SqlDataSource Control Named `RecentProductsDataSource` ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image3.png))</span></span>


<span data-ttu-id="9ea0e-151">A próxima etapa pergunta para especificar o banco de dados para se conectar ao.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-151">The next step asks us to specify what database to connect to.</span></span> <span data-ttu-id="9ea0e-152">Escolha o `NORTHWIND.MDF` banco de dados do arquivo na lista suspensa e clique em Avançar.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-152">Choose the `NORTHWIND.MDF` database file from the drop-down list and click Next.</span></span> <span data-ttu-id="9ea0e-153">Como esta é a primeira vez que usamos este banco de dados, o assistente oferecerá para armazenar a cadeia de caracteres de conexão em `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-153">Because this is the first time we've used this database, the wizard will offer to store the connection string in `Web.config`.</span></span> <span data-ttu-id="9ea0e-154">Que permite armazenar a cadeia de caracteres de conexão usando o nome `NorthwindConnectionString`.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-154">Have it store the connection string using the name `NorthwindConnectionString`.</span></span>


<span data-ttu-id="9ea0e-155">[![Conecte-se ao banco de dados Northwind](interacting-with-the-master-page-from-the-content-page-vb/_static/image5.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="9ea0e-155">[![Connect to the Northwind Database](interacting-with-the-master-page-from-the-content-page-vb/_static/image5.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image4.png)</span></span>

<span data-ttu-id="9ea0e-156">**Figura 02**: conectar-se ao banco de dados Northwind ([clique para exibir a imagem em tamanho normal](interacting-with-the-master-page-from-the-content-page-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="9ea0e-156">**Figure 02**: Connect to the Northwind Database  ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image6.png))</span></span>


<span data-ttu-id="9ea0e-157">O Assistente Configurar fonte de dados fornece dois meios pelos quais podemos especificar a consulta usada para recuperar dados:</span><span class="sxs-lookup"><span data-stu-id="9ea0e-157">The Configure Data Source wizard provides two means by which we can specify the query used to retrieve data:</span></span>

- <span data-ttu-id="9ea0e-158">Especificando uma instrução SQL personalizada ou procedimento armazenado, ou</span><span class="sxs-lookup"><span data-stu-id="9ea0e-158">By specifying a custom SQL statement or stored procedure, or</span></span>
- <span data-ttu-id="9ea0e-159">A seleção de uma tabela ou exibição e, em seguida, especificando as colunas para retornar</span><span class="sxs-lookup"><span data-stu-id="9ea0e-159">By picking a table or view and then specifying the columns to return</span></span>

<span data-ttu-id="9ea0e-160">Como queremos retornar que apenas os cinco mais recentemente adicionado produtos, é preciso especificar uma instrução SQL personalizada.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-160">Because we want to return just the five most recently added products, we need to specify a custom SQL statement.</span></span> <span data-ttu-id="9ea0e-161">Use a seguinte `SELECT` consulta:</span><span class="sxs-lookup"><span data-stu-id="9ea0e-161">Use the following `SELECT` query:</span></span>


[!code-sql[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample1.sql)]

<span data-ttu-id="9ea0e-162">O `TOP 5` palavra-chave retorna apenas os cinco primeiros registros da consulta.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-162">The `TOP 5` keyword returns only the first five records from the query.</span></span> <span data-ttu-id="9ea0e-163">O `Products` chave primária da tabela `ProductID`, é um `IDENTITY` coluna, que garante a nós que cada novo produto adicionado à tabela terá um valor maior que a entrada anterior.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-163">The `Products` table's primary key, `ProductID`, is an `IDENTITY` column, which assures us that each new product added to the table will have a larger value than the previous entry.</span></span> <span data-ttu-id="9ea0e-164">Portanto, classificar os resultados por `ProductID` em ordem decrescente retorna os produtos começando com a última aqueles criados.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-164">Therefore, sorting the results by `ProductID` in descending order returns the products starting with the most recently created ones.</span></span>


<span data-ttu-id="9ea0e-165">[![Retorna os cinco produtos adicionados mais recentemente](interacting-with-the-master-page-from-the-content-page-vb/_static/image8.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="9ea0e-165">[![Return the Five Most Recently Added Products](interacting-with-the-master-page-from-the-content-page-vb/_static/image8.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image7.png)</span></span>

<span data-ttu-id="9ea0e-166">**Figura 03**: retornar os cinco mais recentemente adicionado produtos ([clique para exibir a imagem em tamanho normal](interacting-with-the-master-page-from-the-content-page-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="9ea0e-166">**Figure 03**: Return the Five Most Recently Added Products  ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image9.png))</span></span>


<span data-ttu-id="9ea0e-167">Depois de concluir o assistente, o Visual Studio gera dois BoundFields do GridView exibir o `ProductName` e `UnitPrice` campos retornados do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-167">After completing the wizard, Visual Studio generates two BoundFields for the GridView to display the `ProductName` and `UnitPrice` fields returned from the database.</span></span> <span data-ttu-id="9ea0e-168">Neste ponto declarativo da sua página mestre deve incluir marcação semelhante ao seguinte:</span><span class="sxs-lookup"><span data-stu-id="9ea0e-168">At this point your master page's declarative markup should include markup similar to the following:</span></span>


[!code-aspx[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample2.aspx)]

<span data-ttu-id="9ea0e-169">Como você pode ver, a marcação contém: o controle de rótulo Web (`GridMessage`); o GridView `RecentProducts`, com dois BoundFields; e um controle SqlDataSource que retorna os cinco mais recentemente adicionado produtos.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-169">As you can see, the markup contains: the Label Web control (`GridMessage`); the GridView `RecentProducts`, with two BoundFields; and a SqlDataSource control that returns the five most recently added products.</span></span>

<span data-ttu-id="9ea0e-170">Com isso GridView criado e seu controle SqlDataSource configurado, visite o site por meio de um navegador.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-170">With this GridView created and its SqlDataSource control configured, visit the website through a browser.</span></span> <span data-ttu-id="9ea0e-171">Como mostra a Figura 4, você verá uma grade no canto inferior esquerdo que lista os cinco mais recentemente adicionado produtos.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-171">As Figure 4 shows, you will see a grid in the lower left corner that lists the five most recently added products.</span></span>


<span data-ttu-id="9ea0e-172">[![O GridView exibe os cinco produtos adicionados mais recentemente](interacting-with-the-master-page-from-the-content-page-vb/_static/image11.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="9ea0e-172">[![The GridView Displays the Five Most Recently Added Products](interacting-with-the-master-page-from-the-content-page-vb/_static/image11.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image10.png)</span></span>

<span data-ttu-id="9ea0e-173">**Figura 04**: GridView exibe os cinco mais recentemente adicionado produtos ([clique para exibir a imagem em tamanho normal](interacting-with-the-master-page-from-the-content-page-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="9ea0e-173">**Figure 04**: The GridView Displays the Five Most Recently Added Products ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image12.png))</span></span>


> [!NOTE]
> <span data-ttu-id="9ea0e-174">Fique à vontade para limpar a aparência de GridView.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-174">Feel free to clean up the appearance of the GridView.</span></span> <span data-ttu-id="9ea0e-175">Algumas sugestões incluem formatação exibido `UnitPrice` valor como uma moeda e o uso de fontes e cores de plano de fundo para melhorar a aparência da grade.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-175">Some suggestions include formatting the displayed `UnitPrice` value as a currency and using background colors and fonts to improve the grid's appearance.</span></span>


## <a name="step-2-creating-a-content-page-to-add-new-products"></a><span data-ttu-id="9ea0e-176">Etapa 2: Criando uma página de conteúdo para adicionar novos produtos</span><span class="sxs-lookup"><span data-stu-id="9ea0e-176">Step 2: Creating a Content Page to Add New Products</span></span>

<span data-ttu-id="9ea0e-177">Nossa próxima tarefa é criar uma página de conteúdo na qual um usuário pode adicionar um novo produto para o `Products` tabela.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-177">Our next task is to create a content page from which a user can add a new product to the `Products` table.</span></span> <span data-ttu-id="9ea0e-178">Adicione uma nova página de conteúdo para o `Admin` pasta denominada `AddProduct.aspx`, tornando-se para associá-lo para o `Site.master` página mestra.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-178">Add a new content page to the `Admin` folder named `AddProduct.aspx`, making sure to bind it to the `Site.master` master page.</span></span> <span data-ttu-id="9ea0e-179">A Figura 5 mostra o Gerenciador de soluções depois que esta página foi adicionada para o site.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-179">Figure 5 shows the Solution Explorer after this page has been added to the website.</span></span>


<span data-ttu-id="9ea0e-180">[![Adicionar uma nova página ASP.NET para a pasta Admin](interacting-with-the-master-page-from-the-content-page-vb/_static/image14.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="9ea0e-180">[![Add a New ASP.NET Page to the Admin Folder](interacting-with-the-master-page-from-the-content-page-vb/_static/image14.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image13.png)</span></span>

<span data-ttu-id="9ea0e-181">**Figura 05**: adicionar uma nova página ASP.NET para o `Admin` pasta ([clique para exibir a imagem em tamanho normal](interacting-with-the-master-page-from-the-content-page-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="9ea0e-181">**Figure 05**: Add a New ASP.NET Page to the `Admin` Folder ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image15.png))</span></span>


<span data-ttu-id="9ea0e-182">Lembre-se de que o [ *especificando o título, marcas Meta e outros cabeçalhos de HTML na página mestra* ](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md) tutorial criamos uma classe de página de base personalizada chamada `BasePage` que gerou o título da página, se ele foi não foi explicitamente definido.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-182">Recall that in the [*Specifying the Title, Meta Tags, and Other HTML Headers in the Master Page*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md) tutorial we created a custom base page class named `BasePage` that generated the page's title if it was not explicitly set.</span></span> <span data-ttu-id="9ea0e-183">Vá para o `AddProduct.aspx` por trás do código da página de classe e a derivam `BasePage` (em vez de `System.Web.UI.Page`).</span><span class="sxs-lookup"><span data-stu-id="9ea0e-183">Go to the `AddProduct.aspx` page's code-behind class and have it derive from `BasePage` (instead of from `System.Web.UI.Page`).</span></span>

<span data-ttu-id="9ea0e-184">Por fim, atualize o `Web.sitemap` arquivo para incluir uma entrada para esta lição.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-184">Finally, update the `Web.sitemap` file to include an entry for this lesson.</span></span> <span data-ttu-id="9ea0e-185">Adicione a seguinte marcação sob o `<siteMapNode>` da lição problemas de nomenclatura de ID de controle:</span><span class="sxs-lookup"><span data-stu-id="9ea0e-185">Add the following markup beneath the `<siteMapNode>` for the Control ID Naming Issues lesson:</span></span>


[!code-xml[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample3.xml)]

<span data-ttu-id="9ea0e-186">Conforme mostrado na Figura 6, a adição deste `<siteMapNode>` elemento será refletido na lista de lições.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-186">As shown in Figure 6, the addition of this `<siteMapNode>` element is reflected in the Lessons list.</span></span>

<span data-ttu-id="9ea0e-187">Retorne ao `AddProduct.aspx`.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-187">Return to `AddProduct.aspx`.</span></span> <span data-ttu-id="9ea0e-188">No controle de conteúdo para o `MainContent` ContentPlaceHolder, adicione um controle DetailsView e denomine- `NewProduct`.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-188">In the Content control for the `MainContent` ContentPlaceHolder, add a DetailsView control and name it `NewProduct`.</span></span> <span data-ttu-id="9ea0e-189">Associar o DetailsView para um novo controle SqlDataSource chamado `NewProductDataSource`.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-189">Bind the DetailsView to a new SqlDataSource control named `NewProductDataSource`.</span></span> <span data-ttu-id="9ea0e-190">Como com o SqlDataSource na etapa 1, configurar o Assistente para que ele usa o banco de dados Northwind e optar por especificar uma instrução SQL personalizada.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-190">Like with the SqlDataSource in Step 1, configure the wizard so that it uses the Northwind database and choose to specify a custom SQL statement.</span></span> <span data-ttu-id="9ea0e-191">Como o DetailsView será usado para adicionar itens ao banco de dados, é preciso especificar ambos um `SELECT` instrução e um `INSERT` instrução.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-191">Because the DetailsView will be used to add items to the database, we need to specify both a `SELECT` statement and an `INSERT` statement.</span></span> <span data-ttu-id="9ea0e-192">Use a seguinte `SELECT` consulta:</span><span class="sxs-lookup"><span data-stu-id="9ea0e-192">Use the following `SELECT` query:</span></span>


[!code-sql[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample4.sql)]

<span data-ttu-id="9ea0e-193">Em seguida, na guia Inserir, adicione o seguinte `INSERT` instrução:</span><span class="sxs-lookup"><span data-stu-id="9ea0e-193">Then, from the INSERT tab, add the following `INSERT` statement:</span></span>


[!code-sql[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample5.sql)]

<span data-ttu-id="9ea0e-194">Após concluir o assistente, vá para marcas inteligentes de DetailsView e marque a caixa de seleção "Habilitar inserindo".</span><span class="sxs-lookup"><span data-stu-id="9ea0e-194">After completing the wizard go to the DetailsView's smart tag and check the "Enable Inserting" checkbox.</span></span> <span data-ttu-id="9ea0e-195">Isso adiciona um CommandField a DetailsView com seu `ShowInsertButton` propriedade definida como True.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-195">This adds a CommandField to the DetailsView with its `ShowInsertButton` property set to True.</span></span> <span data-ttu-id="9ea0e-196">Como esse DetailsView será usado apenas para a inserção de dados, defina a DetailsView `DefaultMode` propriedade `Insert`.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-196">Because this DetailsView will be used solely for inserting data, set the DetailsView's `DefaultMode` property to `Insert`.</span></span>

<span data-ttu-id="9ea0e-197">Isso é tudo que é necessário para que ele!</span><span class="sxs-lookup"><span data-stu-id="9ea0e-197">That's all there is to it!</span></span> <span data-ttu-id="9ea0e-198">Vamos testar esta página.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-198">Let's test this page.</span></span> <span data-ttu-id="9ea0e-199">Visite `AddProduct.aspx` através de um navegador, digite um nome e o preço (veja a Figura 6).</span><span class="sxs-lookup"><span data-stu-id="9ea0e-199">Visit `AddProduct.aspx` through a browser, enter a name and price (see Figure 6).</span></span>


<span data-ttu-id="9ea0e-200">[![Adicionar um novo produto no banco de dados](interacting-with-the-master-page-from-the-content-page-vb/_static/image17.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="9ea0e-200">[![Add a New Product to the Database](interacting-with-the-master-page-from-the-content-page-vb/_static/image17.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image16.png)</span></span>

<span data-ttu-id="9ea0e-201">**Figura 06**: adicionar um novo produto no banco de dados ([clique para exibir a imagem em tamanho normal](interacting-with-the-master-page-from-the-content-page-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="9ea0e-201">**Figure 06**: Add a New Product to the Database  ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image18.png))</span></span>


<span data-ttu-id="9ea0e-202">Depois de digitar o nome e o preço para o novo produto, clique no botão de inserção.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-202">After typing in the name and price for your new product, click the Insert button.</span></span> <span data-ttu-id="9ea0e-203">Isso faz com que o formulário de postback.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-203">This causes the form to postback.</span></span> <span data-ttu-id="9ea0e-204">Em um postback, o controle SqlDataSource `INSERT` instrução é executada; seus dois parâmetros são preenchidos com os valores inseridos pelo usuário em dois controles de caixa de texto de DetailsView.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-204">On postback, the SqlDataSource control's `INSERT` statement is executed; its two parameters are populated with the user-entered values in the DetailsView's two TextBox controls.</span></span> <span data-ttu-id="9ea0e-205">Infelizmente, não há nenhum comentários visuais que ocorreu uma inserção.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-205">Unfortunately, there is no visual feedback that an insert has occurred.</span></span> <span data-ttu-id="9ea0e-206">Seria ótimo ter uma mensagem exibida, confirmando que foi adicionado um novo registro.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-206">It would be nice to have a message displayed, confirming that a new record has been added.</span></span> <span data-ttu-id="9ea0e-207">Posso deixar isso como um exercício para o leitor.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-207">I leave this as an exercise for the reader.</span></span> <span data-ttu-id="9ea0e-208">Além disso, depois de adicionar um novo registro de DetailsView GridView na página mestra ainda mostra os mesmos cinco registros como antes; ele não inclui o registro adicionado imediatamente.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-208">Also, after adding a new record from the DetailsView the GridView in the master page still shows the same five records as before; it does not include the just-added record.</span></span> <span data-ttu-id="9ea0e-209">Vamos examinar como corrigir isso nas etapas futuras.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-209">We'll examine how to remedy this in the upcoming steps.</span></span>

> [!NOTE]
> <span data-ttu-id="9ea0e-210">Além de adicionar alguma forma de comentários visuais que a inserção foi bem-sucedida, eu recomendo que também atualizar a interface de inserção de DetailsView para incluir validação.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-210">In addition to adding some form of visual feedback that the insert has succeeded, I'd encourage you to also update the DetailsView's inserting interface to include validation.</span></span> <span data-ttu-id="9ea0e-211">Atualmente, não há nenhuma validação.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-211">Currently, there is no validation.</span></span> <span data-ttu-id="9ea0e-212">Se um usuário inserir um valor inválido para o `UnitPrice` campo, como "muito caro," uma exceção será lançada em um postback quando o sistema tenta converter a cadeia de caracteres em um decimal.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-212">If a user enters an invalid value for the `UnitPrice` field, such as "Too expensive," an exception will be thrown on postback when the system attempts to convert that string into a decimal.</span></span> <span data-ttu-id="9ea0e-213">Para obter mais informações sobre como personalizar a inserção de interface, consulte o [ *Personalizando a Interface de modificação de dados* tutorial](https://asp.net/learn/data-access/tutorial-20-vb.aspx) do meu [trabalhando com série de tutoriais de dados](../../data-access/index.md).</span><span class="sxs-lookup"><span data-stu-id="9ea0e-213">For more information on customizing the inserting interface, refer to the [*Customizing the Data Modification Interface* tutorial](https://asp.net/learn/data-access/tutorial-20-vb.aspx) from my [Working with Data tutorial series](../../data-access/index.md).</span></span>


## <a name="step-3-creating-public-properties-and-methods-in-the-master-page"></a><span data-ttu-id="9ea0e-214">Etapa 3: Criar propriedades e métodos públicos na página mestra</span><span class="sxs-lookup"><span data-stu-id="9ea0e-214">Step 3: Creating Public Properties and Methods in the Master Page</span></span>

<span data-ttu-id="9ea0e-215">Na etapa 1, adicionamos um controle de rótulo Web chamado `GridMessage` acima GridView na página mestra.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-215">In Step 1 we added a Label Web control named `GridMessage` above the GridView in the master page.</span></span> <span data-ttu-id="9ea0e-216">Este rótulo destina-se a exibir, opcionalmente, uma mensagem.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-216">This Label is intended to optionally display a message.</span></span> <span data-ttu-id="9ea0e-217">Por exemplo, depois de adicionar um novo registro para o `Products` tabela, que talvez desejemos mostrar a mensagem: "*ProductName* foi adicionado ao banco de dados."</span><span class="sxs-lookup"><span data-stu-id="9ea0e-217">For example, after adding a new record to the `Products` table, we might want to show a message that reads: "*ProductName* has been added to the database."</span></span> <span data-ttu-id="9ea0e-218">Em vez de embutir em código o texto para este rótulo na página mestre, que talvez desejemos a mensagem seja personalizável, a página de conteúdo.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-218">Rather than hard-code the text for this Label in the master page, we might want the message to be customizable by the content page.</span></span>

<span data-ttu-id="9ea0e-219">Como o controle de rótulo é implementado como uma variável de membro protegido dentro da página mestra não pode ser acessado diretamente das páginas de conteúdo.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-219">Because the Label control is implemented as a protected member variable within the master page it cannot be accessed directly from content pages.</span></span> <span data-ttu-id="9ea0e-220">Para trabalhar com o rótulo em uma página mestre da página de conteúdo (ou, na verdade, qualquer controle de Web na página mestra), precisamos criar uma propriedade pública na página mestra que expõe o controle da Web ou serve como um proxy pelo qual uma de suas propriedades pode ser  acessado.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-220">In order to work with the Label within a master page from the content page (or, for that matter, any Web control in the master page) we need to create a public property in the master page that exposes the Web control or serves as a proxy by which one of its properties can be accessed.</span></span> <span data-ttu-id="9ea0e-221">Adicione a seguinte sintaxe para a classe de code-behind da página mestra para expor o rótulo `Text` propriedade:</span><span class="sxs-lookup"><span data-stu-id="9ea0e-221">Add the following syntax to the master page's code-behind class to expose the Label's `Text` property:</span></span>


[!code-vb[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample6.vb)]

<span data-ttu-id="9ea0e-222">Quando um novo registro é adicionado para o `Products` tabela de uma página de conteúdo a `RecentProducts` GridView na página mestra precisa reassociar a fonte de dados subjacente.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-222">When a new record is added to the `Products` table from a content page the `RecentProducts` GridView in the master page needs to rebind to its underlying data source.</span></span> <span data-ttu-id="9ea0e-223">Para associar novamente a chamada de GridView seu `DataBind` método.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-223">To rebind the GridView call its `DataBind` method.</span></span> <span data-ttu-id="9ea0e-224">Como GridView na página mestre não está acessível por meio de programação para as páginas de conteúdo, é necessário criar um método público na página mestra que, quando chamado, reconecta os dados do GridView.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-224">Because the GridView in the master page is not programmatically accessible to the content pages, we need to create a public method in the master page that, when called, rebinds the data to the GridView.</span></span> <span data-ttu-id="9ea0e-225">Adicione o seguinte método à classe de code-behind da página mestra:</span><span class="sxs-lookup"><span data-stu-id="9ea0e-225">Add the following method to the master page's code-behind class:</span></span>


[!code-vb[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample7.vb)]

<span data-ttu-id="9ea0e-226">Com o `GridMessageText` propriedade e `RefreshRecentProductsGrid` método, qualquer página de conteúdo pode programaticamente definir ou ler o valor da `GridMessage` do rótulo `Text` propriedade ou associar novamente os dados para o `RecentProducts` GridView.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-226">With the `GridMessageText` property and `RefreshRecentProductsGrid` method in place, any content page can programmatically set or read the value of the `GridMessage` Label's `Text` property or rebind the data to the `RecentProducts` GridView.</span></span> <span data-ttu-id="9ea0e-227">Etapa 4 examina como acessar a página mestra propriedades e métodos públicos de uma página de conteúdo.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-227">Step 4 examines how to access the master page's public properties and methods from a content page.</span></span>

> [!NOTE]
> <span data-ttu-id="9ea0e-228">Não se esqueça de marcar a página mestra propriedades e métodos como `Public`.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-228">Don't forget to mark the master page's properties and methods as `Public`.</span></span> <span data-ttu-id="9ea0e-229">Se você não explicitamente denotam essas propriedades e métodos como `Public`, eles não estarão acessíveis a partir da página de conteúdo.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-229">If you do not explicitly denote these properties and methods as `Public`, they will not be accessible from the content page.</span></span>


## <a name="step-4-calling-the-master-pages-public-members-from-a-content-page"></a><span data-ttu-id="9ea0e-230">Etapa 4: Chamando membros públicos da página mestra de uma página de conteúdo</span><span class="sxs-lookup"><span data-stu-id="9ea0e-230">Step 4: Calling the Master Page's Public Members from a Content Page</span></span>

<span data-ttu-id="9ea0e-231">Agora que a página mestra tem as propriedades públicas necessárias e os métodos, estamos prontos para chamar esses métodos e propriedades de `AddProduct.aspx` página de conteúdo.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-231">Now that the master page has the necessary public properties and methods, we're ready to invoke these properties and methods from the `AddProduct.aspx` content page.</span></span> <span data-ttu-id="9ea0e-232">Especificamente, é preciso definir a página mestra `GridMessageText` propriedade e chame seu `RefreshRecentProductsGrid` método depois que o novo produto foi adicionado ao banco de dados.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-232">Specifically, we need to set the master page's `GridMessageText` property and call its `RefreshRecentProductsGrid` method after the new product has been added to the database.</span></span> <span data-ttu-id="9ea0e-233">Todos os controles de Web de dados ASP.NET disparar eventos imediatamente antes e depois de concluir as diversas tarefas, que tornam mais fácil para os desenvolvedores de página executar alguma ação programática antes ou depois da tarefa.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-233">All the ASP.NET data Web controls fire events immediately before and after completing various tasks, which make it easy for page developers to take some programmatic action either before or after the task.</span></span> <span data-ttu-id="9ea0e-234">Por exemplo, quando o usuário final clicar botão de inserção de DetailsView, no postback gera o DetailsView seu `ItemInserting` evento antes de iniciar o fluxo de trabalho de inserção.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-234">For example, when the end user clicks the DetailsView's Insert button, on postback the DetailsView raises its `ItemInserting` event before beginning the inserting workflow.</span></span> <span data-ttu-id="9ea0e-235">Em seguida, ele insere o registro no banco de dados.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-235">It then inserts the record into the database.</span></span> <span data-ttu-id="9ea0e-236">Depois disso, DetailsView gera seu `ItemInserted` eventos.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-236">Following that, the DetailsView raises its `ItemInserted` event.</span></span> <span data-ttu-id="9ea0e-237">Portanto, para trabalhar com a página mestra depois de adicionar o novo produto, criar um manipulador de eventos para o DetailsView `ItemInserted` eventos.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-237">Therefore, in order to work with the master page after the new product has been added, create an event handler for the DetailsView's `ItemInserted` event.</span></span>

<span data-ttu-id="9ea0e-238">Há duas maneiras que uma página de conteúdo pode interagir programaticamente com sua página mestra:</span><span class="sxs-lookup"><span data-stu-id="9ea0e-238">There are two ways that a content page can programmatically interface with its master page:</span></span>

- <span data-ttu-id="9ea0e-239">Usando o `Page.Master` propriedade, que retorna uma referência tipadas vagamente à página mestre, ou</span><span class="sxs-lookup"><span data-stu-id="9ea0e-239">Using the `Page.Master` property, which returns a loosely-typed reference to the master page, or</span></span>
- <span data-ttu-id="9ea0e-240">Especifique o caminho de arquivo ou tipo de página mestra da página por meio de um `@MasterType` diretiva; isso adiciona automaticamente uma propriedade fortemente tipado para a página chamada `Master`.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-240">Specify the page's master page type or file path via a `@MasterType` directive; this automatically adds a strongly-typed property to the page named `Master`.</span></span>

<span data-ttu-id="9ea0e-241">Vamos examinar as duas abordagens.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-241">Let's examine both approaches.</span></span>

### <a name="using-the-loosely-typedpagemasterproperty"></a><span data-ttu-id="9ea0e-242">Usando o tipadas vagamente`Page.Master`propriedade</span><span class="sxs-lookup"><span data-stu-id="9ea0e-242">Using the Loosely-Typed`Page.Master`Property</span></span>

<span data-ttu-id="9ea0e-243">Todas as páginas da web ASP.NET deve derivar do `Page` classe, que está localizado no `System.Web.UI` namespace.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-243">All ASP.NET web pages must derive from the `Page` class, which is located in the `System.Web.UI` namespace.</span></span> <span data-ttu-id="9ea0e-244">O `Page` classe inclui um [ `Master` propriedade](https://msdn.microsoft.com/library/system.web.ui.page.master.aspx) que retorna uma referência à página mestre da página.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-244">The `Page` class includes a [`Master` property](https://msdn.microsoft.com/library/system.web.ui.page.master.aspx) that returns a reference to the page's master page.</span></span> <span data-ttu-id="9ea0e-245">Se a página não tem uma página mestra `Master` retorna `Nothing`.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-245">If the page does not have a master page `Master` returns `Nothing`.</span></span>

<span data-ttu-id="9ea0e-246">O `Master` propriedade retorna um objeto do tipo [ `MasterPage` ](https://msdn.microsoft.com/library/system.web.ui.masterpage.aspx) (também localizado no `System.Web.UI` namespace) que é o tipo base da qual todas as páginas mestras derivam.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-246">The `Master` property returns an object of type [`MasterPage`](https://msdn.microsoft.com/library/system.web.ui.masterpage.aspx) (also located in the `System.Web.UI` namespace) which is the base type from which all master pages derive from.</span></span> <span data-ttu-id="9ea0e-247">Portanto, para usar as propriedades públicas nem os métodos definidos na página mestre do nosso site, é necessário converter o `MasterPage` objeto retornado do `Master` propriedade para o tipo apropriado.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-247">Therefore, to use public properties or methods defined in our website's master page we must cast the `MasterPage` object returned from the `Master` property to the appropriate type.</span></span> <span data-ttu-id="9ea0e-248">Como podemos nomeado nosso arquivo de página mestra `Site.master`, a classe code-behind foi nomeada `Site`.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-248">Because we named our master page file `Site.master`, the code-behind class was named `Site`.</span></span> <span data-ttu-id="9ea0e-249">Portanto, o código a seguir conversões de `Page.Master` propriedade a uma instância do `Site` classe.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-249">Therefore, the following code casts the `Page.Master` property to an instance of the `Site` class.</span></span>


[!code-vb[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample8.vb)]

<span data-ttu-id="9ea0e-250">Agora que temos convertida a tipadas vagamente `Page.Master` propriedade para o tipo de Site pode referenciar as propriedades e métodos específicos do Site.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-250">Now that we have casted the loosely-typed `Page.Master` property to the Site type we can reference the properties and methods specific to Site.</span></span> <span data-ttu-id="9ea0e-251">Como mostra a Figura 7, a propriedade pública `GridMessageText` aparece na lista suspensa IntelliSense.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-251">As Figure 7 shows, the public property `GridMessageText` appears in the IntelliSense drop-down.</span></span>


<span data-ttu-id="9ea0e-252">[![IntelliSense mostra os métodos e propriedades públicas da nossa página mestra](interacting-with-the-master-page-from-the-content-page-vb/_static/image20.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="9ea0e-252">[![IntelliSense Shows our Master Page's Public Properties and Methods](interacting-with-the-master-page-from-the-content-page-vb/_static/image20.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image19.png)</span></span>

<span data-ttu-id="9ea0e-253">**Figura 07**: IntelliSense mostra os métodos e propriedades públicas da nossa página mestra ([clique para exibir a imagem em tamanho normal](interacting-with-the-master-page-from-the-content-page-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="9ea0e-253">**Figure 07**: IntelliSense Shows our Master Page's Public Properties and Methods ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image21.png))</span></span>


> [!NOTE]
> <span data-ttu-id="9ea0e-254">Se você nomeou seu arquivo de página mestra `MasterPage.master` , em seguida, o nome da classe por trás do código da página mestra é `MasterPage`.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-254">If you named your master page file `MasterPage.master` then the master page's code-behind class name is `MasterPage`.</span></span> <span data-ttu-id="9ea0e-255">Isso pode resultar em código ambíguo na conversão do tipo `System.Web.UI.MasterPage` para sua `MasterPage` classe.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-255">This can lead to ambiguous code when casting from the type `System.Web.UI.MasterPage` to your `MasterPage` class.</span></span> <span data-ttu-id="9ea0e-256">Em resumo, você precisa qualificar totalmente o tipo de que conversão de, que pode ser um pouco confuso ao usar o modelo de projeto de Site.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-256">In short, you need to fully qualify the type you are casting to, which can be a little tricky when using the Web Site Project model.</span></span> <span data-ttu-id="9ea0e-257">Minha sugestão é para se certificar de que quando você cria uma página mestre você o nomear algo diferente de `MasterPage.master` ou, melhor ainda, crie uma referência fortemente tipada para a página mestra.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-257">My suggestion would be to either make sure that when you create your master page you name it something other than `MasterPage.master` or, even better, create a strongly-typed reference to the master page.</span></span>


### <a name="creating-a-strongly-typed-reference-with-themastertypedirective"></a><span data-ttu-id="9ea0e-258">Criar uma referência fortemente tipada com a`@MasterType`diretiva</span><span class="sxs-lookup"><span data-stu-id="9ea0e-258">Creating a Strongly-Typed Reference with the`@MasterType`Directive</span></span>

<span data-ttu-id="9ea0e-259">Se você examinar detalhadamente você pode ver que a classe de code-behind da página do ASP.NET é uma classe parcial (Observe o `Partial` palavra-chave na definição de classe).</span><span class="sxs-lookup"><span data-stu-id="9ea0e-259">If you look closely you can see that an ASP.NET page's code-behind class is a partial class (note the `Partial` keyword in the class definition).</span></span> <span data-ttu-id="9ea0e-260">Classes parciais foram introduzidas em c# e Visual Basic com o.NET Framework 2.0 e, em resumo, permitem a membros da classe a ser definido em vários arquivos.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-260">Partial classes were introduced in C# and Visual Basic with.NET Framework 2.0 and, in a nutshell, allow for a class's members to be defined across multiple files.</span></span> <span data-ttu-id="9ea0e-261">O arquivo de classe code-behind - `AddProduct.aspx.vb`, por exemplo - contém o código, o desenvolvedor de página, criamos.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-261">The code-behind class file - `AddProduct.aspx.vb`, for example - contains the code that we, the page developer, create.</span></span> <span data-ttu-id="9ea0e-262">Além de nosso código, o mecanismo do ASP.NET cria automaticamente um arquivo de classe separada com propriedades e manipuladores de eventos que traduzem a marcação declarativa para a hierarquia de classe da página.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-262">In addition to our code, the ASP.NET engine automatically creates a separate class file with properties and event handlers in that translate the declarative markup into the page's class hierarchy.</span></span>

<span data-ttu-id="9ea0e-263">A geração de código automática ocorre sempre que uma página for visitada abre caminho para algumas possibilidades bastante úteis e interessantes.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-263">The automatic code generation that occurs whenever an ASP.NET page is visited paves the way for some rather interesting and useful possibilities.</span></span> <span data-ttu-id="9ea0e-264">No caso de páginas mestras, se falarmos sobre o mecanismo do ASP.NET que página mestre está sendo usada por nossa página de conteúdo, ele gera fortemente tipado `Master` propriedade para nós.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-264">In the case of master pages, if we tell the ASP.NET engine what master page is being used by our content page it generates a strongly-typed `Master` property for us.</span></span>

<span data-ttu-id="9ea0e-265">Use o [ `@MasterType` diretiva](https://msdn.microsoft.com/library/ms228274.aspx) para informar o mecanismo do ASP.NET do tipo de página mestra da página de conteúdo.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-265">Use the [`@MasterType` directive](https://msdn.microsoft.com/library/ms228274.aspx) to inform the ASP.NET engine of the content page's master page type.</span></span> <span data-ttu-id="9ea0e-266">O `@MasterType` diretiva pode aceitar o nome do tipo da página mestra ou seu caminho de arquivo.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-266">The `@MasterType` directive can accept either the type name of the master page or its file path.</span></span> <span data-ttu-id="9ea0e-267">Para especificar que o `AddProduct.aspx` página usa `Site.master` como sua página mestra, adicione a seguinte diretiva na parte superior da `AddProduct.aspx`:</span><span class="sxs-lookup"><span data-stu-id="9ea0e-267">To specify that the `AddProduct.aspx` page uses `Site.master` as its master page, add the following directive to the top of `AddProduct.aspx`:</span></span>


[!code-aspx[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample9.aspx)]

<span data-ttu-id="9ea0e-268">Essa diretiva instrui o mecanismo do ASP.NET para adicionar uma referência fortemente tipada para a página mestra por meio de uma propriedade chamada `Master`.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-268">This directive instructs the ASP.NET engine to add a strongly-typed reference to the master page through a property named `Master`.</span></span> <span data-ttu-id="9ea0e-269">Com o `@MasterType` diretiva em vigor, podemos chamar o `Site.master` mestre da página de propriedades e métodos públicos diretamente por meio de `Master` propriedade sem qualquer conversão.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-269">With the `@MasterType` directive in place, we can call the `Site.master` master page's public properties and methods directly through the `Master` property without any casts.</span></span>

> [!NOTE]
> <span data-ttu-id="9ea0e-270">Se você omitir o `@MasterType` diretiva, a sintaxe `Page.Master` e `Master` retornar a mesma coisa: um objeto tipadas vagamente a página mestra da página.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-270">If you omit the `@MasterType` directive, the syntax `Page.Master` and `Master` return the same thing: a loosely-typed object to the page's master page.</span></span> <span data-ttu-id="9ea0e-271">Se você incluir o `@MasterType` , em seguida, a diretiva `Master` retorna uma referência fortemente tipada para a página mestra especificada.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-271">If you include the `@MasterType` directive then `Master` returns a strongly-typed reference to the specified master page.</span></span> <span data-ttu-id="9ea0e-272">`Page.Master`, no entanto, ainda retorna uma referência tipadas vagamente.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-272">`Page.Master`, however, still returns a loosely-typed reference.</span></span> <span data-ttu-id="9ea0e-273">Para uma visão mais completa de por que esse é o caso e como o `Master` propriedade é construída quando o `@MasterType` diretiva for incluída, consulte [K. Scott Allen](http://odetocode.com/blogs/scott/default.aspx)da entrada de blog [ `@MasterType` no ASP.NET 2.0](http://odetocode.com/Blogs/scott/archive/2005/07/16/1944.aspx).</span><span class="sxs-lookup"><span data-stu-id="9ea0e-273">For a more thorough look at why this is the case and how the `Master` property is constructed when the `@MasterType` directive is included, see [K. Scott Allen](http://odetocode.com/blogs/scott/default.aspx)'s blog entry [`@MasterType` in ASP.NET 2.0](http://odetocode.com/Blogs/scott/archive/2005/07/16/1944.aspx).</span></span>


### <a name="updating-the-master-page-after-adding-a-new-product"></a><span data-ttu-id="9ea0e-274">Atualizando a página mestra depois de adicionar um novo produto</span><span class="sxs-lookup"><span data-stu-id="9ea0e-274">Updating the Master Page After Adding a New Product</span></span>

<span data-ttu-id="9ea0e-275">Agora que sabemos como invocar uma página mestra propriedades e métodos públicos de uma página de conteúdo, estamos prontos para atualizar o `AddProduct.aspx` página para que a página mestra for atualizada depois de adicionar um novo produto.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-275">Now that we know how to invoke a master page's public properties and methods from a content page, we're ready to update the `AddProduct.aspx` page so that the master page is refreshed after adding a new product.</span></span> <span data-ttu-id="9ea0e-276">No início da etapa 4, criamos um manipulador de eventos para o controle de DetailsView `ItemInserting` evento, que é executado imediatamente depois que o novo produto foi adicionado ao banco de dados.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-276">At the beginning of Step 4 we created an event handler for the DetailsView control's `ItemInserting` event, which executes immediately after the new product has been added to the database.</span></span> <span data-ttu-id="9ea0e-277">Adicione o seguinte código ao manipulador de eventos:</span><span class="sxs-lookup"><span data-stu-id="9ea0e-277">Add the following code to that event handler:</span></span>


[!code-vb[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample10.vb)]

<span data-ttu-id="9ea0e-278">O código acima usa ambos o tipadas vagamente `Page.Master` propriedade e o tipo mais acentuado `Master` propriedade.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-278">The above code uses both the loosely-typed `Page.Master` property and the strongly-typed `Master` property.</span></span> <span data-ttu-id="9ea0e-279">Observe que o `GridMessageText` está definida como "*ProductName* adicionada à grade..." Valores do produto adicionados apenas são acessíveis por meio de `e.Values` coleção; como você pode ver, a apenas adicionados `ProductName` valor é acessada por meio de `e.Values("ProductName")`.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-279">Note that the `GridMessageText` property is set to "*ProductName* added to grid..." The just-added product's values are accessible through the `e.Values` collection; as you can see, the just-added `ProductName` value is accessed via `e.Values("ProductName")`.</span></span>

<span data-ttu-id="9ea0e-280">A Figura 8 mostra o `AddProduct.aspx` imediatamente após um novo produto - Scott Soda - foi adicionada ao banco de dados.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-280">Figure 8 shows the `AddProduct.aspx` page immediately after a new product - Scott's Soda - has been added to the database.</span></span> <span data-ttu-id="9ea0e-281">Observe que o nome do produto adicionados apenas está disponível no rótulo da página mestra e que o GridView tiver sido atualizada para incluir o produto e seu preço.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-281">Note that the just-added product name is noted in the master page's Label and that the GridView has been refreshed to include the product and its price.</span></span>


<span data-ttu-id="9ea0e-282">[![Rótulo da página mestra e o GridView mostram o produto adicionados apenas](interacting-with-the-master-page-from-the-content-page-vb/_static/image23.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="9ea0e-282">[![The Master Page's Label and GridView Show the Just-Added Product](interacting-with-the-master-page-from-the-content-page-vb/_static/image23.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image22.png)</span></span>

<span data-ttu-id="9ea0e-283">**Figura 08**: A página mestra rótulo e GridView mostram o produto Just-Added ([clique para exibir a imagem em tamanho normal](interacting-with-the-master-page-from-the-content-page-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="9ea0e-283">**Figure 08**: The Master Page's Label and GridView Show the Just-Added Product ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image24.png))</span></span>


## <a name="summary"></a><span data-ttu-id="9ea0e-284">Resumo</span><span class="sxs-lookup"><span data-stu-id="9ea0e-284">Summary</span></span>

<span data-ttu-id="9ea0e-285">Idealmente, uma página mestra e suas páginas de conteúdo são completamente separadas uns dos outros e nenhum nível de interação.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-285">Ideally, a master page and its content pages are completely separate from one another and require no level of interaction.</span></span> <span data-ttu-id="9ea0e-286">Enquanto as páginas mestras e páginas de conteúdo devem ser criadas com esse objetivo em mente, há inúmeros cenários comuns em que uma página de conteúdo deve interagir com sua página mestra.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-286">While master pages and content pages should be designed with that goal in mind, there are a number of common scenarios in which a content page must interface with its master page.</span></span> <span data-ttu-id="9ea0e-287">Um dos motivos mais comuns gira em torno de uma parte específica da exibição de página mestra com base em alguma ação que ocorreu na página de conteúdo de atualização.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-287">One of the most common reasons centers around updating a particular portion of the master page display based on some action that transpired in the content page.</span></span>

<span data-ttu-id="9ea0e-288">A boa notícia é que é relativamente simples para que uma página de conteúdo interagir programaticamente com sua página mestra.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-288">The good news is that it's relatively straightforward to have a content page programmatically interact with its master page.</span></span> <span data-ttu-id="9ea0e-289">Comece criando propriedades públicas nem os métodos na página mestra que encapsula a funcionalidade que precisa ser chamado por uma página de conteúdo.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-289">Start by creating public properties or methods in the master page that encapsulate the functionality that needs to be invoked by a content page.</span></span> <span data-ttu-id="9ea0e-290">Em seguida, na página de conteúdo, acessar a página mestra propriedades e métodos por meio de tipadas vagamente `Page.Master` propriedade ou use o `@MasterType` diretiva para criar uma referência fortemente tipada para a página mestra.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-290">Then, in the content page, access the master page's properties and methods through the loosely-typed `Page.Master` property or use the `@MasterType` directive to create a strongly-typed reference to the master page.</span></span>

<span data-ttu-id="9ea0e-291">O tutorial Avançar examinamos como fazer com que a página mestra interagir programaticamente com uma das suas páginas de conteúdo.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-291">In the next tutorial we examine how to have the master page programmatically interact with one of its content pages.</span></span>

<span data-ttu-id="9ea0e-292">Boa programação!</span><span class="sxs-lookup"><span data-stu-id="9ea0e-292">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="9ea0e-293">Leitura adicional</span><span class="sxs-lookup"><span data-stu-id="9ea0e-293">Further Reading</span></span>

<span data-ttu-id="9ea0e-294">Para obter mais informações sobre os tópicos abordados neste tutorial, consulte os seguintes recursos:</span><span class="sxs-lookup"><span data-stu-id="9ea0e-294">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="9ea0e-295">Acessar e atualizar dados no ASP.NET</span><span class="sxs-lookup"><span data-stu-id="9ea0e-295">Accessing and Updating Data in ASP.NET</span></span>](http://aspnet.4guysfromrolla.com/articles/011106-1.aspx)
- [<span data-ttu-id="9ea0e-296">Páginas mestras do ASP.NET: Dicas, truques e interceptações</span><span class="sxs-lookup"><span data-stu-id="9ea0e-296">ASP.NET Master Pages: Tips, Tricks, and Traps</span></span>](http://www.odetocode.com/articles/450.aspx)
- [<span data-ttu-id="9ea0e-297">`@MasterType` no ASP.NET 2.0</span><span class="sxs-lookup"><span data-stu-id="9ea0e-297">`@MasterType` in ASP.NET 2.0</span></span>](http://odetocode.com/Blogs/scott/archive/2005/07/16/1944.aspx)
- [<span data-ttu-id="9ea0e-298">Passando informações entre o conteúdo e páginas mestras</span><span class="sxs-lookup"><span data-stu-id="9ea0e-298">Passing Information Between Content and Master Pages</span></span>](http://aspnet.4guysfromrolla.com/articles/013107-1.aspx)
- [<span data-ttu-id="9ea0e-299">Trabalhando com dados nos tutoriais do ASP.NET</span><span class="sxs-lookup"><span data-stu-id="9ea0e-299">Working with Data in ASP.NET Tutorials</span></span>](../../data-access/index.md)

### <a name="about-the-author"></a><span data-ttu-id="9ea0e-300">Sobre o autor</span><span class="sxs-lookup"><span data-stu-id="9ea0e-300">About the Author</span></span>

<span data-ttu-id="9ea0e-301">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de vários livros sobre ASP/ASP.NET e fundador da 4GuysFromRolla. com, trabalha com tecnologias Microsoft Web desde 1998.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-301">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="9ea0e-302">Scott funciona como um consultor independente, instrutor e gravador.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-302">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="9ea0e-303">Seu livro mais recente é [ *Sams ensinar por conta própria ASP.NET 3.5 nas 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="9ea0e-303">His latest book is [*Sams Teach Yourself ASP.NET 3.5 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco).</span></span> <span data-ttu-id="9ea0e-304">Scott pode ser contatado pelo [ mitchell@4GuysFromRolla.com ](mailto:mitchell@4GuysFromRolla.com) ou em seu blog [ http://ScottOnWriting.NET ](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="9ea0e-304">Scott can be reached at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="9ea0e-305">Agradecimentos especiais a</span><span class="sxs-lookup"><span data-stu-id="9ea0e-305">Special Thanks To</span></span>

<span data-ttu-id="9ea0e-306">Esta série de tutoriais foi revisado por vários revisores úteis.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-306">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="9ea0e-307">Revisor levar para este tutorial foi Zack Jones.</span><span class="sxs-lookup"><span data-stu-id="9ea0e-307">Lead reviewer for this tutorial was Zack Jones.</span></span> <span data-ttu-id="9ea0e-308">Interessado em examinar meu artigos futuros do MSDN?</span><span class="sxs-lookup"><span data-stu-id="9ea0e-308">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="9ea0e-309">Nesse caso, me enviar uma linha em [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="9ea0e-309">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="9ea0e-310">[Anterior](control-id-naming-in-content-pages-vb.md)
> [Próximo](interacting-with-the-content-page-from-the-master-page-vb.md)</span><span class="sxs-lookup"><span data-stu-id="9ea0e-310">[Previous](control-id-naming-in-content-pages-vb.md)
[Next](interacting-with-the-content-page-from-the-master-page-vb.md)</span></span>

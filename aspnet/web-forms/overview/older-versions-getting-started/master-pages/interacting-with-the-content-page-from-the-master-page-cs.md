---
uid: web-forms/overview/older-versions-getting-started/master-pages/interacting-with-the-content-page-from-the-master-page-cs
title: Interagindo com a página de conteúdo através da página mestra (c#) | Microsoft Docs
author: rick-anderson
description: Examina como chamar métodos, definir propriedades, etc. da página de conteúdo do código na página mestra.
ms.author: aspnetcontent
manager: wpickett
ms.date: 07/11/2008
ms.topic: article
ms.assetid: 3282df5e-516c-4972-8666-313828b90fb5
ms.technology: dotnet-webforms
msc.legacyurl: /web-forms/overview/older-versions-getting-started/master-pages/interacting-with-the-content-page-from-the-master-page-cs
msc.type: authoredcontent
ms.openlocfilehash: bb6785cd3fd462e651441d303c464064739723f9
ms.sourcegitcommit: 953ff9ea4369f154d6fd0239599279ddd3280009
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 07/03/2018
ms.locfileid: "37382589"
---
<a name="interacting-with-the-content-page-from-the-master-page-c"></a><span data-ttu-id="9050d-103">Interagindo com a página de conteúdo através da página mestra (c#)</span><span class="sxs-lookup"><span data-stu-id="9050d-103">Interacting with the Content Page from the Master Page (C#)</span></span>
====================
<span data-ttu-id="9050d-104">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="9050d-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="9050d-105">[Baixar o código](http://download.microsoft.com/download/1/8/4/184e24fa-fcc8-47fa-ac99-4b6a52d41e97/ASPNET_MasterPages_Tutorial_07_CS.zip) ou [baixar PDF](http://download.microsoft.com/download/e/b/4/eb4abb10-c416-4ba4-9899-32577715b1bd/ASPNET_MasterPages_Tutorial_07_CS.pdf)</span><span class="sxs-lookup"><span data-stu-id="9050d-105">[Download Code](http://download.microsoft.com/download/1/8/4/184e24fa-fcc8-47fa-ac99-4b6a52d41e97/ASPNET_MasterPages_Tutorial_07_CS.zip) or [Download PDF](http://download.microsoft.com/download/e/b/4/eb4abb10-c416-4ba4-9899-32577715b1bd/ASPNET_MasterPages_Tutorial_07_CS.pdf)</span></span>

> <span data-ttu-id="9050d-106">Examina como chamar métodos, definir propriedades, etc. da página de conteúdo do código na página mestra.</span><span class="sxs-lookup"><span data-stu-id="9050d-106">Examines how to call methods, set properties, etc. of the Content Page from code in the Master Page.</span></span>


## <a name="introduction"></a><span data-ttu-id="9050d-107">Introdução</span><span class="sxs-lookup"><span data-stu-id="9050d-107">Introduction</span></span>

<span data-ttu-id="9050d-108">O tutorial anterior examinado como fazer com que a página de conteúdo interagir programaticamente com sua página mestra.</span><span class="sxs-lookup"><span data-stu-id="9050d-108">The preceding tutorial examined how to have the content page programmatically interact with its master page.</span></span> <span data-ttu-id="9050d-109">Lembre-se de que atualizamos a página mestra para incluir um controle GridView que são listados os cinco mais recentemente adicionado produtos.</span><span class="sxs-lookup"><span data-stu-id="9050d-109">Recall that we updated the master page to include a GridView control that listed the five most recently added products.</span></span> <span data-ttu-id="9050d-110">Em seguida, criamos uma página de conteúdo na qual o usuário pode adicionar um novo produto.</span><span class="sxs-lookup"><span data-stu-id="9050d-110">We then created a content page from which the user could add a new product.</span></span> <span data-ttu-id="9050d-111">Após a adição de um novo produto, a página de conteúdo necessário para instruir a página mestra para atualizar seu GridView para que ele incluiria o produto just-adicionado.</span><span class="sxs-lookup"><span data-stu-id="9050d-111">Upon adding a new product, the content page needed to instruct the master page to refresh its GridView so that it would include the just-added product.</span></span> <span data-ttu-id="9050d-112">Essa funcionalidade foi feita, adicionando um método público para a página mestra que atualizado os dados associados a GridView e, em seguida, invocando o método da página de conteúdo.</span><span class="sxs-lookup"><span data-stu-id="9050d-112">This functionality was accomplished by adding a public method to the master page that refreshed the data bound to the GridView, and then invoking that method from the content page.</span></span>

<span data-ttu-id="9050d-113">A forma mais comum de conteúdo e interação de página mestra é proveniente da página de conteúdo.</span><span class="sxs-lookup"><span data-stu-id="9050d-113">The most common form of content and master page interaction originates from the content page.</span></span> <span data-ttu-id="9050d-114">No entanto, é possível para a página mestra para rouse a página de conteúdo atual em ação, e essa funcionalidade pode ser necessária se a página mestra contém elementos de interface do usuário que permitem que os usuários modifiquem dados também são exibidos na página de conteúdo.</span><span class="sxs-lookup"><span data-stu-id="9050d-114">However, it is possible for the master page to rouse the current content page into action, and such functionality may be needed if the master page contains user interface elements that enable users to modify data that is also displayed on the content page.</span></span> <span data-ttu-id="9050d-115">Considere uma página de conteúdo que exibe as informações de produtos em um GridView controle e controlar uma página mestra que inclui um botão que, quando clicado, dobrará os preços de todos os produtos.</span><span class="sxs-lookup"><span data-stu-id="9050d-115">Consider a content page that displays the products information in a GridView control and a master page that includes a Button control that, when clicked, doubles the prices of all products.</span></span> <span data-ttu-id="9050d-116">Muito semelhante ao exemplo do tutorial anterior, o GridView precisa ser atualizada após o preço duplo do que botão é clicado, de modo que ele mostre os novos preços, mas esse cenário é a página mestra que precise rouse a página de conteúdo em ação.</span><span class="sxs-lookup"><span data-stu-id="9050d-116">Much like the example in the preceding tutorial, the GridView needs to be refreshed after the double price Button is clicked so that it displays the new prices, but in this scenario it's the master page that needs to rouse the content page into action.</span></span>

<span data-ttu-id="9050d-117">Este tutorial explora como fazer com que a página mestra invocar a funcionalidade definida na página de conteúdo.</span><span class="sxs-lookup"><span data-stu-id="9050d-117">This tutorial explores how to have the master page invoke functionality defined in the content page.</span></span>

### <a name="instigating-programmatic-interaction-via-an-event-and-event-handlers"></a><span data-ttu-id="9050d-118">Provocam interação programática por meio de um evento e manipuladores de eventos</span><span class="sxs-lookup"><span data-stu-id="9050d-118">Instigating Programmatic Interaction via an Event and Event Handlers</span></span>

<span data-ttu-id="9050d-119">Invocar a funcionalidade da página de conteúdo de uma página mestra é mais difícil do que o oposto.</span><span class="sxs-lookup"><span data-stu-id="9050d-119">Invoking content page functionality from a master page is more challenging than the other way around.</span></span> <span data-ttu-id="9050d-120">Como uma página de conteúdo tem uma única página mestra, quando provocam a interação programática da página de conteúdo, nós sabemos quais métodos e propriedades públicas são à nossa disposição.</span><span class="sxs-lookup"><span data-stu-id="9050d-120">Because a content page has a single master page, when instigating the programmatic interaction from the content page we know what public methods and properties are at our disposal.</span></span> <span data-ttu-id="9050d-121">Uma página mestra, no entanto, pode ter muitos diferentes páginas de conteúdo, cada um com seu próprio conjunto de propriedades e métodos.</span><span class="sxs-lookup"><span data-stu-id="9050d-121">A master page, however, can have many different content pages, each with its own set of properties and methods.</span></span> <span data-ttu-id="9050d-122">Como, em seguida, podemos escrever código na página mestra para realizar alguma ação em sua página de conteúdo quando não sabemos qual página de conteúdo será invocada até que o tempo de execução?</span><span class="sxs-lookup"><span data-stu-id="9050d-122">How, then, can we write code in the master page to perform some action in its content page when we don't know what content page will be invoked until runtime?</span></span>

<span data-ttu-id="9050d-123">Considere um controle de Web do ASP.NET, como o controle de botão.</span><span class="sxs-lookup"><span data-stu-id="9050d-123">Consider an ASP.NET Web control, such as the Button control.</span></span> <span data-ttu-id="9050d-124">Um controle de botão pode aparecer em qualquer número de páginas ASP.NET e precisa de um mecanismo pelo qual ele pode alertar a página que foi clicado.</span><span class="sxs-lookup"><span data-stu-id="9050d-124">A Button control can appear on any number of ASP.NET pages and needs a mechanism by which it can alert the page that it has been clicked.</span></span> <span data-ttu-id="9050d-125">Isso é feito usando *eventos*.</span><span class="sxs-lookup"><span data-stu-id="9050d-125">This is accomplished using *events*.</span></span> <span data-ttu-id="9050d-126">Em particular, o controle de botão aciona seu `Click` eventos quando ele for clicado; a página do ASP.NET que contém o botão opcionalmente pode responder a essa notificação por meio de um *manipulador de eventos*.</span><span class="sxs-lookup"><span data-stu-id="9050d-126">In particular, the Button control raises its `Click` event when it is clicked; the ASP.NET page that contains the Button can optionally respond to that notification via an *event handler*.</span></span>

<span data-ttu-id="9050d-127">Esse mesmo padrão pode ser usado para ter uma funcionalidade de gatilho de página mestra em suas páginas de conteúdo:</span><span class="sxs-lookup"><span data-stu-id="9050d-127">This same pattern can be used to have a master page trigger functionality in its content pages:</span></span>

1. <span data-ttu-id="9050d-128">Adicione um evento para a página mestra.</span><span class="sxs-lookup"><span data-stu-id="9050d-128">Add an event to the master page.</span></span>
2. <span data-ttu-id="9050d-129">Gere o evento sempre que a página mestra precisa se comunicar com sua página de conteúdo.</span><span class="sxs-lookup"><span data-stu-id="9050d-129">Raise the event whenever the master page needs to communicate with its content page.</span></span> <span data-ttu-id="9050d-130">Por exemplo, se a página mestra precisa de sua página de conteúdo de alerta que o usuário dobrou os preços, seu evento teria gerado imediatamente depois que os preços duplicou.</span><span class="sxs-lookup"><span data-stu-id="9050d-130">For example, if the master page needs to alert its content page that the user has doubled the prices, its event would be raised immediately after the prices have been doubled.</span></span>
3. <span data-ttu-id="9050d-131">Crie um manipulador de eventos nessas páginas de conteúdo que precisa executar alguma ação.</span><span class="sxs-lookup"><span data-stu-id="9050d-131">Create an event handler in those content pages that need to take some action.</span></span>

<span data-ttu-id="9050d-132">O restante deste tutorial implementa o exemplo descrito na introdução; ou seja, uma página de conteúdo que lista os produtos no banco de dados e uma página mestra que inclui um botão de controle para duas vezes os preços.</span><span class="sxs-lookup"><span data-stu-id="9050d-132">This remainder of this tutorial implements the example outlined in the Introduction; namely, a content page that lists the products in the database and a master page that includes a Button control to double the prices.</span></span>

## <a name="step-1-displaying-products-in-a-content-page"></a><span data-ttu-id="9050d-133">Etapa 1: Exibindo produtos em uma página de conteúdo</span><span class="sxs-lookup"><span data-stu-id="9050d-133">Step 1: Displaying Products in a Content Page</span></span>

<span data-ttu-id="9050d-134">Nossa tarefa prioritária é criar uma página de conteúdo que lista os produtos do banco de dados Northwind.</span><span class="sxs-lookup"><span data-stu-id="9050d-134">Our first order of business is to create a content page that lists the products from the Northwind database.</span></span> <span data-ttu-id="9050d-135">(Adicionamos o banco de dados Northwind ao projeto no tutorial anterior, [ *interagindo com a página mestra através da página de conteúdo*](interacting-with-the-master-page-from-the-content-page-cs.md).) Comece adicionando uma nova página ASP.NET para o `~/Admin` pasta chamada `Products.aspx`, deixando de associá-lo para o `Site.master` página mestra.</span><span class="sxs-lookup"><span data-stu-id="9050d-135">(We added the Northwind database to the project in the preceding tutorial, [*Interacting with the Master Page from the Content Page*](interacting-with-the-master-page-from-the-content-page-cs.md).) Start by adding a new ASP.NET page to the `~/Admin` folder named `Products.aspx`, making sure to bind it to the `Site.master` master page.</span></span> <span data-ttu-id="9050d-136">Figura 1 mostra o Gerenciador de soluções depois que esta página foi adicionada ao site.</span><span class="sxs-lookup"><span data-stu-id="9050d-136">Figure 1 shows the Solution Explorer after this page has been added to the website.</span></span>


<span data-ttu-id="9050d-137">[![Adicionar uma nova página ASP.NET para a pasta Admin](interacting-with-the-content-page-from-the-master-page-cs/_static/image2.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="9050d-137">[![Add a New ASP.NET Page to the Admin Folder](interacting-with-the-content-page-from-the-master-page-cs/_static/image2.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image1.png)</span></span>

<span data-ttu-id="9050d-138">**Figura 01**: Adicione uma nova página ASP.NET para o `Admin` pasta ([clique para exibir a imagem em tamanho normal](interacting-with-the-content-page-from-the-master-page-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="9050d-138">**Figure 01**: Add a New ASP.NET Page to the `Admin` Folder ([Click to view full-size image](interacting-with-the-content-page-from-the-master-page-cs/_static/image3.png))</span></span>


<span data-ttu-id="9050d-139">Lembre-se de que no [ *especificando o título, marcas Meta e outros cabeçalhos de HTML na página mestra* ](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-cs.md) tutorial, criamos uma classe de página de base personalizada chamada `BasePage` que gera o título da página, se não for defina explicitamente.</span><span class="sxs-lookup"><span data-stu-id="9050d-139">Recall that in the [*Specifying the Title, Meta Tags, and Other HTML Headers in the Master Page*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-cs.md) tutorial we created a custom base page class named `BasePage` that generates the page's title if it is not explicitly set.</span></span> <span data-ttu-id="9050d-140">Vá para o `Products.aspx` de lógica da página de classe e fazer com que ele derivam `BasePage` (em vez do `System.Web.UI.Page`).</span><span class="sxs-lookup"><span data-stu-id="9050d-140">Go to the `Products.aspx` page's code-behind class and have it derive from `BasePage` (instead of from `System.Web.UI.Page`).</span></span>

<span data-ttu-id="9050d-141">Por fim, atualize o `Web.sitemap` arquivo para incluir uma entrada para esta lição.</span><span class="sxs-lookup"><span data-stu-id="9050d-141">Finally, update the `Web.sitemap` file to include an entry for this lesson.</span></span> <span data-ttu-id="9050d-142">Adicione a seguinte marcação abaixo o `<siteMapNode>` para o conteúdo a lição de interação de página mestra:</span><span class="sxs-lookup"><span data-stu-id="9050d-142">Add the following markup beneath the `<siteMapNode>` for the Content to Master Page Interaction lesson:</span></span>


[!code-xml[Main](interacting-with-the-content-page-from-the-master-page-cs/samples/sample1.xml)]

<span data-ttu-id="9050d-143">A adição deste `<siteMapNode>` elemento é refletido nas lições lista (veja a Figura 5).</span><span class="sxs-lookup"><span data-stu-id="9050d-143">The addition of this `<siteMapNode>` element is reflected in the Lessons list (see Figure 5).</span></span>

<span data-ttu-id="9050d-144">Retorne ao `Products.aspx`.</span><span class="sxs-lookup"><span data-stu-id="9050d-144">Return to `Products.aspx`.</span></span> <span data-ttu-id="9050d-145">No controle de conteúdo de `MainContent`, adicione um controle GridView e nomeie- `ProductsGrid`.</span><span class="sxs-lookup"><span data-stu-id="9050d-145">In the Content control for `MainContent`, add a GridView control and name it `ProductsGrid`.</span></span> <span data-ttu-id="9050d-146">Associar o GridView para um novo controle SqlDataSource chamado `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="9050d-146">Bind the GridView to a new SqlDataSource control named `ProductsDataSource`.</span></span>


<span data-ttu-id="9050d-147">[![Associar o GridView para um novo controle SqlDataSource](interacting-with-the-content-page-from-the-master-page-cs/_static/image5.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="9050d-147">[![Bind the GridView to a New SqlDataSource Control](interacting-with-the-content-page-from-the-master-page-cs/_static/image5.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image4.png)</span></span>

<span data-ttu-id="9050d-148">**Figura 02**: associar o GridView para um novo controle SqlDataSource ([clique para exibir a imagem em tamanho normal](interacting-with-the-content-page-from-the-master-page-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="9050d-148">**Figure 02**: Bind the GridView to a New SqlDataSource Control  ([Click to view full-size image](interacting-with-the-content-page-from-the-master-page-cs/_static/image6.png))</span></span>


<span data-ttu-id="9050d-149">Configure o Assistente para que ele usa o banco de dados Northwind.</span><span class="sxs-lookup"><span data-stu-id="9050d-149">Configure the wizard so that it uses the Northwind database.</span></span> <span data-ttu-id="9050d-150">Se você trabalhou com o tutorial anterior, você já deve ter uma cadeia de caracteres de conexão denominada `NorthwindConnectionString` em `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="9050d-150">If you worked through the previous tutorial then you should already have a connection string named `NorthwindConnectionString` in `Web.config`.</span></span> <span data-ttu-id="9050d-151">Escolha essa cadeia de caracteres de conexão na lista suspensa, conforme mostrado na Figura 3.</span><span class="sxs-lookup"><span data-stu-id="9050d-151">Choose this connection string from the drop-down list, as shown in Figure 3.</span></span>


<span data-ttu-id="9050d-152">[![Configurar o SqlDataSource para usar o banco de dados Northwind](interacting-with-the-content-page-from-the-master-page-cs/_static/image8.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="9050d-152">[![Configure the SqlDataSource to Use the Northwind Database](interacting-with-the-content-page-from-the-master-page-cs/_static/image8.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image7.png)</span></span>

<span data-ttu-id="9050d-153">**Figura 03**: configurar o SqlDataSource para usar o banco de dados Northwind ([clique para exibir a imagem em tamanho normal](interacting-with-the-content-page-from-the-master-page-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="9050d-153">**Figure 03**: Configure the SqlDataSource to Use the Northwind Database  ([Click to view full-size image](interacting-with-the-content-page-from-the-master-page-cs/_static/image9.png))</span></span>


<span data-ttu-id="9050d-154">Em seguida, especifique o controle de fonte de dados `SELECT` instrução escolhendo a tabela de produtos na lista suspensa e retornando o `ProductName` e `UnitPrice` colunas (veja a Figura 4).</span><span class="sxs-lookup"><span data-stu-id="9050d-154">Next, specify the data source control's `SELECT` statement by choosing the Products table from the drop-down list and returning the `ProductName` and `UnitPrice` columns (see Figure 4).</span></span> <span data-ttu-id="9050d-155">Clique em Avançar e em seguida Concluir para concluir o Assistente Configurar fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="9050d-155">Click Next and then Finish to complete the Configure Data Source wizard.</span></span>


<span data-ttu-id="9050d-156">[![Retornar os campos de UnitPrice e ProductName da tabela produtos](interacting-with-the-content-page-from-the-master-page-cs/_static/image11.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="9050d-156">[![Return the ProductName and UnitPrice Fields from the Products Table](interacting-with-the-content-page-from-the-master-page-cs/_static/image11.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image10.png)</span></span>

<span data-ttu-id="9050d-157">**Figura 04**: retornar o `ProductName` e `UnitPrice` campos dos `Products` tabela ([clique para exibir a imagem em tamanho normal](interacting-with-the-content-page-from-the-master-page-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="9050d-157">**Figure 04**: Return the `ProductName` and `UnitPrice` Fields from the `Products` Table  ([Click to view full-size image](interacting-with-the-content-page-from-the-master-page-cs/_static/image12.png))</span></span>


<span data-ttu-id="9050d-158">Isso é tudo para ele!</span><span class="sxs-lookup"><span data-stu-id="9050d-158">That's all there is to it!</span></span> <span data-ttu-id="9050d-159">Depois de concluir o Assistente para o Visual Studio adiciona dois BoundFields ao GridView para espelhar os dois campos retornados pelo controle SqlDataSource.</span><span class="sxs-lookup"><span data-stu-id="9050d-159">After completing the wizard Visual Studio adds two BoundFields to the GridView to mirror the two fields returned by the SqlDataSource control.</span></span> <span data-ttu-id="9050d-160">Marcação dos controles GridView e SqlDataSource segue.</span><span class="sxs-lookup"><span data-stu-id="9050d-160">The GridView and SqlDataSource controls' markup follows.</span></span> <span data-ttu-id="9050d-161">Figura 5 mostra os resultados quando exibidos por meio de um navegador.</span><span class="sxs-lookup"><span data-stu-id="9050d-161">Figure 5 shows the results when viewed through a browser.</span></span>


[!code-aspx[Main](interacting-with-the-content-page-from-the-master-page-cs/samples/sample2.aspx)]


<span data-ttu-id="9050d-162">[![Cada produto e seu preço está listado em GridView](interacting-with-the-content-page-from-the-master-page-cs/_static/image14.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="9050d-162">[![Each Product and its Price is Listed in the GridView](interacting-with-the-content-page-from-the-master-page-cs/_static/image14.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image13.png)</span></span>

<span data-ttu-id="9050d-163">**Figura 05**: cada produto e seu preço está listado no GridView ([clique para exibir a imagem em tamanho normal](interacting-with-the-content-page-from-the-master-page-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="9050d-163">**Figure 05**: Each Product and its Price is Listed in the GridView  ([Click to view full-size image](interacting-with-the-content-page-from-the-master-page-cs/_static/image15.png))</span></span>


> [!NOTE]
> <span data-ttu-id="9050d-164">Fique à vontade limpar a aparência de GridView.</span><span class="sxs-lookup"><span data-stu-id="9050d-164">Feel free to clean up the appearance of the GridView.</span></span> <span data-ttu-id="9050d-165">Algumas sugestões incluem o valor de UnitPrice exibido como uma moeda de formatação e o uso de fontes e cores de plano de fundo para melhorar a aparência da grade.</span><span class="sxs-lookup"><span data-stu-id="9050d-165">Some suggestions include formatting the displayed UnitPrice value as a currency and using background colors and fonts to improve the grid's appearance.</span></span> <span data-ttu-id="9050d-166">Para obter mais informações sobre como exibir e formatar dados no ASP.NET, consulte a minha [trabalhando com a série de tutoriais de dados](../../data-access/index.md).</span><span class="sxs-lookup"><span data-stu-id="9050d-166">For more information on displaying and formatting data in ASP.NET, refer to my [Working with Data tutorial series](../../data-access/index.md).</span></span>


## <a name="step-2-adding-a-double-prices-button-to-the-master-page"></a><span data-ttu-id="9050d-167">Etapa 2: Adicionando um botão de preços de Double para a página mestra</span><span class="sxs-lookup"><span data-stu-id="9050d-167">Step 2: Adding a Double Prices Button to the Master Page</span></span>

<span data-ttu-id="9050d-168">Nossa próxima tarefa é adicionar um controle da Web de botão para o mestre de página que, quando clicado, será duas vezes o preço de todos os produtos no banco de dados.</span><span class="sxs-lookup"><span data-stu-id="9050d-168">Our next task is to add a Button Web control to the master page that, when clicked, will double the price of all products in the database.</span></span> <span data-ttu-id="9050d-169">Abra o `Site.master` página mestra e arraste um botão da caixa de ferramentas para o Designer, colocando-a sob o `RecentProductsDataSource` controle SqlDataSource que adicionamos no tutorial anterior.</span><span class="sxs-lookup"><span data-stu-id="9050d-169">Open the `Site.master` master page and drag a Button from the Toolbox onto the Designer, placing it beneath the `RecentProductsDataSource` SqlDataSource control we added in the previous tutorial.</span></span> <span data-ttu-id="9050d-170">Definir o botão `ID` propriedade para `DoublePrice` e seu `Text` propriedade como "Dupla os preços dos produtos".</span><span class="sxs-lookup"><span data-stu-id="9050d-170">Set the Button's `ID` property to `DoublePrice` and its `Text` property to "Double Product Prices".</span></span>

<span data-ttu-id="9050d-171">Em seguida, adicione um controle SqlDataSource para a página mestra, nomeando- `DoublePricesDataSource`.</span><span class="sxs-lookup"><span data-stu-id="9050d-171">Next, add a SqlDataSource control to the master page, naming it `DoublePricesDataSource`.</span></span> <span data-ttu-id="9050d-172">Este SqlDataSource será usado para executar o `UPDATE` instrução duplicar todos os preços.</span><span class="sxs-lookup"><span data-stu-id="9050d-172">This SqlDataSource will be used to execute the `UPDATE` statement to double all prices.</span></span> <span data-ttu-id="9050d-173">Especificamente, precisamos definir seus `ConnectionString` e `UpdateCommand` propriedades para a cadeia de caracteres de conexão apropriado e `UPDATE` instrução.</span><span class="sxs-lookup"><span data-stu-id="9050d-173">Specifically, we need to set its `ConnectionString` and `UpdateCommand` properties to the appropriate connection string and `UPDATE` statement.</span></span> <span data-ttu-id="9050d-174">Em seguida, precisamos chamar deste controle SqlDataSource `Update` método quando o `DoublePrice` botão é clicado.</span><span class="sxs-lookup"><span data-stu-id="9050d-174">Then we need to call this SqlDataSource control's `Update` method when the `DoublePrice` Button is clicked.</span></span> <span data-ttu-id="9050d-175">Para definir a `ConnectionString` e `UpdateCommand` propriedades, selecione o controle SqlDataSource e, em seguida, vá para a janela de propriedades.</span><span class="sxs-lookup"><span data-stu-id="9050d-175">To set the `ConnectionString` and `UpdateCommand` properties, select the SqlDataSource control and then go to the Properties window.</span></span> <span data-ttu-id="9050d-176">O `ConnectionString` essas cadeias de caracteres de conexão já armazenadas em listas de propriedades `Web.config` em uma lista suspensa; escolha o `NorthwindConnectionString` opção conforme mostrado na Figura 6.</span><span class="sxs-lookup"><span data-stu-id="9050d-176">The `ConnectionString` property lists those connection strings already stored in `Web.config` in a drop-down list; choose the `NorthwindConnectionString` option as shown in Figure 6.</span></span>


<span data-ttu-id="9050d-177">[![Configurar o SqlDataSource para usar o NorthwindConnectionString](interacting-with-the-content-page-from-the-master-page-cs/_static/image17.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="9050d-177">[![Configure the SqlDataSource to Use the NorthwindConnectionString](interacting-with-the-content-page-from-the-master-page-cs/_static/image17.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image16.png)</span></span>

<span data-ttu-id="9050d-178">**Figura 06**: configurar o SqlDataSource para usar o `NorthwindConnectionString` ([clique para exibir a imagem em tamanho normal](interacting-with-the-content-page-from-the-master-page-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="9050d-178">**Figure 06**: Configure the SqlDataSource to Use the `NorthwindConnectionString` ([Click to view full-size image](interacting-with-the-content-page-from-the-master-page-cs/_static/image18.png))</span></span>


<span data-ttu-id="9050d-179">Para definir o `UpdateCommand` propriedade, localize a opção UpdateQuery na janela Propriedades.</span><span class="sxs-lookup"><span data-stu-id="9050d-179">To set the `UpdateCommand` property, locate the UpdateQuery option in the Properties window.</span></span> <span data-ttu-id="9050d-180">Essa propriedade, quando selecionado, exibe um botão com reticências; Clique neste botão para exibir a caixa de diálogo Editor de comando e parâmetro, mostrada na Figura 7.</span><span class="sxs-lookup"><span data-stu-id="9050d-180">This property, when selected, displays a button with ellipses; click this button to display the Command and Parameter Editor dialog box shown in Figure 7.</span></span> <span data-ttu-id="9050d-181">Digite o seguinte `UPDATE` instrução na caixa de texto da caixa de diálogo:</span><span class="sxs-lookup"><span data-stu-id="9050d-181">Type the following `UPDATE` statement into the dialog box's textbox:</span></span>


[!code-sql[Main](interacting-with-the-content-page-from-the-master-page-cs/samples/sample3.sql)]

<span data-ttu-id="9050d-182">Essa instrução, quando executada, dobre o `UnitPrice` valor para cada registro no `Products` tabela.</span><span class="sxs-lookup"><span data-stu-id="9050d-182">This statement, when executed, will double the `UnitPrice` value for each record in the `Products` table.</span></span>


<span data-ttu-id="9050d-183">[![Definir propriedade de UpdateCommand do SqlDataSource](interacting-with-the-content-page-from-the-master-page-cs/_static/image20.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="9050d-183">[![Set SqlDataSource's UpdateCommand Property](interacting-with-the-content-page-from-the-master-page-cs/_static/image20.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image19.png)</span></span>

<span data-ttu-id="9050d-184">**Figura 07**: defina SqlDataSource `UpdateCommand` propriedade ([clique para exibir a imagem em tamanho normal](interacting-with-the-content-page-from-the-master-page-cs/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="9050d-184">**Figure 07**: Set SqlDataSource's `UpdateCommand` Property  ([Click to view full-size image](interacting-with-the-content-page-from-the-master-page-cs/_static/image21.png))</span></span>


<span data-ttu-id="9050d-185">Depois de definir essas propriedades, a marcação declarativa de seu botão e SqlDataSource dos controles deve ser semelhante ao seguinte:</span><span class="sxs-lookup"><span data-stu-id="9050d-185">After setting these properties, your Button and SqlDataSource controls' declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](interacting-with-the-content-page-from-the-master-page-cs/samples/sample4.aspx)]

<span data-ttu-id="9050d-186">Tudo o que resta é chamar seu `Update` método quando o `DoublePrice` botão é clicado.</span><span class="sxs-lookup"><span data-stu-id="9050d-186">All that remains is to call its `Update` method when the `DoublePrice` Button is clicked.</span></span> <span data-ttu-id="9050d-187">Criar uma `Click` manipulador de eventos para o `DoublePrice` botão e adicione o seguinte código:</span><span class="sxs-lookup"><span data-stu-id="9050d-187">Create a `Click` event handler for the `DoublePrice` Button and add the following code:</span></span>


[!code-csharp[Main](interacting-with-the-content-page-from-the-master-page-cs/samples/sample5.cs)]

<span data-ttu-id="9050d-188">Para testar essa funcionalidade, visite o `~/Admin/Products.aspx` página podemos criado na etapa 1 e clique no botão "Double os preços dos produtos".</span><span class="sxs-lookup"><span data-stu-id="9050d-188">To test this functionality, visit the `~/Admin/Products.aspx` page we created in Step 1 and click the "Double Product Prices" button.</span></span> <span data-ttu-id="9050d-189">Clicando no botão faz com que um postback e executa o `DoublePrice` do botão `Click` manipulador de eventos, dobrando os preços de todos os produtos.</span><span class="sxs-lookup"><span data-stu-id="9050d-189">Clicking the button causes a postback and executes the `DoublePrice` Button's `Click` event handler, doubling the prices of all products.</span></span> <span data-ttu-id="9050d-190">A página é renderizada novamente e a marcação é retornada e novamente exibida no navegador.</span><span class="sxs-lookup"><span data-stu-id="9050d-190">The page is then re-rendered and the markup is returned and re-displayed in the browser.</span></span> <span data-ttu-id="9050d-191">O GridView na página de conteúdo, no entanto, lista os mesmos preços como antes do "Double os preços dos produtos" botão foi clicado.</span><span class="sxs-lookup"><span data-stu-id="9050d-191">The GridView in the content page, however, lists the same prices as before the "Double Product Prices" button was clicked.</span></span> <span data-ttu-id="9050d-192">Isso ocorre porque os dados carregados inicialmente no GridView tinham o estado armazenado no estado de exibição, portanto, não será recarregada em postbacks, a menos que indicado o contrário.</span><span class="sxs-lookup"><span data-stu-id="9050d-192">This is because the data initially loaded in the GridView had its state stored in view state, so it's not reloaded on postbacks unless instructed otherwise.</span></span> <span data-ttu-id="9050d-193">Se você visitar uma página diferente e, em seguida, retornar para o `~/Admin/Products.aspx` página você verá os preços atualizados.</span><span class="sxs-lookup"><span data-stu-id="9050d-193">If you visit a different page and then return to the `~/Admin/Products.aspx` page you'll see the updated prices.</span></span>

## <a name="step-3-raising-an-event-when-the-prices-are-doubled"></a><span data-ttu-id="9050d-194">Etapa 3: Gerar um evento quando o preços serão duplicadas</span><span class="sxs-lookup"><span data-stu-id="9050d-194">Step 3: Raising an Event When the Prices are Doubled</span></span>

<span data-ttu-id="9050d-195">Porque o GridView no `~/Admin/Products.aspx` página não reflete imediatamente da duplicação de preço, um usuário pode pensar é compreensível que eles não clicar no botão de "Double os preços dos produtos", ou que não funcionou.</span><span class="sxs-lookup"><span data-stu-id="9050d-195">Because the GridView in the `~/Admin/Products.aspx` page does not immediately reflect the price doubling, a user may understandably think that they did not click the "Double Product Prices" button, or that it didn't work.</span></span> <span data-ttu-id="9050d-196">Eles talvez tente clicar no botão mais algumas vezes, dobrando os preços e novamente.</span><span class="sxs-lookup"><span data-stu-id="9050d-196">They may try clicking the button a few more times, doubling the prices again and again.</span></span> <span data-ttu-id="9050d-197">Para corrigir isso, precisamos ter a grade no conteúdo de exibição de página os novos preços imediatamente depois que eles estão duplicados.</span><span class="sxs-lookup"><span data-stu-id="9050d-197">To fix this we need to have the grid in the content page display the new prices immediately after they are doubled.</span></span>

<span data-ttu-id="9050d-198">Conforme discutido anteriormente neste tutorial, é necessário acionar um evento na página mestra sempre que o usuário clica o `DoublePrice` botão.</span><span class="sxs-lookup"><span data-stu-id="9050d-198">As discussed earlier in this tutorial, we need to raise an event in the master page whenever the user clicks the `DoublePrice` Button.</span></span> <span data-ttu-id="9050d-199">Um evento é uma maneira para uma classe (um editor de eventos) notifique outro sobre um conjunto de outras classes (os assinantes do evento) que algo interessante ocorreu.</span><span class="sxs-lookup"><span data-stu-id="9050d-199">An event is a way for one class (an event publisher) to notify another a set of other classes (the event subscribers) that something interesting has occurred.</span></span> <span data-ttu-id="9050d-200">Neste exemplo, a página mestra é o Editor de eventos; aqueles que se preocupam quando páginas de conteúdo a `DoublePrice` botão é clicado são os assinantes.</span><span class="sxs-lookup"><span data-stu-id="9050d-200">In this example, the master page is the event publisher; those content pages that care about when the `DoublePrice` Button is clicked are the subscribers.</span></span>

<span data-ttu-id="9050d-201">Uma classe assina um evento com a criação de um *manipulador de eventos*, que é um método que é executado em resposta ao evento sendo gerado.</span><span class="sxs-lookup"><span data-stu-id="9050d-201">A class subscribes to an event by creating an *event handler*, which is a method that is executed in response to the event being raised.</span></span> <span data-ttu-id="9050d-202">O fornecedor define os eventos que ele gera com a definição de um *delegado do evento*.</span><span class="sxs-lookup"><span data-stu-id="9050d-202">The publisher defines the events he raises by defining an *event delegate*.</span></span> <span data-ttu-id="9050d-203">O delegado do evento especifica que o manipulador de eventos deve aceitar parâmetros de entrada.</span><span class="sxs-lookup"><span data-stu-id="9050d-203">The event delegate specifies what input parameters the event handler must accept.</span></span> <span data-ttu-id="9050d-204">No .NET Framework, representantes de eventos não retornar qualquer valor em aceitar dois parâmetros de entrada:</span><span class="sxs-lookup"><span data-stu-id="9050d-204">In the .NET Framework, event delegates do not return any value and accept two input parameters:</span></span>

- <span data-ttu-id="9050d-205">Um `Object`, que identifica a origem do evento, e</span><span class="sxs-lookup"><span data-stu-id="9050d-205">An `Object`, which identifies the event source, and</span></span>
- <span data-ttu-id="9050d-206">Uma classe derivada de `System.EventArgs`</span><span class="sxs-lookup"><span data-stu-id="9050d-206">A class derived from `System.EventArgs`</span></span>

<span data-ttu-id="9050d-207">O segundo parâmetro passado para um manipulador de eventos pode incluir informações adicionais sobre o evento.</span><span class="sxs-lookup"><span data-stu-id="9050d-207">The second parameter passed to an event handler can include additional information about the event.</span></span> <span data-ttu-id="9050d-208">Embora a base `EventArgs` classe não transmitir qualquer informação, o .NET Framework inclui um número de classes que estendem `EventArgs` e abrangem propriedades adicionais.</span><span class="sxs-lookup"><span data-stu-id="9050d-208">While the base `EventArgs` class does not pass along any information, the .NET Framework includes a number of classes that extend `EventArgs` and encompass additional properties.</span></span> <span data-ttu-id="9050d-209">Por exemplo, uma `CommandEventArgs` instância é passada para manipuladores de eventos que respondem ao `Command` evento e inclui duas propriedades informativas: `CommandArgument` e `CommandName`.</span><span class="sxs-lookup"><span data-stu-id="9050d-209">For example, a `CommandEventArgs` instance is passed to event handlers that respond to the `Command` event, and includes two informational properties: `CommandArgument` and `CommandName`.</span></span>

> [!NOTE]
> <span data-ttu-id="9050d-210">Para obter mais informações sobre como criar, gerando e manipulando eventos, consulte [eventos e delegados](https://msdn.microsoft.com/library/17sde2xt.aspx) e [representantes de eventos em inglês simples](http://www.codeproject.com/KB/cs/eventdelegates.aspx).</span><span class="sxs-lookup"><span data-stu-id="9050d-210">For more information on creating, raising, and handling events, see [Events and Delegates](https://msdn.microsoft.com/library/17sde2xt.aspx) and [Event Delegates in Simple English](http://www.codeproject.com/KB/cs/eventdelegates.aspx).</span></span>


<span data-ttu-id="9050d-211">Para definir um evento use a seguinte sintaxe:</span><span class="sxs-lookup"><span data-stu-id="9050d-211">To define an event use the following syntax:</span></span>


[!code-csharp[Main](interacting-with-the-content-page-from-the-master-page-cs/samples/sample6.cs)]

<span data-ttu-id="9050d-212">Como precisamos apenas para a página de conteúdo de alerta quando o usuário clicou com o `DoublePrice` botão e não precisar passar ao longo de qualquer outra informação, podemos usar o delegado do evento `EventHandler`, que define um manipulador de eventos que aceita como seu segundo um objeto do tipo de parâmetro `System.EventArgs`.</span><span class="sxs-lookup"><span data-stu-id="9050d-212">Because we only need to alert the content page when the user has clicked the `DoublePrice` Button and do not need to pass along any other additional information, we can use the event delegate `EventHandler`, which defines an event handler that accepts as its second parameter an object of type `System.EventArgs`.</span></span> <span data-ttu-id="9050d-213">Para criar o evento na página mestra, adicione a seguinte linha de código à classe de code-behind da página mestra:</span><span class="sxs-lookup"><span data-stu-id="9050d-213">To create the event in the master page, add the following line of code to the master page's code-behind class:</span></span>


[!code-csharp[Main](interacting-with-the-content-page-from-the-master-page-cs/samples/sample7.cs)]

<span data-ttu-id="9050d-214">O código acima adiciona um evento público para a página mestra chamada `PricesDoubled`.</span><span class="sxs-lookup"><span data-stu-id="9050d-214">The above code adds a public event to the master page named `PricesDoubled`.</span></span> <span data-ttu-id="9050d-215">Agora, precisamos gere este evento após os preços duplicou.</span><span class="sxs-lookup"><span data-stu-id="9050d-215">We now need to raise this event after the prices have been doubled.</span></span> <span data-ttu-id="9050d-216">Para elevar um evento use a seguinte sintaxe:</span><span class="sxs-lookup"><span data-stu-id="9050d-216">To raise an event use the following syntax:</span></span>


[!code-csharp[Main](interacting-with-the-content-page-from-the-master-page-cs/samples/sample8.cs)]

<span data-ttu-id="9050d-217">Em que *remetente* e *eventArgs* são os valores que você deseja passar para o manipulador de eventos do assinante.</span><span class="sxs-lookup"><span data-stu-id="9050d-217">Where *sender* and *eventArgs* are the values you want to pass to the subscriber's event handler.</span></span>

<span data-ttu-id="9050d-218">Atualizar o `DoublePrice` `Click` manipulador de eventos com o código a seguir:</span><span class="sxs-lookup"><span data-stu-id="9050d-218">Update the `DoublePrice` `Click` event handler with the following code:</span></span>


[!code-csharp[Main](interacting-with-the-content-page-from-the-master-page-cs/samples/sample9.cs)]

<span data-ttu-id="9050d-219">Como antes, o `Click` manipulador de eventos inicia com a chamada a `DoublePricesDataSource` do controle SqlDataSource `Update` método duplicar os preços de todos os produtos.</span><span class="sxs-lookup"><span data-stu-id="9050d-219">As before, the `Click` event handler starts by calling the `DoublePricesDataSource` SqlDataSource control's `Update` method to double the prices of all products.</span></span> <span data-ttu-id="9050d-220">Há duas adições ao manipulador de eventos a seguir.</span><span class="sxs-lookup"><span data-stu-id="9050d-220">Following that there are two additions to the event handler.</span></span> <span data-ttu-id="9050d-221">Primeiro, o `RecentProducts` dados do GridView são atualizados.</span><span class="sxs-lookup"><span data-stu-id="9050d-221">First, the `RecentProducts` GridView's data is refreshed.</span></span> <span data-ttu-id="9050d-222">Este GridView foi adicionado à página mestra no tutorial anterior e exibe os cinco produtos recentemente adicionados.</span><span class="sxs-lookup"><span data-stu-id="9050d-222">This GridView was added to the master page in the preceding tutorial and displays the five most recently-added products.</span></span> <span data-ttu-id="9050d-223">É necessário atualizar essa grade para que ele mostra os preços dobrado apenas para esses cinco produtos.</span><span class="sxs-lookup"><span data-stu-id="9050d-223">We need to refresh this grid so that it shows the just-doubled prices for these five products.</span></span> <span data-ttu-id="9050d-224">Depois disso, o `PricesDoubled` é gerado.</span><span class="sxs-lookup"><span data-stu-id="9050d-224">Following that, the `PricesDoubled` event is raised.</span></span> <span data-ttu-id="9050d-225">Uma referência para a página mestra em si (`this`) é enviado para o manipulador de eventos como a origem do evento e um vazio `EventArgs` objeto é enviado como os argumentos do evento.</span><span class="sxs-lookup"><span data-stu-id="9050d-225">A reference to the master page itself (`this`) is sent to the event handler as the event source and an empty `EventArgs` object is sent as the event arguments.</span></span>

## <a name="step-4-handling-the-event-in-the-content-page"></a><span data-ttu-id="9050d-226">Etapa 4: Manipulando o evento na página de conteúdo</span><span class="sxs-lookup"><span data-stu-id="9050d-226">Step 4: Handling the Event in the Content Page</span></span>

<span data-ttu-id="9050d-227">Neste momento a página mestra aciona seu `PricesDoubled` evento sempre que o `DoublePrice` controle de botão é clicado.</span><span class="sxs-lookup"><span data-stu-id="9050d-227">At this point the master page raises its `PricesDoubled` event whenever the `DoublePrice` Button control is clicked.</span></span> <span data-ttu-id="9050d-228">No entanto, isso é apenas metade da batalha - precisamos manipular o evento no assinante.</span><span class="sxs-lookup"><span data-stu-id="9050d-228">However, this is only half the battle - we still need to handle the event in the subscriber.</span></span> <span data-ttu-id="9050d-229">Isso envolve duas etapas: Criando o manipulador de eventos e adicionando o código de fiação de evento para que quando o evento é gerado, o manipulador de eventos é executado.</span><span class="sxs-lookup"><span data-stu-id="9050d-229">This involves two steps: creating the event handler and adding event wiring code so that when the event is raised the event handler is executed.</span></span>

<span data-ttu-id="9050d-230">Comece criando um manipulador de eventos chamado `Master_PricesDoubled`.</span><span class="sxs-lookup"><span data-stu-id="9050d-230">Start by creating an event handler named `Master_PricesDoubled`.</span></span> <span data-ttu-id="9050d-231">Devido a como definimos os `PricesDoubled` evento na página mestra dois parâmetros de entrada do manipulador de eventos devem ser de tipos `Object` e `EventArgs`, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="9050d-231">Because of how we defined the `PricesDoubled` event in the master page the event handler's two input parameters must be of types `Object` and `EventArgs`, respectively.</span></span> <span data-ttu-id="9050d-232">Na chamada do manipulador de eventos do `ProductsGrid` do GridView `DataBind` método associar novamente os dados à grade.</span><span class="sxs-lookup"><span data-stu-id="9050d-232">In the event handler call the `ProductsGrid` GridView's `DataBind` method to rebind the data to the grid.</span></span>


[!code-csharp[Main](interacting-with-the-content-page-from-the-master-page-cs/samples/sample10.cs)]

<span data-ttu-id="9050d-233">O código para o manipulador de eventos está concluído, mas ainda não encontramos a página mestra na transmissão `PricesDoubled` eventos para este manipulador de eventos.</span><span class="sxs-lookup"><span data-stu-id="9050d-233">The code for the event handler is complete but we've yet to wire the master page's `PricesDoubled` event to this event handler.</span></span> <span data-ttu-id="9050d-234">O assinante conecta um evento para um manipulador de eventos por meio da sintaxe a seguir:</span><span class="sxs-lookup"><span data-stu-id="9050d-234">The subscriber wires an event to an event handler via the following syntax:</span></span>


[!code-csharp[Main](interacting-with-the-content-page-from-the-master-page-cs/samples/sample11.cs)]

<span data-ttu-id="9050d-235">*Publisher* é uma referência ao objeto que oferece o evento *eventName*, e *methodName* é o nome do manipulador de eventos definido no assinante que tem uma assinatura correspondente o *eventDelegate*.</span><span class="sxs-lookup"><span data-stu-id="9050d-235">*publisher* is a reference to the object that offers the event *eventName*, and *methodName* is the name of the event handler defined in the subscriber that has a signature corresponding to the *eventDelegate*.</span></span> <span data-ttu-id="9050d-236">Em outras palavras, se o delegado do evento é `EventHandler`, em seguida, *methodName* deve ser o nome de um método no assinante que não retorna um valor e aceita dois parâmetros de tipos de entrada `Object` e `EventArgs`, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="9050d-236">In other words, if the event delegate is `EventHandler`, then *methodName* must be the name of a method in the subscriber that does not return a value and accepts two input parameters of types `Object` and `EventArgs`, respectively.</span></span>

<span data-ttu-id="9050d-237">Esse código de fiação de evento deve ser executado na primeira visita de página e postbacks subsequentes e deve ocorrer em um ponto do ciclo de vida de página anterior quando o evento pode ser gerado.</span><span class="sxs-lookup"><span data-stu-id="9050d-237">This event wiring code must be executed on the first page visit and subsequent postbacks and should occur at a point in the page lifecycle that precedes when the event may be raised.</span></span> <span data-ttu-id="9050d-238">Um bom momento para adicionar o código de fiação de evento está no estágio de PreInit, que ocorre muito cedo no ciclo de vida de página.</span><span class="sxs-lookup"><span data-stu-id="9050d-238">A good time to add event wiring code is in the PreInit stage, which occurs very early in the page lifecycle.</span></span>

<span data-ttu-id="9050d-239">Abra `~/Admin/Products.aspx` e crie um `Page_PreInit` manipulador de eventos:</span><span class="sxs-lookup"><span data-stu-id="9050d-239">Open `~/Admin/Products.aspx` and create a `Page_PreInit` event handler:</span></span>


[!code-csharp[Main](interacting-with-the-content-page-from-the-master-page-cs/samples/sample12.cs)]

<span data-ttu-id="9050d-240">Para concluir esse código de fiação precisamos de uma referência de programação para a página mestra da página de conteúdo.</span><span class="sxs-lookup"><span data-stu-id="9050d-240">In order to complete this wiring code we need a programmatic reference to the master page from the content page.</span></span> <span data-ttu-id="9050d-241">Conforme observado no tutorial anterior, há duas maneiras de fazer isso:</span><span class="sxs-lookup"><span data-stu-id="9050d-241">As noted in the previous tutorial, there are two ways to do this:</span></span>

- <span data-ttu-id="9050d-242">Convertendo a tipagem `Page.Master` propriedade para o tipo apropriado na página mestra, ou</span><span class="sxs-lookup"><span data-stu-id="9050d-242">By casting the loosely-typed `Page.Master` property to the appropriate master page type, or</span></span>
- <span data-ttu-id="9050d-243">Adicionando um `@MasterType` diretiva a `.aspx` página e, em seguida, usando o tipo mais acentuado `Master` propriedade.</span><span class="sxs-lookup"><span data-stu-id="9050d-243">By adding a `@MasterType` directive in the `.aspx` page and then using the strongly-typed `Master` property.</span></span>

<span data-ttu-id="9050d-244">Vamos usar a segunda abordagem.</span><span class="sxs-lookup"><span data-stu-id="9050d-244">Let's use the latter approach.</span></span> <span data-ttu-id="9050d-245">Adicione o seguinte `@MasterType` diretiva na parte superior da marcação declarativa da página:</span><span class="sxs-lookup"><span data-stu-id="9050d-245">Add the following `@MasterType` directive to the top of the page's declarative markup:</span></span>


[!code-aspx[Main](interacting-with-the-content-page-from-the-master-page-cs/samples/sample13.aspx)]

<span data-ttu-id="9050d-246">Em seguida, adicione o seguinte código de fiação de evento no `Page_PreInit` manipulador de eventos:</span><span class="sxs-lookup"><span data-stu-id="9050d-246">Then add the following event wiring code in the `Page_PreInit` event handler:</span></span>


[!code-csharp[Main](interacting-with-the-content-page-from-the-master-page-cs/samples/sample14.cs)]

<span data-ttu-id="9050d-247">Com esse código em vigor, o GridView na página de conteúdo é atualizado sempre que o `DoublePrice` botão é clicado.</span><span class="sxs-lookup"><span data-stu-id="9050d-247">With this code in place, the GridView in the content page is refreshed whenever the `DoublePrice` Button is clicked.</span></span>

<span data-ttu-id="9050d-248">As figuras 8 e 9 ilustram esse comportamento.</span><span class="sxs-lookup"><span data-stu-id="9050d-248">Figures 8 and 9 illustrate this behavior.</span></span> <span data-ttu-id="9050d-249">Figura 8 mostra a página quando visitado pela primeira vez.</span><span class="sxs-lookup"><span data-stu-id="9050d-249">Figure 8 shows the page when first visited.</span></span> <span data-ttu-id="9050d-250">Observe que os valores de preço em ambos os `RecentProducts` GridView (na coluna esquerda da página mestra) e o `ProductsGrid` GridView (na página de conteúdo).</span><span class="sxs-lookup"><span data-stu-id="9050d-250">Note that price values in both the `RecentProducts` GridView (in the left column of the master page) and the `ProductsGrid` GridView (in the content page).</span></span> <span data-ttu-id="9050d-251">Mostra a Figura 9 a mesma tela imediatamente após o `DoublePrice` botão foi clicado.</span><span class="sxs-lookup"><span data-stu-id="9050d-251">Figure 9 shows the same screen immediately after the `DoublePrice` Button has been clicked.</span></span> <span data-ttu-id="9050d-252">Como você pode ver, os novos preços instantaneamente são refletidos em ambos os GridViews.</span><span class="sxs-lookup"><span data-stu-id="9050d-252">As you can see, the new prices are instantaneously reflected in both GridViews.</span></span>


<span data-ttu-id="9050d-253">[![Os valores de preço inicial](interacting-with-the-content-page-from-the-master-page-cs/_static/image23.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="9050d-253">[![The Initial Price Values](interacting-with-the-content-page-from-the-master-page-cs/_static/image23.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image22.png)</span></span>

<span data-ttu-id="9050d-254">**Figura 08**: os valores iniciais de preço ([clique para exibir a imagem em tamanho normal](interacting-with-the-content-page-from-the-master-page-cs/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="9050d-254">**Figure 08**: The Initial Price Values  ([Click to view full-size image](interacting-with-the-content-page-from-the-master-page-cs/_static/image24.png))</span></span>


<span data-ttu-id="9050d-255">[![Os preços Just-Doubled são exibidos no GridViews](interacting-with-the-content-page-from-the-master-page-cs/_static/image26.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="9050d-255">[![The Just-Doubled Prices are Displayed in the GridViews](interacting-with-the-content-page-from-the-master-page-cs/_static/image26.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image25.png)</span></span>

<span data-ttu-id="9050d-256">**Figura 09**: os preços de The Just-Doubled são exibidos no GridViews ([clique para exibir a imagem em tamanho normal](interacting-with-the-content-page-from-the-master-page-cs/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="9050d-256">**Figure 09**: The Just-Doubled Prices are Displayed in the GridViews  ([Click to view full-size image](interacting-with-the-content-page-from-the-master-page-cs/_static/image27.png))</span></span>


## <a name="summary"></a><span data-ttu-id="9050d-257">Resumo</span><span class="sxs-lookup"><span data-stu-id="9050d-257">Summary</span></span>

<span data-ttu-id="9050d-258">O ideal é que uma página mestra e suas páginas de conteúdo são completamente separadas umas das outras e nenhum nível de interação.</span><span class="sxs-lookup"><span data-stu-id="9050d-258">Ideally, a master page and its content pages are completely separate from one another and require no level of interaction.</span></span> <span data-ttu-id="9050d-259">No entanto, se você tiver uma página mestra ou a página de conteúdo que exibe os dados que podem ser modificados na página mestra ou página de conteúdo, em seguida, você pode precisa ter a página mestra de alerta a página de conteúdo (ou vice-versa uma) quando os dados são modificados para que a exibição pode ser atualizada.</span><span class="sxs-lookup"><span data-stu-id="9050d-259">However, if you have a master page or content page that displays data that can be modified from the master page or content page, then you may need to have the master page alert the content page (or vice-a-versa) when data is modified so that the display can be updated.</span></span> <span data-ttu-id="9050d-260">No tutorial anterior, vimos como fazer com que uma página de conteúdo interagir programaticamente com sua página mestra; Neste tutorial vimos como fazer uma inicialização de página mestra a interação.</span><span class="sxs-lookup"><span data-stu-id="9050d-260">In the preceding tutorial we saw how to have a content page programmatically interact with its master page; in this tutorial we looked at how to have a master page initiate the interaction.</span></span>

<span data-ttu-id="9050d-261">Enquanto a interação programática entre uma página mestra e de conteúdo pode ser obtidos o conteúdo ou a página mestra, o padrão de interação usado depende da origem.</span><span class="sxs-lookup"><span data-stu-id="9050d-261">While programmatic interaction between a content and master page can originate from either the content or master page, the interaction pattern used depends on the origination.</span></span> <span data-ttu-id="9050d-262">As diferenças são devido ao fato de que uma página de conteúdo tem uma única página mestra, mas uma página mestre pode ter muitas páginas de conteúdo diferentes.</span><span class="sxs-lookup"><span data-stu-id="9050d-262">The differences are due to the fact that a content page has a single master page, but a master page can have many different content pages.</span></span> <span data-ttu-id="9050d-263">Em vez de ter uma página mestra que interagem diretamente com uma página de conteúdo, uma abordagem melhor é ter a página mestra acionar um evento para sinalizar que alguma ação ocorreu.</span><span class="sxs-lookup"><span data-stu-id="9050d-263">Rather than having a master page directly interact with a content page, a better approach is to have the master page raise an event to signal that some action has taken place.</span></span> <span data-ttu-id="9050d-264">Essas páginas de conteúdo que se preocupam com a ação podem criar manipuladores de eventos.</span><span class="sxs-lookup"><span data-stu-id="9050d-264">Those content pages that care about the action can create event handlers.</span></span>

<span data-ttu-id="9050d-265">Boa programação!</span><span class="sxs-lookup"><span data-stu-id="9050d-265">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="9050d-266">Leitura adicional</span><span class="sxs-lookup"><span data-stu-id="9050d-266">Further Reading</span></span>

<span data-ttu-id="9050d-267">Para obter mais informações sobre os tópicos abordados neste tutorial, consulte os seguintes recursos:</span><span class="sxs-lookup"><span data-stu-id="9050d-267">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="9050d-268">Acessar e atualizar dados no ASP.NET</span><span class="sxs-lookup"><span data-stu-id="9050d-268">Accessing and Updating Data in ASP.NET</span></span>](http://aspnet.4guysfromrolla.com/articles/011106-1.aspx)
- [<span data-ttu-id="9050d-269">Delegados e eventos</span><span class="sxs-lookup"><span data-stu-id="9050d-269">Events and Delegates</span></span>](https://msdn.microsoft.com/library/17sde2xt.aspx)
- [<span data-ttu-id="9050d-270">Passando informações entre o conteúdo e páginas mestras</span><span class="sxs-lookup"><span data-stu-id="9050d-270">Passing Information Between Content and Master Pages</span></span>](http://aspnet.4guysfromrolla.com/articles/013107-1.aspx)
- [<span data-ttu-id="9050d-271">Trabalhando com dados nos tutoriais do ASP.NET</span><span class="sxs-lookup"><span data-stu-id="9050d-271">Working with Data in ASP.NET Tutorials</span></span>](../../data-access/index.md)

### <a name="about-the-author"></a><span data-ttu-id="9050d-272">Sobre o autor</span><span class="sxs-lookup"><span data-stu-id="9050d-272">About the Author</span></span>

<span data-ttu-id="9050d-273">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de vários livros sobre ASP/ASP.NET e fundador da 4GuysFromRolla.com, trabalha com tecnologias Web Microsoft desde 1998.</span><span class="sxs-lookup"><span data-stu-id="9050d-273">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="9050d-274">Scott funciona como um consultor independente, instrutor e escritor.</span><span class="sxs-lookup"><span data-stu-id="9050d-274">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="9050d-275">Seu livro mais recente é [ *Sams Teach por conta própria ASP.NET 3.5 in 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="9050d-275">His latest book is [*Sams Teach Yourself ASP.NET 3.5 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco).</span></span> <span data-ttu-id="9050d-276">Scott pode ser contatado pelo [ mitchell@4GuysFromRolla.com ](mailto:mitchell@4GuysFromRolla.com) ou por meio de seu blog em [ http://ScottOnWriting.NET ](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="9050d-276">Scott can be reached at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="9050d-277">Agradecimentos especiais a</span><span class="sxs-lookup"><span data-stu-id="9050d-277">Special Thanks To</span></span>

<span data-ttu-id="9050d-278">Esta série de tutoriais foi revisada por muitos revisores úteis.</span><span class="sxs-lookup"><span data-stu-id="9050d-278">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="9050d-279">Revisor de avanço para este tutorial foi Suchi Banerjee.</span><span class="sxs-lookup"><span data-stu-id="9050d-279">Lead reviewer for this tutorial was Suchi Banerjee.</span></span> <span data-ttu-id="9050d-280">Você está interessado na revisão Meus próximos artigos do MSDN?</span><span class="sxs-lookup"><span data-stu-id="9050d-280">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="9050d-281">Nesse caso, escreva-me em [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="9050d-281">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="9050d-282">[Anterior](interacting-with-the-master-page-from-the-content-page-cs.md)
> [Próximo](master-pages-and-asp-net-ajax-cs.md)</span><span class="sxs-lookup"><span data-stu-id="9050d-282">[Previous](interacting-with-the-master-page-from-the-content-page-cs.md)
[Next](master-pages-and-asp-net-ajax-cs.md)</span></span>

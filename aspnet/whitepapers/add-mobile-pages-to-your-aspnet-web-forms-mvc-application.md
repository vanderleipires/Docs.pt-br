---
uid: whitepapers/add-mobile-pages-to-your-aspnet-web-forms-mvc-application
title: 'Como: Adicionar páginas móveis ao seu Web Forms do ASP.NET / aplicativo MVC | Microsoft Docs'
author: rick-anderson
description: Esse manual descreve várias maneiras para servir páginas otimizadas para dispositivos móveis do seu Web Forms do ASP.NET / aplicativo MVC e sugere, arquitetura e...
ms.author: riande
ms.date: 01/20/2011
ms.assetid: 3124f28e-cc32-418a-afe3-519fa56f4c36
msc.legacyurl: /whitepapers/add-mobile-pages-to-your-aspnet-web-forms-mvc-application
msc.type: content
ms.openlocfilehash: 1693838a74f0564e38e11a2827cceb3d6474677b
ms.sourcegitcommit: 45ac74e400f9f2b7dbded66297730f6f14a4eb25
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/16/2018
ms.locfileid: "41825422"
---
<a name="how-to-add-mobile-pages-to-your-aspnet-web-forms--mvc-application"></a><span data-ttu-id="c6753-103">Como: Adicionar páginas móveis ao seu Web Forms do ASP.NET / aplicativo MVC</span><span class="sxs-lookup"><span data-stu-id="c6753-103">How To: Add Mobile Pages to Your ASP.NET Web Forms / MVC Application</span></span>
====================
> <span data-ttu-id="c6753-104">**Aplica-se a**</span><span class="sxs-lookup"><span data-stu-id="c6753-104">**Applies To**</span></span>
> 
> - <span data-ttu-id="c6753-105">Versão de Web Forms do ASP.NET 4.0</span><span class="sxs-lookup"><span data-stu-id="c6753-105">ASP.NET Web Forms version 4.0</span></span>
> - <span data-ttu-id="c6753-106">ASP.NET MVC versão 3.0</span><span class="sxs-lookup"><span data-stu-id="c6753-106">ASP.NET MVC version 3.0</span></span>
> 
> <span data-ttu-id="c6753-107">**Resumo**</span><span class="sxs-lookup"><span data-stu-id="c6753-107">**Summary**</span></span>
> 
> <span data-ttu-id="c6753-108">Esse manual descreve várias maneiras para servir páginas otimizadas para dispositivos móveis do seu Web Forms do ASP.NET / aplicativo MVC e sugere, arquitetura e design problemas a serem considerados ao direcionar uma ampla gama de dispositivos.</span><span class="sxs-lookup"><span data-stu-id="c6753-108">This How To describes various ways to serve pages optimized for mobile devices from your ASP.NET Web Forms / MVC application, and suggests architectural and design issues to consider when targeting a broad range of devices.</span></span> <span data-ttu-id="c6753-109">Este documento também explica por que o os controles ASP.NET do ASP.NET 2.0 para 3.5 agora estão obsoletos e discute algumas alternativas modernas.</span><span class="sxs-lookup"><span data-stu-id="c6753-109">This document also explains why the ASP.NET Mobile Controls from ASP.NET 2.0 to 3.5 are now obsolete, and discusses some modern alternatives.</span></span>


## <a name="contents"></a><span data-ttu-id="c6753-110">Conteúdo</span><span class="sxs-lookup"><span data-stu-id="c6753-110">Contents</span></span>

- <span data-ttu-id="c6753-111">Visão geral</span><span class="sxs-lookup"><span data-stu-id="c6753-111">Overview</span></span>
- <span data-ttu-id="c6753-112">Opções de arquitetura</span><span class="sxs-lookup"><span data-stu-id="c6753-112">Architectural options</span></span>
- <span data-ttu-id="c6753-113">Detecção de navegadores e dispositivos</span><span class="sxs-lookup"><span data-stu-id="c6753-113">Browser and device detection</span></span>
- <span data-ttu-id="c6753-114">Como aplicativos de Web Forms do ASP.NET podem apresentar a páginas específicas para dispositivos móveis</span><span class="sxs-lookup"><span data-stu-id="c6753-114">How ASP.NET Web Forms applications can present mobile-specific pages</span></span>
- <span data-ttu-id="c6753-115">Como os aplicativos ASP.NET MVC podem apresentar páginas específicas para dispositivos móveis</span><span class="sxs-lookup"><span data-stu-id="c6753-115">How ASP.NET MVC applications can present mobile-specific pages</span></span>
- <span data-ttu-id="c6753-116">Recursos adicionais</span><span class="sxs-lookup"><span data-stu-id="c6753-116">Additional resources</span></span>

<span data-ttu-id="c6753-117">Para obter exemplos de código para download que demonstra técnicas deste white paper para ASP.NET Web Forms e MVC, consulte [os aplicativos móveis e Sites com ASP.NET](https://docs.microsoft.com/aspnet/mobile/overview).</span><span class="sxs-lookup"><span data-stu-id="c6753-117">For downloadable code samples demonstrating this white paper's techniques for both ASP.NET Web Forms and MVC, see [Mobile Apps & Sites with ASP.NET](https://docs.microsoft.com/aspnet/mobile/overview).</span></span>

## <a name="overview"></a><span data-ttu-id="c6753-118">Visão geral</span><span class="sxs-lookup"><span data-stu-id="c6753-118">Overview</span></span>

<span data-ttu-id="c6753-119">Dispositivos móveis – smartphones, celulares e tablets – continuam a crescer em termos de popularidade como um meio para acessar a Web.</span><span class="sxs-lookup"><span data-stu-id="c6753-119">Mobile devices – smartphones, feature phones, and tablets – continue to grow in popularity as a means to access the Web.</span></span> <span data-ttu-id="c6753-120">Para muitas empresas voltados para a web e os desenvolvedores da web, isso significa que é cada vez mais importante fornecer uma excelente experiência de navegação para visitantes que usam esses dispositivos.</span><span class="sxs-lookup"><span data-stu-id="c6753-120">For many web developers and web-oriented businesses, this means it's increasingly important to provide a great browsing experience for visitors using those devices.</span></span>

### <a name="how-earlier-versions-of-aspnet-supported-mobile-browsers"></a><span data-ttu-id="c6753-121">Versões anteriores como de navegadores para dispositivos móveis com suporte do ASP.NET</span><span class="sxs-lookup"><span data-stu-id="c6753-121">How earlier versions of ASP.NET supported mobile browsers</span></span>

<span data-ttu-id="c6753-122">Versões do ASP.NET 2.0 para 3.5 incluído *controles móveis do ASP.NET*: um conjunto de controles de servidor para dispositivos móveis nos *System* assembly e o  *MobileControls* namespace.</span><span class="sxs-lookup"><span data-stu-id="c6753-122">ASP.NET versions 2.0 to 3.5 included *ASP.NET Mobile Controls*: a set of server controls for mobile devices in the *System.Web.Mobile.dll* assembly and the *System.Web.UI.MobileControls* namespace.</span></span> <span data-ttu-id="c6753-123">O assembly ainda está incluído no ASP.NET 4, mas ela foi preterida.</span><span class="sxs-lookup"><span data-stu-id="c6753-123">The assembly is still included in ASP.NET 4, but it is deprecated.</span></span> <span data-ttu-id="c6753-124">Os desenvolvedores são aconselhados a migrar as abordagens mais modernos, como as descritas neste documento.</span><span class="sxs-lookup"><span data-stu-id="c6753-124">Developers are advised to migrate to more modern approaches, such as those described in this paper.</span></span>

<span data-ttu-id="c6753-125">O motivo por que os controles ASP.NET foram marcados como obsoleto é que o seu design é orientado em torno de celulares que eram comuns em torno de 2005 e versões anteriores.</span><span class="sxs-lookup"><span data-stu-id="c6753-125">The reason why ASP.NET Mobile Controls have been marked as obsolete is that their design is oriented around the mobile phones that were common around 2005 and earlier.</span></span> <span data-ttu-id="c6753-126">Os controles são projetados principalmente para renderizar marcação WML ou cHTML (em vez de HTML regular) para os navegadores WAP do que era.</span><span class="sxs-lookup"><span data-stu-id="c6753-126">The controls are mainly designed to render WML or cHTML markup (instead of regular HTML) for the WAP browsers of that era.</span></span> <span data-ttu-id="c6753-127">Mas, WAP e WML cHTML não são mais relevantes para a maioria dos projetos, porque o HTML agora é a linguagem de marcação de todos os lugares para os navegadores móveis e da área de trabalho semelhantes.</span><span class="sxs-lookup"><span data-stu-id="c6753-127">But WAP, WML, and cHTML are no longer relevant for most projects, because HTML has now become the ubiquitous markup language for mobile and desktop browsers alike.</span></span>

### <a name="the-challenges-of-supporting-mobile-devices-today"></a><span data-ttu-id="c6753-128">Os desafios de que dão suporte a dispositivos móveis</span><span class="sxs-lookup"><span data-stu-id="c6753-128">The challenges of supporting mobile devices today</span></span>

<span data-ttu-id="c6753-129">Embora navegadores móveis agora quase universalmente ofereçam suporte a HTML, você ainda enfrentará muitos desafios com o objetivo de criar excelentes experiências de navegação móveis:</span><span class="sxs-lookup"><span data-stu-id="c6753-129">Even though mobile browsers now almost universally support HTML, you will still face many challenges when aiming to create great mobile browsing experiences:</span></span>

- <span data-ttu-id="c6753-130">***Tamanho da tela*** – os dispositivos móveis variam bastante no formulário e suas telas costumam ser muito menor do que os monitores de área de trabalho.</span><span class="sxs-lookup"><span data-stu-id="c6753-130">***Screen size*** - Mobile devices vary dramatically in form, and their screens are often much smaller than desktop monitors.</span></span> <span data-ttu-id="c6753-131">Portanto, você precisa criar layouts de página completamente diferente para eles.</span><span class="sxs-lookup"><span data-stu-id="c6753-131">So, you may need to design completely different page layouts for them.</span></span>
- <span data-ttu-id="c6753-132">***Métodos de entrada*** – alguns dispositivos têm teclados, algumas têm styluses, outros usam o toque.</span><span class="sxs-lookup"><span data-stu-id="c6753-132">***Input methods*** – Some devices have keypads, some have styluses, others use touch.</span></span> <span data-ttu-id="c6753-133">Você talvez precise considerar a navegação com vários métodos de entrada de dados e mecanismos.</span><span class="sxs-lookup"><span data-stu-id="c6753-133">You may need to consider multiple navigation mechanisms and data input methods.</span></span>
- <span data-ttu-id="c6753-134">***Conformidade com padrões*** – muitos navegadores móveis não dão suporte os padrões mais recentes de HTML, CSS ou JavaScript.</span><span class="sxs-lookup"><span data-stu-id="c6753-134">***Standards compliance*** – Many mobile browsers do not support the latest HTML, CSS, or JavaScript standards.</span></span>
- <span data-ttu-id="c6753-135">***Largura de banda*** – desempenho de rede de dados de celular varia muito, e alguns usuários finais estão em tarifas cobram por megabytes.</span><span class="sxs-lookup"><span data-stu-id="c6753-135">***Bandwidth*** – Cellular data network performance varies wildly, and some end users are on tariffs that charge by the megabyte.</span></span>

<span data-ttu-id="c6753-136">Há uma solução padronizada; seu aplicativo terá que procurar e se comportam diferentemente, de acordo com o dispositivo acessá-lo.</span><span class="sxs-lookup"><span data-stu-id="c6753-136">There's no one-size-fits-all solution; your application will have to look and behave differently according to the device accessing it.</span></span> <span data-ttu-id="c6753-137">Dependendo de qual nível de suporte móvel que você deseja, isso pode ser um desafio maior para desenvolvedores da web que já era a área de trabalho "guerras de navegador".</span><span class="sxs-lookup"><span data-stu-id="c6753-137">Depending on what level of mobile support you want, this can be a bigger challenge for web developers than the desktop "browser wars" ever was.</span></span>

<span data-ttu-id="c6753-138">Os desenvolvedores se aproximando do suporte do navegador móvel pela primeira vez geralmente inicialmente pensam que só é importante dar suporte a smartphones mais sofisticadas e mais recentes (por exemplo, Windows Phone 7, iPhone ou Android), talvez porque os desenvolvedores geralmente pessoal possuem como dispositivos.</span><span class="sxs-lookup"><span data-stu-id="c6753-138">Developers approaching mobile browser support for the first time often initially think it's only important to support the latest and most sophisticated smartphones (e.g., Windows Phone 7, iPhone, or Android), perhaps because developers often personally own such devices.</span></span> <span data-ttu-id="c6753-139">No entanto, mais baratos telefones ainda são muito populares e seus proprietários usá-los para navegar na web – especialmente em países em que os celulares são mais fáceis de obter que uma conexão de banda larga.</span><span class="sxs-lookup"><span data-stu-id="c6753-139">However, cheaper phones are still extremely popular, and their owners do use them to browse the web – especially in countries where mobile phones are easier to get than a broadband connection.</span></span> <span data-ttu-id="c6753-140">Sua empresa precisará decidir quais variedade de dispositivos para dar suporte a considerando seus clientes provavelmente.</span><span class="sxs-lookup"><span data-stu-id="c6753-140">Your business will need to decide what range of devices to support by considering its likely customers.</span></span> <span data-ttu-id="c6753-141">Se você estiver criando um folheto on-line para um spa de integridade de luxo, você pode tomar uma decisão de negócios somente para smartphones avançados, de destino enquanto se você estiver criando um sistema de reservas de tíquete para um cinema, você precisa levar em conta os visitantes com recurso menos potentes provavelmente telefones.</span><span class="sxs-lookup"><span data-stu-id="c6753-141">If you're building an online brochure for a luxury health spa, you might make a business decision only to target advanced smartphones, whereas if you're creating a ticket booking system for a cinema, you probably need to account for visitors with less powerful feature phones.</span></span>

## <a name="architectural-options"></a><span data-ttu-id="c6753-142">Opções de arquitetura</span><span class="sxs-lookup"><span data-stu-id="c6753-142">Architectural options</span></span>

<span data-ttu-id="c6753-143">Antes de entrarmos em detalhes técnicos específicos do ASP.NET Web Forms ou MVC, observe que os desenvolvedores da web em geral têm três opções possíveis principais para dar suporte a navegadores para dispositivos móveis:</span><span class="sxs-lookup"><span data-stu-id="c6753-143">Before we get to the specific technical details of ASP.NET Web Forms or MVC, note that web developers in general have three main possible options for supporting mobile browsers:</span></span>

1. <span data-ttu-id="c6753-144">***Não faça nada –*** você pode simplesmente criar um aplicativo orientado a área de trabalho, standard, web e dependem de navegadores para dispositivos móveis para renderizá-lo de forma aceitável.</span><span class="sxs-lookup"><span data-stu-id="c6753-144">***Do nothing –*** You can simply create a standard, desktop-oriented web application, and rely on mobile browsers to render it acceptably.</span></span> 

    - <span data-ttu-id="c6753-145">**Vantagem**: é a opção mais econômica de implementar e manter – um trabalho não adicional</span><span class="sxs-lookup"><span data-stu-id="c6753-145">**Advantage**: It's the cheapest option to implement and maintain – no extra work</span></span>
    - <span data-ttu-id="c6753-146">**Desvantagem**: fornece a experiência do usuário final pior:</span><span class="sxs-lookup"><span data-stu-id="c6753-146">**Disadvantage**: Gives the worst end-user experience:</span></span> 

        - <span data-ttu-id="c6753-147">Os smartphones mais recente pode processar seu HTML tão bem quanto um navegador da área de trabalho, mas os usuários ainda serão forçados para ampliar e rolar horizontalmente e verticalmente para consumir o conteúdo em uma tela pequena.</span><span class="sxs-lookup"><span data-stu-id="c6753-147">The latest smartphones may render your HTML just as well as a desktop browser, but users will still be forced to zoom and scroll horizontally and vertically to consume your content on a small screen.</span></span> <span data-ttu-id="c6753-148">Isso está longe de ser ideal.</span><span class="sxs-lookup"><span data-stu-id="c6753-148">This is far from optimal.</span></span>
        - <span data-ttu-id="c6753-149">Dispositivos mais antigos e celulares podem falhar ao renderizar sua marcação de maneira satisfatória.</span><span class="sxs-lookup"><span data-stu-id="c6753-149">Older devices and feature phones may fail to render your markup in a satisfactory way.</span></span>
        - <span data-ttu-id="c6753-150">Mesmo em dispositivos tablet mais recentes (cujas telas podem ser tão grandes quanto as telas de laptop), interação com diferentes regras se aplicam.</span><span class="sxs-lookup"><span data-stu-id="c6753-150">Even on the latest tablet devices (whose screens can be as big as laptop screens), different interaction rules apply.</span></span> <span data-ttu-id="c6753-151">Entrada baseados em toque funciona melhor com maior botões e links de disseminação ainda mais distantes, e não é possível passar o mouse de um cursor do mouse sobre um menu suspenso.</span><span class="sxs-lookup"><span data-stu-id="c6753-151">Touch-based input works best with larger buttons and links spread further apart, and there's no way to hover a mouse cursor over a fly-out menu.</span></span>
2. <span data-ttu-id="c6753-152">***Resolver o problema no cliente* –** com o uso cuidadoso de CSS e [aprimoramento progressivo](http://en.wikipedia.org/wiki/Progressive_enhancement) você pode criar marcação, estilos e scripts que se adaptam a qualquer navegador é executá-los.</span><span class="sxs-lookup"><span data-stu-id="c6753-152">***Solve the problem on the client* –** With careful use of CSS and [progressive enhancement](http://en.wikipedia.org/wiki/Progressive_enhancement) you can create markup, styles, and scripts that adapt to whatever browser is running them.</span></span> <span data-ttu-id="c6753-153">Por exemplo, com [consultas de mídia do CSS 3](http://www.w3.org/TR/2010/CR-css3-mediaqueries-20100727/), você pode criar um layout de várias coluna que se transforma em um layout de coluna única em dispositivos cujas telas são mais estreitas do que um limite determinado.</span><span class="sxs-lookup"><span data-stu-id="c6753-153">For example, with [CSS 3 media queries](http://www.w3.org/TR/2010/CR-css3-mediaqueries-20100727/), you could create a multi-column layout that turns into a single column layout on devices whose screens are narrower than a chosen threshold.</span></span> 

    - <span data-ttu-id="c6753-154">**Vantagem**: otimiza o processamento para o dispositivo específico em uso, mesmo para dispositivos desconhecidos de futuros acordo com qualquer tela e características de entrada tiverem</span><span class="sxs-lookup"><span data-stu-id="c6753-154">**Advantage**: Optimizes rendering for the specific device in use, even for unknown future devices according to whatever screen and input characteristics they have</span></span>
    - <span data-ttu-id="c6753-155">**Vantagem**: facilmente permite que você compartilhe a lógica do lado do servidor em todos os tipos de dispositivo – mínimo de duplicação de código ou esforço</span><span class="sxs-lookup"><span data-stu-id="c6753-155">**Advantage**: Easily lets you share server-side logic across all device types – minimal duplication of code or effort</span></span>
    - <span data-ttu-id="c6753-156">**Desvantagem**: dispositivos móveis são tão diferentes dispositivos da área de trabalho que você pode realmente deseja suas páginas móveis ser completamente diferente de suas páginas da área de trabalho, mostrando informações diferentes.</span><span class="sxs-lookup"><span data-stu-id="c6753-156">**Disadvantage**: Mobile devices are so different from desktop devices that you may really want your mobile pages to be completely different from your desktop pages, showing different information.</span></span> <span data-ttu-id="c6753-157">Essas variações podem ser ineficientes ou impossíveis de atingir com robustez por meio da CSS sozinho, especialmente considerando como inconsistentemente dispositivos mais antigos interpretam as regras de CSS.</span><span class="sxs-lookup"><span data-stu-id="c6753-157">Such variations can be inefficient or impossible to achieve robustly through CSS alone, especially considering how inconsistently older devices interpret CSS rules.</span></span> <span data-ttu-id="c6753-158">Isso é especialmente verdadeiro para atributos de CSS 3.</span><span class="sxs-lookup"><span data-stu-id="c6753-158">This is particularly true of CSS 3 attributes.</span></span>
    - <span data-ttu-id="c6753-159">**Desvantagem**: não oferece suporte para fluxos de trabalho para diferentes dispositivos e variada lógica do lado do servidor.</span><span class="sxs-lookup"><span data-stu-id="c6753-159">**Disadvantage**: Provides no support for varying server-side logic and workflows for different devices.</span></span> <span data-ttu-id="c6753-160">Você não pode, por exemplo, implementar um simplificada compras carrinho check-out fluxo de trabalho para usuários móveis por meio de CSS sozinho.</span><span class="sxs-lookup"><span data-stu-id="c6753-160">You can't, for example, implement a simplified shopping cart checkout workflow for mobile users by means of CSS alone.</span></span>
    - <span data-ttu-id="c6753-161">**Desvantagem**: uso ineficiente de largura de banda.</span><span class="sxs-lookup"><span data-stu-id="c6753-161">**Disadvantage**: Inefficient bandwidth use.</span></span> <span data-ttu-id="c6753-162">Servidor você pode ter que transmitir a marcação e estilos que se aplicam a todos os dispositivos possíveis, mesmo que o dispositivo de destino usará apenas um subconjunto dessas informações.</span><span class="sxs-lookup"><span data-stu-id="c6753-162">You server may have to transmit the markup and styles that apply to all possible devices, even though the target device will only use a subset of that information.</span></span>
3. <span data-ttu-id="c6753-163">***Resolver o problema no servidor* –** se seu servidor sabe qual dispositivo está acessando – ou pelo menos as características desse dispositivo, como seu tamanho da tela e o método de entrada, e se ele é um dispositivo móvel – pode ser executada uma lógica diferente e marcação HTML diferente de saída.</span><span class="sxs-lookup"><span data-stu-id="c6753-163">***Solve the problem on the server* –** If your server knows what device is accessing it – or at least the characteristics of that device, such as its screen size and input method, and whether it's a mobile device – it can run different logic and output different HTML markup.</span></span> 

    - <span data-ttu-id="c6753-164">**Vantagem:** flexibilidade máxima.</span><span class="sxs-lookup"><span data-stu-id="c6753-164">**Advantage:** Maximum flexibility.</span></span> <span data-ttu-id="c6753-165">Não há nenhum limite para quanto você pode variar sua lógica do lado do servidor para celulares ou otimizar sua marcação para o layout desejado, específico do dispositivo.</span><span class="sxs-lookup"><span data-stu-id="c6753-165">There's no limit to how much you can vary your server-side logic for mobiles or optimize your markup for the desired, device-specific layout.</span></span>
    - <span data-ttu-id="c6753-166">**Vantagem:** uso eficiente da largura de banda.</span><span class="sxs-lookup"><span data-stu-id="c6753-166">**Advantage:** Efficient bandwidth use.</span></span> <span data-ttu-id="c6753-167">Você só precisar transmitir a marcação e informações de estilo que vai usar o dispositivo de destino.</span><span class="sxs-lookup"><span data-stu-id="c6753-167">You only need to transmit the markup and styling information that the target device is going to use.</span></span>
    - <span data-ttu-id="c6753-168">**Desvantagem:** às vezes força a repetição de esforço ou de código (por exemplo, fazer com que você crie cópias semelhantes, mas ligeiramente diferentes de suas páginas Web Forms ou as exibições do MVC).</span><span class="sxs-lookup"><span data-stu-id="c6753-168">**Disadvantage:** Sometimes forces repetition of effort or code (e.g., making you create similar but slightly different copies of your Web Forms pages or MVC views).</span></span> <span data-ttu-id="c6753-169">Onde possível que será fatorar lógica comum em uma camada subjacente ou serviço, mas ainda assim, algumas partes do seu código de interface do usuário ou a marcação talvez precise ser duplicado e, em seguida, são mantidos em paralelo.</span><span class="sxs-lookup"><span data-stu-id="c6753-169">Where possible you will factor out common logic into an underlying layer or service, but still, some parts of your UI code or markup may have to be duplicated and then maintained in parallel.</span></span>
    - <span data-ttu-id="c6753-170">**Desvantagem:** detecção do dispositivo não é trivial.</span><span class="sxs-lookup"><span data-stu-id="c6753-170">**Disadvantage:** Device detection is not trivial.</span></span> <span data-ttu-id="c6753-171">Ele requer uma lista ou um banco de dados de tipos de dispositivos conhecidos e suas características (que nem sempre podem ser perfeitamente atualizadas) e não é garantido para corresponder com precisão a cada solicitação de entrada.</span><span class="sxs-lookup"><span data-stu-id="c6753-171">It requires a list or database of known device types and their characteristics (which may not always be perfectly up-to-date) and isn't guaranteed to accurately match every incoming request.</span></span> <span data-ttu-id="c6753-172">Este documento descreve algumas opções e suas armadilhas mais tarde.</span><span class="sxs-lookup"><span data-stu-id="c6753-172">This document describes some options and their pitfalls later.</span></span>

<span data-ttu-id="c6753-173">Para obter os melhores resultados, a maioria dos desenvolvedores localizar que precisam para combinar as opções (2) e (3).</span><span class="sxs-lookup"><span data-stu-id="c6753-173">To get the best results, most developers find they need to combine options (2) and (3).</span></span> <span data-ttu-id="c6753-174">Pequenas diferenças estilísticas são melhor acomodadas no cliente usando CSS ou até mesmo JavaScript, enquanto as principais diferenças de dados, fluxo de trabalho ou marcação com mais eficiência são implementadas no código do lado do servidor.</span><span class="sxs-lookup"><span data-stu-id="c6753-174">Minor stylistic differences are best accommodated on the client using CSS or even JavaScript, whereas major differences in data, workflow, or markup are most effectively implemented in server-side code.</span></span>

### <a name="this-paper-focuses-on-server-side-techniques"></a><span data-ttu-id="c6753-175">Este documento se concentra em técnicas do lado do servidor</span><span class="sxs-lookup"><span data-stu-id="c6753-175">This paper focuses on server-side techniques</span></span>

<span data-ttu-id="c6753-176">Como Web Forms do ASP.NET e MVC são ambas as tecnologias do lado do servidor principalmente, este white paper se concentra em técnicas de lado do servidor que permitem que você produza uma marcação diferente e a lógica para navegadores de dispositivos móveis.</span><span class="sxs-lookup"><span data-stu-id="c6753-176">Since ASP.NET Web Forms and MVC are both primarily server-side technologies, this white paper will focus on server-side techniques that let you produce different markup and logic for mobile browsers.</span></span> <span data-ttu-id="c6753-177">É claro, você também pode combinar isso com qualquer técnica do lado do cliente (por exemplo, CSS 3 consultas de mídia, o JavaScript de aprimoramento progressivo), mas que é mais uma questão de design da web de desenvolvimento do ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="c6753-177">Of course, you can also combine this with any client-side technique (e.g., CSS 3 media queries, progressive-enhancement JavaScript), but that's more a matter of web design than ASP.NET development.</span></span>

## <a name="browser-and-device-detection"></a><span data-ttu-id="c6753-178">Detecção de navegadores e dispositivos</span><span class="sxs-lookup"><span data-stu-id="c6753-178">Browser and device detection</span></span>

<span data-ttu-id="c6753-179">O pré-requisito de chave para todas as técnicas do lado do servidor para dar suporte a dispositivos móveis é saber qual dispositivo está usando o seu visitante.</span><span class="sxs-lookup"><span data-stu-id="c6753-179">The key prerequisite for all server-side techniques for supporting mobile devices is to know what device your visitor is using.</span></span> <span data-ttu-id="c6753-180">Na verdade, ainda melhor do que saber o número de fabricante e modelo de que o dispositivo é saber o *características* do dispositivo.</span><span class="sxs-lookup"><span data-stu-id="c6753-180">In fact, even better than knowing the manufacturer and model number of that device is knowing the *characteristics* of the device.</span></span> <span data-ttu-id="c6753-181">Características podem incluir:</span><span class="sxs-lookup"><span data-stu-id="c6753-181">Characteristics may include:</span></span>

- <span data-ttu-id="c6753-182">É um dispositivo móvel?</span><span class="sxs-lookup"><span data-stu-id="c6753-182">Is it a mobile device?</span></span>
- <span data-ttu-id="c6753-183">Método de entrada (mouse/teclado, toque, teclado, joystick,...)</span><span class="sxs-lookup"><span data-stu-id="c6753-183">Input method (mouse/keyboard, touch, keypad, joystick, …)</span></span>
- <span data-ttu-id="c6753-184">Tamanho da tela (fisicamente e em pixels)</span><span class="sxs-lookup"><span data-stu-id="c6753-184">Screen size (physically and in pixels)</span></span>
- <span data-ttu-id="c6753-185">Formatos de mídia e os dados com suporte</span><span class="sxs-lookup"><span data-stu-id="c6753-185">Supported media and data formats</span></span>
- <span data-ttu-id="c6753-186">Etc.</span><span class="sxs-lookup"><span data-stu-id="c6753-186">Etc.</span></span>

<span data-ttu-id="c6753-187">É melhor tomar decisões com base nas características que o número do modelo, porque, em seguida, você estará mais bem equipado para lidar com dispositivos futuros.</span><span class="sxs-lookup"><span data-stu-id="c6753-187">It's better to make decisions based on characteristics than model number, because then you'll be better equipped to handle future devices.</span></span>

### <a name="using-aspnets-built-in-browser-detection-support"></a><span data-ttu-id="c6753-188">Usando o ASP. Suporte de detecção de navegador interno da rede</span><span class="sxs-lookup"><span data-stu-id="c6753-188">Using ASP.NET's built-in browser detection support</span></span>

<span data-ttu-id="c6753-189">Os desenvolvedores ASP.NET Web Forms e MVC imediatamente podem descobrir características importantes de um navegador visitando inspecionando as propriedades do *Request. browser* objeto.</span><span class="sxs-lookup"><span data-stu-id="c6753-189">ASP.NET Web Forms and MVC developers can immediately discover important characteristics of a visiting browser by inspecting properties of the *Request.Browser* object.</span></span> <span data-ttu-id="c6753-190">Por exemplo, consulte</span><span class="sxs-lookup"><span data-stu-id="c6753-190">For example, see</span></span>

- <span data-ttu-id="c6753-191">Request.Browser.IsMobileDevice</span><span class="sxs-lookup"><span data-stu-id="c6753-191">Request.Browser.IsMobileDevice</span></span>
- <span data-ttu-id="c6753-192">Request.Browser.MobileDeviceManufacturer, Request.Browser.MobileDeviceModel</span><span class="sxs-lookup"><span data-stu-id="c6753-192">Request.Browser.MobileDeviceManufacturer, Request.Browser.MobileDeviceModel</span></span>
- <span data-ttu-id="c6753-193">Request.Browser.ScreenPixelsWidth</span><span class="sxs-lookup"><span data-stu-id="c6753-193">Request.Browser.ScreenPixelsWidth</span></span>
- <span data-ttu-id="c6753-194">Request.Browser.SupportsXmlHttp</span><span class="sxs-lookup"><span data-stu-id="c6753-194">Request.Browser.SupportsXmlHttp</span></span>
- <span data-ttu-id="c6753-195">... e muitos outros</span><span class="sxs-lookup"><span data-stu-id="c6753-195">…and many others</span></span>

<span data-ttu-id="c6753-196">Nos bastidores, a plataforma ASP.NET corresponde à entrada *User-Agent* cabeçalho HTTP (UA) contra expressões regulares em um conjunto de arquivos XML de definição do navegador.</span><span class="sxs-lookup"><span data-stu-id="c6753-196">Behind the scenes, the ASP.NET platform matches the incoming *User-Agent* (UA) HTTP header against regular expressions in a set of Browser Definition XML files.</span></span> <span data-ttu-id="c6753-197">Por padrão, a plataforma inclui definições de vários dispositivos móveis comuns, e você pode adicionar arquivos de definição de navegador personalizados para outras pessoas que você deseja reconhecer.</span><span class="sxs-lookup"><span data-stu-id="c6753-197">By default the platform includes definitions for many common mobile devices, and you can add custom Browser Definition files for others you wish to recognize.</span></span> <span data-ttu-id="c6753-198">Para obter mais detalhes, consulte a página do MSDN [controles de servidor Web ASP.NET e recursos do navegador](https://msdn.microsoft.com/library/x3k2ssx2.aspx).</span><span class="sxs-lookup"><span data-stu-id="c6753-198">For more details, see the MSDN page [ASP.NET Web Server Controls and Browser Capabilities](https://msdn.microsoft.com/library/x3k2ssx2.aspx).</span></span>

### <a name="using-the-wurfl-device-database-via-51degreesmobi-foundation"></a><span data-ttu-id="c6753-199">Usando o banco de dados do dispositivo WURFL via 51Degrees.mobi Foundation</span><span class="sxs-lookup"><span data-stu-id="c6753-199">Using the WURFL device database via 51Degrees.mobi Foundation</span></span>

<span data-ttu-id="c6753-200">Embora o ASP. Suporte de detecção de navegador interno da rede será suficiente para muitos aplicativos, há dois principais casos em que talvez não seja suficiente:</span><span class="sxs-lookup"><span data-stu-id="c6753-200">While ASP.NET's built-in browser detection support will be sufficient for many applications, there are two main cases when it might not be enough:</span></span>

- <span data-ttu-id="c6753-201">***Você deseja reconhecer os dispositivos mais recentes***(sem criar manualmente os arquivos de definição do navegador para eles).</span><span class="sxs-lookup"><span data-stu-id="c6753-201">***You want to recognize the latest devices***(without manually creating Browser Definition files for them).</span></span> <span data-ttu-id="c6753-202">Observe que os arquivos de definição de navegador do .NET 4 não são suficientemente recentes para reconhecer Apple iPads, telefones Android, navegadores Opera Mobile ou Windows Phone 7.</span><span class="sxs-lookup"><span data-stu-id="c6753-202">Note that .NET 4's Browser Definition files are not recent enough to recognize Windows Phone 7, Android phones, Opera Mobile browsers, or Apple iPads.</span></span>
- <span data-ttu-id="c6753-203">***Você precisa obter informações mais detalhadas sobre os recursos de dispositivo***.</span><span class="sxs-lookup"><span data-stu-id="c6753-203">***You need more detailed information about device capabilities***.</span></span> <span data-ttu-id="c6753-204">Talvez você precise saber sobre o método de entrada de um dispositivo (por exemplo, o teclado vs de toque) ou quais áudio formata o navegador dá suporte.</span><span class="sxs-lookup"><span data-stu-id="c6753-204">You may need to know about a device's input method (e.g., touch vs keypad), or what audio formats the browser supports.</span></span> <span data-ttu-id="c6753-205">Essas informações não estão disponíveis nos arquivos de definição do navegador padrão.</span><span class="sxs-lookup"><span data-stu-id="c6753-205">This information isn't available in the standard Browser Definition files.</span></span>

<span data-ttu-id="c6753-206">O [ *arquivo de recurso Universal sem fio* project (WURFL)](http://wurfl.sourceforge.net/) mantém muito mais informações atualizadas e detalhadas sobre os dispositivos móveis em uso hoje em dia.</span><span class="sxs-lookup"><span data-stu-id="c6753-206">The [*Wireless Universal Resource File* (WURFL) project](http://wurfl.sourceforge.net/) maintains much more up-to-date and detailed information about mobile devices in use today.</span></span>

<span data-ttu-id="c6753-207">A ótima notícia para desenvolvedores do .NET é que o ASP. O recurso de detecção de navegador do NET é extensível, portanto, é possível aperfeiçoá-lo para superar esses problemas.</span><span class="sxs-lookup"><span data-stu-id="c6753-207">The great news for .NET developers is that ASP.NET's browser detection feature is extensible, so it's possible to enhance it to overcome these problems.</span></span> <span data-ttu-id="c6753-208">Por exemplo, você pode adicionar código-fonte aberto [ *51Degrees.mobi Foundation* ](https://github.com/51Degrees/dotNET-Device-Detection) biblioteca ao seu projeto.</span><span class="sxs-lookup"><span data-stu-id="c6753-208">For example, you can add the open source [*51Degrees.mobi Foundation*](https://github.com/51Degrees/dotNET-Device-Detection) library to your project.</span></span> <span data-ttu-id="c6753-209">É um IHttpModule do ASP.NET ou um navegador recursos de provedor (pode ser usado em aplicativos Web Forms e MVC), que lê dados WURFL diretamente e o vincula ao ASP. Mecanismo de detecção de navegador interno da rede.</span><span class="sxs-lookup"><span data-stu-id="c6753-209">It's an ASP.NET IHttpModule or Browser Capabilities Provider (usable on both Web Forms and MVC applications), that directly reads WURFL data and hooks it into ASP.NET's built-in browser detection mechanism.</span></span> <span data-ttu-id="c6753-210">Depois que você instalou o módulo *Request. browser* repentinamente conterá informações detalhadas e muito mais precisas: ele corretamente reconhecerá muitos dos dispositivos mencionados anteriormente e listar seus recursos (incluindo recursos adicionais, como método de entrada).</span><span class="sxs-lookup"><span data-stu-id="c6753-210">Once you've installed the module, *Request.Browser* will suddenly contain a lot more accurate and detailed information: it will correctly recognize many of the devices previously mentioned and list their capabilities (including additional capabilities such as input method).</span></span> <span data-ttu-id="c6753-211">Consulte a documentação do projeto para obter mais detalhes.</span><span class="sxs-lookup"><span data-stu-id="c6753-211">See the project's documentation for more details.</span></span>

## <a name="how-web-forms-applications-can-present-mobile-specific-pages"></a><span data-ttu-id="c6753-212">Como aplicativos de formulários da Web podem apresentar a páginas específicas para dispositivos móveis</span><span class="sxs-lookup"><span data-stu-id="c6753-212">How Web Forms applications can present mobile-specific pages</span></span>

<span data-ttu-id="c6753-213">Por padrão, aqui está como um novo aplicativo de Web Forms exibe em dispositivos móveis comuns:</span><span class="sxs-lookup"><span data-stu-id="c6753-213">By default, here's how a brand new Web Forms application displays on common mobile devices:</span></span>

![](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/_static/image1.png)

<span data-ttu-id="c6753-214">Obviamente, nem layout ficaria muito amigáveis para dispositivos móveis – esta página foi projetada para um monitor grande, com orientação paisagem, não para uma tela pequena e orientada a retrato.</span><span class="sxs-lookup"><span data-stu-id="c6753-214">Clearly, neither layout looks very mobile-friendly – this page was designed for a large, landscape-oriented monitor, not for a small portrait-oriented screen.</span></span> <span data-ttu-id="c6753-215">Portanto, o que você pode fazer sobre ele?</span><span class="sxs-lookup"><span data-stu-id="c6753-215">So what can you do about it?</span></span>

<span data-ttu-id="c6753-216">Conforme discutido anteriormente neste documento, há várias maneiras para personalizar suas páginas para dispositivos móveis.</span><span class="sxs-lookup"><span data-stu-id="c6753-216">As discussed earlier in this paper, there are many ways to tailor your pages for mobile devices.</span></span> <span data-ttu-id="c6753-217">Algumas técnicas são baseados em servidor, outros executam no cliente.</span><span class="sxs-lookup"><span data-stu-id="c6753-217">Some techniques are server-based, others run on the client.</span></span>

### <a name="creating-a-mobile-specific-master-page"></a><span data-ttu-id="c6753-218">Criando uma página mestra do específicas para dispositivos móveis</span><span class="sxs-lookup"><span data-stu-id="c6753-218">Creating a mobile-specific master page</span></span>

<span data-ttu-id="c6753-219">Dependendo dos seus requisitos, você poderá usar os mesmos formulários da Web para todos os visitantes, mas têm duas páginas mestres separadas: uma para visitantes de área de trabalho, outro para visitantes por dispositivos móveis.</span><span class="sxs-lookup"><span data-stu-id="c6753-219">Depending on your requirements, you may be able to use the same Web Forms for all visitors, but have two separate master pages: one for desktop visitors, another for mobile visitors.</span></span> <span data-ttu-id="c6753-220">Isso lhe dá a flexibilidade de alterar sua marcação HTML de nível superior de acordo com os dispositivos móveis, sem forçá-lo a duplicar a lógica de qualquer página ou de folha de estilos CSS.</span><span class="sxs-lookup"><span data-stu-id="c6753-220">This gives you the flexibility of changing the CSS stylesheet or your top-level HTML markup to suit mobile devices, without forcing you to duplicate any page logic.</span></span>

<span data-ttu-id="c6753-221">Isso é fácil de fazer.</span><span class="sxs-lookup"><span data-stu-id="c6753-221">This is easy to do.</span></span> <span data-ttu-id="c6753-222">Por exemplo, você pode adicionar um manipulador de PreInit como o seguinte para um formulário da Web:</span><span class="sxs-lookup"><span data-stu-id="c6753-222">For example, you can add a PreInit handler such as the following to a Web Form:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample1.cs)]

<span data-ttu-id="c6753-223">Agora, crie uma página mestra chamada Mobile.Master na pasta de nível superior do seu aplicativo, e ele será usado quando um dispositivo móvel for detectado.</span><span class="sxs-lookup"><span data-stu-id="c6753-223">Now, create a master page called Mobile.Master in the top-level folder of your application, and it will be used when a mobile device is detected.</span></span> <span data-ttu-id="c6753-224">A página mestra móvel pode fazer referência a uma folha de estilos CSS específicas para dispositivos móveis se necessário.</span><span class="sxs-lookup"><span data-stu-id="c6753-224">Your mobile master page can reference a mobile-specific CSS stylesheet if necessary.</span></span> <span data-ttu-id="c6753-225">Os visitantes da área de trabalho ainda verá a página mestra padrão, não aquela móvel.</span><span class="sxs-lookup"><span data-stu-id="c6753-225">Desktop visitors will still see your default master page, not the mobile one.</span></span>

### <a name="creating-independent-mobile-specific-web-forms"></a><span data-ttu-id="c6753-226">Criando independentes do Web Forms móveis específicas</span><span class="sxs-lookup"><span data-stu-id="c6753-226">Creating independent mobile-specific Web Forms</span></span>

<span data-ttu-id="c6753-227">Para máxima flexibilidade, você pode ir muito mais do que ter apenas páginas mestras separadas para diferentes tipos de dispositivos.</span><span class="sxs-lookup"><span data-stu-id="c6753-227">For maximum flexibility, you can go much further than just having separate master pages for different device types.</span></span> <span data-ttu-id="c6753-228">Você pode implementar dois *totalmente separadas conjuntos de páginas de Web Forms* – um outro conjunto para navegadores de desktop, definido para celulares.</span><span class="sxs-lookup"><span data-stu-id="c6753-228">You can implement two *totally separate sets of Web Forms pages* – one set for desktop browsers, another set for mobiles.</span></span> <span data-ttu-id="c6753-229">Isso funciona melhor se você quiser apresentar informações muito diferentes ou fluxos de trabalho aos visitantes por dispositivos móveis.</span><span class="sxs-lookup"><span data-stu-id="c6753-229">This works best if you want to present very different information or workflows to mobile visitors.</span></span> <span data-ttu-id="c6753-230">O restante desta seção descreve essa abordagem em detalhes.</span><span class="sxs-lookup"><span data-stu-id="c6753-230">The rest of this section describes this approach in detail.</span></span>

<span data-ttu-id="c6753-231">Supondo que você já tiver um aplicativo Web Forms projetado para navegadores de desktop, a maneira mais fácil para prosseguir é criar uma subpasta chamada "Móvel" dentro de seu projeto e criar suas páginas de dispositivos móveis.</span><span class="sxs-lookup"><span data-stu-id="c6753-231">Assuming you already have a Web Forms application designed for desktop browsers, the easiest way to proceed is to create a subfolder called "Mobile" within your project, and build your mobile pages there.</span></span> <span data-ttu-id="c6753-232">Você pode construir um subsite inteira, com suas próprias páginas mestras, folhas de estilo e páginas, usando as mesmas técnicas que você deseja usar para qualquer outro aplicativo de formulários da Web.</span><span class="sxs-lookup"><span data-stu-id="c6753-232">You can construct an entire sub-site, with its own master pages, style sheets, and pages, using all the same techniques that you'd use for any other Web Forms application.</span></span> <span data-ttu-id="c6753-233">Você não precisa necessariamente para produzir um equivalente de móvel para *cada* página no site da área de trabalho; você pode escolher o subconjunto da funcionalidade faz sentido para visitantes por dispositivos móveis.</span><span class="sxs-lookup"><span data-stu-id="c6753-233">You don't necessarily need to produce a mobile equivalent for *every* page in your desktop site; you can choose what subset of functionality makes sense for mobile visitors.</span></span>

<span data-ttu-id="c6753-234">Páginas de dispositivos móveis podem compartilhar recursos estáticos comuns (como imagens, JavaScript ou CSS arquivos) com suas páginas regulares se desejar.</span><span class="sxs-lookup"><span data-stu-id="c6753-234">Your mobile pages can share common static resources (such as images, JavaScript, or CSS files) with your regular pages if you wish.</span></span> <span data-ttu-id="c6753-235">Uma vez que a pasta "Móvel" será *não* ser marcado como um aplicativo separado quando hospedado no IIS (ele é apenas uma subpasta simple de páginas Web Forms), ele também compartilhará a mesma configuração, dados de sessão e outra infraestrutura como seu páginas da área de trabalho.</span><span class="sxs-lookup"><span data-stu-id="c6753-235">Since your "Mobile" folder will *not* be marked as a separate application when hosted in IIS (it's just a simple subfolder of Web Forms pages), it will also share all the same configuration, Session data, and other infrastructure as your desktop pages.</span></span>

> [!NOTE]
> <span data-ttu-id="c6753-236">Como essa abordagem geralmente envolve algumas eliminação de duplicação de código (páginas móveis provavelmente compartilham algumas semelhanças com páginas da área de trabalho), é importante para criar qualquer negócio dados ou lógica de acesso código comum em uma camada subjacente compartilhada ou um serviço.</span><span class="sxs-lookup"><span data-stu-id="c6753-236">Since this approach usually involves some duplication of code (mobile pages are likely to share some similarities with desktop pages), it's important to factor out any common business logic or data access code into a shared underlying layer or service.</span></span> <span data-ttu-id="c6753-237">Caso contrário, você vai double o esforço de criação e manutenção de seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="c6753-237">Otherwise, you'll double the effort of creating and maintaining your application.</span></span>


#### <a name="redirecting-mobile-visitors-to-your-mobile-pages"></a><span data-ttu-id="c6753-238">Redirecionando visitantes por dispositivos móveis às suas páginas móveis</span><span class="sxs-lookup"><span data-stu-id="c6753-238">Redirecting mobile visitors to your mobile pages</span></span>

<span data-ttu-id="c6753-239">É conveniente redirecionar os visitantes por dispositivos móveis para as páginas móveis apenas na *primeiro* solicitar em sua sessão de navegação (e não em cada solicitação em sua sessão), porque:</span><span class="sxs-lookup"><span data-stu-id="c6753-239">It's often convenient to redirect mobile visitors to the mobile pages only on the *first* request in their browsing session (and not on every request in their session), because:</span></span>

- <span data-ttu-id="c6753-240">Em seguida, você pode facilmente permitir visitantes por dispositivos móveis acessar suas páginas da área de trabalho caso queiram – apenas colocar um link na página mestra que vai para "Versão da área de trabalho".</span><span class="sxs-lookup"><span data-stu-id="c6753-240">You can then easily allow mobile visitors to access your desktop pages if they wish – just put a link on your master page that goes to "Desktop version".</span></span> <span data-ttu-id="c6753-241">O visitante não ser redirecionado para uma página móvel, porque não é a primeira solicitação em sua sessão.</span><span class="sxs-lookup"><span data-stu-id="c6753-241">The visitor won't be redirected back to a mobile page, because it's no longer the first request in their session.</span></span>
- <span data-ttu-id="c6753-242">Ele evita o risco de interferir solicitações para quaisquer recursos dinâmicos compartilhados entre partes móveis e desktops do seu site (por exemplo, se você tiver um formulário da Web comuns que exibem de partes móveis e desktops do seu site em um IFRAME, ou certos manipuladores de Ajax)</span><span class="sxs-lookup"><span data-stu-id="c6753-242">It avoids the risk of interfering with requests for any dynamic resources shared between desktop and mobile parts of your site (e.g., if you have a common Web Form that both desktop and mobile parts of your site display in an IFRAME, or certain Ajax handlers)</span></span>

<span data-ttu-id="c6753-243">Para fazer isso, você pode colocar a lógica de redirecionamento em um **sessão\_iniciar** método.</span><span class="sxs-lookup"><span data-stu-id="c6753-243">To do this, you can place your redirection logic in a **Session\_Start** method.</span></span> <span data-ttu-id="c6753-244">Por exemplo, adicione o seguinte método ao seu arquivo Global.asax.cs:</span><span class="sxs-lookup"><span data-stu-id="c6753-244">For example, add the following method to your Global.asax.cs file:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample2.cs)]

#### <a name="configuring-forms-authentication-to-respect-your-mobile-pages"></a><span data-ttu-id="c6753-245">Configurando a autenticação de formulários para respeitar a suas páginas para dispositivos móveis</span><span class="sxs-lookup"><span data-stu-id="c6753-245">Configuring Forms Authentication to respect your mobile pages</span></span>

<span data-ttu-id="c6753-246">Observe que a autenticação de formulários faz determinadas suposições sobre onde ele pode redirecionar os visitantes durante e após o processo de autenticação:</span><span class="sxs-lookup"><span data-stu-id="c6753-246">Note that Forms Authentication makes certain assumptions about where it can redirect visitors during and after the authentication process:</span></span>

- <span data-ttu-id="c6753-247">Quando um usuário precisa ser autenticada, autenticação de formulários serão redirecioná-las à sua página de logon da área de trabalho, independentemente se eles estão um usuário móvel ou da área de trabalho (porque ele tem um conceito de apenas *um* URL de logon).</span><span class="sxs-lookup"><span data-stu-id="c6753-247">When a user needs to be authenticated, Forms Authentication will redirect them to your desktop login page, regardless of whether they're a desktop or mobile user (because it only has a concept of *one* login URL).</span></span> <span data-ttu-id="c6753-248">Supondo que você deseja definir o estilo de sua página de logon móvel diferente, você precisa aprimorar sua página de logon da área de trabalho, de modo que ele redireciona os usuários móveis a uma página de logon móvel separado.</span><span class="sxs-lookup"><span data-stu-id="c6753-248">Assuming you want to style your mobile login page differently, you need to enhance your desktop login page so that it redirects mobile users to a separate mobile login page.</span></span> <span data-ttu-id="c6753-249">Por exemplo, adicione o seguinte código ao seu **desktop** lógica para página de logon:</span><span class="sxs-lookup"><span data-stu-id="c6753-249">For example, add the following code to your **desktop** login page code-behind:</span></span> 

    [!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample3.cs)]
- <span data-ttu-id="c6753-250">Depois que um usuário faz logon com êxito, autenticação de formulários será por padrão redirecioná-las para a home page da área de trabalho (porque ele tem um conceito de apenas *um* página padrão).</span><span class="sxs-lookup"><span data-stu-id="c6753-250">After a user successfully logs in, Forms Authentication will by default redirect them to your desktop home page (because it only has a concept of *one* default page).</span></span> <span data-ttu-id="c6753-251">Você precisa aprimorar sua página de logon móveis, de modo que ele redireciona para a home page móvel após um logon bem-sucedido.</span><span class="sxs-lookup"><span data-stu-id="c6753-251">You need to enhance your mobile login page so that it redirects to the mobile home page after a successful log-in.</span></span> <span data-ttu-id="c6753-252">Por exemplo, adicione o seguinte código ao seu **móvel** lógica para página de logon:</span><span class="sxs-lookup"><span data-stu-id="c6753-252">For example, add the following code to your **mobile** login page code-behind:</span></span> 

    [!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample4.cs)]
  
  <span data-ttu-id="c6753-253">Esse código pressupõe que sua página tiver um controle de servidor de logon chamado LoginUser, como no modelo de projeto padrão.</span><span class="sxs-lookup"><span data-stu-id="c6753-253">This code assumes your page has a Login server control called LoginUser, as in the default project template.</span></span>

### <a name="working-with-output-caching"></a><span data-ttu-id="c6753-254">Trabalhando com o cache de saída</span><span class="sxs-lookup"><span data-stu-id="c6753-254">Working with Output Caching</span></span>

<span data-ttu-id="c6753-255">Se você estiver usando o cache de saída, lembre-se de que por padrão, é possível que um usuário da área de trabalho visitar um determinado URL (fazendo com que sua saída seja armazenada em cache), seguido por um usuário móvel que, em seguida, recebe a saída da área de trabalho do cache.</span><span class="sxs-lookup"><span data-stu-id="c6753-255">If you're using output caching, beware that by default it's possible for a desktop user to visit a certain URL (causing its output to be cached), followed by a mobile user who then receives the cached desktop output.</span></span> <span data-ttu-id="c6753-256">Esse aviso se aplica independentemente de você apenas estiver variando a página mestra por tipo de dispositivo ou implementar totalmente separadas do Web Forms por tipo de dispositivo.</span><span class="sxs-lookup"><span data-stu-id="c6753-256">This warning applies whether you're just varying your master page by device type, or implementing totally separate Web Forms per device type.</span></span>

<span data-ttu-id="c6753-257">Para evitar o problema, você pode instruir o ASP.NET para variar a entrada de cache de acordo com se o visitante está usando um dispositivo móvel.</span><span class="sxs-lookup"><span data-stu-id="c6753-257">To avoid the problem, you can instruct ASP.NET to vary the cache entry according to whether the visitor is using a mobile device.</span></span> <span data-ttu-id="c6753-258">Adicione um parâmetro de VaryByCustom a declaração de OutputCache da sua página da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="c6753-258">Add a VaryByCustom parameter to your page's OutputCache declaration as follows:</span></span>

[!code-aspx[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample5.aspx)]

<span data-ttu-id="c6753-259">Em seguida, defina *isMobileDevice* como um cache personalizado parâmetro, adicionando o seguinte método de substituição ao seu arquivo Global.asax.cs:</span><span class="sxs-lookup"><span data-stu-id="c6753-259">Next, define *isMobileDevice* as a custom cache parameter by adding the following method override to your Global.asax.cs file:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample6.cs)]

<span data-ttu-id="c6753-260">Isso garantirá que os visitantes por dispositivos móveis para a página não recebem saída colocar previamente no cache por um visitante da área de trabalho.</span><span class="sxs-lookup"><span data-stu-id="c6753-260">This will ensure that mobile visitors to the page don't receive output previously put into the cache by a desktop visitor.</span></span>

### <a name="a-working-example"></a><span data-ttu-id="c6753-261">Um exemplo de trabalho</span><span class="sxs-lookup"><span data-stu-id="c6753-261">A working example</span></span>

<span data-ttu-id="c6753-262">Para ver essas técnicas em ação, baixe [exemplos de código neste white paper](https://docs.microsoft.com/aspnet/mobile/overview).</span><span class="sxs-lookup"><span data-stu-id="c6753-262">To see these techniques in action, download [this white paper's code samples](https://docs.microsoft.com/aspnet/mobile/overview).</span></span> <span data-ttu-id="c6753-263">O aplicativo de exemplo de formulários da Web redireciona automaticamente os usuários móveis a um conjunto de páginas específicas para dispositivos móveis em uma subpasta chamada Mobile.</span><span class="sxs-lookup"><span data-stu-id="c6753-263">The Web Forms sample application automatically redirects mobile users to a set of mobile-specific pages in a subfolder called Mobile.</span></span> <span data-ttu-id="c6753-264">A marcação e o estilo dessas páginas melhor é otimizado para navegadores de dispositivos móveis, como você pode ver de capturas de tela as seguir:</span><span class="sxs-lookup"><span data-stu-id="c6753-264">The markup and styling of those pages is better optimized for mobile browsers, as you can see from the following screenshots:</span></span>

![](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/_static/image2.png)

<span data-ttu-id="c6753-265">Para obter mais dicas sobre como otimizar sua marcação e CSS para navegadores de dispositivos móveis, consulte a seção "Estilos páginas móveis para navegadores de dispositivos móveis" neste documento.</span><span class="sxs-lookup"><span data-stu-id="c6753-265">For more tips about optimizing your markup and CSS for mobile browsers, see the section "Styling mobile pages for mobile browsers" later in this document.</span></span>

## <a name="how-aspnet-mvc-applications-can-present-mobile-specific-pages"></a><span data-ttu-id="c6753-266">Como os aplicativos ASP.NET MVC podem apresentar páginas específicas para dispositivos móveis</span><span class="sxs-lookup"><span data-stu-id="c6753-266">How ASP.NET MVC applications can present mobile-specific pages</span></span>

<span data-ttu-id="c6753-267">Uma vez que o padrão Model-View-Controller separa a lógica do aplicativo (em controladores) da lógica de apresentação (nos modos de exibição), você pode escolher de qualquer uma das seguintes abordagens para lidar com suporte móvel no código do lado do servidor:</span><span class="sxs-lookup"><span data-stu-id="c6753-267">Since the Model-View-Controller pattern decouples application logic (in controllers) from presentation logic (in views), you can choose from any of the following approaches to handling mobile support in server-side code:</span></span>

1. <span data-ttu-id="c6753-268">***Usar o mesmo controladores e modos de exibição para navegadores móveis e desktops, mas renderizar as exibições com diferentes layouts de Razor dependendo do tipo de dispositivo *.**</span><span class="sxs-lookup"><span data-stu-id="c6753-268">***Use the same controllers and views for both desktop and mobile browsers, but render the views with different Razor layouts depending on the device type*.**</span></span> <span data-ttu-id="c6753-269">Essa opção funciona melhor se você estiver exibindo dados idênticos em todos os dispositivos, mas simplesmente deseja fornecer diferentes folhas de estilo CSS ou alterar alguns elementos de HTML de nível superior para celulares.</span><span class="sxs-lookup"><span data-stu-id="c6753-269">This option works best if you're displaying identical data on all devices, but simply want to supply different CSS stylesheets or change a few top-level HTML elements for mobiles.</span></span>
2. <span data-ttu-id="c6753-270">***Usar os mesmos controladores para navegadores móveis e desktops, mas renderizar exibições diferentes dependendo do tipo de dispositivo***.</span><span class="sxs-lookup"><span data-stu-id="c6753-270">***Use the same controllers for both desktop and mobile browsers, but render different views depending on the device type***.</span></span> <span data-ttu-id="c6753-271">Essa opção funciona melhor se você estiver exibindo aproximadamente os mesmos dados e fornecendo os mesmos fluxos de trabalho para os usuários finais, mas deseja renderizar a marcação HTML muito diferente de acordo com o dispositivo que está sendo usado.</span><span class="sxs-lookup"><span data-stu-id="c6753-271">This option works best if you're displaying roughly the same data and providing the same workflows for end users, but want to render very different HTML markup to suit the device being used.</span></span>
3. <span data-ttu-id="c6753-272">***Criar áreas separadas para navegadores móveis e desktops, Implementando independentes controladores e modos de exibição para cada *.**</span><span class="sxs-lookup"><span data-stu-id="c6753-272">***Create separate areas for desktop and mobile browsers, implementing independent controllers and views for each*.**</span></span> <span data-ttu-id="c6753-273">Essa opção funciona melhor se você estiver exibindo as telas muito diferentes, que contém informações diferentes e leva o usuário por meio de diferentes fluxos de trabalho otimizada para seu tipo de dispositivo.</span><span class="sxs-lookup"><span data-stu-id="c6753-273">This option works best if you're displaying very different screens, containing different information and leading the user through different workflows optimized for their device type.</span></span> <span data-ttu-id="c6753-274">Pode significar algumas repetições de código, mas você pode minimizar que ao fatorar a lógica comum em uma camada ou o serviço subjacente.</span><span class="sxs-lookup"><span data-stu-id="c6753-274">It may mean some repetition of code, but you can minimize that by factoring out common logic into an underlying layer or service.</span></span>

<span data-ttu-id="c6753-275">Se você quiser executar o **primeiro** opção e variar somente o layout do Razor por tipo de dispositivo, é muito fácil.</span><span class="sxs-lookup"><span data-stu-id="c6753-275">If you want to take the **first** option and vary only the Razor layout per device type, it's very easy.</span></span> <span data-ttu-id="c6753-276">Basta modificar seu \_viewstart. cshtml arquivos da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="c6753-276">Just modify your \_ViewStart.cshtml file as follows:</span></span>

[!code-cshtml[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample7.cshtml)]

<span data-ttu-id="c6753-277">Agora você pode criar um layout específicas para dispositivos móveis chamado \_LayoutMobile.cshtml com uma estrutura de página e CSS regras otimizados para dispositivos móveis.</span><span class="sxs-lookup"><span data-stu-id="c6753-277">Now you can create a mobile-specific layout called \_LayoutMobile.cshtml with a page structure and CSS rules optimized for mobile devices.</span></span>

<span data-ttu-id="c6753-278">Se você quiser executar o **segundo** opção totalmente diferentes modos de exibição de renderização acordo com o tipo de dispositivo do visitante, consulte [postagem de blog de Hanselman](http://www.hanselman.com/blog/ABetterASPNETMVCMobileDeviceCapabilitiesViewEngine.aspx).</span><span class="sxs-lookup"><span data-stu-id="c6753-278">If you want to take the **second** option render totally different views according to the visitor's device type, see [Scott Hanselman's blog post](http://www.hanselman.com/blog/ABetterASPNETMVCMobileDeviceCapabilitiesViewEngine.aspx).</span></span>

<span data-ttu-id="c6753-279">O restante deste documento se concentra na **terceiro** opção – Criando controladores separados *e* modos de exibição para dispositivos móveis, portanto, você pode controlar exatamente quais subconjunto da funcionalidade é oferecido para visitantes por dispositivos móveis.</span><span class="sxs-lookup"><span data-stu-id="c6753-279">The rest of this paper focuses on the **third** option – creating separate controllers *and* views for mobile devices – so you can control exactly what subset of functionality is offered for mobile visitors.</span></span>

### <a name="setting-up-a-mobile-area-within-your-aspnet-mvc-application"></a><span data-ttu-id="c6753-280">Configurando uma área móvel dentro de seu aplicativo ASP.NET MVC</span><span class="sxs-lookup"><span data-stu-id="c6753-280">Setting up a Mobile area within your ASP.NET MVC application</span></span>

<span data-ttu-id="c6753-281">Você pode adicionar uma área chamada "Móvel" para um aplicativo ASP.NET MVC existente da maneira normal: clique com botão direito no nome do projeto no Gerenciador de soluções e escolha Adicionar à área.</span><span class="sxs-lookup"><span data-stu-id="c6753-281">You can add an area called "Mobile" to an existing ASP.NET MVC application in the normal way: right-click on your project name in Solution Explorer, then choose Add à Area.</span></span> <span data-ttu-id="c6753-282">Em seguida, você pode adicionar controladores e exibições como você faria para qualquer outra área dentro de um aplicativo ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="c6753-282">You can then add controllers and views as you would for any other area within an ASP.NET MVC application.</span></span> <span data-ttu-id="c6753-283">Por exemplo, adicione à sua área móvel um novo controlador chamado HomeController para atuar como uma home page para visitantes por dispositivos móveis.</span><span class="sxs-lookup"><span data-stu-id="c6753-283">For example, add to your Mobile area a new controller called HomeController to act as a homepage for mobile visitors.</span></span>

### <a name="ensuring-the-url-mobile-reaches-the-mobile-homepage"></a><span data-ttu-id="c6753-284">Garantindo a URL /Mobile atinge a home page da móvel</span><span class="sxs-lookup"><span data-stu-id="c6753-284">Ensuring the URL /Mobile reaches the mobile homepage</span></span>

<span data-ttu-id="c6753-285">Se você quiser /Mobile a URL para acessar a ação Index em HomeController dentro de sua área móvel, você precisará fazer duas pequenas alterações em sua configuração de roteamento.</span><span class="sxs-lookup"><span data-stu-id="c6753-285">If you want the URL /Mobile to reach the Index action on HomeController inside your Mobile area, you will need to make two small changes to your routing configuration.</span></span> <span data-ttu-id="c6753-286">Primeiro, atualize sua classe MobileAreaRegistration para que o HomeController é o controlador padrão em sua área móvel, conforme mostrado no código a seguir:</span><span class="sxs-lookup"><span data-stu-id="c6753-286">First, update your MobileAreaRegistration class so that HomeController is the default controller in your Mobile area, as shown in the following code:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample8.cs)]

<span data-ttu-id="c6753-287">Isso significa que a home page da móvel agora estará localizado em /Mobile, em vez de/móvel/Home, como "Home" agora é o implicitamente o nome de controlador padrão para páginas para dispositivos móveis.</span><span class="sxs-lookup"><span data-stu-id="c6753-287">This means the mobile homepage will now be located at /Mobile, rather than /Mobile/Home, because "Home" is now the implicitly default controller name for mobile pages.</span></span>

<span data-ttu-id="c6753-288">Em seguida, observe que, ao adicionar um segundo HomeController ao seu aplicativo (ou seja, móvel aquele, além de área de trabalho um existente), você vai ter dividido sua home page da área de trabalho regular.</span><span class="sxs-lookup"><span data-stu-id="c6753-288">Next, note that by adding a second HomeController to your application (i.e., the mobile one, in addition to the existing desktop one), you'll have broken your regular desktop homepage.</span></span> <span data-ttu-id="c6753-289">Ocorrerá uma falha com o erro "*foram encontrados vários tipos que correspondem ao controlador chamado 'Home'*".</span><span class="sxs-lookup"><span data-stu-id="c6753-289">It will fail with the error "*Multiple types were found that match the controller named 'Home'*".</span></span> <span data-ttu-id="c6753-290">Para resolver esse problema, atualize sua configuração de roteamento de nível superior (em Global.asax.cs) para especificar que o HomeController da área de trabalho deve têm prioridade quando não há ambiguidade:</span><span class="sxs-lookup"><span data-stu-id="c6753-290">To resolve this, update your top-level routing configuration (in Global.asax.cs) to specify that your desktop HomeController should take priority when there's ambiguity:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample9.cs)]

<span data-ttu-id="c6753-291">Agora, o erro irá distância e a URL http://<em>seusite</em>/ atingirá a home page da área de trabalho e http://<em>seusite</em>/mobile/ alcançará a móvel da home page.</span><span class="sxs-lookup"><span data-stu-id="c6753-291">Now the error will go away, and the URL http://<em>yoursite</em>/ will reach the desktop homepage, and http://<em>yoursite</em>/mobile/ will reach the mobile homepage.</span></span>

### <a name="redirecting-mobile-visitors-to-your-mobile-area"></a><span data-ttu-id="c6753-292">Redirecionando visitantes por dispositivos móveis na sua área de móvel</span><span class="sxs-lookup"><span data-stu-id="c6753-292">Redirecting mobile visitors to your mobile area</span></span>

<span data-ttu-id="c6753-293">Há muitos pontos de extensibilidade diferentes no ASP.NET MVC, portanto, há muitas maneiras possíveis de injetar lógica de redirecionamento.</span><span class="sxs-lookup"><span data-stu-id="c6753-293">There are many different extensibility points in ASP.NET MVC, so there are many possible ways to inject redirection logic.</span></span> <span data-ttu-id="c6753-294">Uma opção legal é criar um atributo de filtro, [RedirectMobileDevicesToMobileArea], que executa um redirecionamento se as seguintes condições forem atendidas:</span><span class="sxs-lookup"><span data-stu-id="c6753-294">One neat option is to create a filter attribute, [RedirectMobileDevicesToMobileArea], that performs a redirection if the following conditions are met:</span></span>

1. <span data-ttu-id="c6753-295">É a primeira solicitação na sessão do usuário (ou seja, Session.IsNewSession é igual a true)</span><span class="sxs-lookup"><span data-stu-id="c6753-295">It's the first request in the user's session (i.e., Session.IsNewSession equals true)</span></span>
2. <span data-ttu-id="c6753-296">A solicitação vier de um navegador móvel (ou seja, Request.Browser.IsMobileDevice é igual a true)</span><span class="sxs-lookup"><span data-stu-id="c6753-296">The request comes from a mobile browser (i.e., Request.Browser.IsMobileDevice equals true)</span></span>
3. <span data-ttu-id="c6753-297">O usuário já não solicita um recurso na área de trabalho móvel (ou seja, o *caminho* parte da URL não começa com /Mobile)</span><span class="sxs-lookup"><span data-stu-id="c6753-297">The user is not already requesting a resource in the mobile area (i.e., the *path* part of the URL does not begin with /Mobile)</span></span>

<span data-ttu-id="c6753-298">O exemplo disponível para download que acompanha este white paper inclui uma implementação da lógica do programa.</span><span class="sxs-lookup"><span data-stu-id="c6753-298">The downloadable sample included with this white paper includes an implementation of this logic.</span></span> <span data-ttu-id="c6753-299">Ele é implementado como um filtro de autorização, derivado de AuthorizeAttribute, o que significa que ele pode funcionar corretamente, mesmo se você estiver usando o cache de saída (caso contrário, se um acessa primeiro uma URL determinado, a saída da área de trabalho do visitante da área de trabalho pode ser armazenados em cache e, em seguida, servido a visitantes móveis subsequentes).</span><span class="sxs-lookup"><span data-stu-id="c6753-299">It's implemented as an authorization filter, derived from AuthorizeAttribute, which means it can work correctly even if you are using output caching (otherwise, if a desktop visitor first accesses a certain URL, the desktop output might be cached and then served to subsequent mobile visitors).</span></span>

<span data-ttu-id="c6753-300">Como ele é um filtro, você pode escolher para aplicá-la para controladores específicos e ações, por exemplo,</span><span class="sxs-lookup"><span data-stu-id="c6753-300">As it's a filter, you can choose either to apply it to specific controllers and actions, e.g.,</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample10.cs)]

<span data-ttu-id="c6753-301">…</span><span class="sxs-lookup"><span data-stu-id="c6753-301">…</span></span> <span data-ttu-id="c6753-302">ou você pode aplicá-la a todos os controladores e ações como um MVC 3 *filtro global* em seu arquivo Global.asax.cs:</span><span class="sxs-lookup"><span data-stu-id="c6753-302">or you can apply it to all controllers and actions as an MVC 3 *global filter* in your Global.asax.cs file:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample11.cs)]

<span data-ttu-id="c6753-303">O exemplo disponível para download também demonstra como você pode criar subclasses que redirecionam para locais específicos dentro de sua área móvel desse atributo.</span><span class="sxs-lookup"><span data-stu-id="c6753-303">The downloadable sample also demonstrates how you can create subclasses of this attribute that redirect to specific locations within your mobile area.</span></span> <span data-ttu-id="c6753-304">Isso significa que, por exemplo, você pode:</span><span class="sxs-lookup"><span data-stu-id="c6753-304">This means, for example, you can:</span></span>

- <span data-ttu-id="c6753-305">Registre um filtro global conforme mostrado acima que envia os visitantes por dispositivos móveis para a home page de móvel por padrão.</span><span class="sxs-lookup"><span data-stu-id="c6753-305">Register a global filter as shown above that sends mobile visitors to the mobile homepage by default.</span></span>
- <span data-ttu-id="c6753-306">Também se aplicam um filtro [RedirectMobileDevicesToMobileProductPage] especial a uma ação de "Exibir produto" que aceita visitantes por dispositivos móveis para a versão móvel de qualquer página do produto que tinham solicitados.</span><span class="sxs-lookup"><span data-stu-id="c6753-306">Also apply a special [RedirectMobileDevicesToMobileProductPage] filter to a "view product" action that takes mobile visitors to the mobile version of whatever product page they had requested.</span></span>
- <span data-ttu-id="c6753-307">Também aplicar outras subclasses especiais do filtro para ações específicas, redirecionando os visitantes por dispositivos móveis para a página móvel equivalente</span><span class="sxs-lookup"><span data-stu-id="c6753-307">Also apply other special subclasses of the filter to specific actions, redirecting mobile visitors to the equivalent mobile page</span></span>

### <a name="configuring-forms-authentication-to-respect-your-mobile-pages"></a><span data-ttu-id="c6753-308">Configurando a autenticação de formulários para respeitar a suas páginas para dispositivos móveis</span><span class="sxs-lookup"><span data-stu-id="c6753-308">Configuring Forms Authentication to respect your mobile pages</span></span>

<span data-ttu-id="c6753-309">Se você estiver usando autenticação de formulários, você deve observar que quando um usuário precisa para fazer logon, ele automaticamente redireciona o usuário para uma única "logon" URL específica, que por padrão é **/conta/LogOn**.</span><span class="sxs-lookup"><span data-stu-id="c6753-309">If you're using Forms Authentication, you should note that when a user needs to log in, it automatically redirects the user to a single specific "log on" URL, which by default is **/Account/LogOn**.</span></span> <span data-ttu-id="c6753-310">Isso significa que os usuários móveis podem ser redirecionados para a ação da área de trabalho "fazer logon".</span><span class="sxs-lookup"><span data-stu-id="c6753-310">This means that mobile users may be redirected to your desktop "log on" action.</span></span>

<span data-ttu-id="c6753-311">Para evitar esse problema, adicione lógica para a ação de "logon" da área de trabalho, de modo que ele redireciona os usuários móveis novamente para uma ação de "logon" móvel.</span><span class="sxs-lookup"><span data-stu-id="c6753-311">To avoid this problem, add logic to your desktop "log on" action so that it redirects mobile users again to a mobile "log on" action.</span></span> <span data-ttu-id="c6753-312">Se você estiver usando o modelo de aplicativo do ASP.NET MVC padrão, atualize a ação de LogOn do AccountController da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="c6753-312">If you're using the default ASP.NET MVC application template, update AccountController's LogOn action as follows:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample12.cs)]

<span data-ttu-id="c6753-313">…</span><span class="sxs-lookup"><span data-stu-id="c6753-313">…</span></span> <span data-ttu-id="c6753-314">e, em seguida, implemente uma ação de "logon" específicas para dispositivos móveis adequado em um controlador chamado AccountController em sua área móvel.</span><span class="sxs-lookup"><span data-stu-id="c6753-314">and then implement a suitable mobile-specific "log on" action on a controller called AccountController in your Mobile area.</span></span>

### <a name="working-with-output-caching"></a><span data-ttu-id="c6753-315">Trabalhando com o cache de saída</span><span class="sxs-lookup"><span data-stu-id="c6753-315">Working with Output Caching</span></span>

<span data-ttu-id="c6753-316">Se você estiver usando o filtro [OutputCache], você deve forçar a entrada de cache para variar por tipo de dispositivo.</span><span class="sxs-lookup"><span data-stu-id="c6753-316">If you're using the [OutputCache] filter, you must force the cache entry to vary by device type.</span></span> <span data-ttu-id="c6753-317">Por exemplo, escreva:</span><span class="sxs-lookup"><span data-stu-id="c6753-317">For example, write:</span></span>

[!code-javascript[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample13.js)]

<span data-ttu-id="c6753-318">Em seguida, adicione o seguinte método ao seu arquivo Global.asax.cs:</span><span class="sxs-lookup"><span data-stu-id="c6753-318">Then, add the following method to your Global.asax.cs file:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample14.cs)]

<span data-ttu-id="c6753-319">Isso garantirá que os visitantes por dispositivos móveis para a página não recebem saída colocar previamente no cache por um visitante da área de trabalho.</span><span class="sxs-lookup"><span data-stu-id="c6753-319">This will ensure that mobile visitors to the page don't receive output previously put into the cache by a desktop visitor.</span></span>

### <a name="a-working-example"></a><span data-ttu-id="c6753-320">Um exemplo de trabalho</span><span class="sxs-lookup"><span data-stu-id="c6753-320">A working example</span></span>

<span data-ttu-id="c6753-321">Para ver essas técnicas em ação, baixe [código deste white paper associado exemplos](https://docs.microsoft.com/aspnet/mobile/overview).</span><span class="sxs-lookup"><span data-stu-id="c6753-321">To see these techniques in action, download [this white paper's code associated samples](https://docs.microsoft.com/aspnet/mobile/overview).</span></span> <span data-ttu-id="c6753-322">O exemplo inclui um aplicativo ASP.NET MVC 3 (versão Release Candidate) aprimorado para dar suporte a dispositivos móveis usando os métodos descritos acima.</span><span class="sxs-lookup"><span data-stu-id="c6753-322">The sample includes an ASP.NET MVC 3 (Release Candidate) application enhanced to support mobile devices using the methods described above.</span></span>

## <a name="further-guidance-and-suggestions"></a><span data-ttu-id="c6753-323">Obter mais diretrizes e sugestões</span><span class="sxs-lookup"><span data-stu-id="c6753-323">Further guidance and suggestions</span></span>

<span data-ttu-id="c6753-324">A discussão a seguir se aplica a Web Forms e desenvolvedores MVC que estão usando as técnicas abordadas neste documento.</span><span class="sxs-lookup"><span data-stu-id="c6753-324">The following discussion applies both to Web Forms and MVC developers who are using the techniques covered in this document.</span></span>

### <a name="enhancing-your-redirection-logic-using-51degreesmobi-foundation"></a><span data-ttu-id="c6753-325">Aprimorando sua lógica de redirecionamento usando 51Degrees.mobi Foundation</span><span class="sxs-lookup"><span data-stu-id="c6753-325">Enhancing your redirection logic using 51Degrees.mobi Foundation</span></span>

<span data-ttu-id="c6753-326">A lógica de redirecionamento mostrada neste documento pode ser perfeitamente suficiente para seu aplicativo, mas ele não funcionará se você precisar desabilitar sessões ou com navegadores de dispositivos móveis que rejeitam cookies (eles não podem ter sessões), porque ele não saberá se uma determinada solicitação é o primeiro do que o visitante.</span><span class="sxs-lookup"><span data-stu-id="c6753-326">The redirection logic shown in this document may be perfectly sufficient for your application, but it won't work if you need to disable sessions, or with mobile browsers that reject cookies (these can't have sessions), because it won't know whether a given request is the first one from that visitor.</span></span>

<span data-ttu-id="c6753-327">Você já aprendeu como o código-fonte aberto de 51Degrees.mobi Foundation pode melhorar a precisão do ASP. Detecção de navegador do NET.</span><span class="sxs-lookup"><span data-stu-id="c6753-327">You already learned how the open source 51Degrees.mobi Foundation can improve the accuracy of ASP.NET's browser detection.</span></span> <span data-ttu-id="c6753-328">Ele também tem uma capacidade interna para redirecionar os visitantes por dispositivos móveis em locais específicos configurados em Web. config. Ele é capaz de trabalhar sem dependendo das sessões do ASP.NET (e, portanto, cookies), armazenando um log temporário de hashes de cabeçalhos HTTP e os endereços IP dos visitantes, portanto, ele sabe se cada solicitação é o primeiro de um determinada de visitante.</span><span class="sxs-lookup"><span data-stu-id="c6753-328">It also has a built-in ability to redirect mobile visitors to specific locations configured in Web.config. It's able to work without depending on ASP.NET Sessions (and hence cookies) by storing a temporary log of hashes of visitors' HTTP headers and IP addresses, so it knows whether or not each request is the first one from a given vistor.</span></span>

<span data-ttu-id="c6753-329">O seguinte elemento adicionado à seção fiftyOne do arquivo Web. config será redirecionado para a página, a primeira solicitação de um dispositivo móvel detectado ~ / Mobile/Default.aspx.</span><span class="sxs-lookup"><span data-stu-id="c6753-329">The following element added to the fiftyOne section of the web.config file will redirect the first request from a detected mobile device to the page ~/Mobile/Default.aspx.</span></span> <span data-ttu-id="c6753-330">Todas as solicitações para páginas sob a pasta móvel serão *não* ser redirecionada, independentemente do tipo de dispositivo.</span><span class="sxs-lookup"><span data-stu-id="c6753-330">Any requests to pages under the Mobile folder will *not* be redirected, regardless of device type.</span></span> <span data-ttu-id="c6753-331">Se o dispositivo móvel ficar inativo por um período de 20 minutos ou mais o dispositivo será esquecido e solicitações subsequentes serão tratadas como novos para fins de redirecionamento.</span><span class="sxs-lookup"><span data-stu-id="c6753-331">If the mobile device has been inactive for a period of 20 minutes or more the device will be forgotten and subsequent requests will be treated as new ones for the purposes of redirection.</span></span>

[!code-xml[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample15.xml)]

<span data-ttu-id="c6753-332">Para obter mais detalhes, consulte [51degrees.mobi documentação Foundation](https://github.com/51Degrees/dotNET-Device-Detection).</span><span class="sxs-lookup"><span data-stu-id="c6753-332">For more details, see [51degrees.mobi Foundation documentation](https://github.com/51Degrees/dotNET-Device-Detection).</span></span>

> [!NOTE]
> <span data-ttu-id="c6753-333">Você *pode* recurso de redirecionamento do uso 51Degrees.mobi Foundation em aplicativos ASP.NET MVC, mas você precisará definir sua configuração de redirecionamento em termos de simples URLs, não em termos de parâmetros de roteamento ou colocando os filtros MVC em ações.</span><span class="sxs-lookup"><span data-stu-id="c6753-333">You *can* use 51Degrees.mobi Foundation's redirection feature on ASP.NET MVC applications, but you will need to define your redirection configuration in terms of plain URLs, not in terms of routing parameters or by putting MVC filters on actions.</span></span> <span data-ttu-id="c6753-334">Isso ocorre porque (no momento da gravação) 51Degrees.mobi Foundation não reconhece filtros ou roteamento.</span><span class="sxs-lookup"><span data-stu-id="c6753-334">This is because (at the time of writing) 51Degrees.mobi Foundation does not recognize filters or routing.</span></span>


### <a name="disabling-transcoders-and-proxy-servers"></a><span data-ttu-id="c6753-335">Desabilitando transcodificadores e servidores Proxy</span><span class="sxs-lookup"><span data-stu-id="c6753-335">Disabling Transcoders and Proxy Servers</span></span>

<span data-ttu-id="c6753-336">Operadores de rede móvel tem dois objetivos amplos em sua abordagem para a internet móvel:</span><span class="sxs-lookup"><span data-stu-id="c6753-336">Mobile network operators have two broad objectives in their approach to the mobile internet:</span></span>

1. <span data-ttu-id="c6753-337">Forneça como conteúdo relevante muito possível</span><span class="sxs-lookup"><span data-stu-id="c6753-337">Provide as much relevant content as possible</span></span>
2. <span data-ttu-id="c6753-338">Maximizar o número de clientes que podem compartilhar a largura de banda de rede limitada de rádio</span><span class="sxs-lookup"><span data-stu-id="c6753-338">Maximize the number of customers who can share the limited radio network bandwidth</span></span>

<span data-ttu-id="c6753-339">Uma vez que a maioria das páginas da web foram criados para telas grandes em tamanho da área de trabalho e conexões de banda larga fixo linha rápida, muitos operadores usam *transcodificadores* ou *servidores proxy* que alteram dinamicamente o conteúdo da web.</span><span class="sxs-lookup"><span data-stu-id="c6753-339">Since most web pages were designed for large desktop-sized screens and fast fixed-line broadband connections, many operators use *transcoders* or *proxy servers* that dynamically alter web content.</span></span> <span data-ttu-id="c6753-340">Eles podem modificar sua marcação HTML ou CSS para atender às telas menores (especialmente para "telefones de recurso" que não têm a capacidade de processamento para lidar com layouts complexos), e eles podem recompactar suas imagens (reduzindo significativamente a qualidade) para melhorar as velocidades de entrega de página.</span><span class="sxs-lookup"><span data-stu-id="c6753-340">They may modify your HTML markup or CSS to suit smaller screens (especially for "feature phones" that lack the processing power to handle complex layouts), and they may recompress your images (significantly reducing their quality) to improve page delivery speeds.</span></span>

<span data-ttu-id="c6753-341">Mas se você executou o esforço necessário para produzir uma versão otimizada para celular do seu site, você provavelmente não quer interferir com ele qualquer ainda mais o operador de rede.</span><span class="sxs-lookup"><span data-stu-id="c6753-341">But if you've taken the effort to produce a mobile-optimized version of your site, you probably don't want the network operator to interfere with it any further.</span></span> <span data-ttu-id="c6753-342">Você pode adicionar a seguinte linha para a página\_eventos de carga em qualquer formulário de Web do ASP.NET:</span><span class="sxs-lookup"><span data-stu-id="c6753-342">You can add the following line to the Page\_Load event in any ASP.NET Web Form:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample16.cs)]

<span data-ttu-id="c6753-343">Ou, para um controlador ASP.NET MVC, você pode adicionar a seguinte substituição do método para que ele se aplica a todas as ações nesse controlador:</span><span class="sxs-lookup"><span data-stu-id="c6753-343">Or, for an ASP.NET MVC controller, you could add the following method override so that it applies to all actions on that controller:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample17.cs)]

<span data-ttu-id="c6753-344">A mensagem HTTP resultante informa transcodificadores compatíveis do W3C e proxies não deve alterar o conteúdo.</span><span class="sxs-lookup"><span data-stu-id="c6753-344">The resulting HTTP message informs W3C compliant transcoders and proxies not to alter content.</span></span> <span data-ttu-id="c6753-345">Obviamente, não há nenhuma garantia de que os operadores de rede móvel respeitará essa mensagem.</span><span class="sxs-lookup"><span data-stu-id="c6753-345">Of course, there is no guarantee that mobile network operators will respect this message.</span></span>

### <a name="styling-mobile-pages-for-mobile-browsers"></a><span data-ttu-id="c6753-346">Definir o estilo de páginas para dispositivos móveis para navegadores de dispositivos móveis</span><span class="sxs-lookup"><span data-stu-id="c6753-346">Styling mobile pages for mobile browsers</span></span>

<span data-ttu-id="c6753-347">Ele está além do escopo deste documento descrever em detalhes quais tipos de trabalho de marcação HTML corretamente ou quais técnicas de design da web maximizar a usabilidade em dispositivos específicos.</span><span class="sxs-lookup"><span data-stu-id="c6753-347">It's beyond the scope of this document to describe in great detail what kinds of HTML markup work correctly or which web design techniques maximize usability on particular devices.</span></span> <span data-ttu-id="c6753-348">Ele tem-se para localizar um layout simples suficientemente, otimizado para uma tela de tamanho de celular, sem o uso de não-confiável HTML ou CSS truques de posicionamento.</span><span class="sxs-lookup"><span data-stu-id="c6753-348">It's up to you to find a sufficiently simple layout, optimized for a mobile-sized screen, without using unreliable HTML or CSS positioning tricks.</span></span> <span data-ttu-id="c6753-349">No entanto, é uma técnica importante que vale a pena mencionar, o *marca meta viewport*.</span><span class="sxs-lookup"><span data-stu-id="c6753-349">One important technique worth mentioning, however, is the *viewport meta tag*.</span></span>

<span data-ttu-id="c6753-350">Determinados navegadores móveis modernos, em um esforço exibir as páginas da web para monitores de área de trabalho, renderizarem a página em uma tela de virtual, também chamada de "visor" (por exemplo, o visor virtual é 980 pixels de largura no iPhone e 850 pixels de largura no Opera Mobile por padrão) e, em seguida, Reduza o resultado para caber em pixels físicos da tela.</span><span class="sxs-lookup"><span data-stu-id="c6753-350">Certain modern mobile browsers, in an effort display web pages meant for desktop monitors, render the page on a virtual canvas, also called "viewport" (e.g., the virtual viewport is 980 pixels wide on iPhone, and 850 pixels wide on Opera Mobile by default) and then scale the result down to fit onto the screen's physical pixels.</span></span> <span data-ttu-id="c6753-351">O usuário pode, em seguida, aplicar zoom e panorâmica desse visor.</span><span class="sxs-lookup"><span data-stu-id="c6753-351">The user can then zoom in and pan around that viewport.</span></span> <span data-ttu-id="c6753-352">Isso tem a vantagem que ele permite que o navegador exibir a página em seu layout desejado, mas é também tem a desvantagem de que ela obriga o zoom e panorâmica, que é inconveniente para o usuário.</span><span class="sxs-lookup"><span data-stu-id="c6753-352">This has the advantage that it lets the browser display the page in its intended layout, but it's also has the disadvantage that it forces zooming and panning, which is inconvenient for the user.</span></span> <span data-ttu-id="c6753-353">Se você estiver criando para dispositivos móveis, é melhor design para uma tela de estreita para que nenhuma aplicação de zoom ou de rolagem horizontal é necessário.</span><span class="sxs-lookup"><span data-stu-id="c6753-353">If you're designing for mobile, it's better to design for a narrow screen so that no zooming or horizontal scrolling is necessary.</span></span>

<span data-ttu-id="c6753-354">Uma forma de dizer ao navegador móvel a largura do visor deve ter é por meio de não-padrão *visor* marca meta.</span><span class="sxs-lookup"><span data-stu-id="c6753-354">A way to tell the mobile browser how wide the viewport should be is through the nonstandard *viewport* meta tag.</span></span> <span data-ttu-id="c6753-355">Por exemplo, se você adicionar o seguinte à seção de cabeçalho da sua página,</span><span class="sxs-lookup"><span data-stu-id="c6753-355">For example, if you add the following to your page's HEAD section,</span></span>

[!code-html[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample18.html)]

<span data-ttu-id="c6753-356">…</span><span class="sxs-lookup"><span data-stu-id="c6753-356">…</span></span> <span data-ttu-id="c6753-357">em seguida, dar suporte a navegadores do smartphone irá dispor a página em uma tela de 480 pixels virtual amplos.</span><span class="sxs-lookup"><span data-stu-id="c6753-357">then supporting smartphone browsers will lay out the page on a 480-pixel wide virtual canvas.</span></span> <span data-ttu-id="c6753-358">Isso significa que, se seus elementos HTML definem a largura em termos percentuais, as porcentagens serão interpretadas em relação a esse 480 pixels de largura, não a largura do visor padrão.</span><span class="sxs-lookup"><span data-stu-id="c6753-358">This means that if your HTML elements define their widths in percentage terms, the percentages will be interpreted with respect to this 480-pixel width, not the default viewport width.</span></span> <span data-ttu-id="c6753-359">Como resultado, o usuário é menos propensos a aplique zoom e panorâmica horizontalmente – consideravelmente, melhorando a experiência de navegação móvel.</span><span class="sxs-lookup"><span data-stu-id="c6753-359">As a result, the user is less likely to have to zoom and pan horizontally – considerably improving the mobile browsing experience.</span></span>

<span data-ttu-id="c6753-360">Se você quiser que a largura do visor para corresponder os pixels de física do dispositivo, você pode especificar o seguinte:</span><span class="sxs-lookup"><span data-stu-id="c6753-360">If you want the viewport width to match the device's physical pixels, you can specify the following:</span></span>

[!code-html[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample19.html)]

<span data-ttu-id="c6753-361">Para que isso funcione corretamente, você deve explicitamente forçar elementos exceder essa largura (por exemplo, usando um *largura* atributo ou propriedade CSS), caso contrário, o navegador será forçado a usar um visor maior independentemente.</span><span class="sxs-lookup"><span data-stu-id="c6753-361">For this to work correctly, you must not explicitly force elements to exceed that width (e.g., using a *width* attribute or CSS property), otherwise the browser will be forced to use a larger viewport regardless.</span></span> <span data-ttu-id="c6753-362">Consulte também: [mais detalhes sobre a marca viewport não padrão](https://developer.apple.com/library/safari/#documentation/AppleApplications/Reference/SafariHTMLRef/Articles/MetaTags.html).</span><span class="sxs-lookup"><span data-stu-id="c6753-362">See also: [more details about the nonstandard viewport tag](https://developer.apple.com/library/safari/#documentation/AppleApplications/Reference/SafariHTMLRef/Articles/MetaTags.html).</span></span>

<span data-ttu-id="c6753-363">Suporte a mais modernos smartphones *orientação dupla*: eles podem ser mantidos em modo retrato ou paisagem.</span><span class="sxs-lookup"><span data-stu-id="c6753-363">Most modern smartphones support *dual orientation*: they can be held in either portrait or landscape mode.</span></span> <span data-ttu-id="c6753-364">Portanto, é importante não fazer suposições sobre a largura da tela em pixels.</span><span class="sxs-lookup"><span data-stu-id="c6753-364">So, it's important not to make assumptions about the screen width in pixels.</span></span> <span data-ttu-id="c6753-365">Não mesmo presuma que a largura da tela é fixo, porque o usuário novamente pode orientar seu dispositivo enquanto eles estiverem em sua página.</span><span class="sxs-lookup"><span data-stu-id="c6753-365">Don't even assume that the screen width is fixed, because the user can re-orient their device while they are on your page.</span></span>

<span data-ttu-id="c6753-366">Dispositivos Windows Mobile e Blackberry mais antigos também podem aceitar as seguintes marcas de meta no cabeçalho da página para informá-los conteúdo foi otimizado para dispositivos móveis e, portanto, não devem ser transformados.</span><span class="sxs-lookup"><span data-stu-id="c6753-366">Older Windows Mobile and Blackberry devices may also accept the following meta tags in the page header to inform them content has been optimized for mobile and therefore should not be transformed.</span></span>

[!code-html[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample20.html)]

## <a name="additional-resources"></a><span data-ttu-id="c6753-367">Recursos adicionais</span><span class="sxs-lookup"><span data-stu-id="c6753-367">Additional Resources</span></span>

<span data-ttu-id="c6753-368">Para obter uma lista de emuladores de dispositivos móveis e simuladores, você pode usar para testar seu aplicativo de web móvel ASP.NET, consulte a página [simular dispositivos móveis populares para teste](../mobile/device-simulators.md).</span><span class="sxs-lookup"><span data-stu-id="c6753-368">For a list of mobile device emulators and simulators you can use to test your mobile ASP.NET web application, see the page [Simulate popular mobile devices for testing](../mobile/device-simulators.md).</span></span>

## <a name="credits"></a><span data-ttu-id="c6753-369">Créditos</span><span class="sxs-lookup"><span data-stu-id="c6753-369">Credits</span></span>

- <span data-ttu-id="c6753-370">Autor principal: Steven Sanderson</span><span class="sxs-lookup"><span data-stu-id="c6753-370">Primary author: Steven Sanderson</span></span>
- <span data-ttu-id="c6753-371">Os revisores / adicionais gravadores de conteúdo: James Rosewell, Mikael Söderström, Scott Hanselman, Scott Hunter</span><span class="sxs-lookup"><span data-stu-id="c6753-371">Reviewers / additional content writers: James Rosewell, Mikael Söderström, Scott Hanselman, Scott Hunter</span></span>

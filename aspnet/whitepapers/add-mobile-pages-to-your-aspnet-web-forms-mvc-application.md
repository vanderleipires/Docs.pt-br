---
uid: whitepapers/add-mobile-pages-to-your-aspnet-web-forms-mvc-application
title: "Como: Adicionar páginas móveis aos formulários da Web do ASP.NET / aplicativo MVC | Microsoft Docs"
author: rick-anderson
description: "Esse manual descreve várias maneiras de fornecer páginas otimizadas para dispositivos móveis de sua Web Forms do ASP.NET / aplicativo MVC e sugere arquitetura e..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 01/20/2011
ms.topic: article
ms.assetid: 3124f28e-cc32-418a-afe3-519fa56f4c36
ms.technology: 
ms.prod: .net-framework
msc.legacyurl: /whitepapers/add-mobile-pages-to-your-aspnet-web-forms-mvc-application
msc.type: content
ms.openlocfilehash: c7d893fb9633aaa8628f2f46a8db7f2c09f81830
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 11/10/2017
---
<a name="how-to-add-mobile-pages-to-your-aspnet-web-forms--mvc-application"></a><span data-ttu-id="d4087-103">Como: Adicionar páginas móveis aos formulários da Web do ASP.NET / aplicativo MVC</span><span class="sxs-lookup"><span data-stu-id="d4087-103">How To: Add Mobile Pages to Your ASP.NET Web Forms / MVC Application</span></span>
====================
> <span data-ttu-id="d4087-104">**Aplica-se a**</span><span class="sxs-lookup"><span data-stu-id="d4087-104">**Applies To**</span></span>
> 
> - <span data-ttu-id="d4087-105">Versão de Web Forms do ASP.NET 4.0</span><span class="sxs-lookup"><span data-stu-id="d4087-105">ASP.NET Web Forms version 4.0</span></span>
> - <span data-ttu-id="d4087-106">ASP.NET MVC versão 3.0</span><span class="sxs-lookup"><span data-stu-id="d4087-106">ASP.NET MVC version 3.0</span></span>
> 
> <span data-ttu-id="d4087-107">**Resumo**</span><span class="sxs-lookup"><span data-stu-id="d4087-107">**Summary**</span></span>
> 
> <span data-ttu-id="d4087-108">Esse manual descreve várias maneiras de fornecer páginas otimizadas para dispositivos móveis de sua Web Forms do ASP.NET / aplicativo MVC e sugere arquitetura e design questões a considerar ao direcionar uma ampla variedade de dispositivos.</span><span class="sxs-lookup"><span data-stu-id="d4087-108">This How To describes various ways to serve pages optimized for mobile devices from your ASP.NET Web Forms / MVC application, and suggests architectural and design issues to consider when targeting a broad range of devices.</span></span> <span data-ttu-id="d4087-109">Este documento também explica por que os controles do ASP.NET móvel do ASP.NET 2.0 3.5 agora estão obsoletos e discute algumas alternativas modernas.</span><span class="sxs-lookup"><span data-stu-id="d4087-109">This document also explains why the ASP.NET Mobile Controls from ASP.NET 2.0 to 3.5 are now obsolete, and discusses some modern alternatives.</span></span>


## <a name="contents"></a><span data-ttu-id="d4087-110">Conteúdo</span><span class="sxs-lookup"><span data-stu-id="d4087-110">Contents</span></span>

- <span data-ttu-id="d4087-111">Visão Geral</span><span class="sxs-lookup"><span data-stu-id="d4087-111">Overview</span></span>
- <span data-ttu-id="d4087-112">Opções de arquitetura</span><span class="sxs-lookup"><span data-stu-id="d4087-112">Architectural options</span></span>
- <span data-ttu-id="d4087-113">Detecção de navegadores e dispositivos</span><span class="sxs-lookup"><span data-stu-id="d4087-113">Browser and device detection</span></span>
- <span data-ttu-id="d4087-114">Como os aplicativos ASP.NET Web Forms podem apresentar páginas específicas para dispositivos móveis</span><span class="sxs-lookup"><span data-stu-id="d4087-114">How ASP.NET Web Forms applications can present mobile-specific pages</span></span>
- <span data-ttu-id="d4087-115">Como os aplicativos ASP.NET MVC podem apresentar páginas específicas para dispositivos móveis</span><span class="sxs-lookup"><span data-stu-id="d4087-115">How ASP.NET MVC applications can present mobile-specific pages</span></span>
- <span data-ttu-id="d4087-116">Recursos adicionais</span><span class="sxs-lookup"><span data-stu-id="d4087-116">Additional resources</span></span>

<span data-ttu-id="d4087-117">Para obter exemplos de código para download demonstram técnicas deste white paper Web Forms do ASP.NET e MVC, consulte [Sites com o ASP.NET & aplicativos móveis](https://docs.microsoft.com/aspnet/mobile/overview).</span><span class="sxs-lookup"><span data-stu-id="d4087-117">For downloadable code samples demonstrating this white paper's techniques for both ASP.NET Web Forms and MVC, see [Mobile Apps & Sites with ASP.NET](https://docs.microsoft.com/aspnet/mobile/overview).</span></span>

## <a name="overview"></a><span data-ttu-id="d4087-118">Visão Geral</span><span class="sxs-lookup"><span data-stu-id="d4087-118">Overview</span></span>

<span data-ttu-id="d4087-119">Dispositivos móveis – smartphones, telefones de recurso e tablets – continuam crescendo em popularidade como um meio para acessar a Web.</span><span class="sxs-lookup"><span data-stu-id="d4087-119">Mobile devices – smartphones, feature phones, and tablets – continue to grow in popularity as a means to access the Web.</span></span> <span data-ttu-id="d4087-120">Para muitas empresas para a web e os desenvolvedores da web, isso significa que é cada vez mais importante fornecer uma ótima experiência de navegação para os visitantes que usam esses dispositivos.</span><span class="sxs-lookup"><span data-stu-id="d4087-120">For many web developers and web-oriented businesses, this means it's increasingly important to provide a great browsing experience for visitors using those devices.</span></span>

### <a name="how-earlier-versions-of-aspnet-supported-mobile-browsers"></a><span data-ttu-id="d4087-121">Como as versões do ASP.NET suporte para navegadores de dispositivos móveis</span><span class="sxs-lookup"><span data-stu-id="d4087-121">How earlier versions of ASP.NET supported mobile browsers</span></span>

<span data-ttu-id="d4087-122">Versões do ASP.NET 2.0 para 3.5 incluídos *os controles ASP.NET*: um conjunto de controles de servidor para dispositivos móveis no *System.Web.Mobile.dll* assembly e o  *MobileControls* namespace.</span><span class="sxs-lookup"><span data-stu-id="d4087-122">ASP.NET versions 2.0 to 3.5 included *ASP.NET Mobile Controls*: a set of server controls for mobile devices in the *System.Web.Mobile.dll* assembly and the *System.Web.UI.MobileControls* namespace.</span></span> <span data-ttu-id="d4087-123">O assembly ainda está incluído no ASP.NET 4, mas ela foi preterida.</span><span class="sxs-lookup"><span data-stu-id="d4087-123">The assembly is still included in ASP.NET 4, but it is deprecated.</span></span> <span data-ttu-id="d4087-124">Os desenvolvedores são aconselhados a migrar para abordagens mais modernas, como as descritas neste documento.</span><span class="sxs-lookup"><span data-stu-id="d4087-124">Developers are advised to migrate to more modern approaches, such as those described in this paper.</span></span>

<span data-ttu-id="d4087-125">O motivo por que os controles ASP.NET foram marcados como obsoletos é que seu design é voltado para os telefones celulares que eram comuns em torno de 2005 e versões anteriores.</span><span class="sxs-lookup"><span data-stu-id="d4087-125">The reason why ASP.NET Mobile Controls have been marked as obsolete is that their design is oriented around the mobile phones that were common around 2005 and earlier.</span></span> <span data-ttu-id="d4087-126">Os controles são projetados principalmente para renderizar marcação WML ou cHTML (em vez de HTML regular) para os navegadores WAP do que era.</span><span class="sxs-lookup"><span data-stu-id="d4087-126">The controls are mainly designed to render WML or cHTML markup (instead of regular HTML) for the WAP browsers of that era.</span></span> <span data-ttu-id="d4087-127">Mas, WAP e WML cHTML não são mais relevantes para a maioria dos projetos, porque o HTML tornou a linguagem de marcação onipresente para navegadores de desktop e móveis da mesma forma.</span><span class="sxs-lookup"><span data-stu-id="d4087-127">But WAP, WML, and cHTML are no longer relevant for most projects, because HTML has now become the ubiquitous markup language for mobile and desktop browsers alike.</span></span>

### <a name="the-challenges-of-supporting-mobile-devices-today"></a><span data-ttu-id="d4087-128">Os desafios de oferecer suporte a dispositivos móveis hoje</span><span class="sxs-lookup"><span data-stu-id="d4087-128">The challenges of supporting mobile devices today</span></span>

<span data-ttu-id="d4087-129">Embora navegadores móveis agora quase universalmente oferecem suporte a HTML, você ainda enfrentará muitos desafios quando o objetivo de criar grandes experiências de navegação móveis:</span><span class="sxs-lookup"><span data-stu-id="d4087-129">Even though mobile browsers now almost universally support HTML, you will still face many challenges when aiming to create great mobile browsing experiences:</span></span>

- <span data-ttu-id="d4087-130">***Tamanho da tela*** - dispositivos móveis variam muito no formulário e suas telas são geralmente muito menor do que os monitores de área de trabalho.</span><span class="sxs-lookup"><span data-stu-id="d4087-130">***Screen size*** - Mobile devices vary dramatically in form, and their screens are often much smaller than desktop monitors.</span></span> <span data-ttu-id="d4087-131">Portanto, talvez seja necessário criar layouts de página completamente diferente para eles.</span><span class="sxs-lookup"><span data-stu-id="d4087-131">So, you may need to design completely different page layouts for them.</span></span>
- <span data-ttu-id="d4087-132">***Métodos de entrada*** – alguns dispositivos têm teclados numéricos, algumas têm styluses, outros usam toque.</span><span class="sxs-lookup"><span data-stu-id="d4087-132">***Input methods*** – Some devices have keypads, some have styluses, others use touch.</span></span> <span data-ttu-id="d4087-133">Talvez seja necessário considerar navegação com vários métodos de entrada de mecanismos e os dados.</span><span class="sxs-lookup"><span data-stu-id="d4087-133">You may need to consider multiple navigation mechanisms and data input methods.</span></span>
- <span data-ttu-id="d4087-134">***Conformidade com padrões*** – muitos navegadores móveis não oferecem suporte para os padrões mais recentes de HTML, CSS ou JavaScript.</span><span class="sxs-lookup"><span data-stu-id="d4087-134">***Standards compliance*** – Many mobile browsers do not support the latest HTML, CSS, or JavaScript standards.</span></span>
- <span data-ttu-id="d4087-135">***Largura de banda*** – desempenho de rede de dados de celular varia muito, e alguns usuários finais estiver em tarifas cobram por megabytes.</span><span class="sxs-lookup"><span data-stu-id="d4087-135">***Bandwidth*** – Cellular data network performance varies wildly, and some end users are on tariffs that charge by the megabyte.</span></span>

<span data-ttu-id="d4087-136">Não há nenhuma solução padronizada; seu aplicativo terá a aparência e se comportam diferentemente, de acordo com o dispositivo acessá-lo.</span><span class="sxs-lookup"><span data-stu-id="d4087-136">There's no one-size-fits-all solution; your application will have to look and behave differently according to the device accessing it.</span></span> <span data-ttu-id="d4087-137">Dependendo de qual nível de suporte móvel que você deseja, isso pode ser um desafio maior para desenvolvedores da web de área de trabalho "conflitos de navegador" nunca foi.</span><span class="sxs-lookup"><span data-stu-id="d4087-137">Depending on what level of mobile support you want, this can be a bigger challenge for web developers than the desktop "browser wars" ever was.</span></span>

<span data-ttu-id="d4087-138">Os desenvolvedores se aproximando de suporte do navegador móvel pela primeira vez geralmente inicialmente que só é importante dar suporte a smartphones mais sofisticados e mais recentes (por exemplo, Windows Phone 7, iPhone ou Android), talvez porque os desenvolvedores geralmente pessoal possuem como dispositivos.</span><span class="sxs-lookup"><span data-stu-id="d4087-138">Developers approaching mobile browser support for the first time often initially think it's only important to support the latest and most sophisticated smartphones (e.g., Windows Phone 7, iPhone, or Android), perhaps because developers often personally own such devices.</span></span> <span data-ttu-id="d4087-139">No entanto, telefones mais baratos ainda são extremamente populares e seus proprietários usá-los para navegar na web – especialmente em países em que os telefones celulares são mais fácil de obter que uma conexão de banda larga.</span><span class="sxs-lookup"><span data-stu-id="d4087-139">However, cheaper phones are still extremely popular, and their owners do use them to browse the web – especially in countries where mobile phones are easier to get than a broadband connection.</span></span> <span data-ttu-id="d4087-140">Sua empresa precisa decidir quais variedade de dispositivos para dar suporte ao considerar a seus clientes provavelmente.</span><span class="sxs-lookup"><span data-stu-id="d4087-140">Your business will need to decide what range of devices to support by considering its likely customers.</span></span> <span data-ttu-id="d4087-141">Se você estiver criando uma publicação online para um spa de integridade de luxo, pode tomar uma decisão de negócios apenas para smartphones avançados, de destino enquanto se você estiver criando um sistema de reserva do tíquete para um cinema, você provavelmente precisa levar em conta os visitantes com recurso menos avançado telefones.</span><span class="sxs-lookup"><span data-stu-id="d4087-141">If you're building an online brochure for a luxury health spa, you might make a business decision only to target advanced smartphones, whereas if you're creating a ticket booking system for a cinema, you probably need to account for visitors with less powerful feature phones.</span></span>

## <a name="architectural-options"></a><span data-ttu-id="d4087-142">Opções de arquitetura</span><span class="sxs-lookup"><span data-stu-id="d4087-142">Architectural options</span></span>

<span data-ttu-id="d4087-143">Antes de entrarmos em detalhes técnicos específicos do Web Forms do ASP.NET ou MVC, observe que os desenvolvedores da web em geral tem três opções possíveis principais para dar suporte a navegadores móveis:</span><span class="sxs-lookup"><span data-stu-id="d4087-143">Before we get to the specific technical details of ASP.NET Web Forms or MVC, note that web developers in general have three main possible options for supporting mobile browsers:</span></span>

1. <span data-ttu-id="d4087-144">***Não fazer nada –*** você pode simplesmente criar um aplicativo web padrão e orientada a área de trabalho e se baseiam em navegadores de dispositivos móveis para renderizá-lo de forma aceitável.</span><span class="sxs-lookup"><span data-stu-id="d4087-144">***Do nothing –*** You can simply create a standard, desktop-oriented web application, and rely on mobile browsers to render it acceptably.</span></span> 

    - <span data-ttu-id="d4087-145">**Vantagem**: é a opção mais barato de implementar e manter – extra não funcionam</span><span class="sxs-lookup"><span data-stu-id="d4087-145">**Advantage**: It's the cheapest option to implement and maintain – no extra work</span></span>
    - <span data-ttu-id="d4087-146">**Desvantagem**: fornece a experiência do usuário final pior:</span><span class="sxs-lookup"><span data-stu-id="d4087-146">**Disadvantage**: Gives the worst end-user experience:</span></span> 

        - <span data-ttu-id="d4087-147">Os smartphones mais recente pode renderizar HTML, bem como um navegador de área de trabalho, mas os usuários ainda serão forçados zoom e rolar horizontalmente e verticalmente para consumir o conteúdo em uma tela pequena.</span><span class="sxs-lookup"><span data-stu-id="d4087-147">The latest smartphones may render your HTML just as well as a desktop browser, but users will still be forced to zoom and scroll horizontally and vertically to consume your content on a small screen.</span></span> <span data-ttu-id="d4087-148">Isso é bem inferior a ideal.</span><span class="sxs-lookup"><span data-stu-id="d4087-148">This is far from optimal.</span></span>
        - <span data-ttu-id="d4087-149">Telefones de recurso e dispositivos mais antigos podem falhar ao renderizar a marcação de forma satisfatória.</span><span class="sxs-lookup"><span data-stu-id="d4087-149">Older devices and feature phones may fail to render your markup in a satisfactory way.</span></span>
        - <span data-ttu-id="d4087-150">Mesmo em dispositivos tablet mais recentes (cujas telas podem ser tão grandes como telas de laptop), interação diferentes regras se aplicam.</span><span class="sxs-lookup"><span data-stu-id="d4087-150">Even on the latest tablet devices (whose screens can be as big as laptop screens), different interaction rules apply.</span></span> <span data-ttu-id="d4087-151">Toque de entrada funciona melhor com os botões maiores e vincula a visualização mais separa e não é possível passar o cursor de um cursor do mouse sobre um menu suspenso.</span><span class="sxs-lookup"><span data-stu-id="d4087-151">Touch-based input works best with larger buttons and links spread further apart, and there's no way to hover a mouse cursor over a fly-out menu.</span></span>
2. <span data-ttu-id="d4087-152">***Resolver o problema no cliente* –** com uso cuidadoso de CSS e [aprimoramento progressivo](http://en.wikipedia.org/wiki/Progressive_enhancement) você pode criar marcação, estilos e scripts que se adaptar a qualquer navegador está executando.</span><span class="sxs-lookup"><span data-stu-id="d4087-152">***Solve the problem on the client* –** With careful use of CSS and [progressive enhancement](http://en.wikipedia.org/wiki/Progressive_enhancement) you can create markup, styles, and scripts that adapt to whatever browser is running them.</span></span> <span data-ttu-id="d4087-153">Por exemplo, com [as consultas de mídia CSS 3](http://www.w3.org/TR/2010/CR-css3-mediaqueries-20100727/), você pode criar um layout de várias coluna que se transforma em um layout de coluna única em dispositivos cujas telas estão mais estreitas do que um limite determinado.</span><span class="sxs-lookup"><span data-stu-id="d4087-153">For example, with [CSS 3 media queries](http://www.w3.org/TR/2010/CR-css3-mediaqueries-20100727/), you could create a multi-column layout that turns into a single column layout on devices whose screens are narrower than a chosen threshold.</span></span> 

    - <span data-ttu-id="d4087-154">**Vantagem**: otimiza o processamento para o dispositivo específico em uso, mesmo para os dispositivos futuras desconhecidos acordo com qualquer tela e características de entrada tiverem</span><span class="sxs-lookup"><span data-stu-id="d4087-154">**Advantage**: Optimizes rendering for the specific device in use, even for unknown future devices according to whatever screen and input characteristics they have</span></span>
    - <span data-ttu-id="d4087-155">**Vantagem**: facilmente permite que você compartilhe lógica do lado do servidor em todos os tipos de dispositivo – eliminação de duplicação mínimo de esforço ou de código</span><span class="sxs-lookup"><span data-stu-id="d4087-155">**Advantage**: Easily lets you share server-side logic across all device types – minimal duplication of code or effort</span></span>
    - <span data-ttu-id="d4087-156">**Desvantagem**: dispositivos móveis são tão diferentes de dispositivos de área de trabalho que pode realmente deseja que suas páginas móveis seja completamente diferente de suas páginas da área de trabalho, mostrando informações diferentes.</span><span class="sxs-lookup"><span data-stu-id="d4087-156">**Disadvantage**: Mobile devices are so different from desktop devices that you may really want your mobile pages to be completely different from your desktop pages, showing different information.</span></span> <span data-ttu-id="d4087-157">Essas variações podem ser ineficientes ou impossível robustez por meio de CSS sozinho, especialmente considerando como inconsistente dispositivos mais antigos interpretam as regras de CSS.</span><span class="sxs-lookup"><span data-stu-id="d4087-157">Such variations can be inefficient or impossible to achieve robustly through CSS alone, especially considering how inconsistently older devices interpret CSS rules.</span></span> <span data-ttu-id="d4087-158">Isso é particularmente verdadeiro de atributos de CSS 3.</span><span class="sxs-lookup"><span data-stu-id="d4087-158">This is particularly true of CSS 3 attributes.</span></span>
    - <span data-ttu-id="d4087-159">**Desvantagem**: não fornece suporte para fluxos de trabalho para diferentes dispositivos e lógica de servidor diferentes.</span><span class="sxs-lookup"><span data-stu-id="d4087-159">**Disadvantage**: Provides no support for varying server-side logic and workflows for different devices.</span></span> <span data-ttu-id="d4087-160">Você não pode, por exemplo, implementar um simplificado compras carrinho check-out fluxo de trabalho para usuários móveis por meio de CSS sozinho.</span><span class="sxs-lookup"><span data-stu-id="d4087-160">You can't, for example, implement a simplified shopping cart checkout workflow for mobile users by means of CSS alone.</span></span>
    - <span data-ttu-id="d4087-161">**Desvantagem**: uso de largura de banda ineficiente.</span><span class="sxs-lookup"><span data-stu-id="d4087-161">**Disadvantage**: Inefficient bandwidth use.</span></span> <span data-ttu-id="d4087-162">Servidor você pode ter que transmitir a marcação e estilos que se aplicam a todos os dispositivos possíveis, mesmo que o dispositivo de destino usará apenas um subconjunto dessas informações.</span><span class="sxs-lookup"><span data-stu-id="d4087-162">You server may have to transmit the markup and styles that apply to all possible devices, even though the target device will only use a subset of that information.</span></span>
3. <span data-ttu-id="d4087-163">***Resolver o problema no servidor* –** se o servidor sabe qual dispositivo está acessando – ou pelo menos as características do dispositivo, tais como o tamanho da tela e o método de entrada, e se ele é um dispositivo móvel – pode executar uma lógica diferente e marcação HTML diferente de saída.</span><span class="sxs-lookup"><span data-stu-id="d4087-163">***Solve the problem on the server* –** If your server knows what device is accessing it – or at least the characteristics of that device, such as its screen size and input method, and whether it's a mobile device – it can run different logic and output different HTML markup.</span></span> 

    - <span data-ttu-id="d4087-164">**Vantagem:** flexibilidade máxima.</span><span class="sxs-lookup"><span data-stu-id="d4087-164">**Advantage:** Maximum flexibility.</span></span> <span data-ttu-id="d4087-165">Não há nenhum limite quanto você pode variar a lógica do lado do servidor para celulares ou otimizar sua marcação para o layout desejado, específico do dispositivo.</span><span class="sxs-lookup"><span data-stu-id="d4087-165">There's no limit to how much you can vary your server-side logic for mobiles or optimize your markup for the desired, device-specific layout.</span></span>
    - <span data-ttu-id="d4087-166">**Vantagem:** uso eficiente da largura de banda.</span><span class="sxs-lookup"><span data-stu-id="d4087-166">**Advantage:** Efficient bandwidth use.</span></span> <span data-ttu-id="d4087-167">Você só precisar transmitir a marcação e informações de estilo que irá usar o dispositivo de destino.</span><span class="sxs-lookup"><span data-stu-id="d4087-167">You only need to transmit the markup and styling information that the target device is going to use.</span></span>
    - <span data-ttu-id="d4087-168">**A desvantagem:** às vezes força a repetição de esforço ou de código (por exemplo, fazer com que você crie cópias semelhantes, mas um pouco diferentes de suas páginas de Web Forms ou exibições do MVC).</span><span class="sxs-lookup"><span data-stu-id="d4087-168">**Disadvantage:** Sometimes forces repetition of effort or code (e.g., making you create similar but slightly different copies of your Web Forms pages or MVC views).</span></span> <span data-ttu-id="d4087-169">Onde possível que você serão fatorados lógica comuns em uma camada subjacente ou serviço, mas ainda assim, algumas partes do seu código de interface do usuário ou a marcação talvez precise ser duplicado e, em seguida, são mantidas em paralelo.</span><span class="sxs-lookup"><span data-stu-id="d4087-169">Where possible you will factor out common logic into an underlying layer or service, but still, some parts of your UI code or markup may have to be duplicated and then maintained in parallel.</span></span>
    - <span data-ttu-id="d4087-170">**A desvantagem:** detecção do dispositivo não é algo trivial.</span><span class="sxs-lookup"><span data-stu-id="d4087-170">**Disadvantage:** Device detection is not trivial.</span></span> <span data-ttu-id="d4087-171">Ele requer uma lista ou banco de dados de tipos de dispositivo conhecido e suas características (que podem não ser perfeitamente atualizadas) e não é garantido para corresponder com precisão de cada solicitação de entrada.</span><span class="sxs-lookup"><span data-stu-id="d4087-171">It requires a list or database of known device types and their characteristics (which may not always be perfectly up-to-date) and isn't guaranteed to accurately match every incoming request.</span></span> <span data-ttu-id="d4087-172">Este documento descreve algumas opções e suas armadilhas mais tarde.</span><span class="sxs-lookup"><span data-stu-id="d4087-172">This document describes some options and their pitfalls later.</span></span>

<span data-ttu-id="d4087-173">Para obter os melhores resultados, a maioria dos desenvolvedores localizar que precisam para combinar opções (2) e (3).</span><span class="sxs-lookup"><span data-stu-id="d4087-173">To get the best results, most developers find they need to combine options (2) and (3).</span></span> <span data-ttu-id="d4087-174">Pequenas diferenças estilos são melhor acomodadas no cliente usando CSS ou JavaScript mesmo, enquanto as principais diferenças de dados, fluxo de trabalho ou marcação com mais eficácia são implementadas no código do lado do servidor.</span><span class="sxs-lookup"><span data-stu-id="d4087-174">Minor stylistic differences are best accommodated on the client using CSS or even JavaScript, whereas major differences in data, workflow, or markup are most effectively implemented in server-side code.</span></span>

### <a name="this-paper-focuses-on-server-side-techniques"></a><span data-ttu-id="d4087-175">Este documento se concentra em técnicas do lado do servidor</span><span class="sxs-lookup"><span data-stu-id="d4087-175">This paper focuses on server-side techniques</span></span>

<span data-ttu-id="d4087-176">Como Web Forms do ASP.NET e MVC são ambas as tecnologias principalmente no lado do servidor, este white paper se concentrará em técnicas do lado do servidor que permitem que você gerar marcação diferente e lógica para navegadores de dispositivos móveis.</span><span class="sxs-lookup"><span data-stu-id="d4087-176">Since ASP.NET Web Forms and MVC are both primarily server-side technologies, this white paper will focus on server-side techniques that let you produce different markup and logic for mobile browsers.</span></span> <span data-ttu-id="d4087-177">Naturalmente, você também pode combinar isso com qualquer técnica do lado do cliente (por exemplo, CSS 3 consultas de mídia, aprimoramento progressivo JavaScript), mas é mais uma questão de design da web de desenvolvimento do ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="d4087-177">Of course, you can also combine this with any client-side technique (e.g., CSS 3 media queries, progressive-enhancement JavaScript), but that's more a matter of web design than ASP.NET development.</span></span>

## <a name="browser-and-device-detection"></a><span data-ttu-id="d4087-178">Detecção de navegadores e dispositivos</span><span class="sxs-lookup"><span data-stu-id="d4087-178">Browser and device detection</span></span>

<span data-ttu-id="d4087-179">O pré-requisito de chave para todas as técnicas do lado do servidor para dar suporte a dispositivos móveis é saber qual dispositivo está usando o visitante.</span><span class="sxs-lookup"><span data-stu-id="d4087-179">The key prerequisite for all server-side techniques for supporting mobile devices is to know what device your visitor is using.</span></span> <span data-ttu-id="d4087-180">Na verdade, ainda melhor do que saber o número de modelo e fabricante do dispositivo é saber a *características* do dispositivo.</span><span class="sxs-lookup"><span data-stu-id="d4087-180">In fact, even better than knowing the manufacturer and model number of that device is knowing the *characteristics* of the device.</span></span> <span data-ttu-id="d4087-181">Características podem incluir:</span><span class="sxs-lookup"><span data-stu-id="d4087-181">Characteristics may include:</span></span>

- <span data-ttu-id="d4087-182">É um dispositivo móvel?</span><span class="sxs-lookup"><span data-stu-id="d4087-182">Is it a mobile device?</span></span>
- <span data-ttu-id="d4087-183">Método de entrada (teclado/mouse, toque, teclado, joystick,...)</span><span class="sxs-lookup"><span data-stu-id="d4087-183">Input method (mouse/keyboard, touch, keypad, joystick, …)</span></span>
- <span data-ttu-id="d4087-184">Tamanho da tela (fisicamente e em pixels)</span><span class="sxs-lookup"><span data-stu-id="d4087-184">Screen size (physically and in pixels)</span></span>
- <span data-ttu-id="d4087-185">Formatos de mídia e dados com suporte</span><span class="sxs-lookup"><span data-stu-id="d4087-185">Supported media and data formats</span></span>
- <span data-ttu-id="d4087-186">etc.</span><span class="sxs-lookup"><span data-stu-id="d4087-186">Etc.</span></span>

<span data-ttu-id="d4087-187">É melhor tomar decisões com base em características que o número de modelo, porque, em seguida, será melhor equipados para lidar com dispositivos futuras.</span><span class="sxs-lookup"><span data-stu-id="d4087-187">It's better to make decisions based on characteristics than model number, because then you'll be better equipped to handle future devices.</span></span>

### <a name="using-aspnets-built-in-browser-detection-support"></a><span data-ttu-id="d4087-188">Usando ASP. Suporte de detecção do navegador interno do NET</span><span class="sxs-lookup"><span data-stu-id="d4087-188">Using ASP.NET's built-in browser detection support</span></span>

<span data-ttu-id="d4087-189">Os desenvolvedores do ASP.NET Web Forms e MVC imediatamente podem descobrir características importantes de um navegador visitando inspecionando propriedades do *Request. browser* objeto.</span><span class="sxs-lookup"><span data-stu-id="d4087-189">ASP.NET Web Forms and MVC developers can immediately discover important characteristics of a visiting browser by inspecting properties of the *Request.Browser* object.</span></span> <span data-ttu-id="d4087-190">Por exemplo, consulte</span><span class="sxs-lookup"><span data-stu-id="d4087-190">For example, see</span></span>

- <span data-ttu-id="d4087-191">Request.Browser.IsMobileDevice</span><span class="sxs-lookup"><span data-stu-id="d4087-191">Request.Browser.IsMobileDevice</span></span>
- <span data-ttu-id="d4087-192">Request.Browser.MobileDeviceManufacturer, Request.Browser.MobileDeviceModel</span><span class="sxs-lookup"><span data-stu-id="d4087-192">Request.Browser.MobileDeviceManufacturer, Request.Browser.MobileDeviceModel</span></span>
- <span data-ttu-id="d4087-193">Request.Browser.ScreenPixelsWidth</span><span class="sxs-lookup"><span data-stu-id="d4087-193">Request.Browser.ScreenPixelsWidth</span></span>
- <span data-ttu-id="d4087-194">Request.Browser.SupportsXmlHttp</span><span class="sxs-lookup"><span data-stu-id="d4087-194">Request.Browser.SupportsXmlHttp</span></span>
- <span data-ttu-id="d4087-195">... e muitos outros</span><span class="sxs-lookup"><span data-stu-id="d4087-195">…and many others</span></span>

<span data-ttu-id="d4087-196">Nos bastidores, a plataforma ASP.NET corresponde a entrada *User-Agent* cabeçalho HTTP (UA) em expressões regulares em um conjunto de arquivos XML de definição do navegador.</span><span class="sxs-lookup"><span data-stu-id="d4087-196">Behind the scenes, the ASP.NET platform matches the incoming *User-Agent* (UA) HTTP header against regular expressions in a set of Browser Definition XML files.</span></span> <span data-ttu-id="d4087-197">Por padrão, a plataforma inclui definições para muitos dispositivos móveis comuns, e você pode adicionar arquivos de definição de navegador personalizados para outras pessoas que você deseja reconhecer.</span><span class="sxs-lookup"><span data-stu-id="d4087-197">By default the platform includes definitions for many common mobile devices, and you can add custom Browser Definition files for others you wish to recognize.</span></span> <span data-ttu-id="d4087-198">Para obter mais detalhes, consulte a página do MSDN [controles de servidor Web ASP.NET e recursos do navegador](https://msdn.microsoft.com/en-us/library/x3k2ssx2.aspx).</span><span class="sxs-lookup"><span data-stu-id="d4087-198">For more details, see the MSDN page [ASP.NET Web Server Controls and Browser Capabilities](https://msdn.microsoft.com/en-us/library/x3k2ssx2.aspx).</span></span>

### <a name="using-the-wurfl-device-database-via-51degreesmobi-foundation"></a><span data-ttu-id="d4087-199">Usando o banco de dados do dispositivo WURFL via 51Degrees.mobi Foundation</span><span class="sxs-lookup"><span data-stu-id="d4087-199">Using the WURFL device database via 51Degrees.mobi Foundation</span></span>

<span data-ttu-id="d4087-200">Enquanto o ASP. Suporte de detecção do navegador interno do NET será suficiente para muitos aplicativos, há dois principais casos em que talvez não seja suficiente:</span><span class="sxs-lookup"><span data-stu-id="d4087-200">While ASP.NET's built-in browser detection support will be sufficient for many applications, there are two main cases when it might not be enough:</span></span>

- <span data-ttu-id="d4087-201">***Você deseja reconhecer os dispositivos mais recentes***(sem criar manualmente os arquivos de definição de navegador para eles).</span><span class="sxs-lookup"><span data-stu-id="d4087-201">***You want to recognize the latest devices***(without manually creating Browser Definition files for them).</span></span> <span data-ttu-id="d4087-202">Observe que os arquivos de definição de navegador do .NET 4 não são recentes o suficiente para reconhecer Apple iPads, telefones Android, navegadores Opera Mobile ou Windows Phone 7.</span><span class="sxs-lookup"><span data-stu-id="d4087-202">Note that .NET 4's Browser Definition files are not recent enough to recognize Windows Phone 7, Android phones, Opera Mobile browsers, or Apple iPads.</span></span>
- <span data-ttu-id="d4087-203">***Você precisa obter informações mais detalhadas sobre os recursos do dispositivo***.</span><span class="sxs-lookup"><span data-stu-id="d4087-203">***You need more detailed information about device capabilities***.</span></span> <span data-ttu-id="d4087-204">Você precisará saber sobre o método de entrada do dispositivo (por exemplo, toque vs teclado) ou o áudio formata o navegador oferece suporte.</span><span class="sxs-lookup"><span data-stu-id="d4087-204">You may need to know about a device's input method (e.g., touch vs keypad), or what audio formats the browser supports.</span></span> <span data-ttu-id="d4087-205">Essas informações não estão disponíveis nos arquivos de definição de navegador padrão.</span><span class="sxs-lookup"><span data-stu-id="d4087-205">This information isn't available in the standard Browser Definition files.</span></span>

<span data-ttu-id="d4087-206">O [ *arquivo de recurso Universal sem fio* projeto (WURFL)](http://wurfl.sourceforge.net/) mantém muito mais informações atualizadas e detalhadas sobre dispositivos móveis em uso hoje.</span><span class="sxs-lookup"><span data-stu-id="d4087-206">The [*Wireless Universal Resource File* (WURFL) project](http://wurfl.sourceforge.net/) maintains much more up-to-date and detailed information about mobile devices in use today.</span></span>

<span data-ttu-id="d4087-207">A boa notícia para desenvolvedores .NET é que o ASP. Recurso de detecção do navegador do NET é extensível, portanto, é possível aprimorá-lo para solucionar esses problemas.</span><span class="sxs-lookup"><span data-stu-id="d4087-207">The great news for .NET developers is that ASP.NET's browser detection feature is extensible, so it's possible to enhance it to overcome these problems.</span></span> <span data-ttu-id="d4087-208">Por exemplo, você pode adicionar código-fonte aberto [ *51Degrees.mobi Foundation* ](https://github.com/51Degrees/dotNET-Device-Detection) biblioteca ao seu projeto.</span><span class="sxs-lookup"><span data-stu-id="d4087-208">For example, you can add the open source [*51Degrees.mobi Foundation*](https://github.com/51Degrees/dotNET-Device-Detection) library to your project.</span></span> <span data-ttu-id="d4087-209">É um IHttpModule do ASP.NET ou um navegador recursos de provedor (pode ser usado em aplicativos Web Forms e MVC), que lê dados WURFL diretamente e conecta à ASP. Mecanismo de detecção do navegador interno do NET.</span><span class="sxs-lookup"><span data-stu-id="d4087-209">It's an ASP.NET IHttpModule or Browser Capabilities Provider (usable on both Web Forms and MVC applications), that directly reads WURFL data and hooks it into ASP.NET's built-in browser detection mechanism.</span></span> <span data-ttu-id="d4087-210">Depois de instalar o módulo *Request. browser* repentinamente conterá informações detalhadas e muito mais precisas: ele corretamente reconhecerá muitos dispositivos mencionados anteriormente e lista seus recursos (incluindo recursos adicionais, como o método de entrada).</span><span class="sxs-lookup"><span data-stu-id="d4087-210">Once you've installed the module, *Request.Browser* will suddenly contain a lot more accurate and detailed information: it will correctly recognize many of the devices previously mentioned and list their capabilities (including additional capabilities such as input method).</span></span> <span data-ttu-id="d4087-211">Consulte a documentação do projeto para obter mais detalhes.</span><span class="sxs-lookup"><span data-stu-id="d4087-211">See the project's documentation for more details.</span></span>

## <a name="how-web-forms-applications-can-present-mobile-specific-pages"></a><span data-ttu-id="d4087-212">Como os aplicativos Web Forms podem apresentar páginas específicas para dispositivos móveis</span><span class="sxs-lookup"><span data-stu-id="d4087-212">How Web Forms applications can present mobile-specific pages</span></span>

<span data-ttu-id="d4087-213">Por padrão, aqui está como um novo aplicativo de Web Forms são exibidos em dispositivos móveis comuns:</span><span class="sxs-lookup"><span data-stu-id="d4087-213">By default, here's how a brand new Web Forms application displays on common mobile devices:</span></span>

![](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/_static/image1.png)

<span data-ttu-id="d4087-214">Obviamente, nem layout parece muito amigáveis para dispositivos móveis – esta página foi projetada para um monitor grande, com orientação paisagem, não para uma tela pequena orientadas por retrato.</span><span class="sxs-lookup"><span data-stu-id="d4087-214">Clearly, neither layout looks very mobile-friendly – this page was designed for a large, landscape-oriented monitor, not for a small portrait-oriented screen.</span></span> <span data-ttu-id="d4087-215">Então o que você pode fazer sobre ele?</span><span class="sxs-lookup"><span data-stu-id="d4087-215">So what can you do about it?</span></span>

<span data-ttu-id="d4087-216">Como discutido neste documento, há muitas maneiras de personalizar as páginas para dispositivos móveis.</span><span class="sxs-lookup"><span data-stu-id="d4087-216">As discussed earlier in this paper, there are many ways to tailor your pages for mobile devices.</span></span> <span data-ttu-id="d4087-217">Algumas técnicas são baseados em servidor, outras pessoas executam no cliente.</span><span class="sxs-lookup"><span data-stu-id="d4087-217">Some techniques are server-based, others run on the client.</span></span>

### <a name="creating-a-mobile-specific-master-page"></a><span data-ttu-id="d4087-218">Criando uma página mestra específicas para dispositivos móveis</span><span class="sxs-lookup"><span data-stu-id="d4087-218">Creating a mobile-specific master page</span></span>

<span data-ttu-id="d4087-219">Dependendo dos requisitos, você poderá usar os mesmos formulários da Web para todos os visitantes, mas tem duas páginas mestras separadas: uma para os visitantes de área de trabalho, outro para os visitantes móveis.</span><span class="sxs-lookup"><span data-stu-id="d4087-219">Depending on your requirements, you may be able to use the same Web Forms for all visitors, but have two separate master pages: one for desktop visitors, another for mobile visitors.</span></span> <span data-ttu-id="d4087-220">Isso oferece a flexibilidade de alterar sua marcação HTML nível superior de acordo com os dispositivos móveis, sem forçar duplicar qualquer lógica de página ou de folha de estilos CSS.</span><span class="sxs-lookup"><span data-stu-id="d4087-220">This gives you the flexibility of changing the CSS stylesheet or your top-level HTML markup to suit mobile devices, without forcing you to duplicate any page logic.</span></span>

<span data-ttu-id="d4087-221">Isso é fácil.</span><span class="sxs-lookup"><span data-stu-id="d4087-221">This is easy to do.</span></span> <span data-ttu-id="d4087-222">Por exemplo, você pode adicionar um manipulador de PreInit como o seguinte para um formulário da Web:</span><span class="sxs-lookup"><span data-stu-id="d4087-222">For example, you can add a PreInit handler such as the following to a Web Form:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample1.cs)]

<span data-ttu-id="d4087-223">Agora, crie uma página mestra chamada Mobile.Master na pasta de nível superior do seu aplicativo, e ele será usado quando um dispositivo móvel é detectado.</span><span class="sxs-lookup"><span data-stu-id="d4087-223">Now, create a master page called Mobile.Master in the top-level folder of your application, and it will be used when a mobile device is detected.</span></span> <span data-ttu-id="d4087-224">A página principal móvel pode fazer referência a uma folha de estilos CSS específicas para dispositivos móveis se necessário.</span><span class="sxs-lookup"><span data-stu-id="d4087-224">Your mobile master page can reference a mobile-specific CSS stylesheet if necessary.</span></span> <span data-ttu-id="d4087-225">Os visitantes de área de trabalho ainda verá a página mestra padrão, não aquele móvel.</span><span class="sxs-lookup"><span data-stu-id="d4087-225">Desktop visitors will still see your default master page, not the mobile one.</span></span>

### <a name="creating-independent-mobile-specific-web-forms"></a><span data-ttu-id="d4087-226">Criar formulários de Web independentes específicas para dispositivos móveis</span><span class="sxs-lookup"><span data-stu-id="d4087-226">Creating independent mobile-specific Web Forms</span></span>

<span data-ttu-id="d4087-227">Para obter a máxima flexibilidade, você pode ir muito mais do que apenas páginas mestras separadas para tipos diferentes de dispositivos.</span><span class="sxs-lookup"><span data-stu-id="d4087-227">For maximum flexibility, you can go much further than just having separate master pages for different device types.</span></span> <span data-ttu-id="d4087-228">Você pode implementar dois *totalmente separar conjuntos de páginas Web Forms* – um conjunto para navegadores de desktop, outro conjunto de móveis.</span><span class="sxs-lookup"><span data-stu-id="d4087-228">You can implement two *totally separate sets of Web Forms pages* – one set for desktop browsers, another set for mobiles.</span></span> <span data-ttu-id="d4087-229">Isso funciona melhor se você quiser apresentar informações muito diferentes ou fluxos de trabalho para visitantes móveis.</span><span class="sxs-lookup"><span data-stu-id="d4087-229">This works best if you want to present very different information or workflows to mobile visitors.</span></span> <span data-ttu-id="d4087-230">O restante desta seção descreve essa abordagem em detalhes.</span><span class="sxs-lookup"><span data-stu-id="d4087-230">The rest of this section describes this approach in detail.</span></span>

<span data-ttu-id="d4087-231">Supondo que você já tiver um aplicativo Web Forms projetado para navegadores de desktop, a maneira mais fácil para prosseguir é criar uma subpasta chamada "Móvel" dentro de seu projeto e criar suas páginas de celular.</span><span class="sxs-lookup"><span data-stu-id="d4087-231">Assuming you already have a Web Forms application designed for desktop browsers, the easiest way to proceed is to create a subfolder called "Mobile" within your project, and build your mobile pages there.</span></span> <span data-ttu-id="d4087-232">Você pode construir um subsite inteiro, com suas próprias páginas mestras, folhas de estilo e páginas, usando as mesmas técnicas que você usaria para qualquer outro aplicativo de Web Forms.</span><span class="sxs-lookup"><span data-stu-id="d4087-232">You can construct an entire sub-site, with its own master pages, style sheets, and pages, using all the same techniques that you'd use for any other Web Forms application.</span></span> <span data-ttu-id="d4087-233">Não é necessário produzir um equivalente móvel para *cada* página em seu site de área de trabalho; você pode escolher o subconjunto da funcionalidade faz sentido para os visitantes móveis.</span><span class="sxs-lookup"><span data-stu-id="d4087-233">You don't necessarily need to produce a mobile equivalent for *every* page in your desktop site; you can choose what subset of functionality makes sense for mobile visitors.</span></span>

<span data-ttu-id="d4087-234">Páginas de celular podem compartilhar recursos estáticos comuns (como imagens, JavaScript ou CSS arquivos) com suas páginas regulares se desejar.</span><span class="sxs-lookup"><span data-stu-id="d4087-234">Your mobile pages can share common static resources (such as images, JavaScript, or CSS files) with your regular pages if you wish.</span></span> <span data-ttu-id="d4087-235">Desde que a pasta "Móvel" será *não* ser marcado como um aplicativo separado quando hospedados no IIS (é apenas uma subpasta simple de páginas Web Forms), ele também compartilharão a mesma configuração, dados de sessão e outra infraestrutura como seu páginas da área de trabalho.</span><span class="sxs-lookup"><span data-stu-id="d4087-235">Since your "Mobile" folder will *not* be marked as a separate application when hosted in IIS (it's just a simple subfolder of Web Forms pages), it will also share all the same configuration, Session data, and other infrastructure as your desktop pages.</span></span>

> [!NOTE]
> <span data-ttu-id="d4087-236">Como essa abordagem geralmente envolve uma duplicação de código (páginas móveis são provavelmente compartilham algumas semelhanças com páginas da área de trabalho), é importante para criar qualquer comuns business dados ou lógica de código de acesso em uma camada subjacente compartilhada ou um serviço.</span><span class="sxs-lookup"><span data-stu-id="d4087-236">Since this approach usually involves some duplication of code (mobile pages are likely to share some similarities with desktop pages), it's important to factor out any common business logic or data access code into a shared underlying layer or service.</span></span> <span data-ttu-id="d4087-237">Caso contrário, você vai dobrar o esforço de criação e manutenção de seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="d4087-237">Otherwise, you'll double the effort of creating and maintaining your application.</span></span>


#### <a name="redirecting-mobile-visitors-to-your-mobile-pages"></a><span data-ttu-id="d4087-238">Redirecionando visitantes móveis às páginas móveis</span><span class="sxs-lookup"><span data-stu-id="d4087-238">Redirecting mobile visitors to your mobile pages</span></span>

<span data-ttu-id="d4087-239">É geralmente conveniente redirecionar visitantes móveis para as páginas móveis apenas o *primeiro* na sua sessão de navegação (e não em cada solicitação em sua sessão), a solicitação porque:</span><span class="sxs-lookup"><span data-stu-id="d4087-239">It's often convenient to redirect mobile visitors to the mobile pages only on the *first* request in their browsing session (and not on every request in their session), because:</span></span>

- <span data-ttu-id="d4087-240">Em seguida, você pode facilmente permitir visitantes móveis acessar as páginas da área de trabalho, se desejarem – colocar apenas um link em sua página mestra que vão para a "Versão da área de trabalho".</span><span class="sxs-lookup"><span data-stu-id="d4087-240">You can then easily allow mobile visitors to access your desktop pages if they wish – just put a link on your master page that goes to "Desktop version".</span></span> <span data-ttu-id="d4087-241">O visitante não ser redirecionado para uma página móvel, porque ele não é mais a primeira solicitação na sua sessão.</span><span class="sxs-lookup"><span data-stu-id="d4087-241">The visitor won't be redirected back to a mobile page, because it's no longer the first request in their session.</span></span>
- <span data-ttu-id="d4087-242">Isso evita o risco de interferir com solicitações de todos os recursos dinâmicos compartilhados entre partes móveis e desktop do seu site (por exemplo, se você tiver um formulário da Web comuns que exibem partes móveis e desktop de seu site em um IFRAME ou certos manipuladores Ajax)</span><span class="sxs-lookup"><span data-stu-id="d4087-242">It avoids the risk of interfering with requests for any dynamic resources shared between desktop and mobile parts of your site (e.g., if you have a common Web Form that both desktop and mobile parts of your site display in an IFRAME, or certain Ajax handlers)</span></span>

<span data-ttu-id="d4087-243">Para fazer isso, você pode colocar sua lógica de redirecionamento em um **sessão\_iniciar** método.</span><span class="sxs-lookup"><span data-stu-id="d4087-243">To do this, you can place your redirection logic in a **Session\_Start** method.</span></span> <span data-ttu-id="d4087-244">Por exemplo, adicione o seguinte método ao arquivo asax:</span><span class="sxs-lookup"><span data-stu-id="d4087-244">For example, add the following method to your Global.asax.cs file:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample2.cs)]

#### <a name="configuring-forms-authentication-to-respect-your-mobile-pages"></a><span data-ttu-id="d4087-245">Configurando a autenticação de formulários para respeitar as páginas móveis</span><span class="sxs-lookup"><span data-stu-id="d4087-245">Configuring Forms Authentication to respect your mobile pages</span></span>

<span data-ttu-id="d4087-246">Observe que a autenticação de formulários faz algumas suposições sobre onde ele poderá redirecionar os visitantes durante e após o processo de autenticação:</span><span class="sxs-lookup"><span data-stu-id="d4087-246">Note that Forms Authentication makes certain assumptions about where it can redirect visitors during and after the authentication process:</span></span>

- <span data-ttu-id="d4087-247">Quando um usuário precisa ser autenticada, autenticação de formulários redirecionará-los para a página de logon de área de trabalho, independentemente de se um usuário de desktop ou mobile (porque somente tem um conceito de *um* URL de logon).</span><span class="sxs-lookup"><span data-stu-id="d4087-247">When a user needs to be authenticated, Forms Authentication will redirect them to your desktop login page, regardless of whether they're a desktop or mobile user (because it only has a concept of *one* login URL).</span></span> <span data-ttu-id="d4087-248">Supondo que você deseja definir o estilo de sua página de logon móvel diferente, você precisa melhorar sua página de logon de área de trabalho para que ele redireciona os usuários móveis para uma página de logon móvel separado.</span><span class="sxs-lookup"><span data-stu-id="d4087-248">Assuming you want to style your mobile login page differently, you need to enhance your desktop login page so that it redirects mobile users to a separate mobile login page.</span></span> <span data-ttu-id="d4087-249">Por exemplo, adicione o seguinte código ao seu **desktop** lógica para página de logon:</span><span class="sxs-lookup"><span data-stu-id="d4087-249">For example, add the following code to your **desktop** login page code-behind:</span></span> 

    [!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample3.cs)]
- <span data-ttu-id="d4087-250">Depois que um usuário fizer logon com êxito, autenticação de formulários por padrão redirecionará-los para a home page da área de trabalho (porque somente tem um conceito de *um* página padrão).</span><span class="sxs-lookup"><span data-stu-id="d4087-250">After a user successfully logs in, Forms Authentication will by default redirect them to your desktop home page (because it only has a concept of *one* default page).</span></span> <span data-ttu-id="d4087-251">Você precisa aumentar sua página de logon móveis para que ele redireciona para a home page móvel após um log bem-sucedido.</span><span class="sxs-lookup"><span data-stu-id="d4087-251">You need to enhance your mobile login page so that it redirects to the mobile home page after a successful log-in.</span></span> <span data-ttu-id="d4087-252">Por exemplo, adicione o seguinte código ao seu **móvel** lógica para página de logon:</span><span class="sxs-lookup"><span data-stu-id="d4087-252">For example, add the following code to your **mobile** login page code-behind:</span></span> 

    [!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample4.cs)]
  
 <span data-ttu-id="d4087-253">Esse código supõe que a página tem um controle de servidor de logon chamado LoginUser, como o modelo de projeto padrão.</span><span class="sxs-lookup"><span data-stu-id="d4087-253">This code assumes your page has a Login server control called LoginUser, as in the default project template.</span></span>

### <a name="working-with-output-caching"></a><span data-ttu-id="d4087-254">Trabalhando com o cache de saída</span><span class="sxs-lookup"><span data-stu-id="d4087-254">Working with Output Caching</span></span>

<span data-ttu-id="d4087-255">Se você estiver usando o cache de saída, lembre-se de que por padrão é possível que um usuário visitar um determinado URL (fazendo com que a saída para ser armazenado em cache), seguido por um usuário móvel que, em seguida, recebe a saída de área de trabalho do cache.</span><span class="sxs-lookup"><span data-stu-id="d4087-255">If you're using output caching, beware that by default it's possible for a desktop user to visit a certain URL (causing its output to be cached), followed by a mobile user who then receives the cached desktop output.</span></span> <span data-ttu-id="d4087-256">Este aviso se aplica se você estiver apenas variando a página mestra por tipo de dispositivo ou implementando totalmente separadas Web Forms por tipo de dispositivo.</span><span class="sxs-lookup"><span data-stu-id="d4087-256">This warning applies whether you're just varying your master page by device type, or implementing totally separate Web Forms per device type.</span></span>

<span data-ttu-id="d4087-257">Para evitar o problema, você pode instruir o ASP.NET para variar a entrada de cache de acordo com se o visitante está usando um dispositivo móvel.</span><span class="sxs-lookup"><span data-stu-id="d4087-257">To avoid the problem, you can instruct ASP.NET to vary the cache entry according to whether the visitor is using a mobile device.</span></span> <span data-ttu-id="d4087-258">Adicione um parâmetro de VaryByCustom a declaração de OutputCache da página da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="d4087-258">Add a VaryByCustom parameter to your page's OutputCache declaration as follows:</span></span>

[!code-aspx[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample5.aspx)]

<span data-ttu-id="d4087-259">Em seguida, defina *isMobileDevice* como um cache personalizado parâmetro adicionando o seguinte método substituir em seu arquivo asax:</span><span class="sxs-lookup"><span data-stu-id="d4087-259">Next, define *isMobileDevice* as a custom cache parameter by adding the following method override to your Global.asax.cs file:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample6.cs)]

<span data-ttu-id="d4087-260">Isso garantirá que visitantes móveis não recebem saída anteriormente colocada em cache por um visitante de área de trabalho.</span><span class="sxs-lookup"><span data-stu-id="d4087-260">This will ensure that mobile visitors to the page don't receive output previously put into the cache by a desktop visitor.</span></span>

### <a name="a-working-example"></a><span data-ttu-id="d4087-261">Um exemplo de trabalho</span><span class="sxs-lookup"><span data-stu-id="d4087-261">A working example</span></span>

<span data-ttu-id="d4087-262">Para ver essas técnicas em ação, baixe [exemplos de código deste white paper](https://docs.microsoft.com/aspnet/mobile/overview).</span><span class="sxs-lookup"><span data-stu-id="d4087-262">To see these techniques in action, download [this white paper's code samples](https://docs.microsoft.com/aspnet/mobile/overview).</span></span> <span data-ttu-id="d4087-263">O aplicativo de exemplo de formulários da Web automaticamente redireciona os usuários móveis para um conjunto de páginas específicas para dispositivos móveis em uma subpasta chamada móvel.</span><span class="sxs-lookup"><span data-stu-id="d4087-263">The Web Forms sample application automatically redirects mobile users to a set of mobile-specific pages in a subfolder called Mobile.</span></span> <span data-ttu-id="d4087-264">A marcação e o estilo dessas páginas é otimizada para navegadores de dispositivos móveis, como você pode ver as capturas de tela a seguir:</span><span class="sxs-lookup"><span data-stu-id="d4087-264">The markup and styling of those pages is better optimized for mobile browsers, as you can see from the following screenshots:</span></span>

![](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/_static/image2.png)

<span data-ttu-id="d4087-265">Para obter mais dicas sobre como otimizar sua marcação e CSS para navegadores de dispositivos móveis, consulte a seção "Estilo móveis páginas para navegadores de dispositivos móveis" posteriormente neste documento.</span><span class="sxs-lookup"><span data-stu-id="d4087-265">For more tips about optimizing your markup and CSS for mobile browsers, see the section "Styling mobile pages for mobile browsers" later in this document.</span></span>

## <a name="how-aspnet-mvc-applications-can-present-mobile-specific-pages"></a><span data-ttu-id="d4087-266">Como os aplicativos ASP.NET MVC podem apresentar páginas específicas para dispositivos móveis</span><span class="sxs-lookup"><span data-stu-id="d4087-266">How ASP.NET MVC applications can present mobile-specific pages</span></span>

<span data-ttu-id="d4087-267">Como o padrão Model-View-Controller separa a lógica do aplicativo (nos controladores) da lógica de apresentação (nos modos de exibição), você pode escolher de qualquer uma das seguintes abordagens para lidar com suporte móvel no código do lado do servidor:</span><span class="sxs-lookup"><span data-stu-id="d4087-267">Since the Model-View-Controller pattern decouples application logic (in controllers) from presentation logic (in views), you can choose from any of the following approaches to handling mobile support in server-side code:</span></span>

1. <span data-ttu-id="d4087-268">***Usar o mesmo controladores e exibições para navegadores de desktop e móveis, mas renderizar exibições com diferentes layouts de Razor, dependendo do tipo de dispositivo*.**</span><span class="sxs-lookup"><span data-stu-id="d4087-268">***Use the same controllers and views for both desktop and mobile browsers, but render the views with different Razor layouts depending on the device type*.**</span></span> <span data-ttu-id="d4087-269">Essa opção funciona melhor se você estiver exibindo dados idênticos em todos os dispositivos, mas simplesmente deseja fornecer diferentes folhas de estilo CSS ou alterar alguns elementos de HTML de nível superior para celulares.</span><span class="sxs-lookup"><span data-stu-id="d4087-269">This option works best if you're displaying identical data on all devices, but simply want to supply different CSS stylesheets or change a few top-level HTML elements for mobiles.</span></span>
2. <span data-ttu-id="d4087-270">***Use os mesmos controladores para navegadores de desktop e móveis, mas renderizar exibições diferentes dependendo do tipo de dispositivo***.</span><span class="sxs-lookup"><span data-stu-id="d4087-270">***Use the same controllers for both desktop and mobile browsers, but render different views depending on the device type***.</span></span> <span data-ttu-id="d4087-271">Essa opção funciona melhor se você estiver exibindo aproximadamente os mesmos dados e fornecer os mesmos fluxos de trabalho para os usuários finais, mas deseja processar uma marcação HTML muito diferente de acordo com o dispositivo que está sendo usado.</span><span class="sxs-lookup"><span data-stu-id="d4087-271">This option works best if you're displaying roughly the same data and providing the same workflows for end users, but want to render very different HTML markup to suit the device being used.</span></span>
3. <span data-ttu-id="d4087-272">***Criar áreas separadas para navegadores de desktop e mobile, Implementando controladores independentes e modos de exibição para cada*.**</span><span class="sxs-lookup"><span data-stu-id="d4087-272">***Create separate areas for desktop and mobile browsers, implementing independent controllers and views for each*.**</span></span> <span data-ttu-id="d4087-273">Essa opção funciona melhor se você estiver exibindo as telas muito diferentes, que contém informações diferentes e à esquerda do usuário por meio de fluxos de trabalho diferentes, otimizado para o tipo de dispositivo.</span><span class="sxs-lookup"><span data-stu-id="d4087-273">This option works best if you're displaying very different screens, containing different information and leading the user through different workflows optimized for their device type.</span></span> <span data-ttu-id="d4087-274">Pode significar algum repetição de código, mas você pode minimizar que fatorar lógica comuns em uma camada subjacente ou de serviço.</span><span class="sxs-lookup"><span data-stu-id="d4087-274">It may mean some repetition of code, but you can minimize that by factoring out common logic into an underlying layer or service.</span></span>

<span data-ttu-id="d4087-275">Se você quiser tirar o **primeiro** opção e variar somente o layout do Razor por tipo de dispositivo, é muito fácil.</span><span class="sxs-lookup"><span data-stu-id="d4087-275">If you want to take the **first** option and vary only the Razor layout per device type, it's very easy.</span></span> <span data-ttu-id="d4087-276">Basta modificar o \_ViewStart.cshtml arquivos da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="d4087-276">Just modify your \_ViewStart.cshtml file as follows:</span></span>

[!code-cshtml[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample7.cshtml)]

<span data-ttu-id="d4087-277">Agora você pode criar um layout específicas para dispositivos móveis chamado \_LayoutMobile.cshtml com uma estrutura de página e CSS regras otimizado para dispositivos móveis.</span><span class="sxs-lookup"><span data-stu-id="d4087-277">Now you can create a mobile-specific layout called \_LayoutMobile.cshtml with a page structure and CSS rules optimized for mobile devices.</span></span>

<span data-ttu-id="d4087-278">Se você quiser tirar o **segundo** opção totalmente diferentes modos de exibição de renderização de acordo com o tipo de dispositivo do visitante, consulte [postagem no blog de Scott Hanselman](http://www.hanselman.com/blog/ABetterASPNETMVCMobileDeviceCapabilitiesViewEngine.aspx).</span><span class="sxs-lookup"><span data-stu-id="d4087-278">If you want to take the **second** option render totally different views according to the visitor's device type, see [Scott Hanselman's blog post](http://www.hanselman.com/blog/ABetterASPNETMVCMobileDeviceCapabilitiesViewEngine.aspx).</span></span>

<span data-ttu-id="d4087-279">O restante deste documento se concentra no **terceiro** opção – Criando controladores separados *e* modos de exibição para dispositivos móveis, para que você possa controlar exatamente o subconjunto da funcionalidade é oferecido para visitantes móveis.</span><span class="sxs-lookup"><span data-stu-id="d4087-279">The rest of this paper focuses on the **third** option – creating separate controllers *and* views for mobile devices – so you can control exactly what subset of functionality is offered for mobile visitors.</span></span>

### <a name="setting-up-a-mobile-area-within-your-aspnet-mvc-application"></a><span data-ttu-id="d4087-280">Configurando uma área móvel dentro de seu aplicativo ASP.NET MVC</span><span class="sxs-lookup"><span data-stu-id="d4087-280">Setting up a Mobile area within your ASP.NET MVC application</span></span>

<span data-ttu-id="d4087-281">Você pode adicionar uma área chamada "Móvel" para um aplicativo ASP.NET MVC existente da maneira normal: clique no nome do projeto no Gerenciador de soluções e escolha Adicionar à área.</span><span class="sxs-lookup"><span data-stu-id="d4087-281">You can add an area called "Mobile" to an existing ASP.NET MVC application in the normal way: right-click on your project name in Solution Explorer, then choose Add à Area.</span></span> <span data-ttu-id="d4087-282">Em seguida, você pode adicionar controladores e modos de exibição como faria com qualquer outra área dentro de um aplicativo ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="d4087-282">You can then add controllers and views as you would for any other area within an ASP.NET MVC application.</span></span> <span data-ttu-id="d4087-283">Por exemplo, adicione a sua área móvel um novo controlador chamado HomeController para atuar como uma página inicial para os visitantes móveis.</span><span class="sxs-lookup"><span data-stu-id="d4087-283">For example, add to your Mobile area a new controller called HomeController to act as a homepage for mobile visitors.</span></span>

### <a name="ensuring-the-url-mobile-reaches-the-mobile-homepage"></a><span data-ttu-id="d4087-284">Garantindo a URL /Mobile atinge a home page móvel</span><span class="sxs-lookup"><span data-stu-id="d4087-284">Ensuring the URL /Mobile reaches the mobile homepage</span></span>

<span data-ttu-id="d4087-285">Se você quiser /Mobile a URL para acessar a ação de índice no HomeController dentro de sua área móvel, você precisará fazer duas pequenas alterações à sua configuração de roteamento.</span><span class="sxs-lookup"><span data-stu-id="d4087-285">If you want the URL /Mobile to reach the Index action on HomeController inside your Mobile area, you will need to make two small changes to your routing configuration.</span></span> <span data-ttu-id="d4087-286">Atualize sua classe MobileAreaRegistration primeiro, para que HomeController o controlador padrão em sua área móvel, conforme mostrado no código a seguir:</span><span class="sxs-lookup"><span data-stu-id="d4087-286">First, update your MobileAreaRegistration class so that HomeController is the default controller in your Mobile area, as shown in the following code:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample8.cs)]

<span data-ttu-id="d4087-287">Isso significa que a home page móvel agora serão localizada em /Mobile, em vez de celular/Home, porque "Início" é agora o implicitamente o nome de controlador padrão para páginas de celular.</span><span class="sxs-lookup"><span data-stu-id="d4087-287">This means the mobile homepage will now be located at /Mobile, rather than /Mobile/Home, because "Home" is now the implicitly default controller name for mobile pages.</span></span>

<span data-ttu-id="d4087-288">Em seguida, observe que, adicionando um segundo HomeController para seu aplicativo (ou seja, móveis aquele, além da área de trabalho uma existente), você será desfeito sua home page de área de trabalho regular.</span><span class="sxs-lookup"><span data-stu-id="d4087-288">Next, note that by adding a second HomeController to your application (i.e., the mobile one, in addition to the existing desktop one), you'll have broken your regular desktop homepage.</span></span> <span data-ttu-id="d4087-289">Haverá falha com o erro "*vários tipos que corresponda o controlador nomeado 'Início' foram encontrados*".</span><span class="sxs-lookup"><span data-stu-id="d4087-289">It will fail with the error "*Multiple types were found that match the controller named 'Home'*".</span></span> <span data-ttu-id="d4087-290">Para resolver esse problema, atualize sua configuração de roteamento de nível superior (em Global.asax.cs) para especificar que a área de trabalho HomeController deve têm prioridade quando há ambiguidade:</span><span class="sxs-lookup"><span data-stu-id="d4087-290">To resolve this, update your top-level routing configuration (in Global.asax.cs) to specify that your desktop HomeController should take priority when there's ambiguity:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample9.cs)]

<span data-ttu-id="d4087-291">Agora o erro irá ausente e a URL http://*yoursite*/ atingirá a home page da área de trabalho e http://*yoursite*/mobile/ atingirá a home page móvel.</span><span class="sxs-lookup"><span data-stu-id="d4087-291">Now the error will go away, and the URL http://*yoursite*/ will reach the desktop homepage, and http://*yoursite*/mobile/ will reach the mobile homepage.</span></span>

### <a name="redirecting-mobile-visitors-to-your-mobile-area"></a><span data-ttu-id="d4087-292">Redirecionando visitantes móveis na sua área de móvel</span><span class="sxs-lookup"><span data-stu-id="d4087-292">Redirecting mobile visitors to your mobile area</span></span>

<span data-ttu-id="d4087-293">Há muitos pontos de extensibilidade diferentes no ASP.NET MVC, portanto, há muitas maneiras possíveis de injetar lógica de redirecionamento.</span><span class="sxs-lookup"><span data-stu-id="d4087-293">There are many different extensibility points in ASP.NET MVC, so there are many possible ways to inject redirection logic.</span></span> <span data-ttu-id="d4087-294">É uma opção interessante criar um atributo de filtro, [RedirectMobileDevicesToMobileArea], que realiza um redirecionamento se as seguintes condições forem atendidas:</span><span class="sxs-lookup"><span data-stu-id="d4087-294">One neat option is to create a filter attribute, [RedirectMobileDevicesToMobileArea], that performs a redirection if the following conditions are met:</span></span>

1. <span data-ttu-id="d4087-295">É a primeira solicitação na sessão do usuário (ou seja, Session.IsNewSession é igual a true)</span><span class="sxs-lookup"><span data-stu-id="d4087-295">It's the first request in the user's session (i.e., Session.IsNewSession equals true)</span></span>
2. <span data-ttu-id="d4087-296">A solicitação vier de um navegador móvel (ou seja, Request.Browser.IsMobileDevice é igual a true)</span><span class="sxs-lookup"><span data-stu-id="d4087-296">The request comes from a mobile browser (i.e., Request.Browser.IsMobileDevice equals true)</span></span>
3. <span data-ttu-id="d4087-297">O usuário já não solicita um recurso na área de trabalho móvel (ou seja, o *caminho* parte da URL não começa com /Mobile)</span><span class="sxs-lookup"><span data-stu-id="d4087-297">The user is not already requesting a resource in the mobile area (i.e., the *path* part of the URL does not begin with /Mobile)</span></span>

<span data-ttu-id="d4087-298">O exemplo disponível para download que acompanha este white paper inclui uma implementação dessa lógica.</span><span class="sxs-lookup"><span data-stu-id="d4087-298">The downloadable sample included with this white paper includes an implementation of this logic.</span></span> <span data-ttu-id="d4087-299">Ele é implementado como um filtro de autorização, derivado de AuthorizeAttribute, o que significa que ele pode funcionar corretamente, mesmo se você estiver usando o cache de saída (caso contrário, se um acessos de primeiro visitante de área de trabalho uma URL determinado, a saída de área de trabalho podem ser armazenados em cache e, em seguida, servido para visitantes móveis subsequentes).</span><span class="sxs-lookup"><span data-stu-id="d4087-299">It's implemented as an authorization filter, derived from AuthorizeAttribute, which means it can work correctly even if you are using output caching (otherwise, if a desktop visitor first accesses a certain URL, the desktop output might be cached and then served to subsequent mobile visitors).</span></span>

<span data-ttu-id="d4087-300">Como é um filtro, você pode escolher a específicos controladores e ações, por exemplo,</span><span class="sxs-lookup"><span data-stu-id="d4087-300">As it's a filter, you can choose either to apply it to specific controllers and actions, e.g.,</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample10.cs)]

<span data-ttu-id="d4087-301">…</span><span class="sxs-lookup"><span data-stu-id="d4087-301">…</span></span> <span data-ttu-id="d4087-302">ou você pode aplicá-la a todos os controladores e ações como um MVC 3 *filtro global* em seu arquivo asax:</span><span class="sxs-lookup"><span data-stu-id="d4087-302">or you can apply it to all controllers and actions as an MVC 3 *global filter* in your Global.asax.cs file:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample11.cs)]

<span data-ttu-id="d4087-303">O exemplo disponível para download também demonstra como você pode criar as subclasses desse atributo redirecionam para locais específicos dentro de sua área móvel.</span><span class="sxs-lookup"><span data-stu-id="d4087-303">The downloadable sample also demonstrates how you can create subclasses of this attribute that redirect to specific locations within your mobile area.</span></span> <span data-ttu-id="d4087-304">Isso significa que, por exemplo, você pode:</span><span class="sxs-lookup"><span data-stu-id="d4087-304">This means, for example, you can:</span></span>

- <span data-ttu-id="d4087-305">Registre um filtro global conforme mostrado acima que envia os visitantes móveis para a home page móvel por padrão.</span><span class="sxs-lookup"><span data-stu-id="d4087-305">Register a global filter as shown above that sends mobile visitors to the mobile homepage by default.</span></span>
- <span data-ttu-id="d4087-306">Também se aplicam um filtro [RedirectMobileDevicesToMobileProductPage] especial para uma ação de "Exibir produto" que leva os visitantes móveis para a versão móvel de qualquer página que eles solicitaram.</span><span class="sxs-lookup"><span data-stu-id="d4087-306">Also apply a special [RedirectMobileDevicesToMobileProductPage] filter to a "view product" action that takes mobile visitors to the mobile version of whatever product page they had requested.</span></span>
- <span data-ttu-id="d4087-307">Também aplicar outros subclasses especiais do filtro para ações específicas, redirecionando visitantes móveis para a página móvel equivalente</span><span class="sxs-lookup"><span data-stu-id="d4087-307">Also apply other special subclasses of the filter to specific actions, redirecting mobile visitors to the equivalent mobile page</span></span>

### <a name="configuring-forms-authentication-to-respect-your-mobile-pages"></a><span data-ttu-id="d4087-308">Configurando a autenticação de formulários para respeitar as páginas móveis</span><span class="sxs-lookup"><span data-stu-id="d4087-308">Configuring Forms Authentication to respect your mobile pages</span></span>

<span data-ttu-id="d4087-309">Se você estiver usando autenticação de formulários, você deve observar que quando um usuário precisa entrar, ele automaticamente redireciona o usuário para um único "logon" URL específica, que, por padrão, é **conta/LogOn**.</span><span class="sxs-lookup"><span data-stu-id="d4087-309">If you're using Forms Authentication, you should note that when a user needs to log in, it automatically redirects the user to a single specific "log on" URL, which by default is **/Account/LogOn**.</span></span> <span data-ttu-id="d4087-310">Isso significa que os usuários móveis podem ser redirecionados para a ação de área de trabalho "fazer logon".</span><span class="sxs-lookup"><span data-stu-id="d4087-310">This means that mobile users may be redirected to your desktop "log on" action.</span></span>

<span data-ttu-id="d4087-311">Para evitar esse problema, adicione lógica para a ação de "logon" área de trabalho para que ele redireciona os usuários móveis novamente para uma ação de "logon" móveis.</span><span class="sxs-lookup"><span data-stu-id="d4087-311">To avoid this problem, add logic to your desktop "log on" action so that it redirects mobile users again to a mobile "log on" action.</span></span> <span data-ttu-id="d4087-312">Se você estiver usando o modelo de aplicativo do ASP.NET MVC padrão, atualize ação de LogOn do AccountController da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="d4087-312">If you're using the default ASP.NET MVC application template, update AccountController's LogOn action as follows:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample12.cs)]

<span data-ttu-id="d4087-313">…</span><span class="sxs-lookup"><span data-stu-id="d4087-313">…</span></span> <span data-ttu-id="d4087-314">e, em seguida, implemente uma ação de "logon" específicas para dispositivos móveis adequado em um controlador chamado AccountController em sua área móvel.</span><span class="sxs-lookup"><span data-stu-id="d4087-314">and then implement a suitable mobile-specific "log on" action on a controller called AccountController in your Mobile area.</span></span>

### <a name="working-with-output-caching"></a><span data-ttu-id="d4087-315">Trabalhando com o cache de saída</span><span class="sxs-lookup"><span data-stu-id="d4087-315">Working with Output Caching</span></span>

<span data-ttu-id="d4087-316">Se você estiver usando o filtro [OutputCache], você deve forçar a entrada de cache para variar por tipo de dispositivo.</span><span class="sxs-lookup"><span data-stu-id="d4087-316">If you're using the [OutputCache] filter, you must force the cache entry to vary by device type.</span></span> <span data-ttu-id="d4087-317">Por exemplo, escreva:</span><span class="sxs-lookup"><span data-stu-id="d4087-317">For example, write:</span></span>

[!code-javascript[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample13.js)]

<span data-ttu-id="d4087-318">Em seguida, adicione o seguinte método ao arquivo asax:</span><span class="sxs-lookup"><span data-stu-id="d4087-318">Then, add the following method to your Global.asax.cs file:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample14.cs)]

<span data-ttu-id="d4087-319">Isso garantirá que visitantes móveis não recebem saída anteriormente colocada em cache por um visitante de área de trabalho.</span><span class="sxs-lookup"><span data-stu-id="d4087-319">This will ensure that mobile visitors to the page don't receive output previously put into the cache by a desktop visitor.</span></span>

### <a name="a-working-example"></a><span data-ttu-id="d4087-320">Um exemplo de trabalho</span><span class="sxs-lookup"><span data-stu-id="d4087-320">A working example</span></span>

<span data-ttu-id="d4087-321">Para ver essas técnicas em ação, baixe [código deste white paper associado exemplos](https://docs.microsoft.com/aspnet/mobile/overview).</span><span class="sxs-lookup"><span data-stu-id="d4087-321">To see these techniques in action, download [this white paper's code associated samples](https://docs.microsoft.com/aspnet/mobile/overview).</span></span> <span data-ttu-id="d4087-322">O exemplo inclui um aplicativo ASP.NET MVC 3 (versão Release Candidate) aprimorado para dar suporte a dispositivos móveis usando os métodos descritos acima.</span><span class="sxs-lookup"><span data-stu-id="d4087-322">The sample includes an ASP.NET MVC 3 (Release Candidate) application enhanced to support mobile devices using the methods described above.</span></span>

## <a name="further-guidance-and-suggestions"></a><span data-ttu-id="d4087-323">Mais diretrizes e sugestões</span><span class="sxs-lookup"><span data-stu-id="d4087-323">Further guidance and suggestions</span></span>

<span data-ttu-id="d4087-324">A discussão a seguir se aplica a formulários da Web e os desenvolvedores MVC que estão usando as técnicas discutidas neste documento.</span><span class="sxs-lookup"><span data-stu-id="d4087-324">The following discussion applies both to Web Forms and MVC developers who are using the techniques covered in this document.</span></span>

### <a name="enhancing-your-redirection-logic-using-51degreesmobi-foundation"></a><span data-ttu-id="d4087-325">Melhorando a sua lógica de redirecionamento usando 51Degrees.mobi Foundation</span><span class="sxs-lookup"><span data-stu-id="d4087-325">Enhancing your redirection logic using 51Degrees.mobi Foundation</span></span>

<span data-ttu-id="d4087-326">A lógica de redirecionamento mostrada neste documento pode ser perfeitamente suficiente para seu aplicativo, mas não funcionará se você precisar desativar sessões, ou com navegadores de dispositivos móveis que rejeitar cookies (eles não podem ter sessões), porque ele não sabe se uma determinada solicitação é o primeiro de que o visitante.</span><span class="sxs-lookup"><span data-stu-id="d4087-326">The redirection logic shown in this document may be perfectly sufficient for your application, but it won't work if you need to disable sessions, or with mobile browsers that reject cookies (these can't have sessions), because it won't know whether a given request is the first one from that visitor.</span></span>

<span data-ttu-id="d4087-327">Você já aprendeu como o 51Degrees.mobi Foundation do código-fonte aberto pode melhorar a precisão do ASP. Detecção de navegador do NET.</span><span class="sxs-lookup"><span data-stu-id="d4087-327">You already learned how the open source 51Degrees.mobi Foundation can improve the accuracy of ASP.NET's browser detection.</span></span> <span data-ttu-id="d4087-328">Ele também tem uma capacidade interna de redirecionar os visitantes móveis locais específicos configurados no Web. config. É possível trabalhar sem dependendo de sessões ASP.NET (e, portanto, os cookies) ao armazenar um log temporário de hashes de cabeçalhos HTTP e os endereços IP dos visitantes, portanto ele sabe se cada solicitação é o primeiro de um determinado vistor.</span><span class="sxs-lookup"><span data-stu-id="d4087-328">It also has a built-in ability to redirect mobile visitors to specific locations configured in Web.config. It's able to work without depending on ASP.NET Sessions (and hence cookies) by storing a temporary log of hashes of visitors' HTTP headers and IP addresses, so it knows whether or not each request is the first one from a given vistor.</span></span>

<span data-ttu-id="d4087-329">O seguinte elemento adicionado à seção fiftyOne do arquivo Web. config será redirecionado a primeira solicitação de um dispositivo móvel detectado para a página ~ / Mobile/Default.aspx.</span><span class="sxs-lookup"><span data-stu-id="d4087-329">The following element added to the fiftyOne section of the web.config file will redirect the first request from a detected mobile device to the page ~/Mobile/Default.aspx.</span></span> <span data-ttu-id="d4087-330">As solicitações para páginas sob a pasta móvel serão *não* ser redirecionado, independentemente do tipo de dispositivo.</span><span class="sxs-lookup"><span data-stu-id="d4087-330">Any requests to pages under the Mobile folder will *not* be redirected, regardless of device type.</span></span> <span data-ttu-id="d4087-331">Se o dispositivo móvel ficar inativo por um período de 20 minutos ou mais o dispositivo será esquecido e as solicitações subsequentes serão tratadas como novos para fins de redirecionamento.</span><span class="sxs-lookup"><span data-stu-id="d4087-331">If the mobile device has been inactive for a period of 20 minutes or more the device will be forgotten and subsequent requests will be treated as new ones for the purposes of redirection.</span></span>

[!code-xml[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample15.xml)]

<span data-ttu-id="d4087-332">Para obter mais detalhes, consulte [51degrees.mobi documentação Foundation](https://github.com/51Degrees/dotNET-Device-Detection).</span><span class="sxs-lookup"><span data-stu-id="d4087-332">For more details, see [51degrees.mobi Foundation documentation](https://github.com/51Degrees/dotNET-Device-Detection).</span></span>

> [!NOTE]
> <span data-ttu-id="d4087-333">Você *pode* recurso de redirecionamento do uso 51Degrees.mobi Foundation em aplicativos ASP.NET MVC, mas você precisará definir a configuração de redirecionamento em termos de URLs simples, não em termos de parâmetros de roteamentos ou colocando o MVC filtros em ações.</span><span class="sxs-lookup"><span data-stu-id="d4087-333">You *can* use 51Degrees.mobi Foundation's redirection feature on ASP.NET MVC applications, but you will need to define your redirection configuration in terms of plain URLs, not in terms of routing parameters or by putting MVC filters on actions.</span></span> <span data-ttu-id="d4087-334">Isso ocorre porque (no momento da gravação) 51Degrees.mobi Foundation não reconhece roteamento ou filtros.</span><span class="sxs-lookup"><span data-stu-id="d4087-334">This is because (at the time of writing) 51Degrees.mobi Foundation does not recognize filters or routing.</span></span>


### <a name="disabling-transcoders-and-proxy-servers"></a><span data-ttu-id="d4087-335">Desabilitando transcodificadores e servidores Proxy</span><span class="sxs-lookup"><span data-stu-id="d4087-335">Disabling Transcoders and Proxy Servers</span></span>

<span data-ttu-id="d4087-336">Operadores de rede móvel tem dois objetivos amplos abordagem à internet móvel:</span><span class="sxs-lookup"><span data-stu-id="d4087-336">Mobile network operators have two broad objectives in their approach to the mobile internet:</span></span>

1. <span data-ttu-id="d4087-337">Fornecer conteúdo relevante muito possível</span><span class="sxs-lookup"><span data-stu-id="d4087-337">Provide as much relevant content as possible</span></span>
2. <span data-ttu-id="d4087-338">Maximizar o número de clientes que podem compartilhar largura de banda de rede limitada de rádio</span><span class="sxs-lookup"><span data-stu-id="d4087-338">Maximize the number of customers who can share the limited radio network bandwidth</span></span>

<span data-ttu-id="d4087-339">Como a maioria das páginas da web foram criados para telas grandes porte a área de trabalho e conexões de banda larga da linha rápida fixa, muitos operadores usam *transcodificadores* ou *servidores proxy* que alterar dinamicamente o conteúdo da web.</span><span class="sxs-lookup"><span data-stu-id="d4087-339">Since most web pages were designed for large desktop-sized screens and fast fixed-line broadband connections, many operators use *transcoders* or *proxy servers* that dynamically alter web content.</span></span> <span data-ttu-id="d4087-340">Eles podem modificar sua marcação HTML ou CSS de acordo com a telas menores (especialmente para "recurso telefones" que não têm a capacidade de processamento para lidar com layouts complexos), e eles podem recompactar as imagens (reduzindo significativamente a qualidade) para melhorar a velocidade de entrega da página.</span><span class="sxs-lookup"><span data-stu-id="d4087-340">They may modify your HTML markup or CSS to suit smaller screens (especially for "feature phones" that lack the processing power to handle complex layouts), and they may recompress your images (significantly reducing their quality) to improve page delivery speeds.</span></span>

<span data-ttu-id="d4087-341">Mas se você tiver feito o esforço para produzir uma versão otimizado para celular do seu site, provavelmente não deseja que o operador de rede para interferir com ele qualquer adicional.</span><span class="sxs-lookup"><span data-stu-id="d4087-341">But if you've taken the effort to produce a mobile-optimized version of your site, you probably don't want the network operator to interfere with it any further.</span></span> <span data-ttu-id="d4087-342">Você pode adicionar a linha a seguir para a página\_evento de carregamento de qualquer forma de Web do ASP.NET:</span><span class="sxs-lookup"><span data-stu-id="d4087-342">You can add the following line to the Page\_Load event in any ASP.NET Web Form:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample16.cs)]

<span data-ttu-id="d4087-343">Ou, para um controlador do ASP.NET MVC, você pode adicionar a substituição de método a seguir para que ele se aplica a todas as ações desse controlador:</span><span class="sxs-lookup"><span data-stu-id="d4087-343">Or, for an ASP.NET MVC controller, you could add the following method override so that it applies to all actions on that controller:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample17.cs)]

<span data-ttu-id="d4087-344">A mensagem HTTP resultante informa transcodificadores compatíveis do W3C e proxies não deve alterar o conteúdo.</span><span class="sxs-lookup"><span data-stu-id="d4087-344">The resulting HTTP message informs W3C compliant transcoders and proxies not to alter content.</span></span> <span data-ttu-id="d4087-345">Obviamente, não há nenhuma garantia de que os operadores de rede móvel respeitarão essa mensagem.</span><span class="sxs-lookup"><span data-stu-id="d4087-345">Of course, there is no guarantee that mobile network operators will respect this message.</span></span>

### <a name="styling-mobile-pages-for-mobile-browsers"></a><span data-ttu-id="d4087-346">Páginas de celular de estilo para navegadores de dispositivos móveis</span><span class="sxs-lookup"><span data-stu-id="d4087-346">Styling mobile pages for mobile browsers</span></span>

<span data-ttu-id="d4087-347">Ele está além do escopo deste documento descrevem em detalhes quais tipos de trabalho de marcação HTML corretamente ou quais técnicas de design de web maximizar a usabilidade em dispositivos específicos.</span><span class="sxs-lookup"><span data-stu-id="d4087-347">It's beyond the scope of this document to describe in great detail what kinds of HTML markup work correctly or which web design techniques maximize usability on particular devices.</span></span> <span data-ttu-id="d4087-348">Ele tem backup para localizar um layout simples suficientemente, otimizado para uma tela de tamanho de celular, sem usar confiável HTML ou posicionamento truques CSS.</span><span class="sxs-lookup"><span data-stu-id="d4087-348">It's up to you to find a sufficiently simple layout, optimized for a mobile-sized screen, without using unreliable HTML or CSS positioning tricks.</span></span> <span data-ttu-id="d4087-349">No entanto, é uma técnica importante vale a pena mencionar, o *marca meta viewport*.</span><span class="sxs-lookup"><span data-stu-id="d4087-349">One important technique worth mentioning, however, is the *viewport meta tag*.</span></span>

<span data-ttu-id="d4087-350">Determinados navegadores móveis modernos, em uma página da web de exibição de esforço destinam-se para monitores de área de trabalho, renderizam a página em uma tela de virtual, também chamada de "visor" (por exemplo, o visor virtual é 980 pixels de largura no iPhone e 850 pixels de largura no Opera Mobile por padrão) e, em seguida, reduzi o resultado para caber em pixels físicos da tela.</span><span class="sxs-lookup"><span data-stu-id="d4087-350">Certain modern mobile browsers, in an effort display web pages meant for desktop monitors, render the page on a virtual canvas, also called "viewport" (e.g., the virtual viewport is 980 pixels wide on iPhone, and 850 pixels wide on Opera Mobile by default) and then scale the result down to fit onto the screen's physical pixels.</span></span> <span data-ttu-id="d4087-351">O usuário pode aplicar zoom e deslocar-se que visor.</span><span class="sxs-lookup"><span data-stu-id="d4087-351">The user can then zoom in and pan around that viewport.</span></span> <span data-ttu-id="d4087-352">Isso tem a vantagem de que ele permite que o navegador exibirá a página em seu layout desejado, mas também tem a desvantagem é que ele força o zoom e panorâmica, que é inconveniente para o usuário.</span><span class="sxs-lookup"><span data-stu-id="d4087-352">This has the advantage that it lets the browser display the page in its intended layout, but it's also has the disadvantage that it forces zooming and panning, which is inconvenient for the user.</span></span> <span data-ttu-id="d4087-353">Se você estiver criando para dispositivos móveis, é melhor design para uma tela específica para que nenhuma ampliação ou rolagem horizontal é necessário.</span><span class="sxs-lookup"><span data-stu-id="d4087-353">If you're designing for mobile, it's better to design for a narrow screen so that no zooming or horizontal scrolling is necessary.</span></span>

<span data-ttu-id="d4087-354">É uma forma de dizer que o navegador móvel a largura do visor deve ser por meio do padrão *visor* marca meta.</span><span class="sxs-lookup"><span data-stu-id="d4087-354">A way to tell the mobile browser how wide the viewport should be is through the nonstandard *viewport* meta tag.</span></span> <span data-ttu-id="d4087-355">Por exemplo, se você adicionar o seguinte à seção de cabeçalho da página,</span><span class="sxs-lookup"><span data-stu-id="d4087-355">For example, if you add the following to your page's HEAD section,</span></span>

[!code-html[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample18.html)]

<span data-ttu-id="d4087-356">…</span><span class="sxs-lookup"><span data-stu-id="d4087-356">…</span></span> <span data-ttu-id="d4087-357">suporte a navegadores do smartphone irá dispor a página em uma tela de virtual amplo 480 pixels.</span><span class="sxs-lookup"><span data-stu-id="d4087-357">then supporting smartphone browsers will lay out the page on a 480-pixel wide virtual canvas.</span></span> <span data-ttu-id="d4087-358">Isso significa que, se os elementos HTML definem as larguras em termos percentuais, as porcentagens serão interpretadas em relação a esse 480 pixels de largura, não a largura do visor padrão.</span><span class="sxs-lookup"><span data-stu-id="d4087-358">This means that if your HTML elements define their widths in percentage terms, the percentages will be interpreted with respect to this 480-pixel width, not the default viewport width.</span></span> <span data-ttu-id="d4087-359">Como resultado, o usuário é menos provável aplicar zoom e panorâmica horizontalmente – consideravelmente melhorar a experiência de navegação móvel.</span><span class="sxs-lookup"><span data-stu-id="d4087-359">As a result, the user is less likely to have to zoom and pan horizontally – considerably improving the mobile browsing experience.</span></span>

<span data-ttu-id="d4087-360">Se você desejar que a largura do visor para corresponder pixels físicos do dispositivo, você pode especificar o seguinte:</span><span class="sxs-lookup"><span data-stu-id="d4087-360">If you want the viewport width to match the device's physical pixels, you can specify the following:</span></span>

[!code-html[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample19.html)]

<span data-ttu-id="d4087-361">Para que isso funcione corretamente, você deve não explicitamente forçar elementos exceda essa largura (por exemplo, usando um *largura* atributo ou propriedade CSS), caso contrário, o navegador será forçado a usar um visor maior independentemente.</span><span class="sxs-lookup"><span data-stu-id="d4087-361">For this to work correctly, you must not explicitly force elements to exceed that width (e.g., using a *width* attribute or CSS property), otherwise the browser will be forced to use a larger viewport regardless.</span></span> <span data-ttu-id="d4087-362">Consulte também: [mais detalhes sobre a marca viewport padrão](https://developer.apple.com/library/safari/#documentation/AppleApplications/Reference/SafariHTMLRef/Articles/MetaTags.html).</span><span class="sxs-lookup"><span data-stu-id="d4087-362">See also: [more details about the nonstandard viewport tag](https://developer.apple.com/library/safari/#documentation/AppleApplications/Reference/SafariHTMLRef/Articles/MetaTags.html).</span></span>

<span data-ttu-id="d4087-363">Suporte a mais modernos smartphones *orientação dupla*: eles podem ser mantidos no modo retrato ou paisagem.</span><span class="sxs-lookup"><span data-stu-id="d4087-363">Most modern smartphones support *dual orientation*: they can be held in either portrait or landscape mode.</span></span> <span data-ttu-id="d4087-364">Portanto, é importante não faça suposições sobre a largura da tela em pixels.</span><span class="sxs-lookup"><span data-stu-id="d4087-364">So, it's important not to make assumptions about the screen width in pixels.</span></span> <span data-ttu-id="d4087-365">Não mesmo presuma que a largura da tela é fixo, porque o usuário pode orientar novamente seu dispositivo enquanto eles estiverem em sua página.</span><span class="sxs-lookup"><span data-stu-id="d4087-365">Don't even assume that the screen width is fixed, because the user can re-orient their device while they are on your page.</span></span>

<span data-ttu-id="d4087-366">Dispositivos mais antigos do Windows Mobile e Blackberry também podem aceitar as seguintes marcas meta no cabeçalho da página para informá-los conteúdo foi otimizado para dispositivos móveis e, portanto, não devem ser transformadas.</span><span class="sxs-lookup"><span data-stu-id="d4087-366">Older Windows Mobile and Blackberry devices may also accept the following meta tags in the page header to inform them content has been optimized for mobile and therefore should not be transformed.</span></span>

[!code-html[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample20.html)]

## <a name="additional-resources"></a><span data-ttu-id="d4087-367">Recursos adicionais</span><span class="sxs-lookup"><span data-stu-id="d4087-367">Additional Resources</span></span>

<span data-ttu-id="d4087-368">Para obter uma lista de emuladores de dispositivos móveis e simuladores, você pode usar para testar seu aplicativo móvel de web do ASP.NET, consulte a página [simular dispositivos móveis populares para teste](../mobile/device-simulators.md).</span><span class="sxs-lookup"><span data-stu-id="d4087-368">For a list of mobile device emulators and simulators you can use to test your mobile ASP.NET web application, see the page [Simulate popular mobile devices for testing](../mobile/device-simulators.md).</span></span>

## <a name="credits"></a><span data-ttu-id="d4087-369">Créditos</span><span class="sxs-lookup"><span data-stu-id="d4087-369">Credits</span></span>

- <span data-ttu-id="d4087-370">Autor principal: Steven Sanderson</span><span class="sxs-lookup"><span data-stu-id="d4087-370">Primary author: Steven Sanderson</span></span>
- <span data-ttu-id="d4087-371">Revisores / adicionais gravadores de conteúdo: James Rosewell, Mikael Söderström, Scott Hanselman, Scott Hunter</span><span class="sxs-lookup"><span data-stu-id="d4087-371">Reviewers / additional content writers: James Rosewell, Mikael Söderström, Scott Hanselman, Scott Hunter</span></span>

---
uid: mvc/overview/older-versions-1/models-data/creating-model-classes-with-the-entity-framework-vb
title: Criando Classes de modelo com o Entity Framework (VB) | Microsoft Docs
author: microsoft
description: "Neste tutorial, você aprenderá como usar o ASP.NET MVC com o Entity Framework da Microsoft. Você aprenderá a usar o Assistente de entidade para criar um de entidade ADO.NET..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 01/27/2009
ms.topic: article
ms.assetid: ff8322c9-12f3-4e24-aba6-a38046b9bb0d
ms.technology: dotnet-mvc
ms.prod: .net-framework
msc.legacyurl: /mvc/overview/older-versions-1/models-data/creating-model-classes-with-the-entity-framework-vb
msc.type: authoredcontent
ms.openlocfilehash: efc190d856fe9ebf1c09e0ae4758aabb1e3254dc
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 11/10/2017
---
<a name="creating-model-classes-with-the-entity-framework-vb"></a><span data-ttu-id="5f676-104">Criando Classes de modelo com o Entity Framework (VB)</span><span class="sxs-lookup"><span data-stu-id="5f676-104">Creating Model Classes with the Entity Framework (VB)</span></span>
====================
<span data-ttu-id="5f676-105">por [Microsoft](https://github.com/microsoft)</span><span class="sxs-lookup"><span data-stu-id="5f676-105">by [Microsoft](https://github.com/microsoft)</span></span>

> <span data-ttu-id="5f676-106">Neste tutorial, você aprenderá como usar o ASP.NET MVC com o Entity Framework da Microsoft.</span><span class="sxs-lookup"><span data-stu-id="5f676-106">In this tutorial, you learn how to use ASP.NET MVC with the Microsoft Entity Framework.</span></span> <span data-ttu-id="5f676-107">Você aprenderá a usar o Assistente de entidade para criar um modelo de dados de entidade ADO.NET.</span><span class="sxs-lookup"><span data-stu-id="5f676-107">You learn how to use the Entity Wizard to create an ADO.NET Entity Data Model.</span></span> <span data-ttu-id="5f676-108">No decorrer deste tutorial, vamos criar um aplicativo web que ilustra como selecionar, inserir, atualizar e excluir dados do banco de dados usando o Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="5f676-108">Over the course of this tutorial, we build a web application that illustrates how to select, insert, update, and delete database data by using the Entity Framework.</span></span>


<span data-ttu-id="5f676-109">O objetivo deste tutorial é explicar como você pode criar classes de acesso de dados usando o Entity Framework da Microsoft ao compilar um aplicativo ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="5f676-109">The goal of this tutorial is to explain how you can create data access classes using the Microsoft Entity Framework when building an ASP.NET MVC application.</span></span> <span data-ttu-id="5f676-110">Este tutorial não pressupõe que nenhum conhecimento anterior de Microsoft Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="5f676-110">This tutorial assumes no previous knowledge of the Microsoft Entity Framework.</span></span> <span data-ttu-id="5f676-111">No final deste tutorial, compreender como usar o Entity Framework para selecionar, inserir, atualizar e excluir registros do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="5f676-111">By the end of this tutorial, you'll understand how to use the Entity Framework to select, insert, update, and delete database records.</span></span>

<span data-ttu-id="5f676-112">O Entity Framework da Microsoft é uma ferramenta de mapeamento relacional objeto (O/RM) que permite que você gere uma camada de acesso a dados de um banco de dados automaticamente.</span><span class="sxs-lookup"><span data-stu-id="5f676-112">The Microsoft Entity Framework is an Object Relational Mapping (O/RM) tool that enables you to generate a data access layer from a database automatically.</span></span> <span data-ttu-id="5f676-113">O Entity Framework permite que você evite o trabalho tedioso de compilação de suas classes de acesso de dados manualmente.</span><span class="sxs-lookup"><span data-stu-id="5f676-113">The Entity Framework enables you to avoid the tedious work of building your data access classes by hand.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="5f676-114">Não há nenhuma conexão essencial entre ASP.NET MVC e o Entity Framework da Microsoft.</span><span class="sxs-lookup"><span data-stu-id="5f676-114">There is no essential connection between ASP.NET MVC and the Microsoft Entity Framework.</span></span> <span data-ttu-id="5f676-115">Há várias alternativas para o Entity Framework que você pode usar com o ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="5f676-115">There are several alternatives to the Entity Framework that you can use with ASP.NET MVC.</span></span> <span data-ttu-id="5f676-116">Por exemplo, você pode criar suas classes de modelo MVC usando outras ferramentas do / RM, como Microsoft LINQ to SQL, o NHibernate ou SubSonic.</span><span class="sxs-lookup"><span data-stu-id="5f676-116">For example, you can build your MVC Model classes using other O/RM tools such as Microsoft LINQ to SQL, NHibernate, or SubSonic.</span></span>


<span data-ttu-id="5f676-117">Para ilustrar como você pode usar o Entity Framework da Microsoft com o ASP.NET MVC, criaremos um aplicativo de exemplo simples.</span><span class="sxs-lookup"><span data-stu-id="5f676-117">In order to illustrate how you can use the Microsoft Entity Framework with ASP.NET MVC, we'll build a simple sample application.</span></span> <span data-ttu-id="5f676-118">Vamos criar um aplicativo de banco de dados do filme que permite exibir e editar registros de banco de dados do filme.</span><span class="sxs-lookup"><span data-stu-id="5f676-118">We'll create a Movie Database application that enables you to display and edit movie database records.</span></span>

<span data-ttu-id="5f676-119">Este tutorial presume que você tenha o Visual Studio 2008 ou o Visual Web Developer 2008 com Service Pack 1.</span><span class="sxs-lookup"><span data-stu-id="5f676-119">This tutorial assumes that you have Visual Studio 2008 or Visual Web Developer 2008 with Service Pack 1.</span></span> <span data-ttu-id="5f676-120">Você precisa Service Pack 1 para usar o Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="5f676-120">You need Service Pack 1 in order to use the Entity Framework.</span></span> <span data-ttu-id="5f676-121">Você pode baixar o Visual Studio 2008 Service Pack 1 ou o Visual Web Developer com Service Pack 1 do seguinte endereço:</span><span class="sxs-lookup"><span data-stu-id="5f676-121">You can download Visual Studio 2008 Service Pack 1 or Visual Web Developer with Service Pack 1 from the following address:</span></span>

> [<span data-ttu-id="5f676-122">https://www.ASP.NET/downloads/</span><span class="sxs-lookup"><span data-stu-id="5f676-122">https://www.asp.net/downloads/</span></span>](https://www.asp.net/downloads)


## <a name="creating-the-movie-sample-database"></a><span data-ttu-id="5f676-123">Criando o banco de dados de exemplo do filme</span><span class="sxs-lookup"><span data-stu-id="5f676-123">Creating the Movie Sample Database</span></span>

<span data-ttu-id="5f676-124">O aplicativo de banco de dados do filme usa uma tabela de banco de dados denominada filmes que contém as seguintes colunas:</span><span class="sxs-lookup"><span data-stu-id="5f676-124">The Movie Database application uses a database table named Movies that contains the following columns:</span></span>

| <span data-ttu-id="5f676-125">Nome da coluna</span><span class="sxs-lookup"><span data-stu-id="5f676-125">Column Name</span></span> | <span data-ttu-id="5f676-126">Tipo de dados</span><span class="sxs-lookup"><span data-stu-id="5f676-126">Data Type</span></span> | <span data-ttu-id="5f676-127">Permitir nulos?</span><span class="sxs-lookup"><span data-stu-id="5f676-127">Allow Nulls?</span></span> | <span data-ttu-id="5f676-128">É a chave primária?</span><span class="sxs-lookup"><span data-stu-id="5f676-128">Is Primary Key?</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="5f676-129">Id</span><span class="sxs-lookup"><span data-stu-id="5f676-129">Id</span></span> | <span data-ttu-id="5f676-130">int</span><span class="sxs-lookup"><span data-stu-id="5f676-130">int</span></span> | <span data-ttu-id="5f676-131">False</span><span class="sxs-lookup"><span data-stu-id="5f676-131">False</span></span> | <span data-ttu-id="5f676-132">verdadeiro</span><span class="sxs-lookup"><span data-stu-id="5f676-132">True</span></span> |
| <span data-ttu-id="5f676-133">Título</span><span class="sxs-lookup"><span data-stu-id="5f676-133">Title</span></span> | <span data-ttu-id="5f676-134">nvarchar (100)</span><span class="sxs-lookup"><span data-stu-id="5f676-134">nvarchar(100)</span></span> | <span data-ttu-id="5f676-135">False</span><span class="sxs-lookup"><span data-stu-id="5f676-135">False</span></span> | <span data-ttu-id="5f676-136">False</span><span class="sxs-lookup"><span data-stu-id="5f676-136">False</span></span> |
| <span data-ttu-id="5f676-137">Diretor</span><span class="sxs-lookup"><span data-stu-id="5f676-137">Director</span></span> | <span data-ttu-id="5f676-138">nvarchar (100)</span><span class="sxs-lookup"><span data-stu-id="5f676-138">nvarchar(100)</span></span> | <span data-ttu-id="5f676-139">False</span><span class="sxs-lookup"><span data-stu-id="5f676-139">False</span></span> | <span data-ttu-id="5f676-140">False</span><span class="sxs-lookup"><span data-stu-id="5f676-140">False</span></span> |

<span data-ttu-id="5f676-141">Você pode adicionar essa tabela para um projeto ASP.NET MVC seguindo estas etapas:</span><span class="sxs-lookup"><span data-stu-id="5f676-141">You can add this table to an ASP.NET MVC project by following these steps:</span></span>

1. <span data-ttu-id="5f676-142">Clique com botão direito do aplicativo\_pasta de dados na janela do Gerenciador de soluções e selecione a opção de menu **Add, o novo Item.**</span><span class="sxs-lookup"><span data-stu-id="5f676-142">Right-click the App\_Data folder in the Solution Explorer window and select the menu option **Add, New Item.**</span></span>
2. <span data-ttu-id="5f676-143">Do **Adicionar Novo Item** caixa de diálogo, selecione **o banco de dados do SQL Server**, forneça o nome MoviesDB.mdf de banco de dados e clique no **adicionar** botão.</span><span class="sxs-lookup"><span data-stu-id="5f676-143">From the **Add New Item** dialog box, select **SQL Server Database**, give the database the name MoviesDB.mdf, and click the **Add** button.</span></span>
3. <span data-ttu-id="5f676-144">Clique duas vezes no arquivo de MoviesDB.mdf para abrir a janela do Gerenciador do servidor Explorer/banco de dados.</span><span class="sxs-lookup"><span data-stu-id="5f676-144">Double-click the MoviesDB.mdf file to open the Server Explorer/Database Explorer window.</span></span>
4. <span data-ttu-id="5f676-145">Expanda a conexão de banco de dados MoviesDB.mdf, com o botão direito na pasta tabelas e selecione a opção de menu **adicionar nova tabela**.</span><span class="sxs-lookup"><span data-stu-id="5f676-145">Expand the MoviesDB.mdf database connection, right-click the Tables folder, and select the menu option **Add New Table**.</span></span>
5. <span data-ttu-id="5f676-146">No Designer de tabela, adicione as colunas de Id, título e Director.</span><span class="sxs-lookup"><span data-stu-id="5f676-146">In the Table Designer, add the Id, Title, and Director columns.</span></span>
6. <span data-ttu-id="5f676-147">Clique o **salvar** botão (ele tem o ícone de disquete) para salvar a nova tabela com os nome de filmes.</span><span class="sxs-lookup"><span data-stu-id="5f676-147">Click the **Save** button (it has the icon of the floppy) to save the new table with the name Movies.</span></span>

<span data-ttu-id="5f676-148">Depois de criar a tabela de banco de dados de filmes, você deve adicionar alguns dados de exemplo para a tabela.</span><span class="sxs-lookup"><span data-stu-id="5f676-148">After you create the Movies database table, you should add some sample data to the table.</span></span> <span data-ttu-id="5f676-149">A tabela de filmes e selecione a opção de menu **Mostrar dados da tabela**.</span><span class="sxs-lookup"><span data-stu-id="5f676-149">Right-click the Movies table and select the menu option **Show Table Data**.</span></span> <span data-ttu-id="5f676-150">Você pode inserir dados do filme falso para a grade que aparece.</span><span class="sxs-lookup"><span data-stu-id="5f676-150">You can enter fake movie data into the grid that appears.</span></span>

## <a name="creating-the-adonet-entity-data-model"></a><span data-ttu-id="5f676-151">Criar o modelo de dados de entidade ADO.NET</span><span class="sxs-lookup"><span data-stu-id="5f676-151">Creating the ADO.NET Entity Data Model</span></span>

<span data-ttu-id="5f676-152">Para usar o Entity Framework, você precisa criar um modelo de dados de entidade.</span><span class="sxs-lookup"><span data-stu-id="5f676-152">In order to use the Entity Framework, you need to create an Entity Data Model.</span></span> <span data-ttu-id="5f676-153">Você pode tirar proveito do Visual Studio *Assistente de modelo de dados de entidade* para gerar um modelo de dados de entidade de banco de dados automaticamente.</span><span class="sxs-lookup"><span data-stu-id="5f676-153">You can take advantage of the Visual Studio *Entity Data Model Wizard* to generate an Entity Data Model from a database automatically.</span></span>

<span data-ttu-id="5f676-154">Siga estas etapas:</span><span class="sxs-lookup"><span data-stu-id="5f676-154">Follow these steps:</span></span>

1. <span data-ttu-id="5f676-155">Clique na pasta de modelos na janela do Gerenciador de soluções e selecione a opção de menu **adicionar, o novo Item**.</span><span class="sxs-lookup"><span data-stu-id="5f676-155">Right-click the Models folder in the Solution Explorer window and select the menu option **Add, New Item**.</span></span>
2. <span data-ttu-id="5f676-156">No **Adicionar Novo Item** caixa de diálogo, selecione a categoria de dados (consulte a Figura 1).</span><span class="sxs-lookup"><span data-stu-id="5f676-156">In the **Add New Item** dialog, select the Data category (see Figure 1).</span></span>
3. <span data-ttu-id="5f676-157">Selecione o **modelo de dados de entidade ADO.NET** modelo, nomeie o modelo de dados de entidade de MoviesDBModel.edmx e clique no **adicionar** botão.</span><span class="sxs-lookup"><span data-stu-id="5f676-157">Select the **ADO.NET Entity Data Model** template, give the Entity Data Model the name MoviesDBModel.edmx, and click the **Add** button.</span></span> <span data-ttu-id="5f676-158">Clique o **adicionar** botão inicia o Assistente de modelo de dados.</span><span class="sxs-lookup"><span data-stu-id="5f676-158">Clicking the **Add** button launches the Data Model Wizard.</span></span>
4. <span data-ttu-id="5f676-159">No **escolher o modelo de conteúdo** etapa, escolha o **gerar um banco de dados** opção e clique no **próximo** botão (consulte a Figura 2).</span><span class="sxs-lookup"><span data-stu-id="5f676-159">In the **Choose Model Contents** step, choose the **Generate from a database** option and click the **Next** button (see Figure 2).</span></span>
5. <span data-ttu-id="5f676-160">No **escolha sua Conexão de dados** etapa, selecione a conexão de banco de dados MoviesDB.mdf, insira as entidades de configurações de conexão nome MoviesDBEntities e clique no **próximo** botão (consulte a Figura 3).</span><span class="sxs-lookup"><span data-stu-id="5f676-160">In the **Choose Your Data Connection** step, select the MoviesDB.mdf database connection, enter the entities connection settings name MoviesDBEntities, and click the **Next** button (see Figure 3).</span></span>
6. <span data-ttu-id="5f676-161">No **escolher seus objetos de banco de dados** etapa, selecione a tabela de banco de dados do filme e clique no **concluir** botão (consulte a Figura 4).</span><span class="sxs-lookup"><span data-stu-id="5f676-161">In the **Choose Your Database Objects** step, select the Movie database table and click the **Finish** button (see Figure 4).</span></span>

<span data-ttu-id="5f676-162">Depois de concluir essas etapas, o Designer de modelo de dados de entidade ADO.NET (Designer de entidade) é aberto.</span><span class="sxs-lookup"><span data-stu-id="5f676-162">After you complete these steps, the ADO.NET Entity Data Model Designer (Entity Designer) opens.</span></span>

<span data-ttu-id="5f676-163">**Figura 1 – criar um novo modelo de dados de entidade**</span><span class="sxs-lookup"><span data-stu-id="5f676-163">**Figure 1 – Creating a new Entity Data Model**</span></span>

![clip_image002](creating-model-classes-with-the-entity-framework-vb/_static/image1.jpg)

<span data-ttu-id="5f676-165">**Figura 2 – Escolha a etapa de conteúdo do modelo**</span><span class="sxs-lookup"><span data-stu-id="5f676-165">**Figure 2 – Choose Model Contents Step**</span></span>

![clip_image004](creating-model-classes-with-the-entity-framework-vb/_static/image2.jpg)

<span data-ttu-id="5f676-167">**Figura 3 – Escolha sua Conexão de dados**</span><span class="sxs-lookup"><span data-stu-id="5f676-167">**Figure 3 – Choose Your Data Connection**</span></span>

![clip_image006](creating-model-classes-with-the-entity-framework-vb/_static/image3.jpg)

<span data-ttu-id="5f676-169">**Figura 4 – Escolha seus objetos de banco de dados**</span><span class="sxs-lookup"><span data-stu-id="5f676-169">**Figure 4 – Choose Your Database Objects**</span></span>

![clip_image008](creating-model-classes-with-the-entity-framework-vb/_static/image4.jpg)

## <a name="modifying-the-adonet-entity-data-model"></a><span data-ttu-id="5f676-171">Modificar o modelo de dados de entidade ADO.NET</span><span class="sxs-lookup"><span data-stu-id="5f676-171">Modifying the ADO.NET Entity Data Model</span></span>

<span data-ttu-id="5f676-172">Depois de criar um modelo de dados de entidade, você pode modificar o modelo, aproveitando o Entity Designer (consulte a Figura 5).</span><span class="sxs-lookup"><span data-stu-id="5f676-172">After you create an Entity Data Model, you can modify the model by taking advantage of the Entity Designer (see Figure 5).</span></span> <span data-ttu-id="5f676-173">Você pode abrir o Designer de entidade a qualquer momento clicando no arquivo MoviesDBModel.edmx contido na pasta modelos dentro da janela do Gerenciador de soluções.</span><span class="sxs-lookup"><span data-stu-id="5f676-173">You can open the Entity Designer at any time by double-clicking the MoviesDBModel.edmx file contained in the Models folder within the Solution Explorer window.</span></span>

<span data-ttu-id="5f676-174">**Figura 5 – o Designer de modelo de dados de entidade ADO.NET**</span><span class="sxs-lookup"><span data-stu-id="5f676-174">**Figure 5 – The ADO.NET Entity Data Model Designer**</span></span>

![clip_image010](creating-model-classes-with-the-entity-framework-vb/_static/image5.jpg)

<span data-ttu-id="5f676-176">Por exemplo, você pode usar o Entity Designer para alterar os nomes das classes que gera o Assistente de dados de modelo de entidade.</span><span class="sxs-lookup"><span data-stu-id="5f676-176">For example, you can use the Entity Designer to change the names of the classes that the Entity Model Data Wizard generates.</span></span> <span data-ttu-id="5f676-177">O assistente criou uma nova classe de acesso a dados, denominada filmes.</span><span class="sxs-lookup"><span data-stu-id="5f676-177">The Wizard created a new data access class named Movies.</span></span> <span data-ttu-id="5f676-178">Em outras palavras, o assistente deu a classe com o mesmo nome que a tabela de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="5f676-178">In other words, the Wizard gave the class the very same name as the database table.</span></span> <span data-ttu-id="5f676-179">Pois usaremos esta classe para representar uma instância específica do filme, podemos deve renomear a classe de filmes para filme.</span><span class="sxs-lookup"><span data-stu-id="5f676-179">Because we will use this class to represent a particular Movie instance, we should rename the class from Movies to Movie.</span></span>

<span data-ttu-id="5f676-180">Se você quiser renomear uma classe de entidade, você pode clique duas vezes no nome da classe no Entity Designer e digite um novo nome (veja a Figura 6).</span><span class="sxs-lookup"><span data-stu-id="5f676-180">If you want to rename an entity class, you can double-click on the class name in the Entity Designer and enter a new name (see Figure 6).</span></span> <span data-ttu-id="5f676-181">Como alternativa, você pode alterar o nome de uma entidade na janela Propriedades depois de selecionar uma entidade no Entity Designer.</span><span class="sxs-lookup"><span data-stu-id="5f676-181">Alternatively, you can change the name of an entity in the Properties window after selecting an entity in the Entity Designer.</span></span>

<span data-ttu-id="5f676-182">**Figura 6 – alterar um nome de entidade**</span><span class="sxs-lookup"><span data-stu-id="5f676-182">**Figure 6 – Changing an entity name**</span></span>

![clip_image012](creating-model-classes-with-the-entity-framework-vb/_static/image6.jpg)

<span data-ttu-id="5f676-184">Lembre-se de salvar o modelo de dados de entidade depois de fazer uma modificação clicando no botão Salvar (o ícone de disquete).</span><span class="sxs-lookup"><span data-stu-id="5f676-184">Remember to save your Entity Data Model after making a modification by clicking the Save button (the icon of the floppy disk).</span></span> <span data-ttu-id="5f676-185">Nos bastidores, o Designer de entidade gera um conjunto de classes do Visual Basic .NET.</span><span class="sxs-lookup"><span data-stu-id="5f676-185">Behind the scenes, the Entity Designer generates a set of Visual Basic .NET classes.</span></span> <span data-ttu-id="5f676-186">Você pode exibir essas classes abrindo o arquivo MoviesDBModel.Designer.vb da janela do Gerenciador de soluções.</span><span class="sxs-lookup"><span data-stu-id="5f676-186">You can view these classes by opening the MoviesDBModel.Designer.vb file from the Solution Explorer window.</span></span>


<span data-ttu-id="5f676-187">Não modifique o código no arquivo de designer desde que suas alterações serão substituídas na próxima vez que você usar o Designer de entidade.</span><span class="sxs-lookup"><span data-stu-id="5f676-187">Don't modify the code in the Designer.vb file since your changes will be overwritten the next time you use the Entity Designer.</span></span> <span data-ttu-id="5f676-188">Se desejar estender a funcionalidade das classes de entidade definidas no arquivo de Designer, você pode criar *classes parciais* arquivos separados em.</span><span class="sxs-lookup"><span data-stu-id="5f676-188">If you want to extend the functionality of the entity classes defined in the Designer.vb file then you can create *partial classes* in separate files.</span></span>


#### <a name="selecting-database-records-with-the-entity-framework"></a><span data-ttu-id="5f676-189">Selecionando registros do banco de dados com o Entity Framework</span><span class="sxs-lookup"><span data-stu-id="5f676-189">Selecting Database Records with the Entity Framework</span></span>

<span data-ttu-id="5f676-190">Vamos começar criando o nosso aplicativo de banco de dados do filme, criando uma página que exibe uma lista de registros do filme.</span><span class="sxs-lookup"><span data-stu-id="5f676-190">Let's start building our Movie Database application by creating a page that displays a list of movie records.</span></span> <span data-ttu-id="5f676-191">O controlador Home na listagem 1 expõe uma ação chamada index ().</span><span class="sxs-lookup"><span data-stu-id="5f676-191">The Home controller in Listing 1 exposes an action named Index().</span></span> <span data-ttu-id="5f676-192">A ação Index () retorna todos os registros de filme da tabela de banco de dados do filme, tirando proveito do Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="5f676-192">The Index() action returns all of the movie records from the Movie database table by taking advantage of the Entity Framework.</span></span>

<span data-ttu-id="5f676-193">**Listando 1 – Controllers\HomeController.vb**</span><span class="sxs-lookup"><span data-stu-id="5f676-193">**Listing 1 – Controllers\HomeController.vb**</span></span>

[!code-vb[Main](creating-model-classes-with-the-entity-framework-vb/samples/sample1.vb)]

<span data-ttu-id="5f676-194">Observe que o controlador na listagem 1 inclui um construtor.</span><span class="sxs-lookup"><span data-stu-id="5f676-194">Notice that the controller in Listing 1 includes a constructor.</span></span> <span data-ttu-id="5f676-195">O construtor inicializa um campo de nível de classe chamado \_banco de dados.</span><span class="sxs-lookup"><span data-stu-id="5f676-195">The constructor initializes a class-level field named \_db.</span></span> <span data-ttu-id="5f676-196">O \_campo do banco de dados representa as entidades de banco de dados geradas pelo Microsoft Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="5f676-196">The \_db field represents the database entities generated by the Microsoft Entity Framework.</span></span> <span data-ttu-id="5f676-197">O \_campo de banco de dados é uma instância da classe MoviesDBEntities que foi gerada pelo Designer de entidade.</span><span class="sxs-lookup"><span data-stu-id="5f676-197">The \_db field is an instance of the MoviesDBEntities class that was generated by the Entity Designer.</span></span>

<span data-ttu-id="5f676-198">O \_campo de banco de dados é usado na ação Index () para recuperar os registros da tabela de banco de dados de filmes.</span><span class="sxs-lookup"><span data-stu-id="5f676-198">The \_db field is used within the Index() action to retrieve the records from the Movies database table.</span></span> <span data-ttu-id="5f676-199">A expressão \_banco de dados. MovieSet representa todos os registros da tabela de banco de dados de filmes.</span><span class="sxs-lookup"><span data-stu-id="5f676-199">The expression \_db.MovieSet represents all of the records from the Movies database table.</span></span> <span data-ttu-id="5f676-200">O método ToList() é usado para converter o conjunto de filmes em uma coleção genérica de objetos de filme: lista (de filme).</span><span class="sxs-lookup"><span data-stu-id="5f676-200">The ToList() method is used to convert the set of movies into a generic collection of Movie objects: List( Of Movie).</span></span>

<span data-ttu-id="5f676-201">Os registros de filme são recuperados com a Ajuda do LINQ to Entities.</span><span class="sxs-lookup"><span data-stu-id="5f676-201">The movie records are retrieved with the help of LINQ to Entities.</span></span> <span data-ttu-id="5f676-202">A ação de Index () na listagem 1 usa LINQ *sintaxe de método* para recuperar o conjunto de registros do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="5f676-202">The Index() action in Listing 1 uses LINQ *method syntax* to retrieve the set of database records.</span></span> <span data-ttu-id="5f676-203">Se preferir, você pode usar o LINQ *sintaxe de consulta* em vez disso.</span><span class="sxs-lookup"><span data-stu-id="5f676-203">If you prefer, you can use LINQ *query syntax* instead.</span></span> <span data-ttu-id="5f676-204">As duas instruções a seguir são a mesma coisa:</span><span class="sxs-lookup"><span data-stu-id="5f676-204">The following two statements do the very same thing:</span></span>

[!code-vb[Main](creating-model-classes-with-the-entity-framework-vb/samples/sample2.vb)]

<span data-ttu-id="5f676-205">Use a sintaxe LINQ – sintaxe de método ou sintaxe de consulta – que você consideram mais intuitiva.</span><span class="sxs-lookup"><span data-stu-id="5f676-205">Use whichever LINQ syntax – method syntax or query syntax – that you find most intuitive.</span></span> <span data-ttu-id="5f676-206">Não há nenhuma diferença no desempenho entre as duas abordagens – a única diferença é o estilo.</span><span class="sxs-lookup"><span data-stu-id="5f676-206">There is no difference in performance between the two approaches – the only difference is style.</span></span>

<span data-ttu-id="5f676-207">O modo de exibição na lista 2 é usado para exibir os registros do filme.</span><span class="sxs-lookup"><span data-stu-id="5f676-207">The view in Listing 2 is used to display the movie records.</span></span>

<span data-ttu-id="5f676-208">**A listagem 2 – Views\Home\Index.aspx**</span><span class="sxs-lookup"><span data-stu-id="5f676-208">**Listing 2 – Views\Home\Index.aspx**</span></span>

[!code-aspx[Main](creating-model-classes-with-the-entity-framework-vb/samples/sample3.aspx)]

<span data-ttu-id="5f676-209">O modo de exibição na lista 2 contém um **para cada** loop que itera por meio de cada registro de filme e exibe os valores das propriedades de título e diretor do registro do filme.</span><span class="sxs-lookup"><span data-stu-id="5f676-209">The view in Listing 2 contains a **For Each** loop that iterates through each movie record and displays the values of the movie record's Title and Director properties.</span></span> <span data-ttu-id="5f676-210">Observe que um link de edição e exclusão é exibido ao lado de cada registro.</span><span class="sxs-lookup"><span data-stu-id="5f676-210">Notice that an Edit and Delete link is displayed next to each record.</span></span> <span data-ttu-id="5f676-211">Além disso, um link Adicionar filme aparece na parte inferior do modo de exibição (consulte a Figura 7).</span><span class="sxs-lookup"><span data-stu-id="5f676-211">Furthermore, an Add Movie link appears at the bottom of the view (see Figure 7).</span></span>

<span data-ttu-id="5f676-212">**Figura 7 – o modo de exibição do índice**</span><span class="sxs-lookup"><span data-stu-id="5f676-212">**Figure 7 – The Index view**</span></span>

![clip_image014](creating-model-classes-with-the-entity-framework-vb/_static/image7.jpg)

<span data-ttu-id="5f676-214">A exibição do índice é um *digitado exibição*.</span><span class="sxs-lookup"><span data-stu-id="5f676-214">The Index view is a *typed view*.</span></span> <span data-ttu-id="5f676-215">A exibição do índice tem um &lt;% @ Page %&gt; diretiva que inclui um atributo Inherits.</span><span class="sxs-lookup"><span data-stu-id="5f676-215">The Index view has a &lt;%@ Page %&gt; directive that includes an Inherits attribute.</span></span> <span data-ttu-id="5f676-216">O atributo Inherits converte a propriedade ViewData.Model para uma coleção fortemente tipada genérica lista de objetos de filme – uma lista (de filme).</span><span class="sxs-lookup"><span data-stu-id="5f676-216">The Inherits attribute casts the ViewData.Model property to a strongly typed generic List collection of Movie objects – a List(Of Movie).</span></span>

## <a name="inserting-database-records-with-the-entity-framework"></a><span data-ttu-id="5f676-217">Inserindo registros do banco de dados com o Entity Framework</span><span class="sxs-lookup"><span data-stu-id="5f676-217">Inserting Database Records with the Entity Framework</span></span>

<span data-ttu-id="5f676-218">Você pode usar o Entity Framework para tornar mais fácil inserir novos registros em uma tabela de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="5f676-218">You can use the Entity Framework to make it easy to insert new records into a database table.</span></span> <span data-ttu-id="5f676-219">A listagem 3 contém duas novas ações adicionadas para a classe do controlador inicial que você pode usar para inserir novos registros na tabela de banco de dados do filme.</span><span class="sxs-lookup"><span data-stu-id="5f676-219">Listing 3 contains two new actions added to the Home controller class that you can use to insert new records into the Movie database table.</span></span>

<span data-ttu-id="5f676-220">**A listagem 3 – Controllers\HomeController.vb (Adicionar métodos)**</span><span class="sxs-lookup"><span data-stu-id="5f676-220">**Listing 3 – Controllers\HomeController.vb (Add methods)**</span></span>

[!code-vb[Main](creating-model-classes-with-the-entity-framework-vb/samples/sample4.vb)]

<span data-ttu-id="5f676-221">A primeira ação Add simplesmente retorna uma exibição.</span><span class="sxs-lookup"><span data-stu-id="5f676-221">The first Add() action simply returns a view.</span></span> <span data-ttu-id="5f676-222">O modo de exibição contém um formulário para adicionar um novo banco de dados do filme registrar (consulte a Figura 8).</span><span class="sxs-lookup"><span data-stu-id="5f676-222">The view contains a form for adding a new movie database record (see Figure 8).</span></span> <span data-ttu-id="5f676-223">Quando você enviar o formulário, a segunda ação Add () é chamada.</span><span class="sxs-lookup"><span data-stu-id="5f676-223">When you submit the form, the second Add() action is invoked.</span></span>

<span data-ttu-id="5f676-224">Observe que a segunda ação Add está decorada com o atributo AcceptVerbs.</span><span class="sxs-lookup"><span data-stu-id="5f676-224">Notice that the second Add() action is decorated with the AcceptVerbs attribute.</span></span> <span data-ttu-id="5f676-225">Esta ação pode ser invocada somente quando uma operação HTTP POST.</span><span class="sxs-lookup"><span data-stu-id="5f676-225">This action can be invoked only when performing an HTTP POST operation.</span></span> <span data-ttu-id="5f676-226">Em outras palavras, essa ação só pode ser chamada durante o lançamento de um formulário HTML.</span><span class="sxs-lookup"><span data-stu-id="5f676-226">In other words, this action can only be invoked when posting an HTML form.</span></span>

<span data-ttu-id="5f676-227">A segunda ação Add () cria uma nova instância da classe filme do Entity Framework com a Ajuda do método TryUpdateModel() do ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="5f676-227">The second Add() action creates a new instance of the Entity Framework Movie class with the help of the ASP.NET MVC TryUpdateModel() method.</span></span> <span data-ttu-id="5f676-228">O método TryUpdateModel() usa os campos de FormCollection passado para o método Add () e atribui os valores desses campos de formulário HTML para a classe do filme.</span><span class="sxs-lookup"><span data-stu-id="5f676-228">The TryUpdateModel() method takes the fields in the FormCollection passed to the Add() method and assigns the values of these HTML form fields to the Movie class.</span></span>


<span data-ttu-id="5f676-229">Ao usar o Entity Framework, você deve fornecer uma "lista de permissões" de propriedades ao usar os métodos TryUpdateModel ou UpdateModel para atualizar as propriedades de uma classe de entidade.</span><span class="sxs-lookup"><span data-stu-id="5f676-229">When using the Entity Framework, you must supply a "white list" of properties when using the TryUpdateModel or UpdateModel methods to update the properties of an entity class.</span></span>


<span data-ttu-id="5f676-230">Em seguida, a ação Add () executa uma validação de formulário simples.</span><span class="sxs-lookup"><span data-stu-id="5f676-230">Next, the Add() action performs some simple form validation.</span></span> <span data-ttu-id="5f676-231">A ação verifica se o título e o Diretor propriedades têm valores.</span><span class="sxs-lookup"><span data-stu-id="5f676-231">The action verifies that both the Title and Director properties have values.</span></span> <span data-ttu-id="5f676-232">Se houver um erro de validação, uma mensagem de erro de validação é adicionada para o ModelState.</span><span class="sxs-lookup"><span data-stu-id="5f676-232">If there is a validation error, then a validation error message is added to ModelState.</span></span>

<span data-ttu-id="5f676-233">Se não houver nenhum erro de validação um novo registro de filme é adicionado à tabela de banco de dados de filmes com a Ajuda do Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="5f676-233">If there are no validation errors then a new movie record is added to the Movies database table with the help of the Entity Framework.</span></span> <span data-ttu-id="5f676-234">O novo registro é adicionado ao banco de dados com as duas linhas de código a seguir:</span><span class="sxs-lookup"><span data-stu-id="5f676-234">The new record is added to the database with the following two lines of code:</span></span>

[!code-vb[Main](creating-model-classes-with-the-entity-framework-vb/samples/sample5.vb)]

<span data-ttu-id="5f676-235">A primeira linha do código adiciona a nova entidade de filme ao conjunto de filmes que estão sendo rastreados pelo Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="5f676-235">The first line of code adds the new Movie entity to the set of movies being tracked by the Entity Framework.</span></span> <span data-ttu-id="5f676-236">A segunda linha do código salva as alterações foram feitas para filmes sendo rastreados no banco de dados subjacente.</span><span class="sxs-lookup"><span data-stu-id="5f676-236">The second line of code saves whatever changes have been made to the Movies being tracked back to the underlying database.</span></span>

<span data-ttu-id="5f676-237">**Figura 8 – o modo de exibição de adicionar**</span><span class="sxs-lookup"><span data-stu-id="5f676-237">**Figure 8 – The Add view**</span></span>

![clip_image016](creating-model-classes-with-the-entity-framework-vb/_static/image8.jpg)

## <a name="updating-database-records-with-the-entity-framework"></a><span data-ttu-id="5f676-239">Atualizando os registros do banco de dados com o Entity Framework</span><span class="sxs-lookup"><span data-stu-id="5f676-239">Updating Database Records with the Entity Framework</span></span>

<span data-ttu-id="5f676-240">Você pode seguir quase a mesma abordagem para editar um registro de banco de dados com o Entity Framework, como o método que seguimos apenas para inserir um novo registro de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="5f676-240">You can follow almost the same approach to edit a database record with the Entity Framework as the approach that we just followed to insert a new database record.</span></span> <span data-ttu-id="5f676-241">A listagem 4 contém duas novas ações de controlador, denominadas Edit().</span><span class="sxs-lookup"><span data-stu-id="5f676-241">Listing 4 contains two new controller actions named Edit().</span></span> <span data-ttu-id="5f676-242">A primeira ação Edit() retorna um formulário HTML para editar um registro de filme.</span><span class="sxs-lookup"><span data-stu-id="5f676-242">The first Edit() action returns an HTML form for editing a movie record.</span></span> <span data-ttu-id="5f676-243">A segunda ação Edit() tenta atualizar o banco de dados.</span><span class="sxs-lookup"><span data-stu-id="5f676-243">The second Edit() action attempts to update the database.</span></span>

<span data-ttu-id="5f676-244">**A listagem 4 – Controllers\HomeController.vb (editar métodos)**</span><span class="sxs-lookup"><span data-stu-id="5f676-244">**Listing 4 – Controllers\HomeController.vb (Edit methods)**</span></span>

[!code-vb[Main](creating-model-classes-with-the-entity-framework-vb/samples/sample6.vb)]

<span data-ttu-id="5f676-245">A segunda ação Edit() inicia, recuperando o registro de filme de banco de dados que corresponde à Id do filme que está sendo editado.</span><span class="sxs-lookup"><span data-stu-id="5f676-245">The second Edit() action starts by retrieving the Movie record from the database that matches the Id of the movie being edited.</span></span> <span data-ttu-id="5f676-246">O LINQ seguinte à instrução de entidades captura o primeiro registro de banco de dados que corresponde a uma determinada identificação:</span><span class="sxs-lookup"><span data-stu-id="5f676-246">The following LINQ to Entities statement grabs the first database record that matches a particular Id:</span></span>

[!code-vb[Main](creating-model-classes-with-the-entity-framework-vb/samples/sample7.vb)]

<span data-ttu-id="5f676-247">Em seguida, o método TryUpdateModel() é usado para atribuir os valores dos campos de formulário HTML para as propriedades da entidade do filme.</span><span class="sxs-lookup"><span data-stu-id="5f676-247">Next, the TryUpdateModel() method is used to assign the values of the HTML form fields to the properties of the movie entity.</span></span> <span data-ttu-id="5f676-248">Observe que uma lista de permissões é fornecida para especificar as propriedades exatas para atualizar.</span><span class="sxs-lookup"><span data-stu-id="5f676-248">Notice that a white list is supplied to specify the exact properties to update.</span></span>

<span data-ttu-id="5f676-249">Em seguida, uma validação simple é executada para verificar se o título do filme e diretor propriedades têm valores.</span><span class="sxs-lookup"><span data-stu-id="5f676-249">Next, some simple validation is performed to verify that both the Movie Title and Director properties have values.</span></span> <span data-ttu-id="5f676-250">Se a propriedade está faltando um valor, em seguida, uma mensagem de erro de validação é adicionada ao ModelState e ModelState retorna o valor false.</span><span class="sxs-lookup"><span data-stu-id="5f676-250">If either property is missing a value, then a validation error message is added to ModelState and ModelState.IsValid returns the value false.</span></span>

<span data-ttu-id="5f676-251">Por fim, se não houver nenhum erro de validação, a tabela de banco de dados de filmes subjacente é atualizada com as alterações chamando o método SaveChanges ().</span><span class="sxs-lookup"><span data-stu-id="5f676-251">Finally, if there are no validation errors, then the underlying Movies database table is updated with any changes by calling the SaveChanges() method.</span></span>

<span data-ttu-id="5f676-252">Durante a edição de registros do banco de dados, você precisa passar a Id do registro que está sendo editado para a ação de controlador que executa a atualização do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="5f676-252">When editing database records, you need to pass the Id of the record being edited to the controller action that performs the database update.</span></span> <span data-ttu-id="5f676-253">Caso contrário, a ação de controlador não saberá qual registro será atualizado no banco de dados subjacente.</span><span class="sxs-lookup"><span data-stu-id="5f676-253">Otherwise, the controller action will not know which record to update in the underlying database.</span></span> <span data-ttu-id="5f676-254">O modo de exibição de edição, contido na listagem 5, inclui um campo de formulário oculto que representa a Id do registro de banco de dados que está sendo editado.</span><span class="sxs-lookup"><span data-stu-id="5f676-254">The Edit view, contained in Listing 5, includes a hidden form field that represents the Id of the database record being edited.</span></span>

<span data-ttu-id="5f676-255">**Listando 5 – Views\Home\Edit.aspx**</span><span class="sxs-lookup"><span data-stu-id="5f676-255">**Listing 5 – Views\Home\Edit.aspx**</span></span>

[!code-aspx[Main](creating-model-classes-with-the-entity-framework-vb/samples/sample8.aspx)]

## <a name="deleting-database-records-with-the-entity-framework"></a><span data-ttu-id="5f676-256">Excluir registros do banco de dados com o Entity Framework</span><span class="sxs-lookup"><span data-stu-id="5f676-256">Deleting Database Records with the Entity Framework</span></span>

<span data-ttu-id="5f676-257">A operação de banco de dados final, precisamos abordar neste tutorial, é excluir registros do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="5f676-257">The final database operation, which we need to tackle in this tutorial, is deleting database records.</span></span> <span data-ttu-id="5f676-258">Você pode usar a ação de controlador na listagem 6 para excluir um registro de banco de dados específico.</span><span class="sxs-lookup"><span data-stu-id="5f676-258">You can use the controller action in Listing 6 to delete a particular database record.</span></span>

<span data-ttu-id="5f676-259">**Listando 6 – \Controllers\HomeController.vb (ação de exclusão)**</span><span class="sxs-lookup"><span data-stu-id="5f676-259">**Listing 6 -- \Controllers\HomeController.vb (Delete action)**</span></span>

[!code-vb[Main](creating-model-classes-with-the-entity-framework-vb/samples/sample9.vb)]

<span data-ttu-id="5f676-260">A ação Delete () primeiro recupera o filme que corresponde à Id da entidade é passada para a ação.</span><span class="sxs-lookup"><span data-stu-id="5f676-260">The Delete() action first retrieves the Movie entity that matches the Id passed to the action.</span></span> <span data-ttu-id="5f676-261">Em seguida, o filme é excluído do banco de dados chamando o método DeleteObject() seguido pelo método SaveChanges ().</span><span class="sxs-lookup"><span data-stu-id="5f676-261">Next, the movie is deleted from the database by calling the DeleteObject() method followed by the SaveChanges() method.</span></span> <span data-ttu-id="5f676-262">Por fim, o usuário é redirecionado de volta para o modo de exibição do índice.</span><span class="sxs-lookup"><span data-stu-id="5f676-262">Finally, the user is redirected back to the Index view.</span></span>

## <a name="summary"></a><span data-ttu-id="5f676-263">Resumo</span><span class="sxs-lookup"><span data-stu-id="5f676-263">Summary</span></span>

<span data-ttu-id="5f676-264">O objetivo deste tutorial foi demonstrar como você pode criar aplicativos da web para banco de dados, aproveitando o ASP.NET MVC e o Entity Framework da Microsoft.</span><span class="sxs-lookup"><span data-stu-id="5f676-264">The purpose of this tutorial was to demonstrate how you can build database-driven web applications by taking advantage of ASP.NET MVC and the Microsoft Entity Framework.</span></span> <span data-ttu-id="5f676-265">Você aprendeu a criar um aplicativo que permite que você selecionar, inserir, atualizar e excluir registros do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="5f676-265">You learned how to build an application that enables you to select, insert, update, and delete database records.</span></span>

<span data-ttu-id="5f676-266">Primeiro, discutimos como você pode usar o Assistente de modelo de dados de entidade para gerar um modelo de dados de entidade de dentro do Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="5f676-266">First, we discussed how you can use the Entity Data Model Wizard to generate an Entity Data Model from within Visual Studio.</span></span> <span data-ttu-id="5f676-267">Em seguida, você aprenderá a usar o LINQ to Entities para recuperar um conjunto de registros do banco de dados de uma tabela de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="5f676-267">Next, you learn how to use LINQ to Entities to retrieve a set of database records from a database table.</span></span> <span data-ttu-id="5f676-268">Finalmente, usamos o Entity Framework para inserir, atualizar e excluir registros do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="5f676-268">Finally, we used the Entity Framework to insert, update, and delete database records.</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="5f676-269">[Anterior](validation-with-the-data-annotation-validators-cs.md)
[Próximo](creating-model-classes-with-linq-to-sql-vb.md)</span><span class="sxs-lookup"><span data-stu-id="5f676-269">[Previous](validation-with-the-data-annotation-validators-cs.md)
[Next](creating-model-classes-with-linq-to-sql-vb.md)</span></span>
